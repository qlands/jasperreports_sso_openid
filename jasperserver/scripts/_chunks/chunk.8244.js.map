{"version":3,"sources":["webpack://jrs-ui/./src/components/components.searchBox.js","webpack://jrs-ui/./src/manage/mng.common.actions.js","webpack://jrs-ui/./src/manage/mng.common.js","webpack://jrs-ui/./src/manage/mng.org.module.js","webpack://jrs-ui/./src/manage/mng.main.js","webpack://jrs-ui/./src/manage/mng.root.js","webpack://jrs-ui/./src/tenantImportExport/utils/RegExpRepresenter.js","webpack://jrs-ui/./src/tenantImportExport/export/view/ExportDialogView.js","webpack://jrs-ui/./src/tenantImportExport/import/view/ImportDialogView.js","webpack://jrs-ui/../js-sdk/src/common/component/tree/plugin/ContextMenuTreePlugin.js","webpack://jrs-ui/./src/tenantImportExport/utils/tenantTreeDataUriTemplateUtil.js","webpack://jrs-ui/./src/tenantImportExport/view/tenantTree.js","webpack://jrs-ui/../js-sdk/src/common/component/menu/template/menuOptionTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/menu/Menu.js","webpack://jrs-ui/../js-sdk/src/common/component/menu/template/menuContainerTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/menu/ContextMenu.js","webpack://jrs-ui/./src/tenantImportExport/view/TenantsTreeView.js","webpack://jrs-ui/./src/tenantImportExport/templates/tooltipTemplate.htm","webpack://jrs-ui/./src/util/tools.infiniteScroll.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/ConfirmationDialog.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/confirmDialogTemplate.htm"],"names":["SearchBox","options","this","_id","id","_dom","jQuery","_enabled","_process","_assignHandlers","addMethod","_input","find","_clearButton","_searchButton","on","e","Event","stop","_keyPressHandler","bindAsEventListener","_clearHandler","_searchHandler","KEY_RETURN","keyCode","_doSearch","getText","blank","removeClass","layoutModule","addClass","setText","getValue","text","setValue","_updateClearButtonVisibility","buttonManager","attr","onSearch","orgModule","createAction","entity","data","Object","toJSON","entityName","assigned","unassigned","unencryptedEntity","entities","collect","getNameWithTenant","entityEvent","action","onSuccess","successData","exist","onExist","uniqueId","onNotExist","onError","errorData","inputData","responseData","actionName","event","Error","org","count","length","dialog","ConfirmationDialog","open","getDisplayName","showConfirm","properties","locked","isChanged","confirm","lock","isEditMode","cancel","done","newEntity","getDetailsLoadedEntity","showProperties","fullName","unlock","entityId","cancelIfEdit","hide","RegExpRepresenter","expression","charMap","expressionTokens","__parse","assign","TREE_ID","COOKIE_NAME","messages","ActionMap","SEARCH","BROWSE","NEXT","SELECT_AND_GET_DETAILS","SEARCH_AVAILABLE","SEARCH_ASSIGNED","NEXT_AVAILABLE","NEXT_ASSIGNED","CREATE","UPDATE","DELETE","DELETE_ALL","EXIST","ORG_BROWSE","ENTITY_SEARCH","ENTITY_NEXT","ENTITY_SELECT_AND_GET_DETAILS","RESULT_CHANGED","RESULT_NEXT","ENTITY_DETAILS_LOADED","SEARCH_AVAILABLE_LOADED","SEARCH_ASSIGNED_LOADED","NEXT_AVAILABLE_LOADED","NEXT_ASSIGNED_LOADED","SERVER_ERROR","SERVER_UNAVAILABLE","ENTITY_CREATED","ENTITY_UPDATED","ENTITY_DELETED","ENTITIES_DELETED","observe","eventName","handler","_getContainer","stopObserving","fire","memo","getMessage","messageId","message","Template","evaluate","_comparator","l1","l2","_container","document","body","Configuration","nameSeparator","userDefaultRole","userNameNotSupportedSymbols","roleNameNotSupportedSymbols","emailRegExpPattern","superuserRole","adminRole","anonymousRole","jsonOrNode","param","name","uri","treeNode","tenantId","tenantName","alias","tenantAlias","desc","tenantDesc","tenantUri","parentId","subTenantCount","level","primaryNavModule","deepClone","toQueryString","isInherited","permission","inheritedPermission","isDisabled","newPermission","userName","password","confirmPassword","email","enabled","external","roles","each","role","push","bind","permissionToDisplay","_flowId","FLOW_ID","encodeURIComponent","user","toData","roleName","selectedItem","selectedTenant","window","localStorage","setItem","JSON","stringify","organization","changeDisable","_EDIT_BUTTON_ID","force","refreshAttributes","ID_PATTERN","_listId","_containerId","_searchBoxId","initialize","list","dynamicList","listTemplateDomId","listTemplateId","itemTemplateDomId","itemTemplateId","multiSelect","selectionDefaultsToCursor","comparator","item1","item2","getLabel","_initEvents","_infiniteScroll","InfiniteScroll","contentId","_searchBox","onLoad","toolbarModel","toolbar","show","item","lastSelectedName","tenantsTree","getTenant","isCtrlHeld","refresh","stopSelectOrUnselect","_createEntityItem","value","label","entityList","processTemplate","element","select","update","xssUtil","getSearchText","setSearchText","getSelectedEntities","getSelectedItems","setEntities","items","reset","setItems","findEntity","getItems","_","addEntities","addItems","selectEntity","matched","detect","isSelected","deselect","restoreSelectedEntity","deselectAll","resetSelected","findAll","remove","entityNameOrNameSet","all","isArray","include","removeItems","_EDIT_MODE_CLASS","_moveButtonsId","_value","_NOTHING_TO_DISPLAY_ID","_ASSIGNED_VIEW_ID","_ASSIGNED_VIEW_LIST_ID","_ASSIGNED_ID","_AVAILABLE_ID","_ASSIGNED_LIST_ID","_AVAILABLE_LIST_ID","_ATTRIBUTES_LIST_ID","_SAVE_BUTTON_ID","_CANCEL_BUTTON_ID","_DELETE_BUTTON_ID","_REMOVE_FROM_ASSIGNED_BUTTON_ID","_ADD_TO_ASSIGNED_BUTTON_ID","_BUTTONS_CONTAINER_ID","_MOVE_BUTTONS_CONTAINER_ID","_DND_CLASS","_DROP_CLASS","buttonsFunctions","attributesTypesEnum","_toggleButton","attributes","attributesType","TENANT","USER","optionsFactory","attributesViewOptionsFactory","scrollEventTrait","AttributesViewFacade","extend","attributesFacade","context","container","type","showAssigned","initDnD","initEvents","initButtonsFunctions","_initConfirmationDialog","self","i18n","confirmationDialog","title","cancelOnEdit","propertiesIsChanged","containsUnsavedItems","saveButton","removeAttribute","removeClassName","setAttribute","isRoot","getCurrentView","setContext","render","$","addClassName","changeMode","nothingToDisplay","centerElement","horz","vert","setDetailsLoadedEntity","detailsLoadedEntity","editButton","cancelButton","deleteButton","removeFromAssigned","addToAssigned","assignedViewList","viewAssignedListTemplateDomId","viewAssignedItemTemplateDomId","assignedComparator","allowSelections","commonOptions","dragPattern","selectOnMousedown","setCursorOnMouseDown","assignedList","availableList","searchAssigned","assignedViewSearchBox","identify","availableSearchBox","assignedSearchBox","assignedViewInfiniteScroll","parentNode","availableInfiniteScroll","assignedInfiniteScroll","Droppables","up","accept","hoverclass","onDrop","dragged","dropped","_addToAssigned","_removeFromAssigned","assignedSelectionHandler","availableSelectionHandler","button","matchAny","call","preventDefault","stopPropagation","extObj","dfd","asyncValidate","saveChildren","resolve","fail","reject","trigger","save","validate","_deleteEntity","_addFromAssigned","edit","tabs","attributeTab","propertiesTab","$anchor","hideFilters","detachScrollEvent","$container","parent","toggleMode","initScrollEvent","$$","down","_assigned","_unassigned","style","zIndex","_editEntity","canEdit","canDelete","_showEntity","orgProperties","currentUser","setValuesProperty","setProperties","_moveEntities","bToAssigned","from","to","fromList","toList","concat","available","compact","fromItem","equals","_entitiesToItems","isAvailable","tooltipText","template","undefined","JSTooltip","templateId","nameAnchor","insert","writeAttribute","getManagerURL","getAssignedEntities","getUnassignedEntities","setAssignedEntities","filteredEntities","_filterEntities","addAssignedEntities","setAvailableEntities","addAvailableEntities","removeSet","addSet","allEntities","removeEntity","toLowerCase","changeReadonly","elementsPatterns","elementPattern","resetValidation","panel","ValidationModule","invokeFn","beforeInvoke","isFunction","invokeAction","apply","arguments","doNothing","eventId","actionURL","localContext","flowExecutionKey","ajaxTargettedUpdate","postData","callback","response","error","errorHandler","ajaxAgent","getResponseHeader","baseErrorHandler","mode","AjaxRequester","_actionModel","actionModel","toolbarButtonModule","_toActionMap","buttonId","testFn","toFunction","test","bulkActionModel","actionMap","bulkAction","actionArgs","myAction","getAsFunction","args","belongsToLocalContext","input","validator","isValid","regExp","errorMessage","symbols","unsupportedSymbols","messageKey","onValid","onInvalid","replaceKey","max","hasAttribute","readAttribute","maxlength","parseInt","replace","asElement","matches","exec","truncate","result","$A","i","ch","charAt","substring","token","startsWith","eval","chars","getCharacters","len","state","isProVersion","TenantsTreeView","removeContextMenuTreePlugin","t1","t2","lastSelectedOrg","selectTenant","lastSearchText","Boolean","firstEntity","entityJsonToObject","defaultEntity","relatedEntityJsonToObject","alert","description","entityJson","evalJSON","saveDfD","designer","updateEntityList","entityNameSet","json","reloadEntities","isUserSuperuser","currentUserRoles","r","actionBuilder","mngCommonActions","mngCommon","mngMain","prototype","getRepresentedString","hasReports","resourceType","indexOf","Dialog","constructor","model","resizable","modal","content","buttons","primary","_onExportButtonClick","_closeExportDialog","exportView","ExportView","listenTo","enable","disable","openRepoDialog","repoData","uris","URIString","organizationsFolderUri","jrsConfigs","orgTemplateFolderUri","subOrgRegExp","RegExp","rootOrgTemplateRegExp","isSubOrgLevel","renderOptions","exportTypesEnum","subtitle","i18n2","addCssClasses","_openExportDialog","set","openTenantDialog","tenant","fieldIsValid","fieldIsInvalid","doExport","$el","css","width","close","html","setContent","setTitle","applyEpoxyBindings","delegateEvents","minHeight","outerHeight","outerWidth","additionalCssClasses","_onImportButtonClick","_closeImportDialog","importView","ImportView","openDialog","importExportTypesEnum","doImport","returnContextMenuOptions","contextMenu","option","get","cid","TreePlugin","contextMenus","defaultSelectedItems","showContextMenuCondition","itemAction","optionModel","treeItem","itemsRendered","currentContextMenu","lastContextMenu","resetSelection","left","pageX","top","pageY","collection","optionView","stopListening","contextPath","processors","processItem","_node","addToSelection","TreeWithPlugins","Tree","TooltipTreePlugin","contentTemplate","tooltipContentTemplate","use","ContextMenuTreePlugin","create","instance","selection","allowed","right","multiple","rootless","collapsed","lazyLoad","bufferSize","allowMouseDownEventPropagation","dataUriTemplate","tenantTreeDataUriTemplateUtil","levelDataId","getDataArray","status","xhr","orgs","sort","customDataLayers","TreeDataLayer","parse","_links","dataType","OptionContainer","additionalSettings","mainTemplate","menuContainerTemplate","optionTemplate","menuOptionTemplate","toggle","toggleClass","maxSize","_onConstructor","append","_onInitialize","res","applyMaxSize","height","Menu","topPadding","leftPadding","extraOffset","hideOnMouseLeave","_tryHide","_signOffTryHide","off","_checkBounds","position","menuElHeight","_calculateMenuHeightOnShow","menuElWidth","containerHeight","containerWidth","containerOffset","offset","fitByHeight","fitByWidth","elementRect","offsetTop","bottom","offsetHeight","offsetLeft","offsetWidth","_isPointerOutOfBounds","clientX","clientY","opacity","ROOT_TENANT_ID","Backbone","getItem","root","split","splittedUri","splice","unshift","treeInitOptions","ContextMenu","_onExport","_onImport","exportDialog","ExportDialogView","importDialog","ImportDialogView","tree","tenantTree","refreshTenant","treeLevel","getLevel","getDataLayer","predefinedData","setTenant","addTenant","parentTenantId","parentLevel","listenToOnce","addItem","_processItem","updateTenant","updatedTenant","updateItem","removeTenant","tenantIds","isNew","tenantFolderUri","expandedLevels","_recursivelyOpenLevels","rootLevel","expand","newlevel","_contentId","_scroll","scroll","_loadFactor","loadFactor","_lastContentHeight","_loading","control","_control","_content","childElements","_eventType","isSupportsTouch","_onScrollHandler","_handler","controlScrollTop","y","scrollTop","contentHeight","getHeight","controlHeight","allowLoad","isBottom","isIPad","wait","_waitIndicator","Element","dimensions","getDimensions","offsets","positionedOffset","setStyle","after","confirmDialogTemplate","yesLabel","noLabel"],"mappings":"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","file":"_chunks/chunk.8244.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: Yuriy Plakosh\n * @version: $Id$\n */\n\n/*\n * Search box class.\n *\n * @param options {JSON Object} - Set of options for search box:\n * <ul>\n *      <li>id - the identifier of search box form element in the DOM</li>\n * </ul>\n */\n\nimport layoutModule from '../core/core.layout';\nimport buttonManager from '../core/core.events.bis';\nimport jQuery from 'jquery';\n\nvar SearchBox = function(options) {\n    this._id = options.id;\n    this._dom = jQuery('#' + this._id)[0];\n    this._enabled = true;\n\n    this._process();\n    this._assignHandlers();\n};\n\n/**\n * Processes DOM.\n */\nSearchBox.addMethod('_process', function() {\n    this._input = jQuery(this._dom).find('input')[0];\n    this._clearButton = jQuery(this._dom).find('.button.searchClear')[0];\n    this._searchButton = jQuery(this._dom).find('.button.search')[0];\n});\n\n/**\n * Assigns handlers.\n */\nSearchBox.addMethod('_assignHandlers', function() {\n    jQuery(this._dom).on('submit', function(e) {\n        Event.stop(e);\n    });\n\n    jQuery(this._input).on(\"keypress\", this._keyPressHandler.bindAsEventListener(this));\n\n    jQuery(this._clearButton).on('click', this._clearHandler.bindAsEventListener(this));\n    jQuery(this._searchButton).on('click', this._searchHandler.bindAsEventListener(this));\n});\n\n/**\n * Key pressed handler for input field.\n */\nSearchBox.addMethod('_keyPressHandler', function(e) {\n    if (this._enabled && Event.KEY_RETURN == e.keyCode) {\n        this._doSearch();\n\n        // Fix to prevent click event handling on clear button when enter key is pressed in the input field.\n        Event.stop(e);\n    }\n});\n\n/**\n * Updates visibility of clear button.\n */\nSearchBox.addMethod('_updateClearButtonVisibility', function() {\n    if (!this.getText().blank()) {\n        jQuery(this._clearButton).addClass(layoutModule.UP_CLASS);\n    } else {\n        jQuery(this._clearButton).removeClass(layoutModule.UP_CLASS);\n    }\n});\n\n/**\n * Click handler for clear button.\n */\nSearchBox.addMethod('_clearHandler', function() {\n    if (this._enabled) {\n        this.setText(\"\");\n        this._doSearch();\n    }\n});\n\n/**\n * Click handler for search button.\n */\nSearchBox.addMethod('_searchHandler', function() {\n    if (this._enabled) {\n        this._doSearch();\n    }\n});\n\n/**\n * Gets search box text.\n */\nSearchBox.addMethod('getText', function() {\n    return this._input.getValue();\n});\n\n/**\n * Sets search box text.\n */\nSearchBox.addMethod('setText', function(text) {\n    this._input.setValue(text);\n    this._updateClearButtonVisibility();\n});\n\n/**\n * Enables search box.\n */\nSearchBox.addMethod('enable', function() {\n    buttonManager.enable(this._clearButton);\n    buttonManager.enable(this._searchButton);\n    jQuery(this._input).attr(layoutModule.READONLY_ATTR_NAME, null);\n    jQuery(this._dom).attr(layoutModule.DISABLED_ATTR_NAME, null);\n\n    this._enabled = true;\n});\n\n/**\n * Disables search box.\n */\nSearchBox.addMethod('disable', function() {\n    buttonManager.disable(this._clearButton);\n    buttonManager.disable(this._searchButton);\n    jQuery(this._input).attr(layoutModule.READONLY_ATTR_NAME, layoutModule.READONLY_ATTR_NAME);\n    jQuery(this._dom).attr(layoutModule.DISABLED_ATTR_NAME, layoutModule.DISABLED_ATTR_NAME);\n\n    this._enabled = false;\n});\n\n/**\n * Does search action.\n */\nSearchBox.addMethod('_doSearch', function(text) {\n    this._updateClearButtonVisibility();\n    this.onSearch(this.getText());\n});\n\n/**\n * Is invoked when search action was performed (search button pressed, clear button pressed, enter key pressed in the\n * text input field). This method should be replaced in the instance of SearchBox class to handle search action.\n *\n * @param text the text in the search box.\n */\nSearchBox.addMethod('onSearch', function(text) {\n    // No-op.\n});\n\nexport default SearchBox;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global confirm */\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport orgModule from './mng.org.module';\n\norgModule.serverActionFactory = {\n    'browse': function (options) {\n        return this.createAction(orgModule.ActionMap.BROWSE, options);\n    },\n    'search': function (options) {\n        return this.createAction(orgModule.ActionMap.SEARCH, options);\n    },\n    'next': function (options) {\n        return this.createAction(orgModule.ActionMap.NEXT, options);\n    },\n    'selectAndGetDetails': function (options) {\n        return this.createAction(orgModule.ActionMap.SELECT_AND_GET_DETAILS, options);\n    },\n    'searchAvailable': function (options) {\n        return this.createAction(orgModule.ActionMap.SEARCH_AVAILABLE, options);\n    },\n    'searchAssigned': function (options) {\n        return this.createAction(orgModule.ActionMap.SEARCH_ASSIGNED, options);\n    },\n    'nextAvailable': function (options) {\n        return this.createAction(orgModule.ActionMap.NEXT_AVAILABLE, options);\n    },\n    'nextAssigned': function (options) {\n        return this.createAction(orgModule.ActionMap.NEXT_ASSIGNED, options);\n    },\n    'create': function (options) {\n        var entity = options.entity;\n        var data = { 'entity': Object.toJSON(entity) };\n        return this.createAction(orgModule.ActionMap.CREATE, data);\n    },\n    'update': function (options) {\n        var entityName = options.entityName;\n        var data = {\n            'entityName': entityName,\n            'entity': Object.toJSON(options.entity),\n            'assignedEntities': Object.toJSON(options.assigned),\n            'unassignedEntities': Object.toJSON(options.unassigned)\n        };\n        return this.createAction(orgModule.ActionMap.UPDATE, data, options.unencryptedEntity);\n    },\n    'deleteAll': function (options) {\n        var entities = options.entities;\n        var data = {\n            'entities': Object.toJSON(entities.collect(function (entity) {\n                return entity.getNameWithTenant();\n            }))\n        };\n        return this.createAction(orgModule.ActionMap.DELETE_ALL, data);\n    },\n    'delete': function (options) {\n        var entity = options.entity, entityEvent = options.entityEvent;\n        var data = {\n            'entity': entity.getNameWithTenant(),\n            'entityEvent': entityEvent\n        };\n        return this.createAction(orgModule.ActionMap.DELETE, data);\n    },\n    'exist': function (options) {\n        // TODO: refactor to use createAction method.\n        var entity = options.entity;\n        var data = { entityName: entity.getNameWithTenant() };\n        var action = new orgModule.ServerAction(orgModule.ActionMap.EXIST, data);\n        action.onSuccess = function (successData) {\n            successData.exist ? options.onExist && options.onExist(successData.uniqueId) : options.onNotExist && options.onNotExist();\n        };\n        action.onError = function (errorData) {\n            orgModule.fire(orgModule.Event.SERVER_ERROR, {\n                inputData: options,\n                responseData: errorData\n            });\n        };\n        return action;\n    },\n    createAction: function (actionName, options, unencryptedEntity) {\n        var action = new orgModule.ServerAction(actionName, options);\n        var event;\n        if (actionName == orgModule.ActionMap.BROWSE) {\n            event = orgModule.Event.RESULT_CHANGED;\n        } else if (actionName == orgModule.ActionMap.SEARCH) {\n            event = orgModule.Event.RESULT_CHANGED;\n        } else if (actionName == orgModule.ActionMap.NEXT) {\n            event = orgModule.Event.RESULT_NEXT;\n        } else if (actionName == orgModule.ActionMap.SELECT_AND_GET_DETAILS) {\n            event = orgModule.Event.ENTITY_DETAILS_LOADED;\n        } else if (actionName == orgModule.ActionMap.SEARCH_AVAILABLE) {\n            event = orgModule.Event.SEARCH_AVAILABLE_LOADED;\n        } else if (actionName == orgModule.ActionMap.SEARCH_ASSIGNED) {\n            event = orgModule.Event.SEARCH_ASSIGNED_LOADED;\n        } else if (actionName == orgModule.ActionMap.NEXT_AVAILABLE) {\n            event = orgModule.Event.NEXT_AVAILABLE_LOADED;\n        } else if (actionName == orgModule.ActionMap.NEXT_ASSIGNED) {\n            event = orgModule.Event.NEXT_ASSIGNED_LOADED;\n        } else if (actionName == orgModule.ActionMap.CREATE) {\n            event = orgModule.Event.ENTITY_CREATED;\n        } else if (actionName == orgModule.ActionMap.UPDATE) {\n            event = orgModule.Event.ENTITY_UPDATED;\n        } else if (actionName == orgModule.ActionMap.DELETE_ALL) {\n            event = orgModule.Event.ENTITIES_DELETED;\n        } else if (actionName == orgModule.ActionMap.DELETE) {\n            event = orgModule.Event.ENTITY_DELETED;\n        } else {\n            throw new Error('Unexpected action name \\'' + actionName + '\\'');\n        }\n        action.onSuccess = function (data) {\n            orgModule.fire(event, {\n                inputData: options,\n                unencryptedEntity: unencryptedEntity,\n                responseData: data\n            });\n        };\n        action.onError = function (data) {\n            orgModule.fire(orgModule.Event.SERVER_ERROR, {\n                inputData: options,\n                unencryptedEntity: unencryptedEntity,\n                responseData: data\n            });\n        };\n        return action;\n    }\n};\norgModule.clientActionFactory = {\n    'create': function () {\n        var org;\n        if (orgModule.manager.tenantsTree) {\n            org = orgModule.manager.tenantsTree.getTenant();\n        }\n        var entities = orgModule.entityList.getSelectedEntities();\n        var cancelEditBeforeInvoke = function () {\n            return orgModule.invokeClientAction('cancelIfEdit', { entity: entities[0] });\n        };\n        return new orgModule.Action(function () {\n            orgModule.entityList.deselectAll();\n            orgModule.addDialog.show(org);\n        }, cancelEditBeforeInvoke);\n    },\n    'deleteAll': function () {\n        var entities = orgModule.entityList.getSelectedEntities();\n        var cancelEditBeforeInvoke = function () {\n            return orgModule.invokeClientAction('cancelIfEdit', { entity: entities[0] });\n        };\n        return new orgModule.Action(function () {\n            var text = orgModule.getMessage('deleteAllMessage', { count: entities.length });\n            var dialog = new ConfirmationDialog({ text: text });\n            dialog.on('button:yes', function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.DELETE_ALL, { entities: entities });\n            });\n            dialog.open();\n        }, cancelEditBeforeInvoke);\n    },\n    'delete': function (options) {\n        var entity = options.entity, entityEvent = options.entityEvent;\n        return new orgModule.Action(function () {\n            var text = orgModule.getMessage('deleteMessage', { entity: entity.getDisplayName() });\n\n            var dialog = new ConfirmationDialog({ text: text });\n            dialog.on('button:yes', function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.DELETE, {\n                    entity: entity,\n                    entityEvent: entityEvent\n                });\n            });\n            dialog.open();\n        });\n    },\n    'cancelIfEdit': function (options) {\n        options = options || {};\n        var entity = options.entity || orgModule.manager.tenantsTree && orgModule.manager.tenantsTree.getTenant(), showConfirm = typeof options.showConfirm === 'undefined' ? true : options.showConfirm, entityEvent = typeof options.entityEvent === 'undefined' ? true : options.entityEvent, properties = orgModule.properties;\n        return new orgModule.Action(function () {\n            if ((!properties.locked || !entityEvent) && (!properties.isChanged() || showConfirm && confirm(orgModule.getMessage('cancelEdit', { entity: entity.getDisplayName() })))) {\n                if (properties.isEditMode) {\n                    properties.lock();\n                    properties.cancel().done(function () {\n                        var newEntity = properties.getDetailsLoadedEntity(), showProperties = orgModule.userManager ? orgModule.entityList.findEntity(newEntity.fullName) : true;\n                        properties.unlock();\n                        if (showProperties) {\n                            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                                entityId: newEntity.id,\n                                cancelIfEdit: true,\n                                entityEvent: true\n                            });\n                        } else {\n                            properties.hide();\n                        }\n                    });\n                }\n                return true;\n            } else {\n                !entityEvent && properties.lock();\n                return false;\n            }\n        });\n    }\n};\n\nexport default orgModule;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// Main module for manege organizations, users and roles\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nimport {Droppables} from 'dragdropextra';\nimport {$, $$, $A, Template} from 'prototype';\nimport SearchBox from '../components/components.searchBox';\nimport toolbarButtonModule from '../components/components.toolbarButtons.events';\nimport {\n    toFunction,\n    getAsFunction,\n    isArray,\n    matchAny,\n    centerElement,\n    ValidationModule,\n    deepClone,\n    doNothing\n} from '../util/utils.common';\nimport layoutModule from '../core/core.layout';\nimport {dynamicList} from '../components/list.base';\nimport InfiniteScroll from '../util/tools.infiniteScroll';\nimport {JSTooltip} from '../components/components.tooltip';\nimport buttonManager from '../core/core.events.bis';\nimport primaryNavModule from '../actionModel/actionModel.primaryNavigation';\nimport {ajaxTargettedUpdate, AjaxRequester} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport orgModule from './mng.org.module';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport jQuery from 'jquery';\n\nObject.assign(orgModule, {\n    TREE_ID: 'orgTree',\n    COOKIE_NAME: 'selectedTenant',\n    messages: [],\n    ActionMap: {\n        SEARCH: 'search',\n        BROWSE: 'browse',\n        NEXT: 'next',\n        SELECT_AND_GET_DETAILS: 'selectAndGetDetails',\n        SEARCH_AVAILABLE: 'searchAvailable',\n        SEARCH_ASSIGNED: 'searchAssigned',\n        NEXT_AVAILABLE: 'nextAvailable',\n        NEXT_ASSIGNED: 'nextAssigned',\n        CREATE: 'create',\n        UPDATE: 'update',\n        DELETE: 'delete',\n        DELETE_ALL: 'deleteAll',\n        EXIST: 'exist'\n    },\n    Event: {\n        /** Request events. */\n        ORG_BROWSE: 'org:browse',\n        ENTITY_SEARCH: 'entity:search',\n        ENTITY_NEXT: 'entity:next',\n        ENTITY_SELECT_AND_GET_DETAILS: 'entity:selectAndGetDetails',\n        /** Response events. */\n        RESULT_CHANGED: 'result:changed',\n        RESULT_NEXT: 'result:next',\n        ENTITY_DETAILS_LOADED: 'entity:detailsLoaded',\n        SEARCH_AVAILABLE_LOADED: 'searchAvailable:loaded',\n        SEARCH_ASSIGNED_LOADED: 'searchAssigned:loaded',\n        NEXT_AVAILABLE_LOADED: 'nextAvailable:loaded',\n        NEXT_ASSIGNED_LOADED: 'nextAssigned:loaded',\n        SERVER_ERROR: 'server:error',\n        SERVER_UNAVAILABLE: 'server:unavailable',\n        ENTITY_CREATED: 'entity:created',\n        ENTITY_UPDATED: 'entity:updated',\n        ENTITY_DELETED: 'entity:deleted',\n        ENTITIES_DELETED: 'entities:deleted'\n    },\n    observe: function (eventName, handler) {\n        this._getContainer().observe(eventName, handler);\n    },\n    stopObserving: function (eventName, handler) {\n        this._getContainer().stopObserving(eventName, handler);\n    },\n    fire: function (eventName, memo) {\n        this._getContainer().fire(eventName, memo);\n    },\n    getMessage: function (messageId, options) {\n        var message = orgModule.messages[messageId];\n        return message ? new Template(message).evaluate(options ? options : {}) : '';\n    },\n    _comparator: function (l1, l2) {\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = document.body;\n        }\n        return this._container;\n    },\n    Configuration: {\n        nameSeparator: '|',\n        userDefaultRole: 'ROLE_USER',\n        userNameNotSupportedSymbols: '[|]',\n        roleNameNotSupportedSymbols: '[|]',\n        emailRegExpPattern: '^[\\\\p{L}\\\\p{M}\\\\p{N}._%\\'-\\\\@\\\\,\\\\;\\\\s]+$',\n        superuserRole: 'ROLE_SUPERUSER',\n        adminRole: 'ROLE_ADMINISTRATOR',\n        anonymousRole: 'ROLE_ANONYMOUS'\n    }\n});\n\norgModule.systemRoles = [\n    orgModule.Configuration.userDefaultRole,\n    orgModule.Configuration.superuserRole,\n    orgModule.Configuration.adminRole,\n    orgModule.Configuration.anonymousRole\n];    /**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\n/**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\norgModule.Organization = function (jsonOrNode) {\n    if (!jsonOrNode) {\n        throw new Error('Can\\'t create Organization from undefined json or node');\n    }\n    if (jsonOrNode.param) {\n        this.id = jsonOrNode.param.id;\n        this.name = jsonOrNode.name;\n        this.uri = jsonOrNode.param.uri;\n        this.treeNode = jsonOrNode;\n    } else {\n        this.id = jsonOrNode.tenantId || jsonOrNode.id;\n        this.name = jsonOrNode.tenantName;\n        this.alias = jsonOrNode.tenantAlias || jsonOrNode.alias || '';\n        this.desc = jsonOrNode.tenantDesc;\n        this.uri = jsonOrNode.tenantUri;\n        this.parentId = jsonOrNode.parentId;\n        this.subTenantCount = jsonOrNode.subTenantCount;\n    }\n};\norgModule.Organization.addMethod('isRoot', function (level) {\n    // TODO: load name of root organization from configuration.\n    return this.id == 'organizations';\n});\norgModule.Organization.addMethod('getNameWithTenant', function () {\n    return this.id;\n});\norgModule.Organization.addMethod('getDisplayName', function () {\n    return this.name;\n});\norgModule.Organization.addMethod('equals', function (org) {\n    return org && this.id == org.id;\n});\norgModule.Organization.addMethod('toJSON', function (org) {\n    return {\n        tenantId: this.id,\n        tenantName: this.name,\n        tenantAlias: this.alias,\n        tenantDesc: this.desc,\n        parentId: this.parentId,\n        tenantUri: this.uri\n    };\n});\norgModule.Organization.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.organization);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({ tenantId: this.id });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Permission = function (options) {\n    this.isInherited = !!options.isInherited;\n    if (options.permission) {\n        this.permission = options.permission;\n    }\n    if (options.inheritedPermission) {\n        this.inheritedPermission = options.inheritedPermission;\n    }\n    this.isDisabled = !!options.isDisabled;\n};\norgModule.Permission.addMethod('getResolvedPermission', function () {\n    return this.isInherited ? this.inheritedPermission : this.permission;\n});\norgModule.Permission.addMethod('toJSON', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.Permission.addMethod('toData', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.User = function (options) {\n    if (options) {\n        this.userName = options.userName;\n        this.fullName = options.fullName;\n        this.password = options.password || '';\n        this.confirmPassword = options.confirmPassword || '';\n        this.tenantId = options.tenantId;\n        this.email = options.email;\n        this.enabled = options.enabled;\n        this.external = options.external;\n        this.roles = [];\n        if (options.roles) {\n            options.roles.each(function (role) {\n                this.roles.push(new orgModule.Role(role));\n            }.bind(this));\n        }\n        if (options.permissionToDisplay) {\n            this.permission = new orgModule.Permission(options.permissionToDisplay);\n        }\n    }\n};\norgModule.User.addVar('FLOW_ID', 'userListFlow');\norgModule.User.addMethod('getDisplayName', function () {\n    return this.userName;\n});\norgModule.User.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.userName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.userName;\n    }\n});\norgModule.User.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        text: typeof this.userName !== 'undefined' ? encodeURIComponent(this.userName) : this.userName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.User.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.user);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.userName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.User.addMethod('equals', function (user) {\n    return user && this.userName == user.userName && this.tenantId == user.tenantId;\n});\norgModule.User.addMethod('toPermissionData', function (user) {\n    return {\n        userName: this.userName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\norgModule.Role = function (options) {\n    if (options) {\n        this.roleName = options.roleName;\n        this.external = options.external;\n        this.tenantId = options.tenantId;\n    }\n    if (options.permissionToDisplay) {\n        this.permission = new orgModule.Permission(options.permissionToDisplay);\n    }\n};\norgModule.Role.addVar('FLOW_ID', 'roleListFlow');\norgModule.Role.addMethod('getDisplayName', function () {\n    return this.roleName;\n});\norgModule.Role.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.roleName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.roleName;\n    }\n});\norgModule.Role.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        // Object.toQueryString already does encodeURIComponent() once, so we have double encoding here\n        text: typeof this.roleName !== 'undefined' ? encodeURIComponent(this.roleName) : this.roleName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.Role.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.role);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.roleName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Role.addMethod('equals', function (role) {\n    return role && this.roleName == role.roleName && this.tenantId == role.tenantId;\n});\norgModule.Role.addMethod('toPermissionData', function (user) {\n    return {\n        roleName: this.roleName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\n\norgModule.initTenantsTreeEvents = function () {\n    orgModule.manager.tenantsTree.on('selection:change', function (selectedItem) {\n        if (!orgModule.manager.lastSelectedOrg || orgModule.manager.lastSelectedOrg.id !== selectedItem.id) {\n            var selectedTenant = new orgModule.Organization(selectedItem), properties = orgModule.properties;\n            orgModule.manager.tenantsTree.setTenant(selectedTenant);\n            window.localStorage && localStorage.setItem(orgModule.COOKIE_NAME, JSON.stringify(selectedItem));\n            orgModule.fire(orgModule.Event.ORG_BROWSE, {\n                organization: selectedTenant,\n                entityEvent: false\n            });\n            if (orgModule.orgManager) {\n                properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: selectedTenant.id,\n                    entityEvent: false\n                });\n            }\n            if (orgModule.userManager || orgModule.roleManager) {\n                properties.hide();\n                properties.unlock();\n            }\n        }\n    });\n    orgModule.manager.tenantsTree.on('import:finished', function (tenantId) {\n        var properties = orgModule.properties;\n        orgModule.fire(orgModule.Event.ORG_BROWSE, {\n            force: true,\n            entityEvent: false\n        });\n        if (orgModule.orgManager) {\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                refreshAttributes: true,\n                entityId: tenantId,\n                entityEvent: false\n            });\n        }\n    });\n};\n\norgModule.entityList = {\n    ID_PATTERN: '.ID > a',\n    _listId: 'entitiesList',\n    _containerId: 'listContainer',\n    _searchBoxId: 'secondarySearchBox',\n    initialize: function (options) {\n        this.list = new dynamicList.List(this._listId, {\n            listTemplateDomId: options.listTemplateId,\n            itemTemplateDomId: options.itemTemplateId,\n            multiSelect: true,\n            selectionDefaultsToCursor: true,\n            comparator: function (item1, item2) {\n                return orgModule._comparator(item1.getLabel(), item2.getLabel());\n            }\n        });\n        this._initEvents();    // Infinite scroll setup.\n        // Infinite scroll setup.\n        this._infiniteScroll = new InfiniteScroll({\n            id: this._containerId,\n            contentId: this._listId\n        });\n        this._searchBox = new SearchBox({ id: this._searchBoxId });\n        if (options.text) {\n            this._searchBox.setText(options.text);\n        }\n        this._infiniteScroll.onLoad = function () {\n            orgModule.fire(orgModule.Event.ENTITY_NEXT, {});\n        };\n        this._searchBox.onSearch = function (text) {\n            orgModule.fire(orgModule.Event.ENTITY_SEARCH, { text: text });\n        };\n        orgModule.toolbar.initialize(options.toolbarModel);\n        this.toolbar = orgModule.toolbar;\n        this.list.show();\n    },\n    _initEvents: function () {\n        this.list.observe('item:selected', function (event) {\n            var item = event.memo.item, properties = orgModule.properties;\n            this.lastSelectedName = item.getValue().getNameWithTenant();\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                entityId: item.getValue().id,\n                entityEvent: true\n            });\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n        }.bindAsEventListener(this));\n        this.list.observe('item:unselected', function (event) {\n            var tenantsTree = orgModule.manager.tenantsTree, properties = orgModule.properties;\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);    // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            if (!properties.locked && tenantsTree) {\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: tenantsTree.getTenant().id,\n                    entityEvent: true,\n                    isCtrlHeld: event.memo.isCtrlHeld\n                });\n            } else {\n                properties.hide();\n                this.toolbar.refresh();\n            }\n        }.bindAsEventListener(this));\n        this.list.observe('item:beforeSelectOrUnselect', function (event) {\n            var item = event.memo.item;\n            event.stopSelectOrUnselect = !orgModule.invokeClientAction('cancelIfEdit', {\n                entity: item.getValue(),\n                showConfirm: event.memo.showConfirm\n            });\n        }.bindAsEventListener(this));\n    },\n    //    _refreshProperties: function() {\n    //        if (this.list.getSelectedItems().length == 1) {\n    //            orgModule.properties.show(this.list.getSelectedItems()[0].getValue());\n    //        } else {\n    //            orgModule.properties.hide();\n    //        }\n    //    },\n    _createEntityItem: function (value) {\n        var item = new dynamicList.ListItem({\n            label: value.getDisplayName(),\n            value: value\n        });\n        var entityList = this;\n        item.processTemplate = function (element) {\n            var id = element.select(entityList.ID_PATTERN)[0];\n            id.update(xssUtil.hardEscape(this.getValue().getDisplayName()));\n            return element;\n        };\n        return item;\n    },\n    getSearchText: function () {\n        return this._searchBox.getText();\n    },\n    setSearchText: function (text) {\n        return this._searchBox.setText(text);\n    },\n    getSelectedEntities: function () {\n        if (this.list) {\n            return this.list.getSelectedItems().collect(function (item) {\n                return item.getValue();\n            });\n        } else {\n            return [];\n        }\n    },\n    setEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this._infiniteScroll.reset();\n        this.list.setItems(items);\n        this.list.show();\n        this.toolbar.refresh();\n    },\n    findEntity: function (name) {\n        var items = this.list.getItems(), options = orgModule.properties.options || orgModule.userManager.options;\n        return options._.find(items, function (item) {\n            return item.getValue().fullName === name;\n        });\n    },\n    addEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this.list.addItems(items);\n        this.list.refresh();\n        this.toolbar.refresh();\n    },\n    selectEntity: function (entityName) {\n        var all = this.list.getItems();\n        var matched = all.detect(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        if (matched) {\n            matched.isSelected() && matched.deselect();\n            matched.select();\n            this.lastSelectedName = matched.getValue().getNameWithTenant();\n        }\n    },\n    restoreSelectedEntity: function (entityName) {\n        this.selectEntity(this.lastSelectedName ? this.lastSelectedName : entityName);\n    },\n    deselectAll: function () {\n        this.list.resetSelected();\n    },\n    update: function (entityName, newEntity) {\n        var all = this.list.getItems();\n        var matched = all.findAll(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        matched.each(function (item) {\n            item.setValue(newEntity);\n            item.refresh();\n        });\n    },\n    remove: function (entityNameOrNameSet) {\n        var all = this.list.getItems();\n        var matched;\n        if (isArray(entityNameOrNameSet)) {\n            matched = all.findAll(function (item) {\n                return entityNameOrNameSet.include(item.getValue().getNameWithTenant());\n            });\n        } else {\n            matched = all.findAll(function (item) {\n                return item.getValue().getNameWithTenant() == entityNameOrNameSet;\n            });\n        }\n        this.list.resetSelected();\n        this.list.removeItems(matched);\n    }\n};\norgModule.properties = {\n    _EDIT_MODE_CLASS: 'editMode',\n    _moveButtonsId: 'moveButtons',\n    _id: 'properties',\n    _value: null,\n    isEditMode: false,\n    _NOTHING_TO_DISPLAY_ID: 'nothingToDisplay',\n    _ASSIGNED_VIEW_ID: 'assignedView',\n    _ASSIGNED_VIEW_LIST_ID: 'assignedViewList',\n    _ASSIGNED_ID: 'assigned',\n    _AVAILABLE_ID: 'available',\n    _ASSIGNED_LIST_ID: 'assignedList',\n    _AVAILABLE_LIST_ID: 'availableList',\n    _ATTRIBUTES_LIST_ID: 'attributesTab',\n    _EDIT_BUTTON_ID: 'edit',\n    _SAVE_BUTTON_ID: 'save',\n    _CANCEL_BUTTON_ID: 'cancel',\n    _DELETE_BUTTON_ID: 'delete',\n    _REMOVE_FROM_ASSIGNED_BUTTON_ID: 'removeFromAssigned',\n    _ADD_TO_ASSIGNED_BUTTON_ID: 'addToAssigned',\n    _BUTTONS_CONTAINER_ID: 'propertiesButtons',\n    _MOVE_BUTTONS_CONTAINER_ID: 'moveButtons',\n    _DND_CLASS: '.draggable',\n    _DROP_CLASS: 'wrap',\n    buttonsFunctions: {},\n    initialize: function (options) {\n        var attributesTypesEnum = options.attributesTypesEnum;\n        this.options = options;\n        this.locked = false;\n        this.hide();\n        this.processTemplate(options);\n        this._toggleButton();\n        if (options.attributes) {\n            var attributesType = !orgModule.userManager && orgModule.orgManager ? attributesTypesEnum.TENANT : attributesTypesEnum.USER, optionsFactory = options.attributesViewOptionsFactory, scrollEventTrait = options.scrollEventTrait, AttributesViewFacade = options.AttributesViewFacade;\n            this.options._.extend(this, scrollEventTrait);\n            this.attributesFacade = new AttributesViewFacade(optionsFactory({\n                context: options.attributes.context,\n                container: jQuery('#attributesTab'),\n                type: attributesType\n            }));\n        }\n        if (this.options.showAssigned) {\n            this.initDnD();\n        }\n        this.initEvents();\n        this.initButtonsFunctions();\n        this.options.ConfirmationDialog && this._initConfirmationDialog();\n    },\n    _initConfirmationDialog: function () {\n        var self = this, i18n = this.options.i18n;\n        this.confirmationDialog = new this.options.ConfirmationDialog({\n            title: i18n['attributes.confirm.dialog.title'],\n            text: i18n['attributes.confirm.cancel.dialog.text']\n        });\n        this.confirmationDialog.on('button:yes', function () {\n            self.cancelOnEdit();\n        });\n    },\n    _toggleButton: function () {\n        var propertiesIsChanged = this.isChanged(), attributesAndPropertiesChanged = this.attributesFacade && this.attributesFacade.containsUnsavedItems() || propertiesIsChanged;\n        attributesAndPropertiesChanged ? this.saveButton.removeAttribute('disabled') : this.saveButton.removeClassName('over').setAttribute('disabled', 'disabled');\n    },\n    show: function (value, refreshAttributes) {\n        if (!this.locked) {\n            if (this.attributesFacade) {\n                var self = this, isRoot = value && value.isRoot && value.isRoot(), context = !isRoot ? value : this.options._.extend({}, value, { id: null });\n                this.attributesFacade.getCurrentView().setContext(context, refreshAttributes).done(function () {\n                    self.attributesFacade.render(isRoot);\n                });\n            }\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.addClassName(layoutModule.HIDDEN_CLASS);\n            document.body.removeClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = value;\n            this.changeMode(false);\n        }\n    },\n    hide: function () {\n        if (!this.locked) {\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.removeClassName(layoutModule.HIDDEN_CLASS);\n            centerElement(nothingToDisplay, {\n                horz: true,\n                vert: true\n            });\n            document.body.addClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = null;\n            this.changeMode(false);\n        }\n    },\n    lock: function () {\n        this.locked = true;\n    },\n    unlock: function () {\n        this.locked = false;\n    },\n    setDetailsLoadedEntity: function (entity) {\n        this.detailsLoadedEntity = entity;\n    },\n    getDetailsLoadedEntity: function () {\n        return this.detailsLoadedEntity;\n    },\n    processTemplate: function (options) {\n        this.editButton = $(this._EDIT_BUTTON_ID);\n        this.saveButton = $(this._SAVE_BUTTON_ID);\n        this.cancelButton = $(this._CANCEL_BUTTON_ID);\n        this.deleteButton = $(this._DELETE_BUTTON_ID);\n        if (this.options.showAssigned) {\n            this.removeFromAssigned = $(this._REMOVE_FROM_ASSIGNED_BUTTON_ID);\n            this.addToAssigned = $(this._ADD_TO_ASSIGNED_BUTTON_ID);\n            this.assignedViewList = new dynamicList.List(this._ASSIGNED_VIEW_LIST_ID, {\n                listTemplateDomId: options.viewAssignedListTemplateDomId,\n                itemTemplateDomId: options.viewAssignedItemTemplateDomId,\n                comparator: this.assignedComparator,\n                allowSelections: false,\n                selectionDefaultsToCursor: false\n            });\n            var commonOptions = {\n                listTemplateDomId: 'list_responsive_collapsible_fields',\n                itemTemplateDomId: 'list_responsive_collapsible_fields:fields',\n                comparator: this.assignedComparator,\n                dragPattern: this._DND_CLASS,\n                allowSelections: true,\n                selectionDefaultsToCursor: true,\n                multiSelect: true,\n                selectOnMousedown: true,\n                setCursorOnMouseDown: true\n            };\n            this.assignedList = new dynamicList.List(this._ASSIGNED_LIST_ID, Object.extend({}, commonOptions, {\n                allowSelections: false,\n                selectionDefaultsToCursor: false    //selectOnMouseDown: false,\n                //setCursorOnMouseDown: false\n            }));\n            this.availableList = new dynamicList.List(this._AVAILABLE_LIST_ID, commonOptions);    //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            if (options.searchAssigned) {\n                this.assignedViewSearchBox = new SearchBox({ id: $(this._ASSIGNED_VIEW_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n                this.assignedViewSearchBox.onSearch = function (text) {\n                    orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n                };\n            }\n            this.availableSearchBox = new SearchBox({ id: $(this._AVAILABLE_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.availableSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: text });\n            };\n            this.assignedSearchBox = new SearchBox({ id: $(this._ASSIGNED_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.assignedSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n            };\n            if (options.searchAssigned) {\n                this.assignedViewInfiniteScroll = new InfiniteScroll({\n                    id: $($(this._ASSIGNED_VIEW_LIST_ID).parentNode).identify(),\n                    contentId: this._ASSIGNED_VIEW_LIST_ID\n                });\n                this.assignedViewInfiniteScroll.onLoad = function () {\n                    orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n                };\n            }\n            this.availableInfiniteScroll = new InfiniteScroll({\n                id: $($(this._AVAILABLE_LIST_ID).parentNode).identify(),\n                contentId: this._AVAILABLE_LIST_ID\n            });\n            this.availableInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_AVAILABLE, {});\n            };\n            this.assignedInfiniteScroll = new InfiniteScroll({\n                id: $($(this._ASSIGNED_LIST_ID).parentNode).identify(),\n                contentId: this._ASSIGNED_LIST_ID\n            });\n            this.assignedInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n            };\n        }\n    },\n    initDnD: function () {\n        Droppables.add($(this._ASSIGNED_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._addToAssigned();\n                }\n            }.bind(this)\n        });\n        Droppables.add($(this._AVAILABLE_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._removeFromAssigned();\n                }\n            }.bind(this)\n        });\n    },\n    initEvents: function () {\n        function assignedSelectionHandler() {\n            (this.assignedList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.removeFromAssigned);\n        }\n        function availableSelectionHandler() {\n            (this.availableList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.addToAssigned);\n        }\n        $(this._BUTTONS_CONTAINER_ID).observe('click', function (event) {\n            var element = event.element();\n            var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n            if (button) {\n                if (this.buttonsFunctions[button.identify()]) {\n                    this.buttonsFunctions[button.identify()].call(this);\n                }\n            }\n            event.preventDefault();\n            event.stopPropagation();\n        }.bindAsEventListener(this));\n        if (this.options.showAssigned) {\n            $(this._MOVE_BUTTONS_CONTAINER_ID).observe('click', function (event) {\n                var element = event.element();\n                var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n                if (button) {\n                    if (button == this.removeFromAssigned) {\n                        this._removeFromAssigned();\n                    } else if (button == this.addToAssigned) {\n                        this._addToAssigned();\n                    }\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }.bindAsEventListener(this));\n            this.assignedList.observe('item:selected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:unselected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:dblclick', function (event) {\n                this._removeFromAssigned();\n            }.bindAsEventListener(this));\n            this.availableList.observe('item:selected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:unselected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:dblclick', function (event) {\n                this._addToAssigned();\n            }.bindAsEventListener(this));\n        }\n        this.attributesFacade && this.attributesFacade.on('change', this.options._.bind(this._toggleButton, this));\n    },\n    initButtonsFunctions: function () {\n        this.buttonsFunctions[this._EDIT_BUTTON_ID] = function () {\n            this.changeMode(true);\n        };\n        this.buttonsFunctions[this._SAVE_BUTTON_ID] = function () {\n            var extObj = this;\n            var dfd = new jQuery.Deferred();\n            if(this.asyncValidate) {\n                this.asyncValidate().done(function() {\n                    extObj.attributesFacade ? extObj.attributesFacade.getCurrentView().saveChildren().done(function () {\n                        dfd.resolve();\n                    }).fail(function () {\n                        dfd.reject();\n                        jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                    }) : dfd.resolve();\n                    dfd.done(function () {\n                        extObj.save(extObj._value);\n                    });\n                });\n            } else if(this.validate()) {\n                //This part never gets called, we can remove this in future.\n                this.attributesFacade ? this.attributesFacade.getCurrentView().saveChildren().done(function () {\n                    dfd.resolve();\n                }).fail(function () {\n                    dfd.reject();\n                    jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                }) : dfd.resolve();\n                dfd.done(function () {\n                    extObj.save(extObj._value);\n                });\n            }\n        };\n        this.buttonsFunctions[this._CANCEL_BUTTON_ID] = function () {\n            if (this.attributesFacade) {\n                this.isChanged() ? this.confirmationDialog.open() : this.cancelOnEdit();\n            } else {\n                orgModule.invokeClientAction('cancelIfEdit', { entity: this.getValue() });\n            }\n        };\n        this.buttonsFunctions[this._DELETE_BUTTON_ID] = function () {\n            this._deleteEntity();\n        };\n        this.buttonsFunctions[this._REMOVE_FROM_ASSIGNED_BUTTON_ID] = function () {\n            this._removeFromAssigned();\n        };\n        this.buttonsFunctions[this._ADD_TO_ASSIGNED_BUTTON_ID] = function () {\n            this._addFromAssigned();\n        };\n    },\n    cancelOnEdit: function () {\n        var self = this;\n        if (this.isEditMode) {\n            this.cancel().done(function () {\n                self.unlock();\n                self.changeMode(false);\n                self._toggleButton();\n            });\n        }\n    },\n    changeMode: function (edit) {\n        this.isEditMode = edit;\n        var tabs, attributeTab, propertiesTab, $anchor;\n        if (this.attributesFacade) {\n            attributeTab = $('attributesTab');\n            var hideFilters = !!this._value && this._value.id === 'organizations';\n            this.detachScrollEvent(this.attributesFacade.getCurrentView().$container.parent());\n            this.attributesFacade.toggleMode(edit, hideFilters);\n            edit && this.initScrollEvent(this.attributesFacade.getCurrentView());\n            tabs = $$('.tertiary')[0];\n            propertiesTab = $('propertiesTab');\n            $anchor = jQuery('.control.tabSet.anchor');\n        }\n        if (edit) {\n            $(this._id).addClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                tabs.down('.selected').removeClassName('selected');\n                tabs.down('li', 0).addClassName('selected');\n                tabs.addClassName('tabbed');\n                attributeTab.addClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                $anchor.removeClass('attributesAnchor');\n            }\n            this._assigned = [];\n            this._unassigned = [];\n            if (this.options.showAssigned) {\n                centerElement($(this._moveButtonsId), { horz: true });\n                $(this._moveButtonsId).style.zIndex = 1000;    //fix for bug 26831\n                //fix for bug 26831\n                this.assignedList.setItems([]);\n                this.assignedList.show();\n                this.availableList.setItems([]);\n                this.availableList.show();\n                buttonManager.disable(this.removeFromAssigned);\n                buttonManager.disable(this.addToAssigned);\n                this.assignedSearchBox.setText('');\n                this.availableSearchBox.setText('');\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: this.assignedSearchBox.getText() });\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: this.availableSearchBox.getText() });\n            }\n            this._editEntity();\n            this._toggleButton();\n        } else {\n            $(this._id).removeClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                attributeTab.removeClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                tabs.removeClassName('tabbed');\n            }\n            if (this.options.searchAssigned && this.assignedViewSearchBox) {\n                this.assignedViewSearchBox.setText('');\n            }\n            this.changeDisable(this.canEdit(), ['#' + this._EDIT_BUTTON_ID]);\n            this.changeDisable(this.canDelete(), ['#' + this._DELETE_BUTTON_ID]);\n            this._showEntity();\n            this._assigned = [];\n            this._unassigned = [];\n        }\n    },\n    canEdit: function () {\n        return true;\n    },\n    canDelete: function () {\n        let orgProperties = this.getValue();\n        if ( orgProperties && orgProperties.getNameWithTenant() === this.options.currentUser) {\n            return false;\n        }\n        return !!orgProperties && orgProperties.uri !== '/';\n    },\n    setValuesProperty: function (name, value) {\n        this._value[name] = value;\n    },\n    getValue: function () {\n        return this._value;\n    },\n    setProperties: function (properties) {\n    },    // Template method.\n\n    isChanged: function (properties) {\n    },    // Template method.\n\n    save: function (properties) {\n    },    // Template method.\n\n    validate: function () {\n        // Template method.\n        return true;\n    },\n    assignedComparator: function (item1, item2) {\n        var l1 = item1.getLabel();\n        var l2 = item2.getLabel();\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _moveEntities: function (bToAssigned) {\n        var from, to, fromList, toList;\n        if (bToAssigned) {\n            from = this._unassigned;\n            fromList = this.availableList;\n            to = this._assigned;\n            toList = this.assignedList;\n        } else {\n            from = this._assigned;\n            fromList = this.assignedList;\n            to = this._unassigned;\n            toList = this.availableList;\n        }\n        var items = fromList.getSelectedItems();\n        var entities = items.collect(function (item) {\n            return item.getValue();\n        });\n        to = to.concat(entities.collect(function (entity) {\n            return entity.available == bToAssigned ? entity : null;\n        })).compact();\n        from = from.reject(function (fromItem) {\n            return entities.detect(function (entity) {\n                return fromItem.equals(entity);\n            });\n        });\n        fromList.removeItems(items);\n        toList.addItems(items, true);\n        toList.refresh();\n        if (bToAssigned) {\n            this._unassigned = from;\n            this._assigned = to;\n        } else {\n            this._assigned = from;\n            this._unassigned = to;\n        }\n    },\n    _addToAssigned: function () {\n        this._moveEntities(true);\n    },\n    _removeFromAssigned: function () {\n        this._moveEntities(false);\n    },\n    _entitiesToItems: function (entities, isAvailable) {\n        entities = entities ? entities : [];\n        return entities.collect(function (entity) {\n            var label = '';\n            var tooltipText = [], template = 'orgTooltip';\n            if (entity instanceof orgModule.User) {\n                label = entity.userName;\n                if (entity.fullName && entity.fullName.length > 0) {\n                    tooltipText = [entity.fullName];\n                }\n                template = entity.tenantId ? 'fullNameAndOrgTooltip' : 'fullNameTooltip';\n            } else if (entity instanceof orgModule.Role) {\n                label = entity.roleName;\n                template = entity.tenantId ? 'orgTooltip' : undefined;\n            }\n            if (entity.tenantId && entity.tenantId.length > 0) {\n                tooltipText.push(entity.tenantId);\n            }\n            entity.available = !!isAvailable;\n            var item = new dynamicList.ListItem({\n                label: label,\n                value: entity\n            });\n            if (this.isEditMode) {\n                item.processTemplate = function (element) {\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return dynamicList.ListItem.prototype.processTemplate.call(this, element);\n                };\n            } else {\n                item.processTemplate = function (element) {\n                    var nameAnchor = element.select('a')[0];\n                    nameAnchor.insert(xssUtil.hardEscape(this.getLabel()));\n                    nameAnchor.writeAttribute('href', this.getValue().getManagerURL());\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return element;\n                };\n            }\n            return item;\n        }.bind(this));\n    },\n    getAssignedEntities: function () {\n        return this._assigned;\n    },\n    getUnassignedEntities: function () {\n        return this._unassigned;\n    },\n    setAssignedEntities: function (entities) {\n        this.assignedViewInfiniteScroll && this.assignedViewInfiniteScroll.reset();\n        this.assignedInfiniteScroll && this.assignedInfiniteScroll.reset();\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.setItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    addAssignedEntities: function (entities) {\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.addItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    setAvailableEntities: function (entities) {\n        this.availableInfiniteScroll.reset();\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.setItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    addAvailableEntities: function (entities) {\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.addItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    _filterEntities: function (entities, removeSet, addSet, text) {\n        var allEntities = entities.reject(function (entity) {\n            return removeSet.detect(function (removeEntity) {\n                return removeEntity.equals(entity);\n            });\n        });\n        text = text.toLowerCase();\n        allEntities = allEntities.concat(addSet.findAll(function (entity) {\n            return entity.getDisplayName().toLowerCase().include(text);\n        }));\n        return allEntities;\n    },\n    changeReadonly: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            $(this._id).select(elementPattern)[0].writeAttribute(layoutModule.READONLY_ATTR_NAME, edit ? null : layoutModule.READONLY_ATTR_NAME);\n        }.bind(this));\n    },\n    resetValidation: function (elementsPatterns) {\n        var panel = $(this._id);\n        elementsPatterns.each(function (elementPattern) {\n            ValidationModule.hideError(panel.select(elementPattern)[0]);\n        }.bind(this));\n    },\n    changeDisable: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            if (edit) {\n                buttonManager.enable($(this._id).select(elementPattern)[0]);\n            } else {\n                buttonManager.disable($(this._id).select(elementPattern)[0]);\n            }\n        }.bind(this));\n    },\n    _deleteEntity: function () {\n    },    // Template method.\n\n    _editEntity: function () {\n    },    // Template method.\n\n    _showEntity: function () {\n    }    // Template method.\n};\norgModule.addDialog = {\n    show: function (organization) {\n    },    // Template method.\n\n    hide: function (organization) {\n    }    // Template method.\n};\norgModule.Action = function (invokeFn, beforeInvoke) {\n    if (Object.isFunction(invokeFn)) {\n        beforeInvoke = beforeInvoke && Object.isFunction(beforeInvoke) ? beforeInvoke : this.beforeInvoke;\n        this.invokeAction = function () {\n            if (beforeInvoke()) {\n                return invokeFn.apply(this, arguments);\n            }\n        };\n    }\n};    /**\n * Invokes action.\n */\n/**\n * Invokes action.\n */\norgModule.Action.addMethod('invokeAction', doNothing);    /**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.Action.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.ServerAction = function (eventId, options) {\n    this.actionURL = 'flow.html?_flowExecutionKey=' + window.localContext.flowExecutionKey + '&_eventId=' + eventId;\n    this.data = Object.toQueryString(options);\n    this.onSuccess = doNothing();\n    this.onError = doNothing();\n};    /**\n * Invokes server action.\n */\n/**\n * Invokes server action.\n */\norgModule.ServerAction.addMethod('invokeAction', function () {\n    if (this.beforeInvoke()) {\n        ajaxTargettedUpdate(this.actionURL, {\n            postData: this.data,\n            callback: function (response) {\n                if (response.error) {\n                    this.onError(response.error);\n                } else {\n                    this.onSuccess(response.data);\n                }\n            }.bind(this),\n            errorHandler: function (ajaxAgent) {\n                if (ajaxAgent.getResponseHeader('LoginRequested')) {\n                    orgModule.fire(orgModule.Event.SERVER_UNAVAILABLE, {});\n                    return true;\n                }\n                return baseErrorHandler(ajaxAgent);\n            },\n            mode: AjaxRequester.prototype.EVAL_JSON\n        });\n    }\n});    /**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.ServerAction.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.toolbar = {\n    _actionModel: {},\n    initialize: function (actionModel) {\n        this._actionModel = actionModel;\n        toolbarButtonModule.initialize(this._toActionMap(this._actionModel));\n        this.refresh();\n    },\n    refresh: function () {\n        for (var name in this._actionModel) {\n            var id = this._actionModel[name].buttonId;\n            var testFn = toFunction(this._actionModel[name].test);\n            toolbarButtonModule.setButtonState($(id), testFn());\n        }\n    },\n    _toActionMap: function (bulkActionModel) {\n        var actionMap = {};\n        for (var name in bulkActionModel) {\n            var bulkAction = bulkActionModel[name];\n            var id = bulkAction.buttonId;\n            actionMap[id] = function (action, actionArgs) {\n                return function () {\n                    var myAction = getAsFunction(action);\n                    var args = actionArgs;\n                    var belongsToLocalContext = window.localContext && window.localContext[action];\n                    if (args && isArray(args)) {\n                        myAction.apply(belongsToLocalContext ? window.localContext : null, args);\n                    } else {\n                        myAction.call(belongsToLocalContext ? window.localContext : null, args);\n                    }\n                };\n            }(bulkAction.action, bulkAction.actionArgs);\n        }\n        return actionMap;\n    }\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\n////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\norgModule.createInputRegExValidator = function (input) {\n    return {\n        validator: function (value) {\n            var matches = input.regExp.test(value);\n            var isValid = !matches;\n            var errorMessage = isValid ? '' : orgModule.getMessage('unsupportedSymbols', { symbols: input.unsupportedSymbols });\n            input.isValid = isValid;\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: input\n    };\n};    /**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createBlankValidator = function (element, messageKey, onValid, onInvalid) {\n    return {\n        validator: function (value) {\n            var isValid = !value.blank();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element,\n        onValid: onValid,\n        onInvalid: onInvalid\n    };\n};    /**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createMaxLengthValidator = function (element, messageKey, replaceKey) {\n    return {\n        validator: function (value) {\n            var max = element.hasAttribute('maxlength') ? element.readAttribute('maxlength') : element.maxlength;\n            var isValid = value.length < parseInt(max);\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            replaceKey && (errorMessage = errorMessage.replace(replaceKey, max));\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\norgModule.createSameValidator = function (element, asElement, messageKey) {\n    return {\n        validator: function (value) {\n            var isValid = value === asElement.getValue();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\norgModule.createRegExpValidator = function (element, messageKey, regExp) {\n    return {\n        validator: function (value) {\n            var matches = regExp.exec(value);\n            var isValid = !matches && value.length === 0 || matches && value == matches[0];\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};\norgModule.truncateOrgName = function (name) {\n    return name && name.length > 0 ? name.truncate(15) : '';\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\nfunction RegExpRepresenter(expression) {\n    this.charMap = { '\\\\s': ' ' };\n    this.expressionTokens = this.__parse(expression);\n}\nRegExpRepresenter.addMethod('__parse', function (expression) {\n    var result = $A();\n    for (var i = 1; i < expression.length - 1; i++) {\n        var ch = expression.charAt(i);\n        if (ch == '\\\\') {\n            ch += expression.charAt(++i);\n        }\n        if (ch == '\\\\u') {\n            ch += expression.substring(++i, i + 4);\n            i += 3;\n        }\n        result.push(ch);\n    }\n    return result;\n});\nRegExpRepresenter.addMethod('getCharacters', function () {\n    var result = $A();\n    this.expressionTokens.each(function (token) {\n        if (token.startsWith('\\\\u')) {\n            /*eslint-disable-next-line no-eval*/\n            result.push(eval('\"' + token + '\"'));\n        } else if (token.startsWith('\\\\')) {\n            var ch = this.charMap[token];\n            result.push(ch ? ch : token.substring(1, token.length));\n        } else {\n            result.push(token);\n        }\n    }.bind(this));\n    return result;\n});\nRegExpRepresenter.addMethod('getRepresentedString', function () {\n    var result = '';\n    var chars = this.getCharacters();\n    var len = chars.length;\n    for (var i = 0; i < len; i++) {\n        var ch = chars[i];\n        if (ch == ' ' || ch == '.' || ch == ',') {\n            result += '[' + ch + ']';\n        } else {\n            result += ch;\n        }\n        if (i < len - 1) {\n            result += ', ';\n        }\n    }\n    return result;\n});\n\nexport default orgModule;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\n\n/* global alert */\n\nimport {isProVersion} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport orgModule from './mng.org.module';\n\nfunction invokeServerAction(actionName, options) {\n    var actionBuilder = orgModule.serverActionFactory[actionName];\n\n    if (actionBuilder) {\n        var action = actionBuilder.call(orgModule.serverActionFactory, options);\n        action.invokeAction();\n    } else {\n        throw new Error(\"No server action found for action name '\" + actionName + \"'\");\n    }\n}\n\nfunction invokeClientAction(actionName, options) {\n    var actionBuilder = orgModule.clientActionFactory[actionName];\n\n    if (actionBuilder) {\n        var action = actionBuilder.call(orgModule.clientActionFactory, options);\n        return action.invokeAction();\n    } else {\n        throw new Error(\"No client action found for action name '\" + actionName + \"'\");\n    }\n}\n\norgModule.confirmAndLeave = function() {\n    var entities = orgModule.entityList.getSelectedEntities();\n\n    if(!orgModule.properties.attributesFacade){\n        return orgModule.invokeClientAction(\"cancelIfEdit\", { entity: entities[0], entityEvent: false});\n    }\n\n    return true;\n};\n\norgModule.manager = {\n    initialize: function(options) {\n        this.options = options;\n        this.state = options.state;\n\n        _.extend(this.state, {id: this.state.tenantId});\n\n        if (isProVersion()) {\n            this.tenantsTree = new options.TenantsTreeView({\n                container: \"#folders .body\",\n                currentUser: options.currentUser,\n                removeContextMenuTreePlugin: options.removeContextMenuTreePlugin,\n                selectedTenant: this.state,\n                comparator: function(t1, t2){\n                    return orgModule._comparator(t1.tenantName, t2.tenantName)\n                }\n            });\n\n            orgModule.initTenantsTreeEvents();\n            this.tenantsTree.render();\n        }\n\n        // Request events listeners.\n        orgModule.observe(\"org:browse\", function(event) {\n            var org;\n\n            this.tenantsTree && (org = this.tenantsTree.getTenant());\n\n            var entityEvent = event.memo.entityEvent,\n                force = event.memo.force;\n\n            if (force || !this.lastSelectedOrg || this.lastSelectedOrg.id !== org?.id) {\n                var entities = orgModule.entityList.getSelectedEntities();\n\n                if(orgModule.invokeClientAction(\"cancelIfEdit\", { entity: entities[0] || org, entityEvent: entityEvent})) {\n                    orgModule.invokeServerAction(orgModule.ActionMap.BROWSE, {\n                        tenantId : (org) ? org.id : null\n                    });\n                    this.lastSelectedOrg = org;\n                } else {\n                    this.lastSelectedOrg && this.tenantsTree.selectTenant(this.lastSelectedOrg.id);\n                }\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:search\", function(event) {\n            var entities = orgModule.entityList.getSelectedEntities(),\n                text = event.memo.text, org;\n\n            if (this.tenantsTree) {\n                org = this.tenantsTree.getTenant();\n            }\n\n            if(orgModule.invokeClientAction(\"cancelIfEdit\", { entity: entities[0] || org })) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH, {\n                    text: text\n                });\n                this.lastSearchText = text;\n            } else {\n                if (text.length === 0 && this.lastSearchText && this.lastSearchText.length !== 0) {\n                    orgModule.entityList.setSearchText(this.lastSearchText);\n                }\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:next\", function(event) {\n            orgModule.invokeServerAction(orgModule.ActionMap.NEXT, {});\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:selectAndGetDetails\", function(event) {\n            var entityEvent = event.memo.entityEvent,\n                isCtrlHeld = event.memo.isCtrlHeld,\n                cancelIfEdit = event.memo.cancelIfEdit,\n                entities = orgModule.entityList.getSelectedEntities(),\n                refreshAttributes = Boolean(event.memo.refreshAttributes);\n\n            if (entities.length > 1) {\n                orgModule.properties.hide();\n                orgModule.entityList.toolbar.refresh();\n            } else {\n                var firstEntity = entities[0],\n                    entityName;\n\n                if (firstEntity && entityEvent) {\n                    entityName = firstEntity.getNameWithTenant()\n                } else {\n                    entityName = (!entityEvent || isCtrlHeld || cancelIfEdit) && event.memo.entityId;\n                }\n\n                if (!firstEntity && (orgModule.userManager || (!orgModule.userManager && orgModule.roleManager)) && isCtrlHeld) {\n                    orgModule.properties.hide();\n                    return;\n                }\n\n                entityName && orgModule.invokeServerAction(orgModule.ActionMap.SELECT_AND_GET_DETAILS, {\n                    refreshAttributes: refreshAttributes,\n                    entity: entityName\n                });\n            }\n        }.bindAsEventListener(this));\n\n        // Response events listeners.\n        orgModule.observe(\"result:changed\", function(event) {\n            var data = event.memo.responseData;\n            orgModule.entityList.setEntities(data.entities.collect(this.entityJsonToObject));\n            options.defaultEntity && orgModule.entityList.restoreSelectedEntity(options.defaultEntity);\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"result:next\", function(event) {\n            var data = event.memo.responseData;\n            if (data.entities.length > 0) {\n                orgModule.entityList.addEntities(data.entities.collect(this.entityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:detailsLoaded\", function(event) {\n            var entity = this.entityJsonToObject(event.memo.responseData),\n                properties = orgModule.properties,\n                refreshAttributes = event.memo.inputData.refreshAttributes;\n\n            orgModule.entityList.update(entity.getNameWithTenant(), entity);\n\n            properties.setDetailsLoadedEntity(entity);\n            properties.show(entity, refreshAttributes);\n            !properties.locked && properties.setProperties(entity);\n\n            orgModule.entityList.toolbar.refresh();\n\n            properties.unlock();\n\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"searchAvailable:loaded\", function(event) {\n            var data = event.memo.responseData;\n            if (data && data.entities) {\n                orgModule.properties.setAvailableEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"searchAssigned:loaded\", function(event) {\n            var data = event.memo.responseData;\n\n            if(data && data.entities) {\n                orgModule.properties.setAssignedEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"nextAvailable:loaded\", function(event) {\n            var data = event.memo.responseData;\n\n            if (data && data.entities && data.entities.length > 0) {\n                orgModule.properties.addAvailableEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"nextAssigned:loaded\", function(event) {\n            var data = event.memo.responseData;\n\n            if (data && data.entities && data.entities.length > 0) {\n                orgModule.properties.addAssignedEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"server:error\", function(event) {\n            var error = event.memo.responseData;\n            if(error) {\n                alert(error.message + \"\\n\\n\" + (error.description) ? error.description : \"\");\n            }\n        }) ;\n\n        orgModule.observe(\"entity:created\", function(event) {\n            orgModule.addDialog.hide();\n\n            var entityJson = event.memo.inputData.entity;\n            if (entityJson) {\n                var entity = this.entityJsonToObject(entityJson.evalJSON());\n\n                orgModule.entityList.addEntities([entity]);\n                orgModule.entityList.deselectAll();\n                orgModule.entityList.selectEntity(entity.getNameWithTenant());\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:updated\",function(event) {\n            var self = this;\n            var entityName = event.memo.inputData.entityName;\n\n\n            ////////////////////////////////////////////////////\n            //  2012-05-09  thorick chow\n            //              http://bugzilla.jaspersoft.com/show_bug.cgi?id=27717\n            //\n            //              Special case for User Objects\n            //              if\n            //                  the update involves the server\n            //                  sending us back an updated User Object\n            //              then\n            //                 use that as the entity\n            //              else\n            //                 fallback to whatever the pre-existing cases were using\n            //\n\n            //  if the Response *Object* contains 'roles' property\n            //  then we'll assume that that's enough to qualify it as a User Object\n            var entityJson = event.memo.responseData;\n            if (!entityJson.roles) {\n                entityJson = event.memo.unencryptedEntity;\n            }\n            if (!entityJson) {\n                entityJson = event.memo.inputData.entity;\n            }\n\n            var attributesFacade = orgModule.properties.attributesFacade || {};\n            var saveDfD = attributesFacade.designer && attributesFacade.designer.saveDfD;\n\n            if (orgModule.properties.isEditMode) {\n                saveDfD ? saveDfD.done(function(){\n                    orgModule.properties.changeMode(false);\n                }) : orgModule.properties.changeMode(false);\n            }\n\n            if (entityJson) {\n                saveDfD ? saveDfD.done(function(){\n                    self.updateEntityList(entityJson, entityName);\n                }) : this.updateEntityList(entityJson, entityName);\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:deleted\", function(event) {\n            var entityName = event.memo.inputData.entity;\n\n            orgModule.entityList.remove(entityName);\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entities:deleted\", function(event) {\n            var entityNameSet = event.memo.inputData.entities;\n\n            if (entityNameSet) {\n                orgModule.entityList.remove(entityNameSet.evalJSON());\n            }\n        }.bindAsEventListener(this));\n    },\n\n    updateEntityList: function(entityJson, entityName){\n        var entity = this.entityJsonToObject(entityJson.evalJSON ? entityJson.evalJSON() : entityJson);\n        orgModule.entityList.update(entityName, entity);\n        orgModule.entityList.selectEntity(entity.getNameWithTenant ? entity.getNameWithTenant() : entityName);\n    },\n\n    entityJsonToObject: function(json) {\n        // Template method.\n    },\n\n    relatedEntityJsonToObject: function(json) {\n        // Template method.\n    },\n\n    reloadEntities: function() {\n        orgModule.fire(orgModule.Event.ORG_BROWSE, {});\n    },\n\n    isUserSuperuser: function () {\n        var superuserRole = (isProVersion())\n            ? orgModule.Configuration.superuserRole\n            : orgModule.Configuration.adminRole;\n\n        var roles = this.options.currentUserRoles;\n\n        return roles.detect(function(r) { return r.roleName == superuserRole && !r.tenantId; }) != null;\n    }\n};\n\norgModule.invokeServerAction = invokeServerAction;\norgModule.invokeClientAction = invokeClientAction;\n\nexport default orgModule;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport mngCommonActions from './mng.common.actions';\nimport mngCommon from './mng.common';\nimport mngMain from './mng.main';\n\nlet orgModule = Object.assign(mngCommonActions, mngCommon, mngMain);\n\n// expose to global scope\nwindow.orgModule = orgModule;\n\nexport default orgModule;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport _ from 'underscore';\nimport {$A} from 'prototype';\n\nfunction RegExpRepresenter(expression) {\n    this.charMap = { '\\\\s': ' ' };\n    this.expressionTokens = this.__parse(expression);\n}\n_.extend(RegExpRepresenter.prototype, {\n    __parse: function (expression) {\n        var result = $A();\n        for (var i = 1; i < expression.length - 1; i++) {\n            var ch = expression.charAt(i);\n            if (ch == '\\\\') {\n                ch += expression.charAt(++i);\n            }\n            if (ch == '\\\\u') {\n                ch += expression.substring(++i, i + 4);\n                i += 3;\n            }\n            result.push(ch);\n        }\n        return result;\n    },\n    getCharacters: function () {\n        var result = $A();\n        this.expressionTokens.each(function (token) {\n            if (token.startsWith('\\\\u')) {\n                /*eslint-disable-next-line no-eval*/\n                result.push(eval('\"' + token + '\"'));\n            } else if (token.startsWith('\\\\')) {\n                var ch = this.charMap[token];\n                result.push(ch ? ch : token.substring(1, token.length));\n            } else {\n                result.push(token);\n            }\n        }.bind(this));\n        return result;\n    },\n    getRepresentedString: function () {\n        var result = '';\n        var chars = this.getCharacters();\n        var len = chars.length;\n        for (var i = 0; i < len; i++) {\n            var ch = chars[i];\n            if (ch == ' ' || ch == '.' || ch == ',') {\n                result += '[' + ch + ']';\n            } else {\n                result += ch;\n            }\n            if (i < len - 1) {\n                result += ', ';\n            }\n        }\n        return result;\n    }\n});\nexport default RegExpRepresenter;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport Dialog from 'js-sdk/src/common/component/dialog/Dialog';\nimport ExportView from './ExportView';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport i18n2 from '../../../i18n/ImportExportBundle.properties';\nimport exportTypesEnum from '../enum/exportTypesEnum';\n\nfunction parseRepoData(data) {\n    if (_.isArray(data)) {\n        return _.pluck(data, 'URIString');\n    } else {\n        return [data.URIString];\n    }\n}\nfunction hasReports(data) {\n    _.isArray(data) || (data = [data]);\n    return !!_.reduce(data, function (memo, item) {\n        return memo || !item.resourceType || item.resourceType.indexOf('ReportUnit') + 1 || item.resourceType.indexOf('ReportOptions') + 1;\n    }, false);\n}\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.options = options;\n        Dialog.prototype.constructor.call(this, {\n            model: this.model,\n            resizable: true,\n            modal: true,\n            content: '',\n            buttons: [\n                {\n                    label: i18n['button.export'],\n                    action: 'export',\n                    primary: true\n                },\n                {\n                    label: i18n['button.cancel'],\n                    action: 'cancel',\n                    primary: false\n                }\n            ]\n        });\n        this.on('button:export', _.bind(this._onExportButtonClick, this));\n        this.on('button:cancel', _.bind(this._closeExportDialog, this));\n    },\n    initialize: function (options) {\n        this.exportView = new ExportView();\n        this.listenTo(this.exportView.model, 'validated', function (isValid) {\n            isValid ? this.buttons.enable('export') : this.buttons.disable('export');\n        }, this);\n        Dialog.prototype.initialize.apply(this, arguments);\n    },\n    openRepoDialog: function (repoData) {\n        var uris = parseRepoData(repoData);\n        var organizationsFolderUri = jrsConfigs.organizationsFolderUri || '/organizations';\n        var orgTemplateFolderUri = jrsConfigs.orgTemplateFolderUri || '/org_template';\n        var subOrgRegExp = new RegExp('^(' + organizationsFolderUri + '/([^/]+))+');\n        var rootOrgTemplateRegExp = new RegExp('^' + organizationsFolderUri + orgTemplateFolderUri + '(/.*)?');\n        var isSubOrgLevel = !!subOrgRegExp.exec(uris[0]) && !rootOrgTemplateRegExp.exec(uris[0]);\n        var renderOptions = {\n                type: exportTypesEnum.REPOSITORY,\n                isSubOrgLevel: isSubOrgLevel\n            }, subtitle = ' ' + i18n2['export.dialog.repository.title'];\n        this.addCssClasses('repository-export-dialog');\n        this._openExportDialog(renderOptions, subtitle);\n        this.exportView.model.set({\n            'uris': uris,\n            'includeScheduledReportJobs': hasReports(repoData)\n        });\n    },\n    openTenantDialog: function (tenant) {\n        var tenantName = ' ' + tenant.name, exportType = !tenant.isRoot() ? exportTypesEnum.TENANT : exportTypesEnum.ROOT_TENANT, renderOptions = {\n            type: exportType,\n            tenantId: tenant.id\n        };\n        this.addCssClasses('tenant-export-dialog');\n        this._openExportDialog(renderOptions, tenantName);\n    },\n    // block default validation handlers\n    fieldIsValid: function () {\n    },\n    fieldIsInvalid: function (error) {\n    },\n    _onExportButtonClick: function () {\n        this.exportView.doExport();\n        this._closeExportDialog();\n    },\n    _closeExportDialog: function () {\n        this.$el.css({ width: this.width });\n        this.close();\n        this.$el.find('.export-view').html('');\n    },\n    _openExportDialog: function (renderOptions, subtitle) {\n        var title = i18n2['export.dialog.title'] + (subtitle ? subtitle : '');\n        this.setContent(this.exportView.render(renderOptions).$el);\n        this.setTitle(title);    //TODO: Find out why applyEpoxyBindings and delegateEvents should be called after new content is set.\n        //TODO: Find out why applyEpoxyBindings and delegateEvents should be called after new content is set.\n        this.exportView.applyEpoxyBindings();\n        this.exportView.delegateEvents();\n        Dialog.prototype.open.apply(this, arguments);\n        this.$el.css({ minHeight: this.$el.outerHeight() });\n        this.width = this.$el.outerWidth();\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from 'js-sdk/src/common/component/dialog/Dialog';\nimport ImportView from './ImportView';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport i18n2 from '../../../i18n/ImportExportBundle.properties';\nimport importExportTypesEnum from '../../export/enum/exportTypesEnum';\n\nexport default Dialog.extend({\n\n    constructor: function (options) {\n        options || (options = {});\n        this.options = options;\n        Dialog.prototype.constructor.call(this, {\n            model: this.model,\n            modal: true,\n            resizable: true,\n            additionalCssClasses: 'tenant-import-dialog',\n            content: '',\n            buttons: [\n                {\n                    label: i18n['button.import'],\n                    action: 'import',\n                    primary: true\n                },\n                {\n                    label: i18n['button.cancel'],\n                    action: 'cancel',\n                    primary: false\n                }\n            ]\n        });\n        this.on('button:import', _.bind(this._onImportButtonClick, this));\n        this.on('button:cancel', _.bind(this._closeImportDialog, this));\n    },\n\n    initialize: function (options) {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.importView = new ImportView();\n        this.listenTo(this.importView, 'import:finished', function (tenantId) {\n            this.close();\n            this.trigger('import:finished', tenantId);\n        });\n        this.listenTo(this.importView.model, 'validated', function (isValid) {\n            isValid ? this.buttons.enable('import') : this.buttons.disable('import');\n        }, this);\n    },\n\n    openDialog: function (tenant) {\n        var title = i18n2['tenant.import.dialog.title'] + ' ' + tenant.name;\n        var type = !tenant.isRoot() ? importExportTypesEnum.TENANT : importExportTypesEnum.ROOT_TENANT;\n        tenant.isRoot() && this.addCssClasses('tenant');\n        this.setContent(this.importView.render({\n            type: type,\n            tenantId: tenant.id\n        }).$el);\n\n        this.setTitle(title);\n\n        Dialog.prototype.open.apply(this, arguments);\n\n        this.importView.applyEpoxyBindings();\n        this.importView.delegateEvents();\n    },\n    // block default validation handlers\n    fieldIsValid: function () {},\n    fieldIsInvalid: function (error) {},\n\n    _closeImportDialog: function () {\n        this.close();\n    },\n\n    _onImportButtonClick: function () {\n        var self = this;\n        this.importView.doImport().done(function (response) {\n            self._closeImportDialog();\n        });\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport TreePlugin from './TreePlugin';\nimport _ from 'underscore';\nimport $ from 'jquery';\nvar returnContextMenuOptions = _.memoize(function (contextMenu) {\n    var actions = _.map(contextMenu.options, function (option) {\n        return option.model.get('action');\n    });\n    return actions;\n}, function (contextMenu) {\n    return contextMenu.cid;\n});\nexport default TreePlugin.extend({\n    initialize: function (options) {\n        if (!options) {\n            throw new Error('Initialization error. Options required.');\n        }\n        this.contextMenus = options.contextMenus;\n        this.contextMenu = options.contextMenu;\n        this.defaultSelectedItems = options.defaultSelectedItems || function () {\n        };\n        if (!this.contextMenus && !this.contextMenu) {\n            throw new Error('contextMenu or contextMenus must be specified.');\n        }\n        this.showContextMenuCondition = options.showContextMenuCondition;\n        if (!this.showContextMenuCondition && !this.contextMenu) {\n            throw new Error('contextMenu must be specified for default behaviour');\n        }\n        !this.showContextMenuCondition && (this.showContextMenuCondition = function () {\n            return this.contextMenu;\n        });\n        this.model = options.model;\n        TreePlugin.prototype.initialize.apply(this, arguments);\n    },\n    itemAction: function (optionModel) {\n        var action = optionModel.get('action');\n        this.treeItem.action = action;\n    },\n    itemsRendered: function (model, list) {\n        var self = this;\n        this.listenTo(list, 'list:item:contextmenu', function (item, event) {\n            this.currentContextMenu = self.showContextMenuCondition(item);\n            this.lastContextMenu && this.lastContextMenu.hide();\n            this.lastContextMenu = this.currentContextMenu;\n            if (this.currentContextMenu) {\n                this.currentContextMenu.treeItem = item;\n                var action = this.currentContextMenu.treeItem.action;\n                action || (action = self.defaultSelectedItems.call(this.currentContextMenu, item, returnContextMenuOptions(this.currentContextMenu))) ? this.currentContextMenu.resetSelection([action]) : this.currentContextMenu.resetSelection();\n                this.currentContextMenu.show({\n                    left: event.pageX,\n                    top: event.pageY\n                });\n                this.listenTo(this.currentContextMenu.collection, 'select', function (optionView, optionModel) {\n                    this.itemAction.call(this.currentContextMenu, optionModel);\n                }, this);\n            }\n        }, this);\n    },\n    remove: function () {\n        this.stopListening();\n        this.contextMenu && this.contextMenu.remove();\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default function(options) {\n    return options.contextPath\n        + \"/rest_v2/organizations?{{= id != 'organizations' ? 'rootTenantId=' + encodeURIComponent(id) : ''}}&offset={{= offset }}&limit={{= limit }}&maxDepth=1\";\n}","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Tree from 'js-sdk/src/common/component/tree/Tree';\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport TreeDataLayer from 'js-sdk/src/common/component/tree/TreeDataLayer';\nimport TooltipTreePlugin from 'js-sdk/src/common/component/tree/plugin/TooltipPlugin';\nimport ContextMenuTreePlugin from 'js-sdk/src/common/component/tree/plugin/ContextMenuTreePlugin';\nimport tenantTreeDataUriTemplateUtil from '../utils/tenantTreeDataUriTemplateUtil';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\n\nvar processors = {\n    tenantProcessor: function (tenantId) {\n        return {\n            processItem: function (item) {\n                item._node = true;\n                item.label = item.value.tenantName;\n                item.value.label = item.label;\n                item.value.uri = item.value.tenantUri;\n                item.id === tenantId && (item.addToSelection = true);\n                return item;\n            }\n        };\n    }\n};\nexport default function (options) {\n    var comparator = options.comparator, TreeWithPlugins = Tree.use(TooltipTreePlugin, {\n        i18n: i18n,\n        contentTemplate: options.tooltipContentTemplate\n    });\n    if (options.contextMenu) {\n        TreeWithPlugins = TreeWithPlugins.use(ContextMenuTreePlugin, { contextMenu: options.contextMenu });\n    }\n    return TreeWithPlugins.create().instance(_.extend({}, {\n        selection: {\n            allowed: {\n                left: true,\n                right: true\n            },\n            multiple: false\n        },\n        rootless: true,\n        collapsed: true,\n        lazyLoad: true,\n        bufferSize: 5000,\n        allowMouseDownEventPropagation: true,\n        dataUriTemplate: tenantTreeDataUriTemplateUtil({\n            contextPath: jrsConfigs.contextPath\n        }),\n        levelDataId: 'id',\n        getDataArray: function (data, status, xhr) {\n            var orgs = data ? data['organization'] : [];\n            comparator && orgs.sort(comparator);\n            return orgs;\n        },\n        processors: [processors.tenantProcessor(options.tenantId)],\n        customDataLayers: {\n            //workaround for correct viewing of '/' tenant label\n            '/': _.extend(new TreeDataLayer({\n                dataUriTemplate: jrsConfigs.contextPath + '/flow.html?_flowId=treeFlow&method=getNode&provider=tenantTreeFoldersProvider&uri=/',\n                processors: [processors.tenantProcessor(options.tenantId)],\n                getDataArray: function (data) {\n                    data = JSON.parse($(data).text());\n                    return [{\n                        id: data.id,\n                        tenantName: data.label,\n                        tenantUri: '/',\n                        resourceType: 'folder',\n                        _links: { content: '@fakeContentLink' }\n                    }];\n                }\n            }), {\n                accept: 'text/html',\n                dataType: 'text'\n            })\n        }\n    }));\n}","export default \"<li class=\\\"leaf\\\" {{ if(typeof(groupId)!== \\\"undefined\\\") { }} data-groupId = {{- groupId }} {{ } }} >\\n\\n    <js-templateNonce></js-templateNonce>\\n    <p class=\\\"wrap button\\\"><span class=\\\"icon\\\"></span>{{- label }}</p>\\n</li>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport OptionContainer from '../base/OptionContainer';\nimport menuOptionTemplate from './template/menuOptionTemplate.htm';\nimport menuContainerTemplate from './template/menuContainerTemplate.htm';\n\nexport default OptionContainer.extend({\n    constructor: function (options, additionalSettings) {\n        if (!options || !_.isArray(options) || options.length === 0) {\n            throw new Error('Menu should have options');\n        }\n        additionalSettings || (additionalSettings = {});\n        OptionContainer.call(this, {\n            options: options,\n            collection: additionalSettings.collection,\n            mainTemplate: additionalSettings.menuContainerTemplate || menuContainerTemplate,\n            optionTemplate: additionalSettings.menuOptionTemplate || menuOptionTemplate,\n            toggle: additionalSettings.toggle,\n            toggleClass: additionalSettings.toggleClass\n        });\n        this.maxSize = additionalSettings.maxSize;\n        this._onConstructor && this._onConstructor(options, additionalSettings);\n    },\n    initialize: function () {\n        OptionContainer.prototype.initialize.apply(this, arguments);\n        $('body').append(this.$el);\n        this._onInitialize && this._onInitialize();\n    },\n    show: function () {\n        var res = OptionContainer.prototype.show.apply(this, arguments);\n        this.applyMaxSize();\n        return res;\n    },\n    applyMaxSize: function () {\n        if (this.maxSize && this.options.length > this.maxSize) {\n            this.$el.css({\n                'overflow-y': 'auto',\n                'max-height': this.maxSize * this.options[0].$el.height() + 'px'\n            });\n        }\n    }\n});","export default \"<div class=\\\"menu vertical dropDown fitable\\\" tabindex=\\\"-1\\\" style=\\\"z-index: 99999; display: none;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"content\\\">\\n        <ul></ul>\\n    </div>\\n</div>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Menu from './Menu';\nimport $ from 'jquery';\nimport _ from 'underscore';\nvar OPACITY_VALUE_FOR_HEIGHT_CALCULATION = 0;\nvar EXTRA_OFFSET = 10;\nexport default Menu.extend({\n    constructor: function (options, additionalSettings) {\n        Menu.call(this, options, additionalSettings);\n        _.bindAll(this, '_tryHide');\n        this.topPadding = additionalSettings && additionalSettings.topPadding || 5;\n        this.leftPadding = additionalSettings && additionalSettings.leftPadding || 5;\n        this.extraOffset = options.extraOffset || EXTRA_OFFSET;\n        this.hideOnMouseLeave = additionalSettings && additionalSettings.hideOnMouseLeave || false;\n        _.bindAll(this, '_tryHide', '_checkBounds');\n        this.hideOnMouseLeave && this.$el.on('mouseleave', this._tryHide);\n    },\n    _tryHide: function () {\n        this.hide();\n        this._signOffTryHide();\n    },\n    _signOffTryHide: function () {\n        $(document.body).off('click.contextMenu', this._tryHide);\n        $(document.body).off('mousemove', this._checkBounds);\n    },\n    show: function (position, container) {\n        if (!position || !_.isNumber(position.top) || !_.isNumber(position.left)) {\n            throw new Error('Required params (top, left) missing: ' + JSON.stringify(position));\n        }\n        $(document.body).on('click.contextMenu', this._tryHide);\n        this.hideOnMouseLeave && $(document.body).on('mousemove', this._checkBounds);\n        var top = position.top, left = position.left, topPadding = this.topPadding, leftPadding = this.leftPadding, body = $('body'), menuElHeight = this._calculateMenuHeightOnShow(), menuElWidth = this.$el.width(), containerHeight = container ? container.height() : body.height(), containerWidth = container ? container.width() : body.width(), containerOffset = container ? container.offset() : body.offset(), fitByHeight = containerHeight - position.top, fitByWidth = containerWidth - position.left;\n        if (fitByHeight < menuElHeight) {\n            top = position.top - menuElHeight - topPadding;\n            top < containerOffset.top && (top += containerOffset.top - top + topPadding);\n            top = top < 0 ? containerHeight / 2 - menuElHeight / 2 : top;\n        }\n        if (fitByWidth < menuElWidth) {\n            left = position.left - menuElWidth - leftPadding;\n            left < containerOffset.left && (left += containerOffset.left - left + leftPadding);\n            left = left < 0 ? containerWidth / 2 - menuElWidth / 2 : left;\n        }\n        _.extend(this, {\n            top: top,\n            left: left\n        });\n        this.$el.css({\n            top: this.top,\n            left: this.left\n        });\n        return Menu.prototype.show.apply(this, arguments);\n    },\n    _checkBounds: function (event) {\n        var elementRect = {\n            top: this.$el[0].offsetTop - this.extraOffset,\n            bottom: this.$el[0].offsetTop + this.$el[0].offsetHeight + this.extraOffset,\n            left: this.$el[0].offsetLeft - this.extraOffset,\n            right: this.$el[0].offsetLeft + this.$el[0].offsetWidth + this.extraOffset\n        };\n        if (this._isPointerOutOfBounds(elementRect, event)) {\n            this._tryHide();\n        }\n    },\n    _isPointerOutOfBounds: function (elementRect, event) {\n        return event.clientX < elementRect.left || event.clientX > elementRect.right || (event.clientY < elementRect.top || event.clientY > elementRect.bottom);\n    },\n    _calculateMenuHeightOnShow: function () {\n        this.$el.css({ opacity: OPACITY_VALUE_FOR_HEIGHT_CALCULATION });\n        Menu.prototype.show.apply(this, arguments);\n        var height = this.$el.height();\n        this.hide();\n        this.$el.css({ opacity: '' });\n        return height;\n    },\n    remove: function () {\n        this._signOffTryHide();\n        this.hideOnMouseLeave && this.$el.off('mouseleave', this._tryHide);\n        Menu.prototype.remove.apply(this, arguments);\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport Backbone from 'backbone';\nimport i18n from '../../i18n/ImportExportBundle.properties';\nimport ExportDialogView from '../export/view/ExportDialogView';\nimport ImportDialogView from '../import/view/ImportDialogView';\nimport tenantTree from './tenantTree';\nimport ContextMenu from 'js-sdk/src/common/component/menu/ContextMenu';\nimport tooltipTemplate from '../templates/tooltipTemplate.htm';\n\nvar ROOT_TENANT_ID = 'organizations';\nvar TenantsTreeView = Backbone.View.extend({\n    initialize: function (options) {\n        this.$container = $(options.container);\n        var tenant = window.localStorage ? JSON.parse(localStorage.getItem('selectedTenant')) : null, selectedTenant = options.selectedTenant || tenant;\n        var root = options.currentUser ? options.currentUser.split('|')[1] || ROOT_TENANT_ID : selectedTenant?.tenantUri === '/' ? selectedTenant.tenantId || ROOT_TENANT_ID : ROOT_TENANT_ID;\n        this.splittedUri = _.compact(selectedTenant.tenantUri.split('/'));\n        this.splittedUri.splice(this.splittedUri.length - 1, 1);\n        this.splittedUri.unshift(root);\n        var treeInitOptions = {\n            tooltipContentTemplate: tooltipTemplate,\n            tenantId: selectedTenant.id || root,\n            comparator: options.comparator\n        };\n        if (!options.removeContextMenuTreePlugin) {\n            this.contextMenu = new ContextMenu([\n                {\n                    label: i18n['context.menu.option.export'],\n                    action: 'export'\n                },\n                {\n                    label: i18n['context.menu.option.import'],\n                    action: 'import'\n                }\n            ], { hideOnMouseLeave: true });\n            _.extend(treeInitOptions, { contextMenu: this.contextMenu });\n            this.listenTo(this.contextMenu, 'option:export', this._onExport);\n            this.listenTo(this.contextMenu, 'option:import', this._onImport);\n        }\n        this.exportDialog = new ExportDialogView();\n        this.importDialog = new ImportDialogView();\n        this.tree = new tenantTree(treeInitOptions);\n        this._initEvents();\n    },\n    render: function () {\n        this.$container.append(this.tree.render().$el);\n    },\n    refreshTenant: function (tenantId) {\n        var treeLevel = this.tree.getLevel(tenantId);    //TODO: Fix this temporary hack with dublicating items when they're in predefinedData.\n        //TODO: Fix this temporary hack with dublicating items when they're in predefinedData.\n        this.tree.getDataLayer(treeLevel).predefinedData = [];\n        tenantId ? treeLevel.refresh() : this.tree.refresh();\n    },\n    getTenant: function () {\n        return this.selectedTenant;\n    },\n    setTenant: function (tenant, name, value) {\n        !name ? this.selectedTenant = tenant : this.selectedTenant[name] = value;\n    },\n    selectTenant: function (tenantId) {\n        this.tree.select(tenantId);\n    },\n    addTenant: function (parentTenantId, tenant) {\n        var parentLevel = this.tree.getLevel(parentTenantId);\n        this.listenToOnce(parentLevel, 'ready', function () {\n            this.tree.addItem(parentTenantId, this._processItem(tenant, true));\n        });\n        parentLevel.open();\n    },\n    updateTenant: function (parentTenantId, updatedTenant, selectTenant) {\n        this.tree.updateItem(this._processItem(updatedTenant, false, selectTenant), parentTenantId);\n    },\n    removeTenant: function (tenantIds, parentTenantId) {\n        var level, parentLevel = this.tree.getLevel(parentTenantId);\n        tenantIds = !_.isArray(tenantIds) ? [tenantIds] : tenantIds;\n        _.each(tenantIds, function (tenantId) {\n            level = this.tree.getLevel(tenantId);\n            level && level.remove();\n        }, this);\n        parentLevel.refresh();\n        parentLevel.open();\n    },\n    remove: function () {\n        this.tree.remove();\n        this.contextMenu && this.contextMenu.remove();\n    },\n    _processItem: function (item, isNew, select) {\n        var id = item.tenantId || item.id, uri = item.tenantFolderUri || item.tenantUri, label = item.tenantName, value = {\n            id: id,\n            label: label,\n            uri: uri,\n            tenantUri: uri,\n            parentId: item.parentId\n        };\n        return isNew ? {\n            _node: true,\n            id: id,\n            label: label,\n            value: value\n        } : {\n            id: item.tenantId,\n            addToSelection: select,\n            label: label,\n            value: value\n        };\n    },\n    _initEvents: function () {\n        this.expandedLevels = [];\n        this.listenTo(this.tree, 'selection:change', function (selection) {\n            this.trigger('selection:change', _.compact(selection)[0]);\n        });\n        this.listenTo(this.importDialog, 'import:finished', function (tenantId) {\n            this.refreshTenant(tenantId);\n            this.trigger('import:finished', tenantId);\n        });\n        this._recursivelyOpenLevels(this.tree.rootLevel);\n    },\n    _recursivelyOpenLevels: function (level) {\n        this.listenTo(level, 'ready', function () {\n            var treeLevel = this.tree.getLevel(this.splittedUri[0]);\n            this.splittedUri.splice(0, 1);\n            if (treeLevel) {\n                this.expandedLevels.push(treeLevel);\n                this.tree.expand(treeLevel.id);\n                this._recursivelyOpenLevels(treeLevel);\n            } else {\n                _.each(this.expandedLevels, function (newlevel) {\n                    this.stopListening(newlevel, 'ready');\n                }, this);\n            }\n        });\n    },\n    _onExport: function () {\n        this.exportDialog.openTenantDialog(this.selectedTenant);\n    },\n    _onImport: function () {\n        this.importDialog.openDialog(this.selectedTenant);\n    }\n});\nexport default TenantsTreeView;","export default \"{{ if (model.value.tenantDesc) { }}\\n<!--<p class=\\\"message label\\\">{{- i18n['tooltip.description'] }}</p><p class=\\\"message\\\">{{- model.value.tenantDesc }}</p>-->\\n{{ } }}\\n{{ if (model.value.uri) { }}\\n<p class=\\\"message label\\\">{{- i18n['tooltip.path'] }}</p><p class=\\\"message\\\">{{- model.value.uri }}</p>\\n{{ } }}\\n\\n    <js-templateNonce></js-templateNonce>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {doNothing, isSupportsTouch, isIPad} from \"./utils.common\";\nimport jQuery from 'jquery';\n\nvar InfiniteScroll = function (options) {\n    this._id = options.id;\n    this._contentId = options.contentId ? options.contentId : undefined;\n    this._scroll = options.scroll;\n    this._loadFactor = options.loadFactor ? options.loadFactor : 0.95;\n    this._lastContentHeight = 0;\n    this._loading = false;    // getting control from 'id' of jquery object or from DOM element\n    // getting control from 'id' of jquery object or from DOM element\n    if (options.control) {\n        if (options.control.length !== undefined && options.control.length > 1) {\n            this._control = jQuery(options.control[0]);\n        } else {\n            this._control = jQuery(options.control)[0];\n        }\n    } else {\n        this._control = this._scroll ? this._scroll.parent : jQuery('#' + this._id)[0];\n    }\n    if (this._scroll) {\n        this._content = this._scroll.element;\n    } else {\n        // getting content from 'id' of jquery object or from DOM element\n        if (options.content) {\n            if (options.content.length !== undefined && options.content.length > 1) {\n                this._content = jQuery(options.content[0]);\n            } else {\n                this._content = jQuery(options.content)[0];\n            }\n        } else {\n            this._content = this._contentId ? jQuery('#' + this._contentId)[0] : this._control.childElements()[0];\n        }\n    }\n    this._eventType = isSupportsTouch() ? 'touchmove' : 'scroll';\n    this._control.observe(this._eventType, this._onScrollHandler.bind(this));\n};\n/**\n\t * Destroys the infinite scroll.\n\t */\nInfiniteScroll.addMethod('destroy', function () {\n    if (this._control) {\n        this._control.stopObserving(this._eventType, this._handler);\n    }\n});    /**\n\t * Handler for scroll event on the control element.\n\t */\n/**\n\t * Handler for scroll event on the control element.\n\t */\nInfiniteScroll.addMethod('_onScrollHandler', function (e) {\n    var controlScrollTop = this._scroll ? this._scroll.y * -1 : this._control.scrollTop;\n    var contentHeight = this._content.getHeight();\n    var controlHeight = this._control.getHeight();\n    if (contentHeight != this._lastContentHeight) {\n        this._loading = false;\n    }\n    var allowLoad = !this._loading && contentHeight != 0;\n    if (this._scroll) {\n        allowLoad = allowLoad && this._scroll.isBottom();\n    } else {\n        allowLoad = allowLoad && (controlHeight + controlScrollTop) / contentHeight > this._loadFactor;\n    }\n    if (allowLoad) {\n        this._loading = true;\n        this._lastContentHeight = contentHeight;\n        isIPad() && this.wait();\n        this.onLoad();\n    }\n});    /**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\n/**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\nInfiniteScroll.addMethod('onLoad', doNothing);    /**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\n/**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\nInfiniteScroll.addMethod('reset', function () {\n    isIPad() ? this._scroll.reset() : this._control.scrollTop = 0;\n    this._loading = false;\n});\nInfiniteScroll.addMethod('wait', function () {\n    if (!this._waitIndicator) {\n        this._waitIndicator = new Element('div', { 'class': 'dimmer resultsOverlay' });\n        var dimensions = this._control.getDimensions();\n        var offsets = this._control.positionedOffset();\n        this._waitIndicator.setStyle({\n            zIndex: '4000',\n            top: offsets.top + 'px',\n            left: offsets.left + 'px',\n            height: dimensions.height + 'px',\n            width: dimensions.width + 'px'\n        });\n        this._control.insert({ after: this._waitIndicator });\n    }\n    this._waitIndicator.show();\n});\nInfiniteScroll.addMethod('stopWaiting', function () {\n    this._waitIndicator && this._waitIndicator.hide();\n});    // TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\n// TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\nwindow.InfiniteScroll = InfiniteScroll;\nexport default InfiniteScroll;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport confirmDialogTemplate from './template/confirmDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.confirmDialogTemplate = options.confirmDialogTemplate || _.template(confirmDialogTemplate);\n        Dialog.prototype.constructor.call(this, {\n            modal: true,\n            additionalCssClasses: options.additionalCssClasses || 'confirmationDialog',\n            title: options.title || i18n['dialog.confirm.title'],\n            content: this.confirmDialogTemplate({ text: options.text }),\n            buttons: [\n                {\n                    label: options.yesLabel || i18n['button.yes'],\n                    action: 'yes',\n                    primary: true\n                },\n                {\n                    label: options.noLabel || i18n['button.no'],\n                    action: 'no',\n                    primary: false\n                }\n            ]\n        });\n    },\n    initialize: function () {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:yes', this.close);\n        this.on('button:no', this.close);\n    },\n    setContent: function (content) {\n        Dialog.prototype.setContent.call(this, this.confirmDialogTemplate({ text: content }));\n    }\n});","export default \"<p class='confirmationText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{ print(_.xssSoftEscape(text)) }}\\n</p>\";"],"sourceRoot":""}