{"version":3,"sources":["webpack://jrs-ui/./src/core/core.ajax.utils.js","webpack://jrs-ui/./runtime_dependencies/dragdropextra/dragdropextra.js"],"names":["showErrorPopup","errorMessage","options","indexOf","dialogs","baseErrorHandler","ajaxAgent","status","responseText","getResponseHeader","document","location","jQuery","length","body","html","JRS","window","parent","removeClass","show","errorHandler","showMessageDialog","Draggable","prototype","startDrag","event","isDragging","this","dragging","delta","currentDelta","zindex","originalZ","parseInt","Element","getStyle","element","style","zIndex","ghosting","_clone","cloneNode","_originallyAbsolute","Position","absolutize","parentNode","insertBefore","tagName","appendChild","superghosting","prepare","pointer","Event","pointerX","pointerY","getElementsByTagName","me","Prototype","Browser","IE","clearAttributes","mergeAttributes","id","hide","removeChild","width","height","getWidth","getHeight","originalScrollTop","draw","scroll","where","_getWindowScroll","originalScrollLeft","left","top","scrollLeft","scrollTop","Draggables","notify","starteffect","point","pos","cumulativeOffset","r","realOffset","deltaX","deltaY","d","_isScrollChild","p","map","i","mouseOffset","offset","bind","snap","Object","isFunction","isArray","v","round","constraint","visibility","initDrag","isUndefined","_dragging","touches","isLeftClick","tag_name","toUpperCase","parents","activate","countdown","DEFAULT_TOLERANCE","stop","fire","targetEvent","Droppables","isAffected","drop","jo","w","h","p0","p1","positioned_within","$","_containers","isContained","accept","classNames","detect","include","finishDrag","success","isIE","onmousemove","quiet","relativize","remove","dropped","onDropped","revert","reverteffect","endeffect","deactivate","reset","Sortable","defaultOnHover","onHover","dropon","overlap","hasClassName","defaultOnEmptyHover","onEmptyHover","SortableObserver","Class","create","initialize","observer","lastValue","serialize","onStart","onEnd","eventName","draggable","unmark","getSortableObserverConstructor","drops","affected","each","push","findDeepestChild","last_active","within","set","position","display"],"mappings":"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","file":"_chunks/chunk.6004.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport dialogs from \"../components/components.dialogs\";\nimport {JRS} from \"../namespace/namespace\";\nimport jQuery from 'jquery';\n\nfunction showErrorPopup(errorMessage, options) {\n    if ((errorMessage && errorMessage.indexOf('sessionAttributeMissingException')) > -1) {\n        dialogs.clusterErrorPopup.show(errorMessage);\n    } else {\n        dialogs.errorPopup.show(errorMessage, false, options);\n    }\n}\nfunction baseErrorHandler(ajaxAgent) {\n    //Handling HTTP 500 - Internal server error\n    if (ajaxAgent.status == 500) {\n        showErrorPopup(ajaxAgent.responseText);\n        return true;\n    }\n    var sessionTimeout = ajaxAgent.getResponseHeader('LoginRequested');\n    if (sessionTimeout) {\n        var newloc = '.';\n        document.location = newloc;\n        return true;\n    }\n    var isErrorPage = ajaxAgent.getResponseHeader('JasperServerError');\n    if (isErrorPage) {\n        var suppressError = ajaxAgent.getResponseHeader('SuppressError');\n        if (!suppressError) {\n            // For dashboard frame we should render error message as frame content.\n            var dashboardViewFrame = jQuery('.dashboardViewFrame');\n            if (dashboardViewFrame.length == 1) {\n                jQuery(document.body).html(ajaxAgent.responseText);\n                var iFrame = jQuery('#' + JRS.fid, window.parent.document);\n                iFrame.removeClass('hidden').show();\n            } else {\n                // In other cases we render error message as popup.\n                showErrorPopup(ajaxAgent.responseText);\n            }\n        }\n        return true;\n    }\n    return false;\n}\n\nfunction errorHandler() {}\nfunction showMessageDialog() {}\n\nexport {\n    showErrorPopup,\n    baseErrorHandler,\n    errorHandler,\n    showMessageDialog\n}","//  DragDropExtra Scriptaculous Enhancement, version 0.5\n//  (c) 2007-2008 Christopher Williams, Iterative Designs\n//\n// v0.5 release\n//      - Fixed bug where 2nd drag on an element in IE would result in funny placement of the\n//        element. [shammond42]\n// v0.4 release\n//\t\t- Fixed issue with dragging and dropping in IE7 due to an exception being thrown and not properly reseting in FinishDrag.\n// v0.3 release\n//    - Fixed bug found by Phillip Sauerbeck psauerbeck@gmail. Tests added based on Phillip's efforts.\n// v0.2 release\n//      - Minor bug fix for the releasing of objects after they have been dropped, prevents memory leak.\n// v0.1 release\n//      - initial release for the super ghosting capability\n//      - Drags from one scrolling list to the other (overflow:auto)\n//      - Retains the original object so that it can remain present despite being dragged\n//\n// dragdropextra.js is freely distributable under the terms of an MIT-style license.\n// For details, see the Iterative Designs web site: http://www.iterativedesigns.com/\n// Parts of this code have been taken from the original dragdrop.js library which is\n// copyrighted by (c) 2005-2007 Thomas Fuchs (http://script.aculo.us,\n// http://mir.aculo.us) and (c) 2005-2007 Sammi Williams\n// (http://www.oriontransfer.co.nz, sammi@oriontransfer.co.nz) and available under\n// a MIT-style license.\n\n//////////////////////////////////////////////////////////////////////////////////////////////\n//Jaspersoft Updates (look for comment: JASPERSOFT #x)\n//////////////////////////////////////////////////////////////////////////////////////////////\n// #1 3/27/10 if options.mouseOffset is true then dragging thing positioned with mousepointer\n// \t\t   see Draggable.prototype.draw\n// #2 9/27/10 restore zIndex of coloned element after dragging\n// #1 11/30/100 updated #1 to allow for parent element offsets\n// #3 11/26/20 JS-60321: Added ability to override SortableObserver\n//////////////////////////////////////////////////////////////////////////////////////////////\n\nDraggable.prototype.startDrag = function(event) {\n\tDraggable.isDragging = true;\n    this.dragging = true;\n    if (!this.delta)\n        this.delta = this.currentDelta();\n\n    if (this.options.zindex) {\n        this.originalZ = parseInt(Element.getStyle(this.element, 'z-index') || 0);\n        this.element.style.zIndex = this.options.zindex;\n    }\n    if (this.options.ghosting) {\n        this._clone = this.element.cloneNode(true);\n        this._originallyAbsolute = (this.element.getStyle('position') == 'absolute');\n        if (!this._originallyAbsolute) {\n            Position.absolutize(this.element);\n        }\n        this.element.parentNode.insertBefore(this._clone, this.element);\n        if (this.element.parentNode.tagName === \"TR\") {\n            document.body.appendChild(this.element);\n        }\n    }\n\n    if (this.options.superghosting) {\n        Position.prepare();\n        var pointer = [Event.pointerX(event), Event.pointerY(event)];\n        var body = document.getElementsByTagName(\"body\")[0];\n        var me = this.element;\n        this._clone = me.cloneNode(true);\n        if (Prototype.Browser.IE) {\n            // Clear event handing from the clone\n            // Solves the second drag issue in IE\n            this._clone.clearAttributes();\n            this._clone.mergeAttributes(me.cloneNode(false));\n        }\n        me.parentNode.insertBefore(this._clone, me);\n        me.id = \"clone_\" + me.id;\n        me.hide();\n\n        Position.absolutize(me);\n        me.parentNode.removeChild(me);\n        body.appendChild(me);\n        //Retain height and width of object only if it has been nulled out.  -v0.3 Fix\n        if (me.style.width == \"0px\" || me.style.height == \"0px\") {\n            me.style.width = Element.getWidth(this._clone) + \"px\";\n            me.style.height = Element.getHeight(this._clone) + \"px\";\n        }\n\n        //overloading in order to reduce repeated code weight.\n        this.originalScrollTop = (Element.getHeight(this._clone) / 2);\n\n        this.draw(pointer);\n\n        me.show();\n    }\n\n    if (this.options.scroll) {\n        if (this.options.scroll == window) {\n            var where = this._getWindowScroll(this.options.scroll);\n            this.originalScrollLeft = where.left;\n            this.originalScrollTop = where.top;\n        } else {\n            this.originalScrollLeft = this.options.scroll.scrollLeft;\n            this.originalScrollTop = this.options.scroll.scrollTop;\n        }\n    }\n\n    Draggables.notify('onStart', this, event);\n\n    if (this.options.starteffect) this.options.starteffect(this.element);\n};\n\n\nDraggable.prototype.draw = function(point) {\n    var pos = Position.cumulativeOffset(this.element);\n\n    if (this.options.ghosting) {\n        var r = Position.realOffset(this.element);\n        pos[0] += r[0] - Position.deltaX;\n        pos[1] += r[1] - Position.deltaY;\n    }\n\n    var d = this.currentDelta();\n    pos[0] -= d[0];\n    pos[1] -= d[1];\n\n    if(this.options.scroll) {\n        pos[0] -= this.options.scroll.scrollLeft;\n        pos[1] -= this.options.scroll.scrollTop;\n    }\n\n    if (this.options.scroll && (this.options.scroll != window && this._isScrollChild)) {\n        pos[0] -= this.options.scroll.scrollLeft - this.originalScrollLeft;\n        pos[1] -= this.options.scroll.scrollTop - this.originalScrollTop;\n    }\n\n    var p = [0,1].map(function(i) {\n        /*\n         * JASPERSOFT #1 - see comment block top of page for more info\n         */\n        return (point[i] - pos[i] - (this.options.mouseOffset ? (-2) : this.offset[i]));\n    }.bind(this));\n\n    if (this.options.snap) {\n        if (Object.isFunction(this.options.snap)) {\n            p = this.options.snap(p[0], p[1], this);\n        } else {\n            if (Object.isArray(this.options.snap)) {\n                p = p.map(function(v, i) {\n                    return (v / this.options.snap[i]).round() * this.options.snap[i]\n                }.bind(this))\n            } else {\n                p = p.map(function(v) {\n                    return (v / this.options.snap).round() * this.options.snap\n                }.bind(this))\n            }\n        }\n    }\n\n    if (this.options.superghosting) {\n        if (this.element.getStyle('position') == 'absolute') {\n            p[1] = point[1] - this.originalScrollTop;\n        } else {\n            p[1] -= this.originalScrollTop || 10;\n        }\n    }\n\n    var style = this.element.style;\n    //JASPERSOFT #1 - see comment block top of page for more info\n    if ((!this.options.constraint) || (this.options.constraint == 'horizontal'))\n        style.left = p[0] + \"px\";\n    if ((!this.options.constraint) || (this.options.constraint == 'vertical'))\n        style.top = p[1] + \"px\";\n    //END JASPERSOFT #2\n\n    if (style.visibility == \"hidden\") style.visibility = \"\"; // fix gecko rendering\n};\n\nDraggable.prototype.initDrag = function(event) {\n    if (!Object.isUndefined(Draggable._dragging[this.element]) &&\n            Draggable._dragging[this.element]) return;\n\n    if ((event.touches && event.touches.length == 1) || Event.isLeftClick(event)) {\n        // abort on form elements, fixes a Firefox issue\n        var src = Event.element(event);\n        var tag_name = src.tagName.toUpperCase();\n        if (tag_name == 'INPUT' ||\n            tag_name == 'SELECT' ||\n            tag_name == 'OPTION' ||\n            tag_name == 'BUTTON' ||\n            tag_name == 'TEXTAREA') return;\n\n        if(jQuery(this.element).parents('#sortDialog').length > 0 && tag_name == 'B') {\n            return;\n        }\n\n        var pointer = [Event.pointerX(event), Event.pointerY(event)];\n        var pos = Position.cumulativeOffset(this.element);\n        this.offset = [0,1].map(function(i) {\n            return (pointer[i] - pos[i])\n        });\n\n        Draggables.activate(this);\n        this.countdown = Draggables.DEFAULT_TOLERANCE;\n        Event.stop(event);\n        this.element.fire('drag:mousedown', {targetEvent: event});\n    }\n};\n\nDroppables.isAffected = function(point, element, drop) {\n    //Position.prepare();\n    //var positioned_within = Position.withinIncludingScrolloffsets(drop.element, point[0], point[1]);\n    var jo = jQuery(drop.element);\n    var w = jo.width();\n    var h = jo.height();\n    var p0 = jo.offset();\n    var p1 = {\n    \tleft: p0.left + w,\n    \ttop: p0.top + h\n    };\n    var positioned_within = point[0] > p0.left && point[0] < p1.left && point[1] > p0.top && point[1] < p1.top;\n\n    return ((drop.element != element) &&\n           ((element.parentNode === $(document.body)) || (!drop._containers) || this.isContained(element, drop)) &&\n           ((!drop.accept) || (Element.classNames(element).detect(function(v) { return drop.accept.include(v) } ))) &&\n           positioned_within );\n};\n\nDraggable.prototype.finishDrag = function(event, success) {\n\tDraggable.isDragging = false;\n    this.dragging = false;\n\n    if (isIE()) document.body.onmousemove = function(){};  // fix for bug 25666\n\n    if (this.options.quiet) {\n        Position.prepare();\n        var pointer = [Event.pointerX(event), Event.pointerY(event)];\n        Droppables.show(pointer, this.element);\n    }\n\n    if (this.options.ghosting) {\n        if (!this._originallyAbsolute) {\n            Position.relativize(this.element);\n            if (this._clone.parentNode.tagName === \"TR\") {\n                this._clone.parentNode.insertBefore(this.element, this._clone);\n            }\n        }\n        delete this._originallyAbsolute;\n        Element.remove(this._clone);\n        this._clone = null;\n    }\n\n    var dropped = false;\n\n    if (success) {\n        dropped = Droppables.fire(event, this.element);\n        if (!dropped) dropped = false;\n    }\n    if (dropped && this.options.onDropped) this.options.onDropped(this.element);\n    Draggables.notify('onEnd', this, event);\n\n    var revert = this.options.revert;\n    if (revert && Object.isFunction(revert)) revert = revert(this.element);\n\n    var d = this.currentDelta();\n    if (revert && this.options.reverteffect) {\n        if (dropped == 0 || revert != 'failure')\n            this.options.reverteffect(this.element,\n                    d[1] - this.delta[1], d[0] - this.delta[0]);\n    } else {\n        this.delta = d;\n    }\n\n    if (this.options.zindex) {\n        this.element.style.zIndex = this.originalZ;\n        /*\n         * JASPERSOFT #2 - see comment block top of page for more info\n         */\n        this._clone && (this._clone.style.zIndex = this.originalZ);\n    }\n\n    this.options.endeffect && this.options.endeffect(this.element);\n\n    if (this.options.superghosting) {\n        // If detached drag element from DOM, we should attach it again!\n        if (this.element.parentNode == null) {\n            Element.hide(this.element);\n            $(document.body).appendChild(this.element);\n        }\n        Element.remove(this.element);\n        new Draggable(this._clone, this.options);\n    }\n\n    Draggables.deactivate(this);\n    Droppables.reset();\n};\n\nSortable.defaultOnHover = Sortable.onHover;\nSortable.onHover = function(element, dropon, overlap) {\n    if (!element.hasClassName(\"dialog\")) {\n        Sortable.defaultOnHover(element, dropon, overlap);\n    }\n};\n\nSortable.defaultOnEmptyHover = Sortable.onEmptyHover;\nSortable.onEmptyHover = function(element, dropon, overlap) {\n    if (!element.hasClassName(\"dialog\")) {\n        Sortable.defaultOnEmptyHover(element, dropon, overlap);\n    }\n};\n\nvar SortableObserver = Class.create({\n    initialize: function(element, observer) {\n        this.element = $(element);\n        this.observer = observer;\n        this.lastValue = Sortable.serialize(this.element);\n    },\n    onStart: function() {\n        this.lastValue = Sortable.serialize(this.element);\n    },\n    onEnd: function(eventName, draggable) {\n        Sortable.unmark();\n        if(this.lastValue != Sortable.serialize(this.element)) {\n            this.observer(this.element, draggable);\n        }\n    }\n});\n\n//JASPERSOFT #3 - see comment block top of page for more info\nSortable.getSortableObserverConstructor = function () {\n    return SortableObserver;\n}\n//END JASPERSOFT #3\n\nDroppables.show = function(point, element) {\n    if (!this.drops.length) return;\n    var drop, affected = [];\n\n    this.drops.each(function(drop) {\n        if(Droppables.isAffected(point, element, drop)) {\n            if(element.hasClassName('sortDialogAvailable') || element.hasClassName('sortDialogSortFields')) {\n                if(drop.element.id == 'sortDialogAvailable' || drop.element.id == 'sortDialogSortFields') {\n                    affected.push(drop);\n                }\n            } else {\n                affected.push(drop);\n            }\n        }\n    });\n\n    if (affected.length > 0)\n        drop = Droppables.findDeepestChild(affected);\n\n    if (this.last_active && this.last_active != drop) {\n    \tthis.deactivate(this.last_active);\n    }\n    if (drop) {\n        Position.within(drop.element, point[0], point[1]);\n        if (drop.onHover) {\n            // Hack to dynamically change level/measure appearing when dragging from tree to some drop container\n            if (element.classNames().include(\"wrap\")) {\n                element.relativize();\n                element.classNames().include(\"measure\") ?\n                        element.classNames().set(\"draggable dragging measure\" + (element.classNames().include(\"supportsFilter\") ? \" supportsFilter\"  : \"\")) :\n                        element.classNames().set(\"draggable dragging dimension\" + (element.classNames().include(\"supportsFilter\") ? \" supportsFilter\"  : \"\"));\n                element.style.position = 'relative';\n                element.style.display = 'inline-block';\n                element.style.width = '';\n                element.style.height = '';\n            }\n\n            drop.onHover(element, drop.element, Position.overlap(drop.overlap, drop.element));\n        }\n\n        if (drop != this.last_active) {\n        \tDroppables.activate(drop);\n        }\n    }\n};\n\n"],"sourceRoot":""}