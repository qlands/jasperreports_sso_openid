{"version":3,"sources":["webpack://jrs-ui/./src/controls/controls.dataconverter.js","webpack://jrs-ui/./src/controls/controls.datatransfer.js","webpack://jrs-ui/./src/controls/controls.basecontrol.js","webpack://jrs-ui/./src/controls/rest/enum/restParamsEnum.ts","webpack://jrs-ui/./src/controls/controls.viewmodel.js","webpack://jrs-ui/./src/controls/predicate/isControlInCascade.ts","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/listWithNavigationModelTrait.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/manager/KeyboardManager.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/ScalableListModel.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/BaseListWithSelectionModel.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/ListWithSelectionModel.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/model/SingleSelectListModel.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/view/ScalableList.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/templates/viewPortChunksTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/scalableList/templates/itemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/scalableList/view/ListWithSelection.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/view/ListWithNavigation.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/view/SingleSelectList.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/manager/DropDownManager.js","webpack://jrs-ui/../js-sdk/src/i18n/ScalableInputControlsBundle.properties.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/view/SingleSelect.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/singleSelectTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/singleSelectTemplate_IE10_11.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/dropDownTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/listTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/itemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/ListWithSelectionAsObjectHashModel.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/model/SingleSelectListModelNew.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/view/SingleSelectNew.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/util/domAndCssUtil.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/mixin/scalableListItemHeightCalculationTrait.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/listTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/AvailableItemsList.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/availableItemsTemplate_IE10_11.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/availableItemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/ListViewForSelectedItemsList.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/SelectedItemsList.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/selectedItemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/selectedItemsListTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/dataprovider/CacheableDataProvider.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/dataprovider/SelectedItemsDataProvider.js","webpack://jrs-ui/../js-sdk/src/components/sizer/Sizer.js","webpack://jrs-ui/../js-sdk/src/components/sizer/template/sizerTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/MultiSelect.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/multiSelectTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory.js","webpack://jrs-ui/./src/controls/dataprovider/InputControlsDataProvider.ts","webpack://jrs-ui/./src/controls/dataprovider/InputControlsDataProviderWithDataLabelHash.ts","webpack://jrs-ui/./src/controls/dataprovider/util/getInputControlsDataProviderNewPageOptions.ts","webpack://jrs-ui/./src/controls/controls.components.js","webpack://jrs-ui/./src/controls/rest/InputControlsService.ts","webpack://jrs-ui/./src/controls/rest/InputControlsServiceWithCache.ts","webpack://jrs-ui/./src/controls/converter/inputControlsToViewModelConverter.ts","webpack://jrs-ui/./src/controls/enum/inputControlTypeEnum.ts","webpack://jrs-ui/./src/controls/converter/getControlPaginationOptionsByControlIdAndType.ts","webpack://jrs-ui/./src/controls/predicate/isQueryControl.ts","webpack://jrs-ui/./src/controls/converter/getControlsPaginationOptionsByControlId.ts","webpack://jrs-ui/./src/controls/service/InputControlsReportViewerService.ts","webpack://jrs-ui/./src/controls/controls.controller.js","webpack://jrs-ui/./src/controls/controls.logging.js","webpack://jrs-ui/./src/core/core.ajax.utils.js","webpack://jrs-ui/./src/scheduler/template/schedulerOverlayIframeTemplate.htm","webpack://jrs-ui/./src/scheduler/util/schedulerConstants.js","webpack://jrs-ui/./src/scheduler/util/schedulerUtils.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/ConfirmationDialog.js","webpack://jrs-ui/../js-sdk/src/common/util/domUtil.js","webpack://jrs-ui/../js-sdk/src/components/dateAndTime/DateAndTimePicker.js","webpack://jrs-ui/../js-sdk/src/components/dateAndTime/template/dateTimePopupContainer.htm","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/confirmDialogTemplate.htm","webpack://jrs-ui/./src/i18n/all.properties.js"],"names":["exp","_","Controls","DataConverter","JRS","Base","extend","structureFormater","response","formatedResponse","map","inputControl","res","readOnly","String","uri","replace","state","controlStructure","compact","each","structure","this","convertResponseToControlsState","rawState","result","requestStates","inputControlState","convertOptionFunc","option","opt","value","label","selected","convertToValues","requestState","isUndefined","isNull","options","isArray","id","error","values","JSON","jQuery","commonErrorHandler","err","errorObject","parse","responseText","e","viewModel","getViewModel","controlUri","inputControlUri","control","find","errorCode","set","defaultMessage","getResponseHeader","status","document","location","__jrsConfigs__","indexOf","message","errorObjectMessage","parameters","length","template","window","statusText","dialogs","DataTransfer","CONTROLS_STRUCTURE_TEMPLATE_URI","INITIAL_CONTROLS_VALUES_TEMPLATE_URL","CONTROLS_VALUES_TEMPLATE_URL","constructor","dataConverter","initialize","setReportUri","reportUri","currentReportUri","buildUrl","reportPath","controlIds","urlTemplate","join","TemplateEngine","renderUrl","sendRequest","url","data","settings","defaultSettings","type","dataType","cache","isEmpty","processData","stringify","contentType","requestSettings","defaults","headers","ajax","fail","fetchControlsStructure","uris","selectedData","controlsStructure","then","bind","Utils","showLoadingDialogOn","updateControlsStructure","updatedStructure","fetchInitialControlValues","initialControlsValues","fetchControlsUpdatedValues","ids","fullUpdateDeferred","reject","Deferred","triggerRequestDeferred","wait","FREQUENT_CHANGES_MIN_DELAY","done","resolve","arguments","BaseControl","elem","templateChunks","args","apply","getElem","setElem","element","bindCustomEventListeners","isSingleSelect","get","isSingleValue","getTemplateSection","section","createTemplateSection","baseRender","isVisible","fireControlSelectionChangeEvent","selection","trigger","CHANGE_CONTROL","createTemplate","setValue","selectedValues","fetch","clearFilter","render","attribute","isValid","undefined","visible","updateWarningMessage","text","reset","attributes","preventNotification","disabled","disable","enable","mandatory","key","keys","val","prop","merge","selections","RestParamsEnum","scrollTimeout","lastScrollAt","isIE","browserDetection","scrollStartStopCallback","Date","getTime","now","self","clearTimeout","setTimeout","ViewModel","containerSelector","DEFAULT_CONTAINER","controls","bindAll","registerEvents","ignore","onControlChange","listen","event","controlInCascade","slaveDependencies","isControlInCascade","CHANGE_SELECTION","CHANGE_VALUES","CHANGE_ORDER","isSelectionChanged","previous","next","previousControlIds","nextControlIds","union","previousFlattenValues","flatten","nextFlattenValues","difference","Model","getControls","instantiate","dataUri","inputControlsService","initialSelectedValues","paginatedValuesOptions","forEach","controlId","createControl","Control","property","toLowerCase","Error","removeControl","reorderControl","oldIndex","newIndex","t","shiftDirection","start","Math","min","max","end","i","controlsOptions","draw","update","Array","findControl","pluck","View","jsonStructure","container","getContainer","empty","attr","controlJson","append","Report","icReorderEnabled","horizontalLayout","layouts","LAYOUT_TOP_OF_PAGE","reportControlsLayout","test","navigator","userAgent","_initSortable","controlSelection","removeValidationMessages","areAllControlsValid","filter","setContainer","reloadContainer","keepSortableAlive","sortableContainer","sortable","delay","placeholder","axis","items","cancel","ui","item","index","stop","parent","off","on","prototype","activate","setActive","that","getData","offset","limit","fetchFailed","active","silent","getActive","KeyboardManager","systemKeyCodes","keydownHandlers","preventKeydownHandlers","stopPropagation","keydownTimeout","context","deferredKeydownHandler","immediateHandleCondition","immediateKeydownHandler","onKeydown","_isSystemKeyPressed","_canImmediatelyHandleKeyboardEvent","_immediatelyHandleKeyboardEvent","deferredHandleKeyboardEvent","deferredTimeout","call","which","_immediateHandleCondition","keydownHandler","_immediatePreventdefaultHandler","preventDefault","Backbone","bufferSize","loadFactor","_fetchComplete","total","bufferEndIndex","bufferStartIndex","afterFetchComplete","_isBufferReloadNecessary","topVisibleItem","bottomVisibleItem","topLoadFactor","bottomLoadFactor","responseStatus","top","bottom","force","bufferCenter","floor","bufferHalf","ScalableListModel","select","_addToSelection","_removeFromSelection","_clearSelection","_selectionContains","_getSelection","_triggerSelectionChange","_addRangeToSelection","rangeStart","rangeEnd","getSelection","_fetchAllDataAndModifySelection","modifySelection","onDone","addValueToSelection","selectionStartIndex","addRangeToSelection","slice","removeValueFromSelection","toggleSelection","selectionContains","clearSelection","selectAll","firstIteration","invertSelection","BaseListWithSelectionModel","_isSelectionEmpty","hasOwnProperty","_selectPendingSelection","pendingSelection","_convertInitialArrayToSelection","_calcSelectionStartIndex","parseInt","SingleSelectListModel","ListWithSelectionModel","listWithNavigationModelTrait","_convertSelectionObject","_select","convertedSelection","shouldFetchLabel","ListModel","listItemSelector","events","model","chunksTemplate","itemsTemplate","defaultChunkHeight","chunkHeight","manualScrollInterval","lazy","defaultItemHeight","listItemHeight","initListeners","listenTo","onModelChange","onFetchFailed","onScroll","scrollTimer","_fetchVisibleData","scrollPos","target","scrollTop","restoreScrollPos","$el","renderData","postProcessChunkModelItem","$","_renderItems","bufferStart","bufferEnd","firstChunkWithData","itemsPerChunk","ceil","lastChunkWithData","chunk","$chunk","chunkModel","_getChunkModel","totalItems","itemHeight","chunkHtml","child","children","removeChild","_renderViewChunks","chunks","_getViewChunksModel","$firstViewChunk","totalChunksToShow","lastChunkHeight","viewChunks","push","height","_calcViewPortConstants","viewPortConstantsInitialized","outerHeight","_calcViewPortHeight","resizeViewPort","viewPortHeight","itemsPerView","_getItemsPerView","firstItemForChunk","lastItemForChunk","visibleItems","_getVisibleItems","_getScrollPos","elOffset","viewChunkOffset","has","resize","is","componentHeight","_componentHeight","callback","keepPosition","once","scrollTo","newTopVisibleItemPos","itemPos","BUTTONS","LEFT","RIGHT","ScalableList","eventListenerPattern","markerClass","selectedClass","_initSelection","delegateEvents","onMousedown","onMousemove","onMousedblclick","onItemEvent","undelegateEvents","selectionAllowed","allowed","leftButtonSelection","left","right","multiple","selectValue","selectRange","deselectValue","onGlobalMouseup","onGlobalMousemove","getDisabled","itemData","_getDomItemData","currentTarget","_singleSelect","selectionChanged","_triggerSelectionChanged","_triggerDblclicked","getItemByEvent","eventType","buttonType","mouseDownPos","_getMousePos","_multiSelect","_allowMouseMoveSelection","_stopAutoScroll","_mouseMoved","leftMouseButtonPressed","rightMouseButtonPressed","mousePosY","clientY","scrollInterval","setInterval","_autoScroll","removeClass","_selectItemByIndex","visibleRangeStart","visibleRangeEnd","$item","addClass","_deselectItemByIndex","newScrollPos","viewPortTop","shouldScroll","_selectRangeOnAutoScroll","oldScrollPos","clearInterval","shiftKey","ctrlKey","metaKey","getValue","modelItem","mousePos","abs","x","clientX","y","modelOptions","selectNone","setDisabled","remove","ListWithSelection","canActivate","ListWithNavigationModel","mouseMovePos","setCanActivate","getCanActivate","activateFirst","activateLast","activateNext","_getActiveIndex","activatePrevious","pageDown","pageUp","getActiveValue","activeIndex","ListWithNavigation","onMouseup","SearcheableDataProvider","indexMapping","internalGetData","deferred","criteria","dataCache","promise","_shouldFilter","_resolvePromise","reverseIndexMapping","_filterValues","getIndexMapping","getReverseIndexMapping","first","last","dataSegment","_getDataSegment","filteredData","j","$body","DropDownManager","$dropDownEl","dropDownEl","calcOffset","isOffsetChanged","_isOffsetChanged","recalcInterval","onOffsetChanged","startCalc","checkOffset","setNewOffset","recalcTimer","stopCalc","whereItNeedsToBe","currentOffset","position","bodyOffset","width","newDimensions","css","currentDimensions","bundle","Object","reduce","acc","keyboardManager","dropUpDirection","dropDownTemplate","processKeydown","listViewModel","_createListViewModel","listView","_createListView","dropDownManager","$dropDownElContainer","calcOffsetForListView","isDimensionsChangedForListView","collapse","SingleSelectList","el","listElement","searcheableDataProvider","_getGetData","_getActiveValueIndex","selectionChange","itemMouseup","listRenderError","changeExpandedState","changeValue","changeDisabled","changeFilter","onGlobalMousedown","singleSelect","isIPad","expanded","i18n","renderListView","$singleSelect","$searchBlock","$inputBlock","$input","listRendered","platform","$scalablelist","show","hide","preventBlur","focus","activeValue","unset","updateValueFromActive","onClickOnInput","expand","onFocus","onBlur","doExpand","doCollapse","updateControlLabel","removeAttr","onUpKey","onDownKey","onEnterKey","onEscKey","onHomeKey","onEndKey","onPageUpKey","onPageDownKey","onTabKey","updateDropDirection","scrollHeight","elHeight","searchBlockHeight","topHeight","bottomHeight","maxSize","expandListView","setValueToList","getBoundingClientRect","convertExternalValueToInternalFormat","internalValue","$inputBlockPlaceholder","$inputBlockSelection","getControlLabelByValue","html","xssUtil","_afterSelect","listPrototype","ListWithSelectionAsObjectHashModel","afterSelect","getSelectionIndex","SingleSelect","formatValue","SingleSelectListModelNew","_getSelectionIndex","classes","appendTo","alwaysClone","cloneHandlers","clone","$tmp","doCalcOnVisibleNodeCloneObject","doCalcOnVisibleNodeClone","_itemHeightSet","_calcItemHeight","_model","_lazy","_visibility","_display","BUTTON_TESTS","selector","strings","className","_debouncedOnResize","onResize","availableItemsTemplate","list","listTemplate","scalableListItemHeightCalculationTrait","activeChange","onRenderData","onListViewModelChanged","selectionClear","selectionAdd","selectionAddRange","selectionRemove","onChangeTotalValue","getModelForRendering","_tuneCSS","setBulkSelectionText","_paddingHeightsSet","searchBarHeight","round","buttonsContainerHeight","activeChangedWithShift","range","sx","sLen","onSelectAll","processSelectionThroughApi","onSelectNone","onInvertSelection","componentWidth","outerWidth","_componentWidth","$bulkButtonsBar","bulkButtonsBarWidth","isAvailableTabInActive","hasClass","$clone","buttonTest","widthOk","buttonString","$button","$buttonText","input","_onUpDownNavigation","activateItem","resetToInitialActiveItem","prevActive","onAKey","convertSelectionForListViewModel","focusStateChanged","selectedItemsList","onMouseupOnDeleteButton","onDeleteKey","emptySelection","CacheableDataProvider","setData","getAllCachedData","SelectedItemsDataProvider","sortFunc","_sortFunc","formatLabel","_formatLabel","_convertToStandardData","_sortData","item1","item2","localeCompare","sort","log","logger","sizerOptions","$container","minHeight","handles","s","resizable","updateMinMax","boundaries","maxHeight","debug","doCalcOnVisibleNodeCloneObj","numberUtils","NumberUtils","available","heightAutoAdjustment","availableItemsListModel","_createAvailableItemsListModel","availableItemsList","_createAvailableItemsList","selectedItemsDataProvider","_createSelectedItemsListDataProvider","_createSelectedItemsList","sizer","Sizer","AvailableItemsList","selectedListOptions","SelectedItemsList","_availableItemsTotalCountChange","selectionRemoved","detach","$toggleContainer","insertAfter","_updateAvailableItemsCountLabel","_updateSelectedItemsCountLabel","_renderSizer","_handleHeight","_cssDepententSizesSet","toggleContainerHeight","_tuneCSSInternal","_emptyContainerHeight","_calcHeightByItemsCount","toggleLists","evt","toggleClass","selectionChangeTimeout","selectionChangeInternal","seletedIndex","currentRawSelection","selectedLength","triggerSelectionChange","_setToggleLabel","count","labelText","formatNumber","currentHeight","_updateSizerVisibility","$noSelection","specialValue","InputControlsDataProvider","additionalParams","serviceOptions","getInputControlsPaginatedValues","controlData","totalCount","InputControlsDataProviderWithDataLabelHash","inputControlsDataProvider","dataLabelHash","controlOptions","name","getInitialSelectedValuesToLabelMap","memo","selectedValue","changeDateFunc","dateText","prevSelection","getNormalizedDatetimeValue","rawValue","toUpperCase","Bool","SingleValueText","ControlsBase","inputValue","SingleValueNumber","SingleValueDate","setupCalendar","localizedDate","dateUtil","picker","DateAndTimePicker","showOn","dateFormat","onSelect","change","after","wrap","SingleValueDatetime","getInput","destroyCalendar","timeFormat","localizedDateTime","SingleValueTime","onClose","localizedTime","initialOptions","inputControlsDataProviderWithDataLabelHash","dataProviderWithCache","DataProviderWithSearchCache","pageSize","maxSearchCacheSize","saveLastCriteria","request","getInputControlsDataProviderNewPageOptions","assign","dfd","initialSelectedValuesToLabelMap","getLabelByValue","makeResizable","updateSelectionOnOptionChange","xhr","showErrorPopup","responseJSON","clear","MultiSelect","multiSelect","selectedItemsDataProviderSorterFactory","_resize","debounce","$sizer","SingleSelectRadio","_fetchData","_renderData","getOptionName","uuid","uniqueId","setInnerHtml","clientHeight","MultiSelectCheckbox","boxes","box","checked","InputControlsService","jrsConfigs","Accept","inputControlIds","ip","c","reportParameter","getCacheKey","params","concat","InputControlsServiceWithCache","getInputControlsSelectedValues","getInputControlsMetadata","getInputControlsValues","getInputControlsOnlySelectedValue","cacheKey","cacheValue","metadata","InputControlTypeEnum","omitLimit","controlSpecificOptionsMap","addControlSpecificOptions","queryControls","getControlPaginationOptionsByControlIdAndType","getPaginatedValuesOptionsForQueryControls","controlsMap","mapper","isQueryControl","newMemo","getControlsPaginationOptionsByControlId","InputControlsReportViewerService","allRequestParameters","inputControlsToViewModelConverter","fetchInitialInputControlsValuesByUriAndStructure","preSelectedData","structureMemo","paginationOptions","paginationOptionsPerControl","fetchInputControlsOptionsByPaginatedValuesOptionsAndUri","controlsWithValueOrDefaultSelection","controlMemo","additionalOptions","masterDependencies","getControlsPaginationOptionsByControlIdOnSelectionChange","newSelection","selectedOnlyOptions","newInitialValuesPromise","selectionPerControl","ICStateMemo","preSelectionData","fetchLabelOfControls","fetchKeysOfParams","requestedSelectionParams","getControlIdInRequestParams","fetchRequestParamsThroughURL","initialPaginatedValuesOptions","initialPaginatedValuesPromise","selectedValuesPromise","paginatedValuesResponse","selectedValuesResponse","paginatedValues","selectedMemo","setCacheValueForControlPaginatedValues","optionsForValues","stateMemo","clearCache","controlPaginationOptions","validatePaginatedValuesResponse","controlsData","areControlsValid","Controller","inputControlsReportViewerService","_onViewModelSelectionChange","_onReportOptionsSelectionChanged","getController","CustomEvent","detail","dispatchEvent","selectionChangedControlId","inCascade","fetchInputControlsValuesOnControlSelectionChange","promises","when","reportOption","previousReportOption","fetchInitialInputControlsValuesByUri","controlPaginatedOptions","reportOptions","reportOptionUri","fetchAndSetInputControlsState","fetchInputControlsInitialState","resetControlsToSelection","fetchInputControlsOptionsBySelectionAndUri","validate","console","errorMessage","baseErrorHandler","ajaxAgent","body","errorHandler","showMessageDialog","SCHEDULER_BACK_URL_STORAGE_NAME","schedulerConstants","getParamsFromUri","parts","search","substr","split","part","tmp","decodeURIComponent","hash","hashParts","shift","saveCurrentLocation","referrer","localStorage","setItem","encodeURIComponent","getBackToPreviousLocation","currentUrl","href","lastUrl","getItem","redirectToUrl","config","_scheduleDashboard","paramsMap","schedulerPage","_onWindowResize","link","encodeParams","_serializeParams","Url","bannerHeight","_addDimmer","encode","substring","_ParamMapping","_closeScheduleOverlay","slideUp","getElementsByClassName","getElementById","$dimmer","resizeTimer","_detachEvents","Dialog","confirmDialogTemplate","modal","additionalCssClasses","title","content","buttons","yesLabel","action","primary","noLabel","close","setContent","scrollbarWidth","getScrollbarWidth","scrollDiv","createElement","style","overflow","appendChild","offsetWidth","clientWidth","hasScrollBar","direction","isScrollable","getComputedStyle","currentStyle","overflowX","overflowY","getElementOffset","offsetParent","offsetLeft","offsetTop","getMargins","$element","isNaN","getPaddings","disableBackForwordCache","onpageshow","persisted","reload","DATE_TIME_DEFAULTS","stepHour","stepMinute","stepSecond","showSecond","changeMonth","changeYear","showButtonPanel","onChangeMonthYear","constrainInput","TIME_DEFAULTS","warn","pickerOptions","inline","skipMoving","pickerType","discoverPickerType","provideDefaultPickerOptions","fixPopupPositionAndStyling","_callPickerAction","getDate","setDate","date","stopListening","setDefaults","configs","locale","time","Helpers","movePickerRelativelyToTriggerIcon","stylePopupContainer","originalBeforeShowFn","beforeShow","afterInject","inst","parseFloat","dpDiv","move","marginLeft","$dpDiv","$popupContainer","$parent"],"mappings":"oGA4BWA,EAAKC,EAAGC,EACXC,E,oFADGH,EA+DTI,cA/DcH,EA+DAA,IA/DGC,EA+DAE,cA9DXD,EAAgBD,EAASG,KAAKC,OAAO,CAErCC,kBAAmB,SAAUC,GACzB,IAAKA,EACD,OAAOA,EAEX,IAAIC,EAAmBR,EAAES,IAAIF,EAASG,cAAc,SAAUC,GAG1D,OAFAA,EAAIC,SAAmC,QAAxBC,OAAOF,EAAIC,UAC1BD,EAAIG,IAAMH,EAAIG,IAAIC,QAAQ,QAAS,IAC5BJ,KAEPK,EAAQhB,EAAES,IAAID,GAAkB,SAAUS,GAC1C,OAAOA,EAAiBD,SAM5B,OAJAA,EAAQhB,EAAEkB,QAAQF,GAClBhB,EAAEmB,KAAKX,GAAkB,SAAUY,UACxBA,EAAS,SAEbpB,EAAEK,OAAO,CAAEe,UAAWZ,GAAoBa,KAAKC,+BAA+BN,KAGzFM,+BAAgC,SAAUC,GACtC,IAAIC,EAAS,GACTC,EAAgBF,EAASG,kBAAoBH,EAASG,kBAAoBH,EAC1EI,EAAoB,SAAUC,GAC9B,IAAIC,EAAM,CACNC,MAAOF,EAAOE,MACdC,MAAOH,EAAOG,OAKlB,MAH+B,QAA3BlB,OAAOe,EAAOI,YACdH,EAAIG,UAAW,GAEZH,GAWPI,EAAkB,SAAUC,GAC5B,OAAKlC,EAAEmC,YAAYD,EAAaJ,QAAW9B,EAAEoC,OAAOF,EAAaJ,QAVlCO,EAaLH,EAAaG,QAXnCrC,EAAEsC,QAAQD,GACDrC,EAAES,IAAI4B,EAASV,GAEf,IAMFO,EAAaJ,MAXH,IAAUO,GAuBnC,OARArC,EAAEmB,KAAKM,GAAe,SAAUS,GACxBA,GAAgBA,EAAapB,MAC7BU,EAAOU,EAAaK,IAAM,CACtBC,MAAOxC,EAAEmC,YAAYD,EAAaM,OAAS,KAAON,EAAaM,MAC/DC,OAAQR,EAAgBC,QAI7B,CAAElB,MAAOQ,MAGxBzB,EAAIG,cAAgBA,EAITC,KAAf,SCvDAA,cAAgB,SAAUuC,EAAMC,EAAQ3C,EAAGC,GAmBvC,SAAS2C,EAAmBC,GACxB,IAAIC,EACJ,IACI,IACIA,EAAcJ,EAAKK,MAAMF,EAAIG,cAC/B,MAAOC,IAET,GAAIH,GAAeA,EAAYN,MAC3BxC,EAAEmB,KAAK2B,EAAYN,OAAO,SAAUA,GAEhC,IAAIU,EAAYjD,EAASkD,eACrBC,EAAaZ,EAAMa,gBAAgBtC,QAAQ,QAAS,IACpDuC,EAAUJ,EAAUK,KAAK,CAACzC,IAAIsC,IAC9BZ,EAAMgB,UACNF,EAAQG,IAAI,CAACjB,MAAMA,EAAMgB,YAClBhB,EAAMkB,gBACbJ,EAAQG,IAAI,CAACjB,MAAMA,EAAMkB,yBAIjC,GAAIb,EAAIc,kBAAkB,mBAAoC,MAAfd,EAAIe,OAC/CC,SAASC,SAAWC,oBACjB,GAAI,CAAC,IAAK,KAAKC,QAAQnB,EAAIe,SAAW,GAAMf,EAAIc,kBAAkB,uBACjEd,EAAIc,kBAAkB,iBAAmB,CAE7C,IAAIM,EAAU,GACd,GAAInB,EAAa,CACb,IAAIoB,EAAqBpB,EAAYmB,SAAW,gBAChD,GAAInB,EAAYqB,YAAcrB,EAAYqB,WAAWC,OAAS,EAE1DH,EADejE,EAAEqE,SAAS,+IAChBA,CAAS,CACfJ,QAASC,EACTC,WAAYrB,EAAYqB,kBAG5BF,EAAUC,OAGdD,EAAUK,OAAOC,WAGrBC,oBAAwBP,IAGlC,MAAOhB,KAOb,OAAOjD,EAAEK,OAAOJ,EAAU,CAGtBwE,aAAaxE,EAASG,KAAKC,OAAO,CAC9BqE,gCAAgCX,gBAA6B,+DAE7DY,qCAAqCZ,gBAA6B,sDAElEa,6BAA6Bb,gBAA6B,sEAE1Dc,YAAc,SAASxC,GACnBhB,KAAKyD,cAAgBzC,EAAQyC,cAC7BzD,KAAK0D,WAAW1C,IAGpB0C,WAAa,SAAS1C,KAEtB2C,aAAa,SAAUC,GACnB5D,KAAK6D,iBAAmBD,GAE5BE,SAAW,SAASC,EAAYC,EAAYC,GAGxC,OAFAD,EAAarF,EAAEsC,QAAQ+C,GAAcA,EAAWE,KAAK,KAAOF,GAAc,GAEnEpF,EAASuF,eAAeC,UAAUH,EAAa,CAClDL,UAAWG,EACXC,WAAYA,KAWpBK,YAAc,SAASC,EAAKC,EAAMC,GAC9B,IAAIC,EAAkB,CAClBH,IAAMA,EACNI,KAAO,MACPC,SAAW,OACXC,OAAQ,GAEPjG,EAAEkG,QAAQN,IACX5F,EAAEK,OAAOyF,EAAiB,CACtBC,KAAO,OACPI,aAAc,EACdP,KAAOlD,EAAK0D,UAAUR,GACtBS,YAAc,qBAItB,IAAIC,EAAkBtG,EAAEuG,SAASV,GAAY,GAAIC,GAiBjD,OAhBAQ,EAAgBE,UAAYF,EAAgBE,QAAU,IAEtDxG,EAAEuG,SAASD,EAAgBE,QAAS,CAMhC,mBAAqB,OAKrB,kBAAmBzC,uBAAkC,KAAM,OAGxDpB,EAAO8D,KAAKH,GACdI,KAAK9D,IAGd+D,uBAAuB,SAAUC,EAAMC,GACnC,IAAIlB,EAAMtE,KAAK8D,SAAS9D,KAAK6D,iBAAkB0B,EAAMvF,KAAKqD,iCAEtDoC,EAAoBzF,KAAKqE,YAAYC,EAAKkB,GAAcE,KAAK/G,EAAEgH,KAAK3F,KAAKyD,cAAcxE,kBAAmBe,KAAKyD,gBAGnH,OADA7E,EAASgH,MAAMC,oBAAoBJ,EAAmB,MAAM,GACpDA,GAGZK,wBAAyB,SAASC,EAAkBtG,GAChD,IAAI6E,EAAMtE,KAAK8D,SAASrE,GAAOO,KAAK6D,iBAAkB,KAAM7D,KAAKqD,iCAEjE,OAAOrD,KAAKqE,YAAYC,EAAKyB,EAAkB,CAACrB,KAAO,QAAQgB,KAAK/G,EAAEgH,KAAK3F,KAAKyD,cAAcxE,kBAAmBe,KAAKyD,iBAG1HuC,0BAA0B,SAAUpC,EAAW4B,GAC3C,IAAIlB,EAAMtE,KAAK8D,SAASF,EAAW,KAAM5D,KAAKsD,sCAE1C2C,EAAwBjG,KAAKqE,YAAYC,EAAKkB,GAC9CE,KAAK1F,KAAKyD,cAAcxD,gCAG5B,OADArB,EAASgH,MAAMC,oBAAoBI,EAAuB,MAAM,GACzDA,GAGXC,2BAA2B,SAAUC,EAAKX,GACtC,IAAIlB,EAAMtE,KAAK8D,SAAS9D,KAAK6D,iBAAkBsC,EAAKnG,KAAKuD,8BACrDE,EAAgBzD,KAAKyD,cACrBzD,KAAKoG,oBAAyD,WAAnCpG,KAAKoG,mBAAmBzG,SACnDK,KAAKoG,mBAAmBC,SAG5B,IAAID,EAAqB,IAAI9E,EAAOgF,SAEhCC,EAAyB3H,EAASgH,MAAMY,KAAK5H,EAASwE,aAAaqD,4BAuBvE,OArBAF,EAAuBG,KAAK/H,EAAEgH,MAAK,WAC/B3F,KAAKqE,YAAYC,EAAKkB,GAClBE,KAAKjC,EAAcxD,gCAAgCyG,MAC/C,SAAUnC,GAC4B,WAA9B6B,EAAmBzG,SACnByG,EAAmBO,QAAQpC,MAGvCc,MAAK,WACDe,EAAmBC,OAAOrG,KAAM4G,gBAEzC5G,OAEHoG,EAAmBf,MAAK,WACpBkB,EAAuBF,YAG3BzH,EAASgH,MAAMC,oBAAoBO,EAAoB,MAAM,GAE7DpG,KAAKoG,mBAAqBA,EAEnBA,IAGZ,CAIC/C,gCAAgCX,gBAA6B,+DAE7DY,qCAAqCZ,gBAA6B,sDAElEa,6BAA6Bb,gBAA6B,sEAE1D+D,2BAA6B,QArNzB,CA0NZpF,KACAC,IACA3C,IACAG,eAGWA,KAAf,S,oPCzOAA,cAAe,SAAUwC,EAAQ3C,EAAGC,GA+BhC,OAAOD,EAAEK,OAAOJ,EAAU,CAEtBiI,YAAajI,EAASG,KAAKC,OAAO,CAE9BkC,GAAI,KAEJ4F,KAAM,KAIN3F,MAAO,KAEP4F,eAAgB,GAChBvD,YAAa,SAAUwD,GACnBhH,KAAK0D,WAAWuD,MAAMjH,KAAM4G,YAGhCM,QAAS,WACL,OAAOlH,KAAK8G,MAGhBK,QAAS,SAAUC,GACfpH,KAAK8G,KAAOM,GAGhBC,yBAA0B,aAE1BC,eAAgB,WACZ,OAAQ3I,EAAEsC,QAAQjB,KAAKuH,IAAI,eAE/BC,cAAe,WACX,OAAQ7I,EAAEsC,QAAQjB,KAAKuH,IAAI,YAG/BE,mBAAoB,SAAUC,GAI1B,OAHK1H,KAAK+G,eAAe/G,KAAK0E,KAAO,IAAMgD,KACvC1H,KAAK+G,eAAe/G,KAAK0E,KAAO,IAAMgD,GAAW9I,EAASuF,eAAewD,sBAAsBD,EAAS1H,KAAK0E,OAE1G1E,KAAK+G,eAAe/G,KAAK0E,KAAO,IAAMgD,IAEjDhE,WAAY,WACR1D,KAAK4H,WAAL,MAAA5H,KAAA,WACAA,KAAK6H,UAAL,MAAA7H,KAAA,YAA2BA,KAAKqH,4BAEpCS,gCAAiC,SAAUC,GAEvCzG,EAAOkB,UAAUwF,QAAQpJ,EAASqJ,eAAgB,CAC9ChG,QAASjC,KACT+H,eAIRH,WAAY,SAAUhI,GAClBA,GAAoBjB,EAAEK,OAAOgB,KAAMJ,GACnC,IAAIoD,EAAWpE,EAASuF,eAAe+D,eAAelI,KAAK0E,MAC3D,GAAI1B,EAAU,CACV,IAAIoE,EAAU9F,EAAO0B,EAAShD,OAC9BA,KAAKmH,QAAQC,KAIrBe,SAAU,SAAUC,KAEpBC,MAAO,SAASrH,KAEhBsH,YAAa,aAEbC,OAAQ,aAERhB,IAAK,SAAUiB,GACX,OAAOxI,KAAKwI,IAGhBC,QAAS,WACL,OAAsB,OAAfzI,KAAKmB,OAAkBnB,KAAKmB,OAASnB,KAAKmB,iBAAiB3B,QAAgC,IAAtBQ,KAAKmB,MAAM4B,QAI3F8E,UAAW,SAAUb,GACjB,OAAQA,QAAyB0B,IAAjB1B,EAAK2B,UAA0C,IAAjB3B,EAAK2B,SAGvDC,qBAAsB,WAClB,IAAIhG,EAAwB,MAAd5C,KAAKmB,MAAgBnB,KAAKmB,MAAQ,GAChDnB,KAAKkH,WAAalH,KAAKkH,UAAUhF,KAAK,YAAY2G,KAAKjG,IAG3DkG,MAAO,SAAS9H,GACZhB,KAAKoC,IAAIpB,GAET,IAAMI,EAASpB,KAAKuH,IAAI,UAEpBvH,KAAK6H,UAAU7H,YAA2B,IAAXoB,GAC/BpB,KAAKmI,SAAS/G,IAItBgB,IAAK,SAAU2G,EAAYC,GAGvB,GAFArK,EAAEK,OAAOgB,KAAM+I,QAEWL,IAAtBK,EAAW3H,OAAsB,KACzBA,EAAW2H,EAAX3H,OAERpB,KAAK6H,UAAU7H,OAASA,KAAKmI,SAAS/G,GAElCpB,KAAKwH,gBACLxH,KAAA,UAAoBoB,EAEhBpB,KAAKsH,iBACLtH,KAAA,UAAoBoB,EAAO,GAE3BpB,KAAA,UAAoBoB,EAYhC,QARgCsH,IAA5BK,EAAU,YACN/I,KAAKwH,kBACLxH,KAAA,OAAiB+I,EAAU,YAE9BC,GAAuBhJ,KAAK8H,gCACzBiB,EAAU,iBAGaL,IAA3BK,EAAU,WAA+B/I,KAAKuH,IAAI,YAAa,CAC/D,IAAI0B,EAAWF,EAAU,SACpBC,IACDC,EAAWjJ,KAAKkJ,UAAYlJ,KAAKmJ,eAGbT,IAAxBK,EAAU,QACV/I,KAAK4I,uBACD5I,KAAKoJ,gBAAmCV,IAAtB1I,KAAA,YAClBA,KAAA,UAAoB,MAIhCkC,KAAM,SAAU6G,GACZ,QAAmBL,IAAfK,GAA4BA,GAAmC,UAArB,EAAOA,GAAwB,CACzE,IAAIM,EAAM1K,EAAE2K,KAAKP,GAAY,GACzBtI,EAAQ9B,EAAEyC,OAAO2H,GAAY,GACjC,OAAOpK,EAAEuD,KAAKlC,KAAKuH,IAAI,WAAW,SAAUgC,GACxC,OAAOA,EAAIF,KAAS5I,OAIhC0I,OAAQ,WACJnJ,KAAKkH,UAAUhF,KAAK,SAASsH,KAAK,YAAY,GAC9CxJ,KAAKkH,UAAUhF,KAAK,UAAUsH,KAAK,YAAY,IAEnDN,QAAS,WACLlJ,KAAKkH,UAAUhF,KAAK,SAASsH,KAAK,YAAY,GAC9CxJ,KAAKkH,UAAUhF,KAAK,UAAUsH,KAAK,YAAY,KAEpD,CAECC,MAAO,SAAUrI,EAAQsI,GACrB,OAAI/K,EAAEoC,OAAOK,IAAWzC,EAAEmC,YAAYM,GAC3BsI,EAEP/K,EAAEoC,OAAO2I,IAAe/K,EAAEmC,YAAY4I,GAC/BtI,EAEPzC,EAAEsC,QAAQyI,GACH/K,EAAES,IAAIgC,GAAQ,SAAUb,GAS3B,YALsBmI,IAHF/J,EAAEuD,KAAKwH,GAAY,SAAU3B,GAC7C,OAAOA,IAAcxH,EAAOE,SAG5BF,EAAOI,UAAW,SAEXJ,EAAOI,SAEXJ,KAGJP,KAAKyJ,MAAMrI,EAAQ,CAACsI,OAIvCzB,eAAgB,oBAlNT,CAoNb3G,IAAQ3C,IAAGG,eAEEA,KAAf,S,ICnPK6K,E,mBAAAA,K,iCAAAA,E,wCAAAA,M,KAKL,UCiCA7K,cAAe,SAAUwC,EAAQ3C,EAAGC,GAehC,IAKQgL,EADAC,EAJJC,EAAOC,WAGPC,GACIH,GAAgB,IAAII,MAAQC,UAGzB,WACH,IAAIC,GAAO,IAAIF,MAAQC,UACnBE,EAAOpK,KAEPmK,EAAMN,EAAe,MACrBA,EAAeM,EAEf7I,EAAOtB,MAAMgI,QAAQ,gBAGzBqC,aAAaT,GAEbA,EAAgBU,YAAW,WACvBhJ,EAAO8I,GAAMpC,QAAQ,gBACtB,OAKPuC,EAAY3L,EAASG,KAAKC,OAAO,CAEjCwE,YAAY,SAAUwD,GAClBhH,KAAKwK,kBAAqBxD,GAAQA,EAAKwD,mBAAsB5L,EAAS2L,UAAUE,kBAChFzK,KAAK0K,SAAW,GAGhB9L,EAASkD,aAAenD,EAAEgH,MAAK,WAC3B,OAAO3F,OACRA,MAEHrB,EAAEgM,QAAQ3K,KACN,iBACA,mBAGJA,KAAK4K,kBAGTA,eAAiB,WACbhM,EAASiM,OAAO,kBAAmB7K,KAAK8K,iBACxClM,EAASmM,OAAO,CACZ,kBAAkB/K,KAAK8K,mBAK/BA,gBAAgB,SAAUE,EAAOhK,GAAS,IAElCiB,EAEAjB,EAFAiB,QACA8F,EACA/G,EADA+G,UAGEkD,EChHlB,SACIhJ,GAKC,IAGGiJ,EAEAjJ,EAFAiJ,kBAQJ,QAH6BA,GAAoBA,EAAkBnI,OAAS,EDkG3CoI,CAAmBlJ,GAE5CX,EAAOkB,UAAUwF,QAAQpJ,EAAS2L,UAAUa,iBAAkB,CAC1DnJ,EAAQf,GACR6G,EACAkD,IAGCA,GAED3J,EAAOkB,UAAUwF,QAAQpJ,EAAS2L,UAAUc,cAAe,CAACrL,KAAKL,UAG1E,CAEC8K,kBAAmB,0BACnBY,cAAe,2BACfD,iBAAkB,8BAClBE,aAAc,0BAEdC,mBAAoB,SAAUC,EAAUC,GACpC,IAAIC,EAAqBF,EAAW7M,EAAE6M,GAAUlC,OAAS,GACrDqC,EAAiBF,EAAO9M,EAAE8M,GAAMnC,OAAS,GAE7C,GADsB3K,EAAEiN,MAAMF,EAAoBC,GAC9B5I,SAAW2I,EAAmB3I,OAAQ,CACtD,IAAI8I,EAAwBL,EAAW7M,EAAEmN,QAAQnN,EAAE6M,GAAUpK,UAAY,GACrE2K,EAAoBN,EAAO9M,EAAEmN,QAAQnN,EAAE8M,GAAMrK,UAAY,GAC7D,OAAOzC,EAAEqN,WAAWH,EAAuBE,GAAmBhJ,OAAS,GAAKpE,EAAEqN,WAAWD,EAAmBF,GAAuB9I,OAAS,EAEhJ,OAAO,KAIXkJ,EAAQ,CAGRC,YAAa,WACT,OAAOlM,KAAK0K,UAIhByB,YAAa,SAAU1G,EAAmBzE,GAAS,WAC/ChB,KAAK0K,SAAW,GAD+B,IAI3C0B,EAIApL,EAJAoL,QACAC,EAGArL,EAHAqL,qBACAC,EAEAtL,EAFAsL,sBACAC,EACAvL,EADAuL,uBAGJ9G,EAAkB+G,SAAQ,SAAC5M,GACvB,IAAM6M,EAAY7M,EAAiBsB,GAEnC,EAAKwL,cAAc9M,EAAiB,CAChCwM,UACAC,uBACAC,sBAAuBA,EAAsBG,IAAc,GAC3DF,uBAAwBA,EAAuBE,IAAc,SAMzEC,cAAe,SAAU9M,EAAkBoB,GAEvC,IAAI2L,EAAU,SAAUjI,GACpB,IAAK,IAAIkI,KAAYhO,EACjB,GAAI8F,EAAKmI,gBAAkBD,EAASC,cAChC,OAAOjO,EAASgO,GAHd,CAMZhN,EAAiB8E,MAEnB,IAAIiI,EAGA,MAAM,IAAIG,MAAM,oDAAsDlN,EAAiB8E,MAE3F,OAJI1E,KAAK0K,SAAS9K,EAAiBsB,IAAM,IAAIyL,EAAQ/M,EAAkBoB,GAIhEhB,KAAK0K,SAAS9K,EAAiBsB,KAI1C6L,cAAe,SAAUN,UACdzM,KAAK0K,SAAS+B,IAIzBO,eAAgB,SAAUC,EAAUC,GAChC,GAA6B,GAAzBlN,KAAKD,UAAUgD,OAAnB,CASA,IAJA,IAGIoK,EAHAC,EAAiBH,EAAWC,EAAW,GAAK,EAC5CG,EAAQJ,EAAWC,EAAWI,KAAKC,IAAIN,EAAUC,GAAYI,KAAKE,IAAIP,EAAUC,GAChFO,EAAMR,EAAWC,EAAWI,KAAKE,IAAIP,EAAUC,GAAYI,KAAKC,IAAIN,EAAUC,GAEzEQ,EAAIL,EAAOK,GAAKD,EAAKC,GAAQN,EAClCD,EAAInN,KAAKD,UAAU2N,GACnB1N,KAAKD,UAAU2N,GAAK1N,KAAKD,UAAU2N,EAAIN,GACvCpN,KAAKD,UAAU2N,EAAIN,GAAkBD,EAEzC7L,EAAOkB,UAAUwF,QAAQpJ,EAAS2L,UAAUe,aAAc,CAACtL,KAAKD,cAIpEqC,IAAK,SAAU2G,EAAYC,GACvB,GAAID,EAAY,CACZpK,EAAEK,OAAOgB,KAAM+I,GADH,IAIRhJ,EACAgJ,EADAhJ,UAIAuM,GACAvD,EAAW4E,iBAAmB,IAD9BrB,sBAGAvM,IACAC,KAAKmM,YAAYpM,EAAWgJ,EAAW4E,iBACvC3N,KAAK4N,KAAK7N,IAGVuM,IACAtM,KAAK6N,OAAOvB,IAEXtD,GAAuB1H,EAAOkB,UAC1BwF,QAAQpJ,EAAS2L,UAAUc,cAAeiB,MAI3D/E,IAAK,SAAUiB,GACX,GAAKA,EAAL,CAGA,GAAkB,cAAdA,EAA2B,CAC3B,IAAIrI,EAAS,GAab,OAZAxB,EAAEmB,KAAKE,KAAKkM,eAAe,SAAUjK,GACjC,IAAIuD,EAAevD,EAAQsF,IAAI,aAI3B/B,aAAwBsI,MACxB3N,EAAO8B,EAAQf,IAAMf,EAAO8B,EAAQf,IAAMsE,EAAazC,OAAS,EAAIyC,EAAevD,EAAQmH,UAAY,GAAK,CAACO,8BACrGhL,EAAEmC,YAAY0E,KACtBrF,EAAO8B,EAAQf,IAAM,CAACsE,OAIvBrF,EAEX,OAAOH,KAAKwI,KAGhBuF,YAAa,SAAUvF,GACnB,IAAIa,EAAM1K,EAAE2K,KAAKd,GAAW,GACxB/H,EAAQ9B,EAAEyC,OAAOoH,GAAW,GAChC,OAAO7J,EAAEuD,KAAKlC,KAAKkM,eAAe,SAAUjK,GACxC,OAAOA,EAAQoH,KAAS5I,MAKhCuN,MAAO,SAAUpB,GACb,OAAOjO,EAAEqP,MAAMhO,KAAKkM,cAAeU,KAIvCqB,EAAO,CAEPL,KAAM,SAAUM,GAAe,WACrBC,EAAYnO,KAAKoO,eAqBvB,GAnBAD,EAAUE,QAENvE,IAGAqE,EAAUG,KAAK,YAAa,SAC5BH,EAAUG,KAAK,aAAc,SAGjCJ,EAAc1B,SAAQ,SAAC+B,GACnB,GAAIA,EAAY5F,QAAS,CACrB,IAAM1G,EAAU,EAAK8L,YAAY,CAAE7M,GAAIqN,EAAYrN,KAEnDe,EAAQsG,SAER4F,EAAUK,OAAOvM,EAAQiF,eAI7BjE,OAAOwL,QAAUxL,OAAOwL,OAAOC,iBAAkB,CACjD,IAAMC,EAAmB1L,OAAOrE,SAASgQ,QAAQC,qBAAuBJ,OAAOK,qBAE1E,6CAA6CC,KAAKC,UAAUC,YAC7DjP,KAAKkP,cAAc,CACff,UAAWA,EACXQ,iBAAkBA,MAOlCd,OAAQ,SAAUvB,GAAuB,WACrC3N,EAAEmB,KAAKwM,GAAuB,SAAC6C,EAAkB1C,GAC7B,EAAKsB,YAAY,CAAE7M,GAAIuL,IAE/BrK,IAAI,CACRhB,OAAQ0M,MAAM7M,QAAQkO,GAAoBA,EAAiB/P,KAAI,SAAAmB,GAAM,OAAIA,EAAOE,SAAS0O,EACzFhO,MAAO,WAOnBiN,aAAc,WACV,OAAIpO,KAAKmO,WAAsC,GAAzBnO,KAAKmO,UAAUpL,SAGjC/C,KAAKmO,UAAY7M,EAAOtB,KAAKwK,oBAFtBxK,KAAKmO,WAQpBiB,yBAA0B,WACtBzQ,EAAEmB,KAAKE,KAAKkM,eAAe,SAAUjK,GACjCA,EAAQG,IAAI,CAAEjB,MAAO,WAK7BkO,oBAAqB,WACjB,OAAO1Q,EAAEkG,QAAQlG,EAAE2Q,OAAOtP,KAAKkM,eAAe,SAAUjK,GACpD,OAAQA,EAAQwG,eAIxB8G,aAAc,SAAU/E,GACpBxK,KAAKmO,UAAY7M,EAAOkJ,IAI5BgF,gBAAiB,WAEb,OADAxP,KAAKmO,UAAY7M,EAAOtB,KAAKwK,mBACtBxK,KAAKmO,WAIhBjF,QAAS,WACLvK,EAAEmB,KAAKE,KAAKkM,eAAe,SAAUjK,GACjCA,EAAQG,IAAI,CAAE6G,UAAU,QAKhCE,OAAQ,WACJxK,EAAEmB,KAAKE,KAAKkM,eAAe,SAAUjK,GACjCA,EAAQG,IAAI,CAAE6G,UAAU,QAIhCiG,cAAe,SAASlO,GACpB,IAAImN,EAAYnN,EAAQmN,UACpBQ,EAAmB3N,EAAQ2N,iBAC3Bc,GAAoB,EAEpBrF,EAAOpK,KAEP0P,EAAoBpO,EAAO6M,GAAWwB,SAAS,CAC/CC,MAAO,IACPC,YAAalB,EAAmB,sBAAwB,wBACxDmB,KAAMnB,EAAmB,IAAM,IAC/BoB,MAAO,UACPC,OAAQ,gEACR3C,MAAO,SAASrC,EAAOiF,GACnBA,EAAGC,KAAK3L,KAAK,WAAY0L,EAAGC,KAAKC,SACjCV,GAAoB,GAExBW,KAAMzR,EAAEgH,MAAK,SAASqF,EAAOiF,GACzB,IAAIhD,EAAWgD,EAAGC,KAAK3L,KAAK,YACxB2I,EAAW+C,EAAGC,KAAKC,QACvBlD,GAAYC,GAAYlN,KAAKgN,eAAeC,EAAUC,GACtDuC,GAAoB,IACrBzP,QAIP,GAAI8J,EAAM,CACN,IAAIuG,EAASrP,EAAQqP,QAAUX,EAAkBW,SAEjDA,EAAOC,IAAI,SAAUtG,GACrBqG,EAAOC,IAAI,eACXD,EAAOC,IAAI,cAEXD,EAAOE,GAAG,SAAUvG,GAEpBqG,EAAOE,GAAG,eAAe,WACrB,IAAKd,EACD,IACIC,EAAkBC,SAAS,WAC7B,MAAO/N,QAIjByO,EAAOE,GAAG,cAAc,YACnBd,GAAqBrF,EAAK8E,cAAc,CACrCmB,OAAQA,EACRlC,UAAWA,EACXQ,iBAAkBA,UAOtC,OADAhQ,EAAEK,OAAOuL,EAAUiG,UAAWvE,EAAOgC,GAC9BtP,EAAEK,OAAOJ,EAAU,CAAE2L,UAAWA,IA1Y5B,CA2YbjJ,IAAQ3C,IAAGG,eAEEA,KAAf,S,eE/WA,QA9CmC,CAC/B2R,SAAU,SAAUN,EAAOnP,GACvB,GAAqB,iBAAVmP,EAKX,GADAnP,EAAUA,GAAW,GACjBmP,GAASnQ,KAAKuH,IAAI,qBAAuB4I,GAASnQ,KAAKuH,IAAI,kBAAmB,CAC9E,IAAI2I,EAAOlQ,KAAKuH,IAAI,SAAS4I,EAAQnQ,KAAKuH,IAAI,qBAC1C2I,GACAlQ,KAAK0Q,UAAU/R,WAASqC,EAAS,CAC7BmP,MAAOA,EACPD,KAAMA,SAGX,CACH,IAAIS,EAAO3Q,KACXA,KAAK4Q,QAAQ,CACTC,OAAQV,EACRW,MAAO,IACRpK,MAAK,SAAUtF,GACduP,EAAKD,UAAU/R,WAASqC,EAAS,CAC7BmP,MAAOA,EACPD,KAAM9O,EAAOmD,KAAK,SAEvBc,KAAKrF,KAAK+Q,kBAtBb/Q,KAAK0Q,UAAU/R,WAAS,GAAIqC,KAyBpC0P,UAAW,SAAU1P,GACbhB,KAAKgR,QAAUhQ,EAAQmP,QAAUnQ,KAAKgR,OAAOb,OAASnP,EAAQkP,KAAKzP,QAAUT,KAAKgR,OAAOvQ,QAG7FT,KAAKgR,OAAShQ,GAAoC,iBAAlBA,EAAQmP,MAAqB,CACzDA,MAAOnP,EAAQmP,MACf1P,MAAOO,EAAQkP,KAAKzP,MACpBC,MAAOM,EAAQkP,KAAKxP,YACpBgI,EACC1H,GAAYA,EAAQiQ,SACrBjR,KAAKgI,QAAQ,UACbhI,KAAKgI,QAAQ,iBAAkBhI,KAAKgR,WAG5CE,UAAW,WACP,OAAOlR,KAAKgR,S,wBC1ChBG,EAAkB,SAAUnQ,GAE5B,OADAhB,KAAK0D,WAAW1C,GACThB,MAEXrB,WAASwS,EAAgBX,UAAW,CAChCY,eAAgB,CACZ,GACA,GACA,GACA,IAEJC,gBAAiB,CACb,GAAM,UACN,GAAM,YACN,GAAM,aACN,GAAM,WACN,GAAM,YACN,GAAM,WACN,EAAK,WACL,GAAM,cACN,GAAM,iBAEVC,uBAAuB,CACnB,GAAM,cACN,GAAM,iBAEV5N,WAAY,SAAU1C,GAClBrC,YAAUqB,KAAM,aACZgB,EAAQqQ,kBACRrR,KAAKqR,gBAAkBrQ,EAAQqQ,iBAEnCrR,KAAKuR,gBAAkBvQ,EAAQuQ,gBAC/BvR,KAAKwR,eAAiBxQ,EAAQwQ,gBAjCP,IAkCvBxR,KAAKyR,QAAUzQ,EAAQyQ,QACvBzR,KAAK0R,uBAAyB1Q,EAAQ0Q,uBACtC1R,KAAK2R,yBAA2B3Q,EAAQ2Q,yBACxC3R,KAAK4R,wBAA0B5Q,EAAQ4Q,yBAE3CC,UAAW,SAAU7G,GACbhL,KAAK8R,oBAAoB9G,KAElBhL,KAAK+R,mCAAmC/G,GAC/ChL,KAAKgS,gCAAgChH,GAErChL,KAAKiS,4BAA4BjH,GAEjChL,KAAKuR,iBACLvG,EAAMuG,oBAGdU,4BAA6B,SAAUjH,GAC/BhL,KAAK0R,yBACD1R,KAAKwR,eAAiB,GACtBnH,aAAarK,KAAKkS,iBAClBlS,KAAKkS,gBAAkB5H,WAAW3L,SAAOqB,KAAK0R,uBAAwB1R,KAAKyR,QAASzG,GAAQhL,KAAKwR,iBAEjGxR,KAAK0R,uBAAuBS,KAAKnS,KAAKyR,QAASzG,KAI3D8G,oBAAqB,SAAU9G,GAC3B,OAAOrM,YAAUqB,KAAKoR,eAAgBpG,EAAMoH,QAAU,GAE1DC,0BAA2B,SAAUrH,GACjC,OAAOhL,KAAK2R,0BAA4B3R,KAAK2R,yBAAyBQ,KAAKnS,KAAKyR,QAASzG,IAE7F+G,mCAAoC,SAAU/G,GAC1C,IAAIsH,EAAiBtS,KAAKqR,gBAAgB,GAAKrG,EAAMoH,OACrD,OAAOE,GAA0D,mBAAjCtS,KAAKyR,QAAQa,IAAkCtS,KAAKqS,0BAA0BrH,IAElHgH,gCAAiC,SAAUhH,GACvC,IAAIsH,EAAiBtS,KAAKqR,gBAAgB,GAAKrG,EAAMoH,OACjDE,GAA0D,mBAAjCtS,KAAKyR,QAAQa,IACtCtS,KAAKyR,QAAQa,GAAgBH,KAAKnS,KAAKyR,QAASzG,GAChDhL,KAAKuS,gCAAgCvH,IAC9BhL,KAAKqS,0BAA0BrH,IACtChL,KAAK4R,yBAA2B5R,KAAK4R,wBAAwBO,KAAKnS,KAAKyR,QAASzG,IAGxFuH,gCAAgC,SAASvH,GAClChL,KAAKsR,uBAAuB,GAAKtG,EAAMoH,QACtCpH,EAAMwH,oBAIlB,UCbA,QAtEwBC,iBAAsB,CAC1C/O,WAAY,SAAU1C,GAClBA,EAAUA,GAAW,GACrBrC,YAAUqB,KAAM,iBAAkB,cAAe,qBAAsB,SACvEA,KAAKoC,IAAI,CAAE2N,MAAO,IAAM,CAAEkB,QAAQ,IAClCjR,KAAK4Q,QAAU5P,EAAQ4P,QACvB5Q,KAAK0S,WAAa1R,EAAQ0R,YARR,IASlB1S,KAAK2S,WAAa3R,EAAQ2R,YARR,KAUtBC,eAAgB,SAAUxR,GACtBpB,KAAK+I,WAAW8J,MAAQzR,EAAOyR,MAC/B7S,KAAKoC,IAAI,CAAE2N,MAAO3O,EAAOmD,MAAQ,CAAE0M,QAAQ,IAC3CjR,KAAK+I,WAAW+J,eAAiBxF,KAAKE,IAAI,EAAGF,KAAKC,IAAIvN,KAAK+I,WAAWgK,iBAAmB/S,KAAK0S,WAAa,EAAG1S,KAAK+I,WAAWgK,iBAAmB3R,EAAOmD,KAAKxB,OAAS,IAClK/C,KAAK+I,WAAW+J,eAAiB9S,KAAK+I,WAAWgK,iBAAmB/S,KAAK0S,WAAa,IACtF1S,KAAK+I,WAAW8J,MAAQvF,KAAKC,IAAInM,EAAOyR,MAAO7S,KAAK+I,WAAW+J,eAAiB,IAEpF9S,KAAKgT,oBAAsBhT,KAAKgT,mBAAmB5R,EAAOmD,KAAMvE,KAAK+I,WAAW8J,OAChF7S,KAAKgI,QAAQ,SAAUhI,OAE3BiT,yBAA0B,SAAUC,EAAgBC,GAChD,QAA4C,IAAjCnT,KAAKuH,IAAI,0BAA6E,IAA/BvH,KAAKuH,IAAI,kBACvE,OAAO,EAEX,GAAI2L,GAAkB,GAAKA,EAAiBlT,KAAKuH,IAAI,qBAAuB4L,EAAoBnT,KAAKuH,IAAI,UAAY4L,EAAoBnT,KAAKuH,IAAI,kBAC9I,OAAO,EAEX,GAAI2L,IAAmBlT,KAAKuH,IAAI,qBAAuB4L,IAAsBnT,KAAKuH,IAAI,kBAClF,OAAO,EAEX,IAAI6L,EAAgB,GAAKF,EAAiBlT,KAAKuH,IAAI,qBAAuBvH,KAAK0S,WAC3EW,EAAmB,GAAKrT,KAAKuH,IAAI,kBAAoB4L,GAAqBnT,KAAK0S,WACnF,OAAO1S,KAAKuH,IAAI,oBAAsB,GAAK6L,GAAiBpT,KAAK2S,YAAc3S,KAAKuH,IAAI,kBAAoBvH,KAAKuH,IAAI,UAAY8L,GAAoBrT,KAAK2S,YAE9JK,mBAAoB,SAAUjD,EAAO8C,KAErC9B,YAAa,SAAUuC,EAAgBnS,GACnCnB,KAAKgI,QAAQ,cAAesL,EAAgBnS,IAEhDkH,MAAO,SAAUrH,GAKb,IAJAA,EAAUrC,WAAS,CACf4U,IAAKvT,KAAKuH,IAAI,qBAAuB,EACrCiM,OAAQxT,KAAKuH,IAAI,mBAAqBvH,KAAK0S,WAAa,GACzD1R,IACSyS,OAASzT,KAAKiT,yBAAyBjS,EAAQuS,IAAKvS,EAAQwS,QAAS,CAC7E,GAAIxS,EAAQuS,MAAQvT,KAAK+I,WAAWgK,kBAAoB/R,EAAQwS,SAAWxT,KAAK+I,WAAW+J,gBAAkB9R,EAAQyS,MAAO,CACxH,IAAIC,EAAe1S,EAAQuS,IAAMjG,KAAKqG,OAAO3S,EAAQwS,OAASxS,EAAQuS,KAAO,GACzEK,EAAatG,KAAKqG,MAAM3T,KAAK0S,WAAa,GAC9C1S,KAAK+I,WAAWgK,iBAAmBzF,KAAKE,IAAI,EAAGkG,EAAeE,GAC1D5T,KAAKuH,IAAI,WAAavG,EAAQyS,MAC9BzT,KAAK+I,WAAW+J,eAAiBxF,KAAKC,IAAIvN,KAAKuH,IAAI,SAAUvH,KAAK+I,WAAWgK,iBAAmB/S,KAAK0S,YAAc,EAEnH1S,KAAK+I,WAAW+J,eAAiB9S,KAAK+I,WAAWgK,iBAAmB/S,KAAK0S,WAAa,EAG9F1S,KAAK4Q,QAAQ,CACTC,OAAQ7Q,KAAKuH,IAAI,oBACjBuJ,MAAO9Q,KAAKuH,IAAI,kBAAoBvH,KAAKuH,IAAI,oBAAsB,IACpEb,KAAK1G,KAAK4S,gBAAgBvN,KAAKrF,KAAK+Q,kBAEvC/Q,KAAKgT,oBAAsBhT,KAAKgT,mBAAmBhT,KAAKuH,IAAI,SAAUvH,KAAKuH,IAAI,WAGvFuB,MAAO,SAAU9H,GACbhB,KAAK+I,WAAa,GAClB/I,KAAKoC,IAAI,CAAE2N,MAAO,IAAM,CAAEkB,QAAQ,IAC7BjQ,GAAYA,EAAQiQ,QACrBjR,KAAKgI,QAAQ,SAAUhI,SCiLnC,QAzNiC6T,SAE7B,CAEInQ,WAAY,SAAS1C,GACjB6S,4BAA4C7T,KAAMgB,GAElDhB,KAAK8T,OAAO9S,EAAQP,MAAO,CAACwQ,QAAQ,KASxC8C,gBAAiB,SAAStT,EAAO0P,GAC7B,KAAM,mBAOV6D,qBAAsB,SAASvT,EAAO0P,GAClC,KAAM,mBAOV8D,gBAAiB,WACb,KAAM,mBAOVC,mBAAoB,SAASzT,EAAO0P,GAChC,KAAM,mBAOVgE,cAAe,WACX,KAAM,mBAKVC,wBAAyB,SAASpT,GACzBA,GAAYA,EAAQiQ,QACrBjR,KAAKgI,QAAQ,UAGjBhI,KAAKgI,QAAQ,qBAGjBqM,qBAAsB,SAAS9P,EAAM+P,EAAYC,GAC7C,IAAK,IAAI7G,EAAI,EAAGA,EAAInJ,EAAKxB,OAAQ2K,IAC7B1N,KAAK+T,gBAAgBxP,EAAKmJ,GAAGjN,MAAOiN,EAAI4G,GAG5CtU,KAAKgI,QAAQ,qBAAsB,CAACqF,MAAOiH,EAAY7G,IAAK8G,EAAUxM,UAAW/H,KAAKwU,kBAG1FC,gCAAiC,SAASC,EAAiBC,GASvD,OARA3U,KAAK4Q,UAAUlK,MAAK,SAAStF,GACzB,IAAK,IAAIsM,EAAI,EAAGA,EAAItM,EAAOmD,KAAKxB,OAAQ2K,IACpCgH,EAAgBtT,EAAOmD,KAAKmJ,GAAGjN,MAAOiN,GAG1CiH,GAAUA,OACXtP,KAAKrF,KAAK+Q,aAEN/Q,MAUX4U,oBAAqB,SAASnU,EAAO0P,GAGjC,OAFAnQ,KAAK6U,oBAAsB1E,EAC3BnQ,KAAK+T,gBAAgBtT,EAAO0P,GACrBnQ,KAAKgI,QAAQ,gBAAiB,CAACvH,MAAOA,EAAO0P,MAAOA,KAM/D2E,oBAAqB,SAASrU,EAAO0P,GAGjC,QAAwC,IAA7BnQ,KAAK6U,qBAMhB,GAAI7U,KAAK6U,sBAAwB1E,EAAjC,CAKA,IAAImE,EAAahH,KAAKC,IAAIvN,KAAK6U,oBAAqB1E,GAChDoE,EAAWjH,KAAKE,IAAIxN,KAAK6U,oBAAqB1E,GAGlD,GAFAnQ,KAAK6U,oBAAsB1E,EAEvBmE,GAActU,KAAKuH,IAAI,qBAAuBgN,GAAYvU,KAAKuH,IAAI,kBAAmB,CAEtF,IAAIhD,EAAOuJ,MAAM0C,UAAUuE,MAAM5C,KAAKnS,KAAKuH,IAAI,SAC3C+M,EAAatU,KAAKuH,IAAI,oBAAqBgN,EAAWvU,KAAKuH,IAAI,oBAAsB,GACzFvH,KAAKqU,qBAAqB9P,EAAM+P,EAAYC,OACzC,CAEH,IAAI5D,EAAO3Q,KACXA,KAAK4Q,QAAQ,CACTC,OAAQyD,EACRxD,MAAOyD,EAAWD,EAAa,IACjC5N,MAAK,SAAStF,GACZuP,EAAK0D,qBAAqBjT,EAAOmD,KAAM+P,EAAYC,MACpDlP,KAAKrF,KAAK+Q,oBA3Bb/Q,KAAK4U,oBAAoBnU,EAAO0P,IAkCxC6E,yBAA0B,SAASvU,EAAO0P,GACtCnQ,KAAKgU,qBAAqBvT,EAAO0P,GACjCnQ,KAAKgI,QAAQ,mBAAoB,CAACvH,MAAOA,EAAO0P,MAAOA,KAM3D8E,gBAAiB,SAASxU,EAAO0P,GACzBnQ,KAAKkV,kBAAkBzU,EAAO0P,GAC9BnQ,KAAKgV,yBAAyBvU,EAAO0P,GAErCnQ,KAAK4U,oBAAoBnU,EAAO0P,IAOxC+E,kBAAmB,SAASzU,EAAO0P,GAC/B,OAAOnQ,KAAKkU,mBAAmBzT,EAAO0P,IAM1CgF,eAAgB,WAEZ,OADAnV,KAAKiU,kBACEjU,KAAKgI,QAAQ,oBAMxBwM,aAAc,WACV,OAAOxU,KAAKmU,iBAMhBL,OAAQ,SAAS/L,EAAW/G,GACxB,KAAM,mBAMVoU,UAAW,WACP,IAAIhL,EAAOpK,KACPqV,GAAiB,EAErBrV,KAAKyU,iCAAgC,SAAShU,EAAO0P,GAI7CkF,IACAjL,EAAK6J,kBACLoB,GAAiB,GAGrBjL,EAAK2J,gBAAgBtT,EAAO0P,KAC7BxR,SAAOqB,KAAKoU,wBAAyBpU,QAM5CsV,gBAAiB,WACb,IAAIlL,EAAOpK,KAEXA,KAAKyU,iCAAgC,SAAShU,EAAO0P,GAC7C/F,EAAK8J,mBAAmBzT,EAAO0P,GAC/B/F,EAAK4J,qBAAqBvT,EAAO0P,GAEjC/F,EAAK2J,gBAAgBtT,EAAO0P,KAEjCxR,SAAOqB,KAAKoU,wBAAyBpU,UCpJpD,QA7F6BuV,SAAkC,CAC3DxB,gBAAiB,SAAUtT,EAAO0P,GAC9BnQ,KAAK+H,UAAUoI,GAAS1P,GAE5BuT,qBAAsB,SAAUvT,EAAO0P,GACnCnQ,KAAK+H,UAAUoI,QAASzH,GAE5BuL,gBAAiB,WACbjU,KAAK+H,UAAY,IAErBmM,mBAAoB,SAAUzT,EAAO0P,GACjC,OAAOnQ,KAAK+H,UAAUoI,KAAW1P,GAErC0T,cAAe,WACX,OAAOnU,KAAK+H,WAEhByN,kBAAmB,SAAUzN,GACzB,IAAKA,EACD,OAAO,EACJ,GAAIpJ,YAAUoJ,IAAmC,IAArBA,EAAUhF,OACzC,OAAO,EACJ,GAAIpE,YAAUoJ,IAAmC,iBAAdA,EACtC,OAAO,EAEX,IAAK,IAAIoI,KAASpI,EACd,GAAIA,EAAU0N,eAAetF,SAA+BzH,IAArBX,EAAUoI,GAC7C,OAAO,EAGf,OAAO,GAEXuF,wBAAyB,SAAUC,EAAkB3U,GACjD,GAAqC,IAAjChB,KAAKuH,IAAI,qBAA6BvH,KAAKuH,IAAI,mBAAqBvH,KAAKuH,IAAI,SAAW,EACxFvH,KAAK4V,gCAAgC5V,KAAKuH,IAAI,SAAUoO,EAAkB3U,OACvE,CACH,IAAI2P,EAAO3Q,KACXA,KAAK4Q,UAAUlK,MAAK,SAAUtF,GAC1BuP,EAAKiF,gCAAgCxU,EAAOmD,KAAMoR,EAAkB3U,MACrEqE,KAAKrF,KAAK+Q,eAGrB6E,gCAAiC,SAAUrR,EAAMoR,EAAkB3U,GAC/D,IAAK,IAAI0M,EAAI,EAAGA,EAAInJ,EAAKxB,OAAQ2K,IACzBiI,EAAiBpR,EAAKmJ,GAAGjN,QACzBT,KAAK+T,gBAAgBxP,EAAKmJ,GAAGjN,MAAOiN,GAG5C1N,KAAKoU,wBAAwBpT,IAEjCoT,wBAAyB,SAAUpT,GAC/BhB,KAAK6V,0BAA4B7V,KAAK6V,2BACtCN,yCAAkEvV,KAAMgB,IAE5E6U,yBAA0B,WACtB,QAAwC,IAA7B7V,KAAK6U,oBAGhB,IAAK,IAAI1E,KAASnQ,KAAK+H,UACnB,GAAI/H,KAAK+H,UAAU0N,eAAetF,SAAoCzH,IAA1B1I,KAAK+H,UAAUoI,GAAsB,CAC7EnQ,KAAK6U,oBAAsBiB,SAAS3F,EAAO,IAC3C,QAIZ2D,OAAQ,SAAU/L,EAAW/G,GAEzB,GADAhB,KAAKiU,kBACDjU,KAAKwV,kBAAkBzN,GACvB/H,KAAKoU,wBAAwBpT,QAGjC,GAAIrC,YAAUoJ,IAAmC,iBAAdA,EAAwB,CACvD,IAAI4N,EAAmB,GACvB,GAAyB,iBAAd5N,EACP4N,EAAiB5N,IAAa,OAE9B,IAAK,IAAI2F,EAAI,EAAGA,EAAI3F,EAAUhF,OAAQ2K,IAClCiI,EAAiB5N,EAAU2F,KAAM,EAGzC1N,KAAK0V,wBAAwBC,EAAkB3U,OAC5C,CACH,IAAK,IAAImP,KAASpI,EACd,GAAIA,EAAU0N,eAAetF,GAAQ,CACjC,IAAI1P,EAAQsH,EAAUoI,QACRzH,IAAVjI,GACAT,KAAK+T,gBAAgBtT,EAAO0P,GAIxCnQ,KAAKoU,wBAAwBpT,OCxFzC,IAAI+U,EAAwBC,SAA8BC,GA6D1D,QA5DAF,EAAwBA,EAAsB/W,OAAO,CACjD0R,UAAW,SAAU1P,GACjBiV,iBAA4CjW,KAAMrB,WAASqC,EAAS,CAAEiQ,QAAQ,KAC9E,IAAIlJ,EAAY,GACa,iBAAlB/G,EAAQmP,QACfpI,EAAU/G,EAAQmP,OAASnP,EAAQkP,KAAKzP,OAE5CT,KAAK8T,OAAO/L,IAEhB6N,gCAAiC,SAAUrR,EAAMoR,EAAkB3U,GAC/D,IAAK,IAAI0M,EAAI,EAAGA,EAAInJ,EAAKxB,OAAQ2K,IACzBiI,EAAiBpR,EAAKmJ,GAAGjN,SACzBT,KAAK+T,gBAAgBxP,EAAKmJ,GAAGjN,MAAOiN,GAC/B1N,KAAKkR,aACN+E,iBAA4CjW,KAAM,CAC9CmQ,MAAOzC,EACPwC,KAAM3L,EAAKmJ,GACXuD,QAAQ,KAKxBjR,KAAKoU,wBAAwBpT,IAEjCkV,wBAAyB,SAAUnO,GAC/B,IAAK,IAAIoI,KAASpI,EACd,GAAIA,EAAU0N,eAAetF,SAA+BzH,IAArBX,EAAUoI,GAAsB,CACnE,IAAI1P,EAAQsH,EAAUoI,GACtB,MAAO,CACHA,MAAO2F,SAAS3F,EAAO,IACvB1P,MAAOA,KAKvB0V,QAASH,mBACTlC,OAAQ,SAAU/L,EAAW/G,GACzB,IAAIoV,EACAC,GAAmB,EACvB,IAAKtO,GAAkC,iBAAdA,GAA0BpJ,YAAUoJ,GACzDkO,iBAA4CjW,KAAM,CAAEiR,QAAQ,SAG5D,GADAmF,EAAqBpW,KAAKkW,wBAAwBnO,GAG3C,CACH,IAAIiJ,EAAShR,KAAKkR,YACbF,GAAUoF,EAAmB3V,QAAUuQ,EAAOvQ,OAAS2V,EAAmBjG,QAAUa,EAAOb,QAC5FkG,GAAmB,QAJvBJ,iBAA4CjW,KAAM,CAAEiR,QAAQ,IAapE,OALIoF,EACArW,KAAKyQ,SAAS2F,EAAmBjG,OAEjCnQ,KAAKmW,QAAQpO,EAAW/G,GAErBhB,QCqNf,QAvQmByS,gBAAqB,CACpC6D,UAAWzC,EACX0C,iBAAkB,KAClBC,OAAQ,CACJ,OAAU,WACV,UAAa,YAEjBzN,WAAY,CAAE,MAAS,uDACvBrF,WAAY,SAAU1C,GAgBlB,OAfArC,YAAUqB,KAAM,qBAChBA,KAAKyW,MAAQzV,EAAQyV,OAAS,IAAIzW,KAAKsW,UAAUtV,GACjDhB,KAAK0W,eAAiB/X,aAAWqC,EAAQ0V,gBC3CjD,iLD4CQ1W,KAAK2W,cAAgBhY,aAAWqC,EAAQ2V,eE5ChD,sqBF6CQ3W,KAAK4W,mBAAqB5W,KAAK6W,YAAc7V,EAAQ6V,aAlBxB,IAmB7B7W,KAAK4J,mBAAiD,IAA1B5I,EAAQ4I,cAAgC5I,EAAQ4I,cAlBvD,GAmBrB5J,KAAK8W,qBAAuB9V,EAAQ8V,sBAlBP,GAmB7B9W,KAAK+W,KAAO/V,EAAQ+V,KACpB/W,KAAKgX,kBAAoBhW,EAAQiW,gBAnBV,GAoBvBjX,KAAKuW,iBAAmBvV,EAAQuV,kBAAoBvW,KAAKuW,iBACzDvW,KAAKuI,SACLvI,KAAKkX,gBACAlX,KAAK+W,MACN/W,KAAKyW,MAAMpO,QAERrI,MAEXkX,cAAe,WACXlX,KAAKmX,SAASnX,KAAKyW,MAAO,SAAUzW,KAAKoX,cAAepX,MACxDA,KAAKmX,SAASnX,KAAKyW,MAAO,cAAezW,KAAKqX,cAAerX,OAEjEuI,OAAQ,WACJ,OAAOvI,MAEXsX,SAAU,SAAUtM,GACZhL,KAAK4J,cAAgB,GACrBS,aAAarK,KAAKuX,aAClBvX,KAAKuX,YAAcjN,WAAWtK,KAAKwX,kBAAmBxX,KAAK4J,gBAE3D5J,KAAKwX,oBAETxX,KAAKyX,UAAYzM,GAASA,EAAM0M,QAAU1M,EAAM0M,OAAOC,WAE3DC,iBAAkB,WACd5X,KAAK6X,IAAIF,UAAU3X,KAAKyX,YAE5BL,cAAe,WACXpX,KAAK8X,cAETT,cAAe,SAAU/D,EAAgBnS,GACrCnB,KAAKgI,QAAQ,kBAAmBsL,EAAgBnS,IAEpD4W,0BAA2B,SAAU7H,EAAMxC,GACvCwC,EAAKC,MAAQnQ,KAAKyW,MAAMlP,IAAI,oBAAsBmG,OAC/BhF,IAAfwH,EAAKxP,QACLwP,EAAKxP,MAAQwP,EAAKzP,OAEtByP,EAAKxP,MAAQsX,SAAO9H,EAAKxP,QAE7BuX,aAAc,WACV,IAAIC,EAAclY,KAAKyW,MAAMlP,IAAI,oBAC7B4Q,EAAYnY,KAAKyW,MAAMlP,IAAI,kBAC3B6Q,EAAqBpY,KAAKqY,cAAgB/K,KAAKgL,MAAMJ,EAAc,GAAKlY,KAAKqY,eAAiB,EAC9FE,EAAoBvY,KAAKqY,cAAgB/K,KAAKgL,MAAMH,EAAY,GAAKnY,KAAKqY,eAAiB,EAC3F1H,EAAO3Q,KACXA,KAAK6X,IAAI3V,KAAK,sBAAsBpC,MAAK,SAAUqQ,EAAOqI,GACtD,IAAIC,EAAST,IAAEQ,GACXE,EAAa/H,EAAKgI,eAAe,CACjCxI,MAAOA,EAAQ,EACfiI,mBAAoBA,EACpBG,kBAAmBA,EACnBL,YAAaA,EACbC,UAAWA,EACXtF,MAAOlC,EAAKiI,WACZP,cAAe1H,EAAK0H,cACpBQ,WAAYlI,EAAKkI,WACjBhC,YAAalG,EAAKkG,YAClBJ,MAAO9F,EAAK8F,QAEZqC,EAAYJ,EAAa/H,EAAKgG,cAAc+B,GAAc,GAC1DK,EAAQP,EAAMQ,SAAS,GAC3BD,GAASP,EAAMS,YAAYF,GAC3BN,EAAOjK,OAAOsK,OAGtBI,kBAAmB,SAAUzF,GACzB,IAAIrJ,EAAOpK,MACPA,KAAK4Y,aAAe5Y,KAAKyW,MAAMlP,IAAI,UAAYkM,KAC/CzT,KAAK4Y,WAAa5Y,KAAKyW,MAAMlP,IAAI,SACnBuG,MAAM0C,UAAUuE,MAAM5C,KAAKnS,KAAK6X,IAAI,GAAGmB,UACzCxM,SAAQ,SAAUgM,GAC1BpO,EAAKyN,IAAI,GAAGoB,YAAYT,MAE5BxY,KAAK6X,IAAIrJ,OAAOxO,KAAK0W,eAAe,CAChC/X,EAAGA,IACHwa,OAAQnZ,KAAKoZ,yBAEjBpZ,KAAKqZ,gBAAkBrZ,KAAK6X,IAAI3V,KAAK,8BAG7CkX,oBAAqB,WAIjB,IAHA,IAAIE,EAAoBtZ,KAAKqY,cAAgB/K,KAAKgL,KAAKtY,KAAK4Y,WAAa5Y,KAAKqY,eAAiB,EAC3FkB,EAAkBD,EAAoB,EAAItZ,KAAK6Y,WAAa7Y,KAAK4Y,WAAa5Y,KAAK6Y,YAAcS,EAAoB,GAAKtZ,KAAK6W,YAAc7W,KAAK6W,YAAc,EAChK2C,EAAa,GACR9L,EAAI,EAAGA,EAAI4L,EAAmB5L,IACnC8L,EAAWC,KAAK,CAAEC,OAAQ1Z,KAAK6W,cAGnC,OADA2C,EAAWC,KAAK,CAAEC,OAAQH,IACnBC,GAEXG,uBAAwB,WACf3Z,KAAK4Z,+BACN5Z,KAAK6Y,WAAa7Y,KAAKgX,kBACnBhX,KAAKqZ,kBACLrZ,KAAK6Y,WAAa7Y,KAAK6X,IAAI3V,KAAKlC,KAAKuW,iBAAmB,UAAUsD,aAAY,IACzE7Z,KAAK6Y,YAAc7Y,KAAK6Y,YAnHd,GAoHX7Y,KAAK6Y,WAAa7Y,KAAKgX,kBACvBhX,KAAK4Z,8BAA+B,GAEpC5Z,KAAK4Z,8BAA+B,GAG5C5Z,KAAK8Z,sBACL9Z,KAAKqY,cAAgB/K,KAAKqG,MAAM3T,KAAK4W,mBAAqB5W,KAAK6Y,YAC/D7Y,KAAK6W,YAAc7W,KAAKqY,cAAgBrY,KAAK6Y,WAC7C7Y,KAAKkZ,mBAAkB,GACvBlZ,KAAKiY,iBAGb8B,eAAgB,SAAUC,GACtBha,KAAKga,eAAiBA,EACtBha,KAAK6X,IAAIgC,YAAY7Z,KAAKga,gBAC1Bha,KAAKia,aAAe3M,KAAKqG,MAAM3T,KAAKga,eAAiBha,KAAK6Y,YAAc,EACxE7Y,KAAKqY,cAAgB/K,KAAKqG,MAAM3T,KAAK4W,mBAAqB5W,KAAK6Y,YAC/D7Y,KAAK6W,YAAc7W,KAAKqY,cAAgBrY,KAAK6Y,WAC7C7Y,KAAKkZ,mBAAkB,GACvBlZ,KAAKiY,gBAET6B,oBAAqB,WACjB9Z,KAAKga,eAAiBha,KAAK6X,IAAI6B,SAC/B1Z,KAAKia,aAAe3M,KAAKqG,MAAM3T,KAAKga,eAAiBha,KAAK6Y,YAAc,GAE5EqB,iBAAkB,WAEd,OADAla,KAAK2Z,yBACE3Z,KAAKia,cAEhBtB,eAAgB,SAAU3X,GACtB,IAAImP,EAAQnP,EAAQmP,MACpB,GAAIA,EAAQnP,EAAQoX,oBAAsBjI,EAAQnP,EAAQuX,kBACtD,OAAO,KAEX,IAAI4B,EAAoBnZ,EAAQqX,cAAgB/K,KAAKE,IAAIxM,EAAQkX,YAAalX,EAAQqX,eAAiBlI,EAAQ,IAAMnP,EAAQkX,YACzHkC,EAAmBpZ,EAAQqX,cAAgB/K,KAAKC,IAAIvM,EAAQmX,UAAWnX,EAAQqX,cAAgBlI,EAAQ,GAAKnP,EAAQmX,UACpH5E,EAAMvS,EAAQ6X,WAAasB,EAAoBnZ,EAAQ6X,YAAc1I,EAAQ,GAAKnP,EAAQ6V,YAAc,EACxG9G,EAAQjC,MAAM0C,UAAUuE,MAAM5C,KAAKnR,EAAQyV,MAAMlP,IAAI,SAAU4S,EAAoBnZ,EAAQkX,YAAakC,EAAmBpZ,EAAQkX,YAAc,GAIrJ,OAHAvZ,SAAOoR,GAAO,SAAUG,EAAMxC,GAC1B1N,KAAK+X,0BAA0B7H,EAAMxC,GAAKyM,EAAoBnZ,EAAQkX,gBACvElY,MACI,CACHuT,IAAKA,EACLxD,MAAOA,IAGfyH,kBAAmB,WACf,IAAI6C,EAAera,KAAKsa,mBACxBta,KAAKyW,MAAMpO,MAAM,CACbkL,IAAK8G,EAAa9G,IAClBC,OAAQ6G,EAAa7G,UAG7B8G,iBAAkB,WACd,IAAI7C,EAAYzX,KAAKua,gBACjB1H,EAAQ7S,KAAKyW,MAAMlP,IAAI,SACvB2L,EAAiB5F,KAAKC,IAAIsF,EAAQ7S,KAAKia,aAAc3M,KAAKqG,MAAM8D,EAAYzX,KAAK6Y,aAErF,MAAO,CACHtF,IAAKL,EACLM,OAHoBlG,KAAKC,IAAIsF,EAAQ,EAAGK,EAAiBlT,KAAKia,aAAe,KAMrFM,cAAe,WACXva,KAAK2Z,yBACL,IAAIlC,EAAY,EAChB,GAAIzX,KAAKqZ,gBAAiB,CACtB,IAAImB,EAAWxa,KAAK6X,IAAIhH,SACpB4J,EAAkBza,KAAKqZ,gBAAgBxI,SACvC2J,GAAYC,IACZhD,EAAY+C,EAASjH,IAAMkH,EAAgBlH,KAGnD,OAAOkE,GAEXK,WAAY,WAWR,OAVI9X,KAAK+W,MAAS/W,KAAKyW,MAAMiE,IAAI,qBAAwB1a,KAAKyW,MAAMiE,IAAI,mBAIpE1a,KAAKgI,QAAQ,sBACbhI,KAAKkZ,oBACLlZ,KAAKiY,eACLjY,KAAK2Z,yBACL3Z,KAAKgI,QAAQ,iBAPbhI,KAAK+W,KAAO,KACZ/W,KAAKyW,MAAMpO,SAQRrI,MAEX2a,OAAQ,WACJ,GAAK3a,KAAK6X,IAAI+C,GAAG,YAAjB,CAGA,IAAIC,EAAkB7a,KAAK6X,IAAIgC,cAC3BgB,IAAoB7a,KAAK8a,mBAGzB9a,KAAK8a,iBAAmBD,EAE5B7a,KAAK4Z,8BAA+B,EACpC5Z,KAAK2Z,4BAETtR,MAAO,SAAU0S,EAAU/Z,GAGvB,IAAIyW,EAFJzX,KAAK+W,MAAO,GACZ/V,EAAUA,GAAW,IAETga,aACRvD,EAAYzX,KAAK6X,IAAItQ,IAAI,GAAGoQ,UAE5B3X,KAAK8I,MAAM,CACPmI,QAAQ,EACR8F,MAAM,IAGd/W,KAAKyW,MAAMwE,KAAK,UAAU,WAClBja,EAAQga,cACRhb,KAAK6X,IAAIF,UAAUF,GAEvBsD,GAAYA,EAAS9T,MAAMjH,KAAM4G,aAClC5G,MAAMqI,MAAM,CAAEoL,OAAO,KAE5B3K,MAAO,SAAU9H,GACbA,EAAUrC,aAAWqC,GAAW,GAAI,CAAE+V,MAAM,IAC5C/W,KAAK6X,IAAIF,UAAU,GACnB3X,KAAK+W,KAAO/V,EAAQ+V,KACpB/W,KAAKyW,MAAM3N,MAAM9H,IAErBka,SAAU,SAAU/K,GAChB,GAAqB,iBAAVA,EAAX,CAGA,IAAIsH,EAAYzX,KAAKua,gBACrB,GAAKva,KAAK4Z,6BAAV,CAGA5Z,KAAK8Z,sBACL,IAAIqB,EAAuB,KACvBC,EAAUjL,EAAQnQ,KAAK6Y,WACvBuC,EAAU3D,EACV0D,EAAuBC,EAChBA,EAAUpb,KAAK6Y,WAAapB,EAAYzX,KAAKga,iBACpDmB,EAAuBC,EAAUpb,KAAK6Y,WAAa7Y,KAAKga,gBAE/B,OAAzBmB,GACAnb,KAAK6X,IAAIF,UAAUwD,QG1Q/B,IACIE,EAAU,CACVC,KAAM,OACNC,MAAO,SA0RX,QAxRwBC,SAAoB,CACxClF,UAAWN,EACXtS,WAAY,SAAU1C,GAMlB,OALArC,YAAUqB,KAAM,kBAAmB,oBAAqB,cAAe,SACvEA,KAAKyb,qBAAuBza,EAAQya,sBAAwB,KAC5Dzb,KAAK0b,YAAc1a,EAAQ0a,YAAc1a,EAAQ0a,YAAc,GAC/D1b,KAAK2b,cAAgB3a,EAAQ2a,cAAgB3a,EAAQ2a,cAAgB,gBACrE3b,KAAK4b,eAAe5a,EAAQ+G,WACrByT,4BAAuCxb,KAAMgB,IAExD6a,eAAgB,WACZ,IAAIvc,EAAMkc,iCAA4Cxb,KAAM4G,WAE5D,OADA5G,KAAK6X,IAAItH,GAAG,YAAavQ,KAAKyb,qBAAsB9c,SAAOqB,KAAK8b,YAAa9b,OAAOuQ,GAAG,YAAavQ,KAAKyb,qBAAsB9c,SAAOqB,KAAK+b,YAAa/b,OAAOuQ,GAAG,WAAYvQ,KAAKyb,qBAAsB9c,SAAOqB,KAAKgc,gBAAiBhc,OAAOuQ,GAAG,cAAevQ,KAAKyb,qBAAsB9c,SAAOqB,KAAKic,YAAajc,KAAMA,KAAK6X,MAAMtH,GAAG,QAASvQ,KAAKyb,qBAAsB9c,SAAOqB,KAAKic,YAAajc,KAAMA,KAAK6X,MAAMtH,GAAG,WAAYvQ,KAAKyb,qBAAsB9c,SAAOqB,KAAKic,YAAajc,KAAMA,KAAK6X,MAAMtH,GAAG,YAAavQ,KAAKyb,qBAAsB9c,SAAOqB,KAAKic,YAAajc,KAAMA,KAAK6X,MACjjBvY,GAEX4c,iBAAkB,WACd,IAAI5c,EAAMkc,mCAA8Cxb,KAAM4G,WAE9D,OADA5G,KAAK6X,IAAIvH,IAAI,WAAWA,IAAI,aAAaA,IAAI,aAAaA,IAAI,YAAYA,IAAI,eAAeA,IAAI,SAASA,IAAI,YAAYA,IAAI,aACvHhR,GAEXsc,eAAgB,SAAU7T,GAAW,MAE7BoU,EAAgB,WADpBpU,EAAYpJ,WAAS,CAAEyd,QAAS,IAAMrU,IACLqU,eAAb,QAAwB,GAAIC,EAAuB1d,aAAWwd,GAAuCA,EAAiBG,KAApCH,EACtGnc,KAAK+H,UAAY,CACbqU,QAAS,CACLE,UAAqC,IAAxBD,GAAsCA,EACnDE,WAAyC,IAA3BJ,EAAiBI,OAAwBJ,EAAiBI,OAE5EC,cAAwC,IAAvBzU,EAAUyU,UAA2BzU,EAAUyU,WAGxEtF,cAAe,WACXsE,+BAA0Cxb,MAC1CA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKmV,eAAgBnV,MAClEA,KAAKmX,SAASnX,KAAKyW,MAAO,gBAAiBzW,KAAKyc,YAAazc,MAC7DA,KAAKmX,SAASnX,KAAKyW,MAAO,qBAAsBzW,KAAK0c,YAAa1c,MAClEA,KAAKmX,SAASnX,KAAKyW,MAAO,mBAAoBzW,KAAK2c,cAAe3c,MAClEgY,IAAE,QAAQzH,GAAG,UAAWvQ,KAAK4c,iBAAiBrM,GAAG,YAAavQ,KAAK6c,oBAEvE9E,0BAA2B,SAAU7H,EAAMxC,GACvC8N,2CAAsDxb,KAAMkQ,EAAMxC,GAClEwC,EAAKvP,SAAWX,KAAKyW,MAAMvB,mBAAqBlV,KAAKyW,MAAMvB,kBAAkBhF,EAAKzP,MAAOyP,EAAKC,QAElG6L,gBAAiB,SAAUhR,GACvB,IAAKhL,KAAK+H,UAAUyU,WACXxc,KAAK+H,UAAUqU,QAAQE,MAAQtc,KAAK+H,UAAUqU,QAAQG,SAAWvc,KAAK8c,cAAe,CACtF,IAAIC,EAAW/c,KAAKgd,gBAAgBhS,EAAMiS,eAC1Cjd,KAAKkd,cAAclS,EAAO+R,EAAStc,MAAOsc,EAAS5M,OAC/CnQ,KAAKmd,mBACLnd,KAAKod,2BACLpd,KAAKqd,qBACLrd,KAAKmd,kBAAmB,KAKxCG,eAAgB,SAAU1b,GACtB,OAAO5B,KAAKgd,gBAAgBpb,EAAEqb,eAAe/M,MAEjD+L,YAAa,SAAU7U,EAASxF,GAC5B,IAAI2b,EAAY3b,EAAE8C,KAAMwL,EAAOlQ,KAAKsd,eAAe1b,GACnD5B,KAAKgI,QAAQ,aAAeuV,EAAWrN,EAAMtO,IAEjDka,YAAa,SAAU9Q,GACnB,IAAKhL,KAAK8c,gBAAkB9c,KAAK+H,UAAUqU,QAAQE,MAAwB,IAAhBtR,EAAMoH,OAAepS,KAAK+H,UAAUqU,QAAQG,OAAyB,IAAhBvR,EAAMoH,OAAc,CAChI,IAAIoL,EAA6B,IAAhBxS,EAAMoH,MAAciJ,EAAQC,KAAOD,EAAQE,MACxDvb,KAAK+H,UAAUyU,WACfxc,KAAKwd,EAAa,uBAAwB,EAC1Cxd,KAAKyd,aAAezd,KAAK0d,aAAa1S,IAE1C,IAAI+R,EAAW/c,KAAKgd,gBAAgBhS,EAAMiS,eAC1Cjd,KAAK+H,UAAUyU,SAAWxc,KAAK2d,aAAa3S,EAAO+R,EAAStc,MAAOsc,EAAS5M,OAASnQ,KAAKkd,cAAclS,EAAO+R,EAAStc,MAAOsc,EAAS5M,SAGhJ4L,YAAa,SAAU/Q,GACnB,GAAIhL,KAAK4d,6BACL5d,KAAK6d,kBACD7d,KAAK8d,YAAY9S,EAAOhL,KAAKyd,eAAe,CAC5Czd,KAAKyd,aAAezd,KAAK0d,aAAa1S,GACtC,IAAI+R,EAAW/c,KAAKgd,gBAAgBhS,EAAMiS,eACrCjd,KAAKyW,MAAMvB,kBAAkB6H,EAAStc,MAAOsc,EAAS5M,QACvDnQ,KAAKyW,MAAM3B,oBAAoBiI,EAAStc,MAAOsc,EAAS5M,SAKxEyM,gBAAiB,SAAU5R,GACvB,IAAIZ,EAAOpK,MACPA,KAAK+d,wBAA0B/d,KAAKge,2BACpCrf,SAAO0c,GAAS,SAAUmC,GACtBpT,EAAKoT,EAAa,uBAAwB,YAEvCxd,KAAKyd,aACZzd,KAAK6d,kBACD7d,KAAKmd,mBACLnd,KAAKod,2BACLpd,KAAKmd,kBAAmB,KAIpCN,kBAAmB,SAAU7R,GACrBhL,KAAK4d,6BACL5d,KAAKie,UAAYjT,EAAMkT,QAClBle,KAAKme,iBACNne,KAAKme,eAAiBC,YAAYpe,KAAKqe,YAAare,KAAK8W,yBAIrE3B,eAAgB,WACZnV,KAAK6X,IAAI3V,KAAK,MAAQlC,KAAK2b,cAAgB3b,KAAK0b,aAAa4C,YAAYte,KAAK2b,eAC9E3b,KAAKmd,kBAAmB,GAE5BV,YAAa,SAAU1U,GACnB/H,KAAKue,mBAAmBxW,EAAUoI,OAC9BnQ,KAAK+H,UAAUyU,SACfxc,KAAKmd,kBAAmB,EAExBnd,KAAKod,4BAGbV,YAAa,SAAU1b,GACnB,IAAIoJ,EAAOpK,KACPwe,EAAoBlR,KAAKE,IAAIxN,KAAKyW,MAAMlP,IAAI,oBAAqBvG,EAAQqM,OACzEoR,EAAkBnR,KAAKC,IAAIvN,KAAKyW,MAAMlP,IAAI,kBAAmBvG,EAAQyM,KACzEzN,KAAK6X,IAAI3V,KAAK,KAAOlC,KAAK0b,YAAc,SAAW1b,KAAK2b,cAAgB,KAAK7b,MAAK,WAC9E,IAAI4e,EAAQ1G,IAAEhY,MACVmQ,EAAQ2F,SAAS4I,EAAMpQ,KAAK,cAAe,IAC/C,GAAI6B,GAASqO,GAAqBrO,GAASsO,EAAiB,CACxD,IAAIvO,EAAO9F,EAAKqM,MAAMlP,IAAI,SAAS4I,EAAQ/F,EAAKqM,MAAMlP,IAAI,qBACtD6C,EAAKqM,MAAMvB,kBAAkBhF,GAAQA,EAAKzP,MAAO0P,IACjDuO,EAAMC,SAASvU,EAAKuR,mBAIhC3b,KAAKmd,kBAAmB,GAE5BR,cAAe,SAAU5U,GACrB/H,KAAK4e,qBAAqB7W,EAAUoI,OAChCnQ,KAAK+H,UAAUyU,SACfxc,KAAKmd,kBAAmB,EAExBnd,KAAKod,4BAGbmB,mBAAoB,SAAUpO,GAC1BnQ,KAAK6X,IAAI3V,KAAK,KAAOlC,KAAK0b,YAAc,gBAAmBvL,EAAQ,WAAcnQ,KAAK2b,cAAgB,KAAKgD,SAAS3e,KAAK2b,gBAE7HiD,qBAAsB,SAAUzO,GAC5BnQ,KAAK6X,IAAI3V,KAAK,kBAAqBiO,EAAQ,MAASnQ,KAAK2b,cAAgB3b,KAAK0b,aAAa4C,YAAYte,KAAK2b,gBAEhH0C,YAAa,WACT,IAGIQ,EAHAC,EAAc9e,KAAK6X,IAAIhH,SAAS0C,IAChCoE,EAAY3X,KAAK6X,IAAIF,YACrBF,OAAsC,IAAnBzX,KAAK2X,UAA4B3X,KAAK2X,UAAYA,EAErEoH,GAAe,EACf/e,KAAKie,UAAYa,EAEjBC,GADAF,EAAepH,EAA8B,EAAlBzX,KAAK6Y,YACFlB,EACvB3X,KAAKie,UAAYa,EAAc9e,KAAKga,iBAE3C+E,GADAF,EAAepH,EAA8B,EAAlBzX,KAAK6Y,YACFlB,GAE9BoH,IACA/e,KAAK6X,IAAIF,UAAUkH,GACnB7e,KAAK2X,UAAY3X,KAAK6X,IAAIF,YAC1B3X,KAAKwX,qBAETxX,KAAKgf,yBAAyBvH,EAAWoH,IAE7CG,yBAA0B,SAAUC,EAAcJ,GAC9C,IAAI1O,EAMJ,GALI8O,EAAeJ,EACf1O,EAAQnQ,KAAKsa,mBAAmB9G,OACzByL,EAAeJ,IACtB1O,EAAQnQ,KAAKsa,mBAAmB/G,KAEhCpD,EAAO,CACP,IAAID,EAAOlQ,KAAKyW,MAAMlP,IAAI,SAAS4I,EAAQnQ,KAAKyW,MAAMlP,IAAI,qBACtD2I,IACKlQ,KAAKyW,MAAMvB,kBAAkBhF,EAAKzP,MAAO0P,IAC1CnQ,KAAKyW,MAAM3B,oBAAoB5E,EAAKzP,MAAO0P,MAK3D0N,gBAAiB,WACT7d,KAAKme,iBACLe,cAAclf,KAAKme,gBACnBne,KAAKme,oBAAiBzV,EACtB1I,KAAK2X,eAAYjP,IAGzBiV,aAAc,SAAU3S,EAAOvK,EAAO0P,GAC9BnF,EAAMmU,SACNnf,KAAKyW,MAAM3B,oBAAoBrU,EAAO0P,GAC/BnF,EAAMoU,SAAWpU,EAAMqU,QAC9Brf,KAAKkd,cAAclS,EAAOvK,EAAO0P,GAEjCnQ,KAAKyW,MAAMxB,gBAAgBxU,EAAO0P,IAG1C+M,cAAe,SAAUlS,EAAOvK,EAAO0P,GACnCnQ,KAAKyW,MAAMtB,iBAAiBP,oBAAoBnU,EAAO0P,IAE3DiN,yBAA0B,WACtBpd,KAAKgI,QAAQ,mBAAoBhI,KAAKsf,aAE1CjC,mBAAoB,WAChBrd,KAAKgI,QAAQ,gBAAiBhI,KAAKsf,aAEvCtC,gBAAiB,SAAU9M,GAGvB,IAFA,IAAIwO,EAAQ1G,IAAE9H,GACVC,EAAQuO,EAAMpQ,KAAK,mBACN5F,IAAVyH,GAEHA,GADAuO,EAAQA,EAAMrO,UACA/B,KAAK,cAEvB6B,EAAQ2F,SAAS3F,EAAO,IACxB,IAAIoP,EAAYvf,KAAKyW,MAAMlP,IAAI,SAAS4I,EAAQnQ,KAAKyW,MAAMlP,IAAI,qBAC/D,MAAO,CACH2I,KAAMqP,EACN9e,MAAO8e,GAAaA,EAAU9e,MAC9B0P,MAAOA,IAGf2N,YAAa,SAAU9S,EAAOwU,GAC1B,OAAOlS,KAAKmS,IAAID,EAASE,EAAI1U,EAAM2U,SAAWrS,KAAKmS,IAAID,EAASI,EAAI5U,EAAMkT,UAxOtD,GA0OxBR,aAAc,SAAU1S,GACpB,MAAO,CACH0U,EAAG1U,EAAM2U,QACTC,EAAG5U,EAAMkT,UAGjBN,yBAA0B,WACtB,OAAQ5d,KAAK+H,UAAUqU,QAAQE,MAAQtc,KAAK+d,wBAA0B/d,KAAK+H,UAAUqU,QAAQG,OAASvc,KAAKge,0BAA4Bhe,KAAK+H,UAAUyU,WAAaxc,KAAK8c,eAE5KwC,SAAU,WACN,OAAOtf,KAAKyW,MAAMjC,gBAEtBrM,SAAU,SAAUJ,EAAW/G,GAO3B,OANAA,EAAUA,GAAW,IACRiQ,QAAYjQ,EAAQ6e,cAAiB7e,EAAQ6e,aAAa5O,QACnEjR,KAAKyW,MAAMwE,KAAK,mBAAoBjb,KAAKod,yBAA0Bpd,MAEvEgB,EAAUA,EAAQ6e,aAClB7f,KAAKyW,MAAM3C,OAAO/L,EAAW/G,GACtBhB,MAEXoV,UAAW,SAAUpU,GAKjB,OAJKA,GAAYA,EAAQiQ,QACrBjR,KAAKyW,MAAMwE,KAAK,mBAAoBjb,KAAKod,yBAA0Bpd,MAEvEA,KAAKyW,MAAMrB,YACJpV,MAEX8f,WAAY,SAAU9e,GAClB,OAAOhB,KAAKmI,SAAS,GAAInH,IAE7BsU,gBAAiB,SAAUtU,GAKvB,OAJKA,GAAYA,EAAQiQ,QACrBjR,KAAKyW,MAAMwE,KAAK,mBAAoBjb,KAAKod,yBAA0Bpd,MAEvEA,KAAKyW,MAAMnB,kBACJtV,MAEX+f,YAAa,SAAU9W,GAGnB,OAFAjJ,KAAKiJ,SAAWA,EAChBjJ,KAAKiJ,SAAWjJ,KAAK6X,IAAI8G,SAAS,YAAc3e,KAAK6X,IAAIyG,YAAY,YAC9Dte,MAEX8c,YAAa,WACT,OAAO9c,KAAKiJ,UAEhB+W,OAAQ,WAEJ,OADAhI,IAAE,QAAQ1H,IAAI,UAAWtQ,KAAK4c,iBAAiBtM,IAAI,YAAatQ,KAAK6c,mBAC9DrB,wBAAmCxb,SCvNlD,QApEyBigB,SAAyB,CAC9CC,aAAa,EACbxc,WAAY,SAAU1C,GAClBA,EAAUA,GAAW,GACrB,IAAImf,EAA0BnK,SAA8BC,GAC5DjV,EAAQyV,MAAQzV,EAAQyV,OAAS,IAAI0J,EAAwBnf,GAC7Dif,4BAA4CjgB,KAAMgB,IAEtD+a,YAAa,SAAU/Q,GAEnB,GADAiV,6BAA6CjgB,KAAMgL,IAC9ChL,KAAKogB,cAAgBpgB,KAAK8d,YAAY9S,EAAOhL,KAAKogB,cAAe,CAClEpgB,KAAKogB,aAAepgB,KAAK0d,aAAa1S,GACtC,IAAI+R,EAAW/c,KAAKgd,gBAAgBhS,EAAMiS,eAC1Cjd,KAAKyQ,SAASsM,EAAS5M,SAG/BkQ,eAAgB,SAAUH,GACtBlgB,KAAKkgB,YAAcA,GAEvBI,eAAgB,WACZ,OAAOtgB,KAAKkgB,cAAgBlgB,KAAK8c,eAErCyD,cAAe,WACXvgB,KAAKyQ,SAAS,IAElB+P,aAAc,WACVxgB,KAAKyQ,SAASnD,KAAKE,IAAI,EAAGxN,KAAKyW,MAAMlP,IAAI,SAAW,KAExDkZ,aAAc,WACVzgB,KAAKyQ,SAASnD,KAAKC,IAAIvN,KAAKyW,MAAMlP,IAAI,SAAW,EAAGvH,KAAK0gB,kBAAoB,KAEjFC,iBAAkB,WACd3gB,KAAKyQ,SAASnD,KAAKE,IAAI,EAAGxN,KAAK0gB,kBAAoB,KAEvDE,SAAU,WACN5gB,KAAKyQ,SAASnD,KAAKC,IAAIvN,KAAKyW,MAAMlP,IAAI,SAAW,EAAGvH,KAAK0gB,kBAAoB1gB,KAAKka,sBAEtF2G,OAAQ,WACJ7gB,KAAKyQ,SAASnD,KAAKE,IAAI,EAAGxN,KAAK0gB,kBAAoB1gB,KAAKka,sBAE5D4G,eAAgB,WACZ,OAAO9gB,KAAKyW,MAAMvF,WAAalR,KAAKyW,MAAMvF,aAE9CT,SAAU,SAAUN,EAAOnP,GACvB,GAAIhB,KAAKsgB,iBAAkB,CACvB,IAAItP,EAAShR,KAAK8gB,iBAClB,GAAI9P,GAAUA,EAAOb,QAAUA,EAC3B,OAEJ,IAAKnP,IAAYA,EAAQiQ,OAAQ,CAC7B,IAAIN,EAAO3Q,KACXA,KAAKyW,MAAMwE,KAAK,kBAAkB,WAC9BtK,EAAK3I,QAAQ,iBAAkB2I,EAAKmQ,qBAG5C9gB,KAAKyW,MAAMhG,SAASN,EAAOnP,KAGnC+W,0BAA2B,SAAU7H,EAAMxC,GACvCuS,2CAA2DjgB,KAAMkQ,EAAMxC,GACvE,IAAIqT,EAAc/gB,KAAK0gB,iBAAmB1gB,KAAK0gB,kBAC/CxQ,EAAKc,YAAgC,IAAhB+P,GAA+BA,IAAgB/gB,KAAKyW,MAAMlP,IAAI,oBAAsBmG,GAE7GgT,gBAAiB,WACb,IAAI1P,EAAShR,KAAK8gB,iBAClB,OAAO9P,GAAUA,EAAOb,SCvChC,QA1BuB6Q,SAA0B,CAC7CxK,OAAQ7X,WAAS,GAAIqiB,mBAAqC,CAAE,aAAc,cAC1Etd,WAAY,SAAU1C,GAClB,IAAIyV,EAAQzV,EAAQyV,OAAS,IAAIV,EAAsB/U,GACvDggB,4BAA6ChhB,KAAMrB,WAAS,CACxD8X,MAAOA,EACPM,MAAM,EACNhP,UAAW,CACPqU,SAAS,EACTI,UAAU,IAEfxb,KAEPigB,UAAW,WACPjhB,KAAKgI,QAAQ,iBAEjByI,SAAU,SAAUN,GAChB,GAAInQ,KAAKsgB,iBAAkB,CACvB,IAAItP,EAAShR,KAAK8gB,iBAClB,GAAI9P,GAAUA,EAAOb,QAAUA,EAC3B,OAEJnQ,KAAKyW,MAAMwE,KAAK,mBAAoBjb,KAAKod,yBAA0Bpd,MAAMyQ,SAASN,OCvB9F,IAAI+Q,EAA0B,SAAUlgB,GACpCrC,YAAUqB,KAAM,UAAW,gBAAiB,iBAC5CA,KAAKmhB,aAAe,GACpBnhB,KAAKohB,gBAAkBpgB,EAAQ4P,SAEnCjS,WAASuiB,EAAwB1Q,UAAW,CACxCI,QAAS,SAAU5P,GACf,IAAIqgB,EAAW,IAAIrJ,cACnB,GAAIhX,QAAuC,IAArBA,EAAQsgB,SAI1B,OAHAthB,KAAKuhB,UAAY,KACjBvhB,KAAKshB,SAAWtgB,EAAQsgB,SACxBD,EAAS1a,UACF0a,EAASG,UAEpB,IAAI7Q,EAAO3Q,KAEX,OAAI2Q,EAAK8Q,iBACDzhB,KAAKuhB,UACLvhB,KAAK0hB,gBAAgB1gB,EAASqgB,GAE9BrhB,KAAKohB,kBAAkB1a,MAAK,SAAUtF,GAClCuP,EAAKwQ,aAAe,GACpBxQ,EAAKgR,oBAAsB,GAC3BhR,EAAK4Q,UAAY5Q,EAAKiR,cAAcxgB,EAAOmD,MAC3CoM,EAAK+Q,gBAAgB1gB,EAASqgB,MAC/Bhc,KAAKgc,EAAShb,QAEdgb,EAASG,YAEhBxhB,KAAKmhB,aAAe,KACpBnhB,KAAK2hB,oBAAsB,KAC3B3hB,KAAKuhB,UAAY,KACVvhB,KAAKohB,gBAAgBpgB,KAGpC6gB,gBAAiB,WACb,OAAO7hB,KAAKmhB,cAEhBW,uBAAwB,WACpB,OAAO9hB,KAAK2hB,qBAEhBD,gBAAiB,SAAU1gB,EAASqgB,GAChC,IAAIU,EAAQ/gB,GAAWA,EAAQ6P,OAAS7P,EAAQ6P,OAAS,EACrDmR,EAAOhhB,GAAWA,EAAQ8P,MAAQiR,EAAQ/gB,EAAQ8P,MAAQ9Q,KAAKuhB,UAAUxe,OACzEkf,EAAcjiB,KAAKkiB,gBAAgBliB,KAAKuhB,UAAWQ,EAAOC,GAC9DX,EAAS1a,QAAQ,CACbpC,KAAM0d,EACNpP,MAAO7S,KAAKuhB,UAAUxe,UAG9B0e,cAAe,WACX,OAAOzhB,KAAKshB,UAEhBM,cAAe,SAAUrd,GAGrB,IAFA,IAAI4d,EAAe,GACfC,EAAI,EACC1U,EAAI,EAAGA,EAAInJ,EAAKxB,OAAQ2K,IAAK,CAClC,IAAIjN,EAAQ8D,EAAKmJ,SACchF,IAAhBjI,EAAMC,MAAsBD,EAAMA,MAAQA,EAAMC,OAClDmM,cAAclK,QAAQ3C,KAAKshB,SAASzU,gBAAkB,IAC/DsV,EAAaC,GAAK3hB,EAClBT,KAAKmhB,aAAaiB,GAAK1U,EACvB1N,KAAK2hB,oBAAoBjU,GAAK0U,EAC9BA,GAAK,GAGb,OAAOD,GAEXD,gBAAiB,SAAU9gB,EAAQ2gB,EAAOC,GACtCA,EAAO1U,KAAKC,IAAIyU,EAAM5gB,EAAO2B,QAE7B,IADA,IAAI5C,EAAS,GACJuN,EAAIqU,EAAOrU,EAAIsU,EAAMtU,IAC1BvN,EAAOsZ,KAAK,CACR/Y,MAAOU,EAAOsM,GAAGhN,MACjBD,MAAOW,EAAOsM,GAAGjN,QAGzB,OAAON,KAGf,UChFA,IACIkiB,EAAQrK,IAAE,QACVsK,EAAkB,SAAUthB,GAE5B,OADAhB,KAAK0D,WAAW1C,GACThB,MAEXrB,WAAS2jB,EAAgB9R,UAAW,CAChC9M,WAAY,SAAU1C,GAClBrC,YAAUqB,KAAM,cAAe,gBAC/BA,KAAKuiB,YAAcvhB,EAAQwhB,WAC3BxiB,KAAKyiB,WAAazhB,EAAQyhB,WAC1BziB,KAAK0iB,gBAAkB1hB,EAAQ0hB,iBAAmB1iB,KAAK2iB,iBACvD3iB,KAAK4iB,eAAiB5hB,EAAQ4hB,gBAZF,IAa5B5iB,KAAK6iB,gBAAkB7hB,EAAQ6hB,iBAEnCC,UAAW,WACP9iB,KAAK+iB,YAAY/iB,KAAKgjB,cACtB9D,cAAclf,KAAKijB,aACnBjjB,KAAKijB,YAAc7E,YAAYzf,SAAOqB,KAAK+iB,YAAa/iB,KAAMA,KAAK6iB,iBAAkB7iB,KAAK4iB,iBAE9FM,SAAU,WACNhE,cAAclf,KAAKijB,cAEvBF,YAAa,SAAUhI,GACnB,IAAIoI,EAAmBnjB,KAAKyiB,aACxBW,EAAgBpjB,KAAKuiB,YAAYc,WACjCC,EAAajB,EAAMxR,UACnByS,EAAW/P,KAAO+P,EAAWhH,QAC7B8G,EAAc7P,KAAO+P,EAAW/P,IAChC6P,EAAc9G,MAAQgH,EAAWhH,MAEjCtc,KAAKuiB,YAAYgB,UAAYJ,EAAiBI,OAC9CvjB,KAAKgjB,aAAaG,GAElBnjB,KAAK0iB,gBAAgBU,EAAeD,IACpCpI,GAAYA,EAASoI,IAG7BH,aAAc,SAAUQ,GACpBxjB,KAAKuiB,YAAYkB,IAAI,MAAOD,EAAcjQ,IAAM8O,EAAMxR,SAAS0C,KAAKkQ,IAAI,OAAQD,EAAclH,KAAO+F,EAAMxR,SAASyL,MAAMmH,IAAI,QAASD,EAAcD,QAEzJZ,iBAAkB,SAAUe,EAAmBF,GAC3C,OAAOlW,KAAKqG,MAAM+P,EAAkBnQ,OAASjG,KAAKqG,MAAM6P,EAAcjQ,MAAQjG,KAAKqG,MAAM+P,EAAkBpH,QAAUhP,KAAKqG,MAAM6P,EAAclH,SAGtJ,U,eCjEQ,IAAIqH,EAEA,gCAAkC,KAClC,gCAAuC,iCAAwC,GAC/EA,EAAS,iCAETA,EAASC,OAAOta,KAAK,KAAOua,QAAO,CAACC,EAAKza,KAC9B,IACAya,KACA,IAAMza,MAEd,IAGP,U,oPC8BR,IAAIgZ,EAAQrK,IAAE,QAmpBd,QAjpBmBvF,gBAAqB,CAEpC+D,OAAQ,WACJ,MAAO,CACH,QAAWxW,KAAK+jB,gBAAgBlS,UAChC,MAAS7R,KAAK+jB,gBAAgBlS,UAC9B,cAAe,UACf,aAAc,SACd,UAAa,cACb,QAAW,YACX,gCAAiC,mBAIzCnO,WAAY,SAAS1C,GACjBrC,YAAUqB,KAAM,kBAAmB,oBAC/B,oBAAqB,cAAe,wBAAyB,YAE5DA,KAAKyW,QACNzW,KAAKyW,MAAQ,IAAIhE,YAGrBzS,KAAKyW,MAAMrU,IAAI,YAAY,EAAO,CAAC6O,QAAQ,IAC3CjR,KAAKyW,MAAMrU,IAAI,WAAY,GAAI,CAAC6O,QAAQ,IACxCjR,KAAKyW,MAAMrU,IAAI,QAAS,GAAI,CAAC6O,QAAQ,IAErC,IAAIjO,EC3EZ,6kBDgFY+G,cAA6BA,gBAC7B/G,EEjFZ,kgBFoFQhD,KAAKgkB,iBAAkB,EACvBhkB,KAAKU,MAAQM,EAAQN,MACrBV,KAAKgD,SAAWrE,aAAWqC,EAAQgC,UAAYA,GAC/ChD,KAAKikB,iBAAmBtlB,aAAWqC,EAAQijB,kBGvFnD,kKHyFQjkB,KAAK+jB,gBAAkB,IAAI5S,EAAgB,CACvCK,eAAgBxQ,EAAQwQ,eACxBC,QAASzR,KACT0R,uBAAwB1R,KAAKkkB,eAC7BvS,yBAA0B3R,KAAK2R,yBAC/BC,wBAAyB5R,KAAK4R,wBAC9BL,iBAAiB,IAIrBvR,KAAKmkB,cAAgBnkB,KAAKokB,qBAAqBpjB,GAG/ChB,KAAKqkB,SAAWrkB,KAAKskB,gBAAgBtjB,GAErChB,KAAKuI,SAELvI,KAAKukB,gBAAkB,IAAIjC,EAAgB,CACvCE,WAAYxiB,KAAKwkB,qBACjB/B,WAAYziB,KAAKykB,sBACjB/B,gBAAiB1iB,KAAK0kB,+BACtB7B,gBAAiB7iB,KAAK2kB,WAG1B3kB,KAAKkX,gBACLlX,KAAKmI,SAASnH,EAAQP,MAAO,CACzBof,aAAc,CAAC5O,QAAQ,MAI/BqT,gBAAiB,SAAStjB,GACtB,OAAO,IAAI4jB,EAAiB,CACxBC,GAAI7jB,EAAQ8jB,aAAe9M,IIzHvC,sLJ0HYvB,MAAOzW,KAAKmkB,cACZzN,eAAgB1V,EAAQ0V,eACxBC,cAAe3V,EAAQ2V,eK5HnC,gmBL6HY/M,cAAe5I,EAAQ4I,iBAI/Bwa,qBAAsB,SAASpjB,GAG3B,OAFAhB,KAAK+kB,wBAA0B,IAAI7D,EAAwB,CAACtQ,QAAS5P,EAAQ4P,UAEtE,IAAImF,EAAsB,CAC7BnF,QAAS5Q,KAAKglB,cACdtS,WAAY1R,EAAQ0R,WACpBC,WAAY3R,EAAQ2R,cAI5BqS,YAAa,WACT,OAAOhlB,KAAK+kB,wBAAwBnU,SAGxCqU,qBAAsB,SAASjU,GAC3B,IAAImQ,EAAenhB,KAAK+kB,wBAAwBlD,kBAChD,OAAOV,EAAeA,EAAanQ,EAAOb,OAASa,EAAOb,OAM9D+G,cAAe,WACXlX,KAAKmX,SAASnX,KAAKqkB,SAAU,mBAAoBrkB,KAAKklB,gBAAiBllB,MACvEA,KAAKmX,SAASnX,KAAKqkB,SAAU,eAAgBrkB,KAAKmlB,YAAanlB,MAC/DA,KAAKmX,SAASnX,KAAKqkB,SAAU,kBAAmBrkB,KAAKolB,gBAAiBplB,MACtEA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKqlB,oBAAqBrlB,MACvEA,KAAKmX,SAASnX,KAAKyW,MAAO,eAAgBzW,KAAKslB,YAAatlB,MAC5DA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKulB,eAAgBvlB,MAClEA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKwlB,aAAcxlB,MAEhEA,KAAKuiB,YAAYhS,GAAG,YAAavQ,KAAK8b,aAEtCuG,EAAM9R,GAAG,YAAavQ,KAAKylB,mBACtBlV,GAAG,gBAAiBvQ,KAAKylB,mBACzBlV,GAAG,UAAWvQ,KAAK4c,iBACnBrM,GAAG,YAAavQ,KAAK6c,oBAG9BtU,OAAQ,WAEJ,IAAImd,EAAe1N,IAAEhY,KAAKgD,SAAS,CAC/BtC,MAAOV,KAAKU,MACZilB,OAAQ5b,aACRtJ,MAAOT,KAAKyW,MAAMlP,IAAI,SAAS7G,MAC/BklB,SAAU5lB,KAAKyW,MAAMlP,IAAI,YACzBse,KAAMA,KAaV,OAVA7lB,KAAK8lB,iBAEL9lB,KAAK6X,IAAIxJ,QACTrO,KAAK6X,IAAIrJ,OAAOkX,GAEhB1lB,KAAK+lB,cAAgBL,EACrB1lB,KAAKgmB,aAAehmB,KAAK6X,IAAI3V,KAAK,4BAClClC,KAAKimB,YAAcjmB,KAAK6X,IAAI3V,KAAK,2BACjClC,KAAKkmB,OAASlmB,KAAKgmB,aAAa9jB,KAAK,SAE9BlC,MAGX8lB,eAAgB,WACP9lB,KAAKmmB,eACNnmB,KAAKwkB,qBAAuBxM,IAAEhY,KAAKikB,iBAC/B,CAAC0B,OAA+B,SAAvB3W,UAAUoX,YAEvBpmB,KAAKuiB,YAAcviB,KAAKwkB,qBAAqBtiB,KAAK,8BAElDlC,KAAKqkB,SAASnI,mBACdlc,KAAKuiB,YAAY/T,OAAOxO,KAAKqkB,SAASxM,KACtCwK,EAAM7T,OAAOxO,KAAKwkB,sBAClBxkB,KAAKqkB,SAASxI,iBAEd7b,KAAKmmB,cAAe,GAGxBnmB,KAAKqmB,cAAgBrmB,KAAKwkB,qBAAqBtiB,KAAK,qBAEpDlC,KAAKyW,MAAMlP,IAAI,YACTvH,KAAKwkB,qBAAqB8B,OAC1BtmB,KAAKwkB,qBAAqB+B,QAGpCzO,WAAY,WAER,OADA9X,KAAKqkB,SAASvM,aACP9X,MAIXolB,gBAAiB,SAAS9R,EAAgBnS,GACtCnB,KAAKgI,QAAQ,kBAAmBsL,EAAgBnS,IAGpDgkB,YAAa,WACT,IAAInlB,KAAKyW,MAAMlP,IAAI,YAAnB,QAKOvH,KAAKwmB,YAGZxmB,KAAKkmB,OAAOO,QAEZ,IAAIC,EAAc1mB,KAAKyW,MAAMlP,IAAI,eAE7Bmf,EAAYjmB,QAAUT,KAAKyW,MAAMlP,IAAI,SAAS9G,OAC9CT,KAAKyW,MAAMkQ,MAAM,eACjB3mB,KAAKyW,MAAMrU,IAAI,QAASskB,IAExB1mB,KAAK2kB,aAIbO,gBAAiB,WACb,IAAIlU,EAAShR,KAAKqkB,SAASvD,iBAEvB9P,GACAhR,KAAKqkB,SAASnJ,SAASlK,EAAOb,OAE9BnQ,KAAKyW,MAAMrU,IAAI,cAAe,CAC1B3B,MAAOuQ,EAAOvQ,MACdC,MAAOsQ,EAAOtQ,MACdyP,MAAOnQ,KAAKilB,qBAAqBjU,KAGrChR,KAAK4mB,yBAEL5mB,KAAKyW,MAAMkQ,MAAM,gBAIzBE,eAAgB,WACZ7mB,KAAKyW,MAAMlP,IAAI,YAAcvH,KAAK2kB,WAAa3kB,KAAK8mB,UAGxDC,QAAS,WACA/mB,KAAKyW,MAAMlP,IAAI,aAChBvH,KAAKimB,YAAYtH,SAAS,iBAIlCqI,OAAQ,WACChnB,KAAKwmB,cACNxmB,KAAK2kB,WAEL3kB,KAAKimB,YAAY3H,YAAY,kBAIrCxC,YAAa,WACT9b,KAAKwmB,aAAc,GAGvBvF,UAAW,WACHjhB,KAAKwmB,qBACExmB,KAAKwmB,YAERxmB,KAAKyW,MAAMlP,IAAI,aACfvH,KAAKkmB,OAAOO,UAKxBpB,oBAAqB,SAAS5O,GACtBA,EAAMlP,IAAI,YACVvH,KAAKinB,WAELjnB,KAAKknB,cAIb5B,YAAa,WACTtlB,KAAK2kB,WACL3kB,KAAKmnB,qBAEAnnB,KAAKiR,cAGCjR,KAAKiR,OAFZjR,KAAKgI,QAAQ,mBAAoBhI,KAAKyW,MAAMlP,IAAI,SAAS9G,OAK7DT,KAAKkmB,OAAO3c,IAAI,IAChBvJ,KAAKyW,MAAMrU,IAAI,WAAY,KAG/BmjB,eAAgB,WACZ,IAAItc,EAAWjJ,KAAKyW,MAAMlP,IAAI,YAE1B0B,GACAjJ,KAAKkmB,OAAO5X,KAAK,WAAY,YAC7BtO,KAAK2kB,YAEL3kB,KAAKkmB,OAAOkB,WAAW,YAG3BpnB,KAAKqkB,SAAStE,YAAY9W,IAG9Bwc,kBAAmB,SAASza,GACxB,GAAIhL,KAAKyW,MAAMlP,IAAI,YAAa,CAC5B,GAAIyD,EAAM0M,SAAW1X,KAAK6kB,IAAM7kB,KAAK6X,IAAI3V,KAAK8I,EAAM0M,QAAQ3U,OAAS,GACjEiI,EAAM0M,SAAW1X,KAAKuiB,YAAY,IAAMviB,KAAKuiB,YAAYrgB,KAAK8I,EAAM0M,QAAQ3U,OAAS,EAGrF,YADA/C,KAAKkmB,OAAOO,QAIhBzmB,KAAKwmB,aAAc,EAEvBxmB,KAAKgnB,UAGTpK,gBAAiB,WACb5c,KAAKihB,aAGTpE,kBAAmB,SAAS7R,GACpBhL,KAAKwmB,aACLxb,EAAMuG,mBAMd8V,QAAS,WACL,GAAKrnB,KAAKyW,MAAMlP,IAAI,YAEb,CACH,IAAIyJ,EAAShR,KAAKqkB,SAASvD,iBAE3B,IAAK9P,GAA2B,IAAjBA,EAAOb,MAElB,YADAnQ,KAAK2kB,WAGL3kB,KAAKqkB,SAAS1D,wBARlB3gB,KAAK8mB,UAabQ,UAAW,WACFtnB,KAAKyW,MAAMlP,IAAI,YAGHvH,KAAKqkB,SAASvD,iBAGvB9gB,KAAKqkB,SAAS5D,eAEdzgB,KAAKqkB,SAAS9D,gBAPlBvgB,KAAK8mB,UAYbS,WAAY,SAASvc,GACjBA,EAAMwH,iBAEDxS,KAAKyW,MAAMlP,IAAI,YAGZvH,KAAKyW,MAAMlP,IAAI,eACfvH,KAAKmlB,cAELnlB,KAAK2kB,WALT3kB,KAAK8mB,UAUbU,SAAU,WACFxnB,KAAKyW,MAAMlP,IAAI,aACfvH,KAAK2kB,YAIb8C,UAAW,WACFznB,KAAKyW,MAAMlP,IAAI,YAGhBvH,KAAKqkB,SAAS9D,gBAFdvgB,KAAK8mB,UAMbY,SAAU,WACD1nB,KAAKyW,MAAMlP,IAAI,YAGhBvH,KAAKqkB,SAAS7D,eAFdxgB,KAAK8mB,UAMba,YAAa,WACJ3nB,KAAKyW,MAAMlP,IAAI,YAGhBvH,KAAKqkB,SAASxD,SAFd7gB,KAAK8mB,UAMbc,cAAe,WACN5nB,KAAKyW,MAAMlP,IAAI,YAGhBvH,KAAKqkB,SAASzD,WAFd5gB,KAAK8mB,UAMbe,SAAU,aAMVC,oBAAqB,WAEjB,IAAIC,EAAe/P,IAAE,QAAQL,YACzB9G,EAAS7Q,KAAK6X,IAAIhH,SAClBmX,EAAWhoB,KAAK6X,IAAI6B,SACpBuO,EAAoBjoB,KAAKgmB,aAAanM,cAEtCqO,EAAYrX,EAAO0C,IAAMwU,EACzBI,EAAenQ,IAAE/U,QAAQyW,SAAWwO,EAAYF,EAEpDhoB,KAAKgkB,gBAAkBkE,EAAYC,EAGnC,IAAIC,EAAUpoB,KAAKgkB,gBAAkBkE,EAAaC,EAClDC,GAAWH,EAAoBD,EAE/BhoB,KAAKqmB,cAAc5C,IAAI,aAAe2E,EAAW,OAGrDnB,SAAU,WACNjnB,KAAK8nB,sBAED9nB,KAAKgkB,kBACLhkB,KAAKuiB,YAAY5D,SAAS,gCAC1B3e,KAAK+lB,cAAcpH,SAAS,wBAGhC3e,KAAKgmB,aAAarH,SAAS,aAC3B3e,KAAKimB,YAAYtH,SAAS,aAC1B3e,KAAKimB,YAAY3H,YAAY,gBAC7Bte,KAAKkmB,OAAOO,QAEZzmB,KAAKqkB,SAAS/M,WACdtX,KAAKqoB,iBAEDroB,KAAKqkB,SAAStN,KACd/W,KAAKqkB,SAAShc,MAAM1J,SAAOqB,KAAKqkB,SAAS1J,OAAQ3a,KAAKqkB,WAEtDrkB,KAAKqkB,SAAS1J,cAG2B,IAAlC3a,KAAKyW,MAAMlP,IAAI,SAAS9G,OAC/BT,KAAKsoB,iBAGTtoB,KAAKgI,QAAQ,SAAUhI,OAG3BqoB,eAAgB,WACZroB,KAAKwkB,qBAAqB8B,OAC1BtmB,KAAKukB,gBAAgBzB,aAGzBoE,WAAY,WACRlnB,KAAKyW,MAAMkQ,MAAM,eACjB3mB,KAAKgmB,aAAa1H,YAAY,aAC9Bte,KAAKimB,YAAY3H,YAAY,aAE7Bte,KAAKuiB,YAAYjE,YAAY,gCAC7Bte,KAAK+lB,cAAczH,YAAY,uBAE/Bte,KAAKimB,YAAYtH,SAAS,gBAC1B3e,KAAKkmB,OAAO3c,IAAI,IAChBvJ,KAAKwkB,qBAAqB+B,OAC1BvmB,KAAKyW,MAAMrU,IAAI,WAAY,IAC3BpC,KAAKukB,gBAAgBrB,WACrBljB,KAAKgI,QAAQ,WAAYhI,OAG7BykB,sBAAuB,WACnB,IACI5T,EAAS7Q,KAAK6X,IAAIhH,SAClByL,EAAO+F,EAAMxR,SAASyL,KAAOzL,EAAOyL,KACpC0L,EAAWhoB,KAAK6X,IAAI6B,SASxB,MAAO,CACHnG,IARAvT,KAAKgkB,gBACC3B,EAAMxR,SAAS0C,IAAM1C,EAAO0C,IAAOvT,KAAKgmB,aAAanM,cAErDwI,EAAMxR,SAAS0C,IAAM1C,EAAO0C,IAAMyU,EAAWhoB,KAAKgmB,aAAatM,SAMrE4C,KAAMA,EACNiH,MAAOvjB,KAAK6kB,GAAG0D,wBAAwBhF,QAI/CmB,+BAAgC,SAAShB,EAAmBF,GAGxD,OAAQlW,KAAKmS,IAAIiE,EAAkBnQ,IAAMiQ,EAAcjQ,KADrC,GAEXjG,KAAKmS,IAAIiE,EAAkBpH,KAAOkH,EAAclH,MAFrC,GAKtB3K,yBAA0B,SAAS3G,GAC/B,OAAQhL,KAAKyW,MAAMlP,IAAI,aAG3BqK,wBAAyB,SAAS5G,GAC9BhL,KAAK8mB,SACL9mB,KAAK+jB,gBAAgB9R,4BAA4BjH,IAGrDkZ,eAAgB,WACZlkB,KAAKyW,MAAMrU,IAAI,WAAYpC,KAAKkmB,OAAO3c,QAG3Cic,aAAc,WACV,IAAI7U,EAAO3Q,KACXA,KAAKglB,aAALhlB,CAAmB,CAACshB,SAAUthB,KAAKyW,MAAMlP,IAAI,cAAcb,MAAK,WAC5DiK,EAAK0T,SAAShc,OAAM,WAChBsI,EAAK2X,wBAKjBA,eAAgB,SAAStnB,GACrB,IAAIP,EAAQT,KAAKyW,MAAMlP,IAAI,SAEvBQ,EAAYtH,EAAMA,MAEtB,QAA2B,IAAhBA,EAAM0P,MAAuB,CACpC,IAAIgR,EAAenhB,KAAK+kB,wBAAwBjD,yBAE5C3R,EAASgR,EAAeA,EAAa1gB,EAAM0P,OAAS1P,EAAM0P,MAC9DpI,EAAY,QAES,IAAVoI,IACPpI,EAAUoI,GAAS1P,EAAMA,OAIjCT,KAAKqkB,SAASlc,SAASJ,EAAW/G,IAItCwnB,qCAAsC,SAAS/nB,GAC3C,IAAIgoB,EAAgB,GAEpB,QAAqB,IAAVhoB,EACP,GAAqB,iBAAVA,GAAgC,OAAVA,EAC7BgoB,EAAgB,CAAChoB,MAAOA,QAExB,IAAK,IAAI0P,KAAS1P,EACd,GAAIA,EAAMgV,eAAetF,SAA2BzH,IAAjBjI,EAAM0P,GAAsB,CAGvDsY,EADwB,WAAxB,EAAOhoB,EAAM0P,IACG,CACZ1P,MAAOA,EAAM0P,GAAO1P,MACpB0P,MAAO2F,SAAS3F,EAAO,IACvBzP,MAAOD,EAAM0P,GAAOzP,OAGR,CACZD,MAAOA,EAAM0P,GACbA,MAAO2F,SAAS3F,EAAO,KAG/B,MAMhB,OAAOsY,GAGX7B,sBAAuB,WACnB,IAAInmB,EAAQT,KAAKyW,MAAMlP,IAAI,SACvBmf,EAAc1mB,KAAKyW,MAAMlP,IAAI,eAE7B9G,EAAMA,QAAUimB,EAAYjmB,YAAgC,IAAhBA,EAAMC,QAClDD,EAAMC,MAAQgmB,EAAYhmB,MAC1BV,KAAKmnB,uBAIbA,mBAAoB,WAChB,IAGIzmB,EAHAD,EAAQT,KAAKyW,MAAMlP,IAAI,SACvBmhB,EAAyB1oB,KAAKimB,YAAY/jB,KAAK,uCAC/CymB,EAAuB3oB,KAAKimB,YAAY/jB,KAAK,qCAG7CvD,YAAU8B,IAAyB,MAAfA,EAAMA,OAC1BioB,EAAuBpK,YAAY,eACnCte,KAAKuI,WAEL7H,EAAQV,KAAK4oB,uBAAuBnoB,GACpCioB,EAAuB/J,SAAS,eAChC3e,KAAKimB,YAAY3X,KAAK,QAAS5N,GAC/BioB,EAAqBE,KAAKC,eAAmBpoB,MAIrDkoB,uBAAwB,SAAUnoB,GAC9B,OAAsB,MAAfA,EAAMC,MACPD,EAAMA,MACNA,EAAMC,OAKhB2H,MAAO,SAAS0S,EAAU/Z,GAEtB,OADAhB,KAAKqkB,SAAShc,MAAM0S,EAAU/Z,GACvBhB,MAGX8I,MAAO,SAAS9H,GAEZ,OADAhB,KAAKqkB,SAASvb,MAAM9H,GACbhB,MAGX8mB,OAAQ,WACJ,IAAI9mB,KAAKyW,MAAMlP,IAAI,YAKnB,OADAvH,KAAKyW,MAAMrU,IAAI,YAAY,GACpBpC,MAGX2kB,SAAU,WAEN,OADA3kB,KAAKyW,MAAMrU,IAAI,YAAY,GACpBpC,MAGXsf,SAAU,WACN,OAAOtf,KAAKyW,MAAMlP,IAAI,SAAS9G,OAGnC0H,SAAU,SAAS1H,EAAOO,GACtBP,EAAQT,KAAKwoB,qCAAqC/nB,GAE9CO,GAAWA,EAAQiQ,SACnBjR,KAAKiR,QAAS,GAGlBjR,KAAKyW,MAAMrU,IAAI,QAAS3B,GACxBT,KAAKsoB,kBAGTvI,YAAa,SAAS9W,GAElB,OADAjJ,KAAKyW,MAAMrU,IAAI,WAAY6G,GACpBjJ,MAGX8c,YAAa,WACT,OAAO9c,KAAKyW,MAAMlP,IAAI,aAG1ByY,OAAQ,WACJhgB,KAAKuiB,YAAYjS,IAAI,YAAatQ,KAAK8b,aAAakE,SACpDhgB,KAAKqkB,SAASrE,SACdhgB,KAAKwkB,qBAAqBxE,SAC1BvN,+BAAoCzS,MACpCqiB,EAAM/R,IAAI,YAAatQ,KAAKylB,mBACvBnV,IAAI,gBAAiBtQ,KAAKylB,mBAC1BnV,IAAI,UAAWtQ,KAAK4c,iBACpBtM,IAAI,YAAatQ,KAAK6c,sBMjoBnC,QAtCyCtH,SAAkC,CACvExB,gBAAiB,SAAUtT,EAAO0P,GAC9BnQ,KAAK+H,UAAUtH,IAAS,GAE5BuT,qBAAsB,SAAUvT,EAAO0P,UAC5BnQ,KAAK+H,UAAUtH,IAE1BwT,gBAAiB,WACbjU,KAAK+H,UAAY,IAErBmM,mBAAoB,SAAUzT,EAAO0P,GACjC,OAAOnQ,KAAK+H,UAAUtH,IAE1B0T,cAAe,WACX,OAAOxV,SAAOqB,KAAK+H,YAEvB+L,OAAQ,SAAU/L,EAAW/G,GAEzB,GADAhB,KAAKiU,kBACoB,iBAAdlM,EACP/H,KAAK+T,gBAAgBhM,QAClB,GAAIpJ,YAAUoJ,GACjB,IAAK,IAAI2F,EAAI,EAAGA,EAAI3F,EAAUhF,OAAQ2K,IAClC1N,KAAK+T,gBAAgBhM,EAAU2F,SAEhC,QAAyB,IAAd3F,EACd,IAAK,IAAIsB,KAAOtB,EACZ,GAAIA,EAAU0N,eAAepM,GAAM,CAC/B,IAAI5I,EAAQsH,EAAUsB,QACRX,IAAVjI,GACAT,KAAK+T,gBAAgBtT,EAAO4I,GAK5CrJ,KAAK+oB,cAAgB/oB,KAAK+oB,aAAahhB,EAAW/G,GAClDhB,KAAKoU,wBAAwBpT,MCnCrC,IAAIgoB,EAAgBC,YAUpB,QAT+BlT,SAA6B,CACxDhC,gBAAiBiV,EAAcjV,gBAC/BC,qBAAsBgV,EAAchV,qBACpCC,gBAAiB+U,EAAc/U,gBAC/BC,mBAAoB8U,EAAc9U,mBAClCC,cAAe6U,EAAc7U,cAC7B0B,8BAA0BnN,EAC1ByN,QAAS6S,EAAclV,SCN3B,SAASoV,EAAYC,EAAmBphB,GACpC,GAAIA,GAAkC,iBAAdA,IACf/H,KAAKkR,YAAa,CACnB,IAAIf,EAAQgZ,EAAkBphB,QACT,IAAVoI,GACP8F,iBAA4CjW,KAAM,CAC9CmQ,MAAOA,EACPD,KAAM,CAAEzP,MAAOsH,GACfkJ,QAAQ,KAuE5B,QAjEsBmY,SAAoB,CACtC1lB,WAAY,SAAU1C,GAClBrC,YAAUqB,KAAM,sBAChBA,KAAKqpB,YAAcroB,EAAQqoB,YAC3BD,4BAAuCppB,KAAMgB,IAEjDojB,qBAAsB,SAAUpjB,GAE5B,OADAhB,KAAK4Q,QAAU5P,EAAQ4P,QAChB5P,EAAQyV,OAAS9X,WAAS,IAAI2qB,EAAyBtoB,GAAU,CAAE+nB,aAAcpqB,YAAUuqB,EAAalpB,KAAKupB,uBAExHA,mBAAoB,SAAUxhB,GAG1B,IAFA,IAAIgL,EAAmB/S,KAAKmkB,cAAc5c,IAAI,oBAC1CwI,EAAQ/P,KAAKmkB,cAAc5c,IAAI,SAC1BmG,EAAI,EAAGA,EAAIqC,EAAMhN,OAAQ2K,IAC9B,GAAI3F,IAAcgI,EAAMrC,GAAGjN,MACvB,OAAOsS,EAAmBrF,GAKtCsX,YAAa,WACT,OAAOhlB,KAAK4Q,SAEhBqU,qBAAsB,SAAUjU,GAC5B,OAAOhR,KAAKupB,mBAAmBvY,EAAOvQ,QAE1C+kB,aAAc,WACV,IAAIpb,EAAOpK,KACPshB,EAAWthB,KAAKyW,MAAMlP,IAAI,YAC9BvH,KAAKqkB,SAASnJ,SAAS,GACvBlb,KAAKglB,aAALhlB,CAAmB,CACfshB,SAAUA,EACVzQ,OAAQ,EACRC,MAAO,IACRpK,MAAK,WACJ0D,EAAKia,SAAShc,OAAM,WAChB+B,EAAKia,SAAS1J,SACdvQ,EAAKke,wBAIjBM,uBAAwB,SAAUnoB,GAC9B,OAAsB,MAAfA,EAAMC,MAAgBV,KAAKqpB,YAAcrpB,KAAKqpB,YAAY5oB,EAAMA,OAASA,EAAMA,MAAQA,EAAMC,OAExGyH,SAAU,SAAU1H,EAAOO,GACvBP,EAAQT,KAAKwoB,qCAAqC/nB,GAC9CO,GAAWA,EAAQiQ,SACnBjR,KAAKiR,QAAS,GAElBjR,KAAKyW,MAAMrU,IAAI,QAAS3B,GACxBT,KAAKsoB,eAAetnB,GACjBhB,KAAKiR,eACGjR,KAAKiR,QAGpBqX,eAAgB,SAAUtnB,GACtB,IAAI+G,EAAY/H,KAAKyW,MAAMlP,IAAI,SAAU9G,EAAQ,GAC7CsH,GAAaA,EAAUoI,MACvB1P,EAAMsH,EAAUoI,OAASpI,EAAUtH,MAC5BsH,IACPtH,EAAQsH,EAAUtH,OAEtBT,KAAKqkB,SAASlc,SAAS1H,EAAOO,M,eC9EtC,QAC8B,SAAUA,GAChC,IAAKA,IAAYA,EAAQ6jB,GACrB,KAAM,8BAiBV,GAfAlmB,aAAWqC,EAAS,CAChByiB,IAAK,GACL+F,QAAS,GACTrb,UAAW,cACXsb,SAAU,OACV1O,SAAU,WACN,KAAM,2BAEV2O,aAAa,EACbC,eAAe,IAEnBhrB,aAAWqC,EAAQyiB,IAAK,CACpB,SAAY,WACZ,KAAQ,aAEPziB,EAAQ0oB,aAAe1R,IAAEhX,EAAQ6jB,IAAIjK,GAAG,YACzC5Z,EAAQ+Z,SAAS/C,IAAEhX,EAAQ6jB,SACxB,CACH,IAAIhN,EAAMG,IAAEhX,EAAQ6jB,IAAI+E,QACpBC,EAAO7R,IAAEhX,EAAQmN,WAAWsV,IAAIziB,EAAQyiB,KAAK9E,SAAS3d,EAAQwoB,SAASC,SAASzR,IAAEhX,EAAQyoB,WAAWjb,OAAOqJ,GAChH7W,EAAQ+Z,SAASlD,GACjBgS,EAAK7J,WCvBjB,IAAI8J,EAAiCC,EAsErC,SApE6C,CACzCxhB,OAAQ,WAKJ,OAJKvI,KAAKgqB,iBACNhqB,KAAKiqB,kBACLjqB,KAAKgqB,gBAAiB,GAEnBhqB,MAEXiqB,gBAAiB,WACb,IAAI7f,EAAOpK,KACXA,KAAKkqB,OAASlqB,KAAKyW,MACnBzW,KAAKmqB,MAAQnqB,KAAK+W,KAClB/W,KAAKoqB,YAAcpqB,KAAK6X,IAAI4L,IAAI,cAChCzjB,KAAKqqB,SAAWrqB,KAAK6X,IAAI4L,IAAI,WAC7BzjB,KAAKyW,MAAQ,IAAI5C,EAAkB,CAC/BjD,QAAS,WACL,IAAIyQ,EAAW,IAAIrJ,cAQnB,OAPAqJ,EAAS1a,QAAQ,CACbkM,MAAO,EACPtO,KAAM,CAAC,CACH9D,MAAO,aACPC,MAAO,iBAGR2gB,KAGfrhB,KAAK6X,IAAI4L,IAAI,CACT,WAAc,SACd,QAAW,UAEfzjB,KAAKyW,MAAMwE,KAAK,SAAUjb,KAAKoX,cAAepX,MAC9CA,KAAK8X,aACLgS,EAA+B,CAC3BjF,GAAI7kB,KAAK6X,IACT4L,IAAK,CAAE,MAAS,SAChB+F,QAAS,QAAUzf,aAA4B,OAAS,IACxDgR,SAAU,SAAUlD,GAChBzN,EAAKyO,WAAahB,EAAI3V,KAAK,MAAM2X,aAAY,GAC7CzP,EAAKiO,cAAgB/K,KAAKqG,MAAMvJ,EAAKwM,mBAAqBxM,EAAKyO,YAC/DzO,EAAKyM,YAAczM,EAAKiO,cAAgBjO,EAAKyO,cAGrD7Y,KAAK6X,IAAIxJ,QAAQoV,IAAI,CACjB,WAAczjB,KAAKoqB,YACnB,QAAWpqB,KAAKqqB,kBAEbrqB,KAAKoqB,mBACLpqB,KAAKqqB,SACZrqB,KAAK4Y,gBAAalQ,EAClB1I,KAAKqZ,qBAAkB3Q,EACvB1I,KAAKyW,MAAQzW,KAAKkqB,cACXlqB,KAAKkqB,OACZlqB,KAAK+W,KAAO/W,KAAKmqB,MACjBnqB,KAAKmqB,cAAgBnqB,KAAKmqB,OAE9BxQ,uBAAwB,WACpB,IAAK3Z,KAAK4Z,6BAA8B,CACpC,IAAK5Z,KAAKgqB,eACN,OAEJhqB,KAAK8Z,sBACL9Z,KAAKkZ,mBAAkB,GACvBlZ,KAAKiY,eACLjY,KAAK4Z,8BAA+B,KC5FhD,0MCiDA,IAAIkQ,GAAiCC,EAEjCO,GAAe,CACf,CACIC,SAAU,iBACVC,QAAS,CACL3E,+BACAA,yBACA,KAGR,CACI0E,SAAU,kBACVC,QAAS,CACL3E,iCACAA,0BACA,KAGR,CACI0E,SAAU,cACVC,QAAS,CACL3E,6BACA,MA0pBZ,SArpByBpT,gBAAqB,CAE1CgY,UAAW,+CAEXjU,OAAQ,WACJ,MAAO,CACH,iCAAkCxW,KAAK+jB,gBAAgBlS,UACvD,+BAAgC,UAChC,8BAA+B,SAC/B,uBAAwB,cACxB,wBAAyB,eACzB,oBAAqB,oBACrB,+BAAgC,iBAChC,kCAAmC,iBACnC,UAAa,cACb,QAAW,cAInBR,gBAAiB1S,WAAS,CACtB,GAAM,UACPwS,6BAEHzN,WAAY,SAAS1C,GAgBjB,IAAIgC,EAfJrE,YAAUqB,KAAM,kBAAmB,oBAAqB,WAAY,oBAChE,cAAe,YAAa,WAAY,cAAe,eACvD,qBAEJA,KAAK0qB,mBAAqB/rB,aAAWqB,KAAK2qB,SAAU,KAE/C3qB,KAAKyW,QACNzW,KAAKyW,MAAQ,IAAIhE,YAGrBzS,KAAKyW,MAAMrU,IAAI,WAAY,GAAI,CAAC6O,QAAQ,IAQpCjO,EADA+G,cAA6BA,aCtHzC,o/CCAA,2iDF4HQ/J,KAAKU,MAAQM,EAAQN,MACrBV,KAAKgD,SAAWrE,aAAWqC,EAAQ4pB,wBAA0B5nB,GAE7DhD,KAAK+jB,gBAAkB,IAAI5S,EAAgB,CACvCE,gBAAiBrR,KAAKqR,gBACtBG,eAAgBxQ,EAAQwQ,eACxBC,QAASzR,KACT0R,uBAAwB1R,KAAKkkB,eAC7BvS,yBAA0B3R,KAAK2R,yBAC/BC,wBAAyB5R,KAAK4R,wBAC9BL,iBAAiB,IAGrBvR,KAAKmkB,cAAgBnkB,KAAKokB,qBAAqBpjB,GAE/ChB,KAAKmI,SAASnH,EAAQP,MAAO,CAACwQ,QAAQ,IAEtCjR,KAAKqkB,SAAWrkB,KAAKskB,gBAAgBtjB,GAErChB,KAAKuI,SAELvI,KAAKkX,iBAGTkN,qBAAsB,SAASpjB,GAC3BhB,KAAK4Q,QAAU5P,EAAQ4P,QAEvB,IAAI3E,EAAQgd,SAA0ChT,GACtD,OAAOjV,EAAQmjB,eAAiB,IAAIlY,EAAM,CACtC2E,QAAS5P,EAAQ4P,QACjB8B,WAAY1R,EAAQ0R,WACpBC,WAAY3R,EAAQ2R,cAI5B2R,gBAAiB,SAAStjB,GACtB,IAAI6pB,EAAO7pB,EAAQqjB,UAAY,IAAIrD,EAAmB,CAClD6D,GAAI7jB,EAAQ8jB,aAAe9M,IAAE8S,IAC7BrU,MAAOzW,KAAKmkB,cACZzN,eAAgB1V,EAAQ0V,eACxBC,cAAe3V,EAAQ2V,cACvB/M,cAAe5I,EAAQ4I,cACvBmN,MAAM,EACN4E,cAAe,gBACf5T,UAAW,CACPqU,SAAS,EACTI,UAAU,KAMlB,OAFA7d,WAASksB,EAAME,IAERF,GAGX3T,cAAe,WACXlX,KAAKmX,SAASnX,KAAKqkB,SAAU,iBAAkBrkB,KAAKgrB,aAAchrB,MAClEA,KAAKmX,SAASnX,KAAKqkB,SAAU,YAAarkB,KAAK8b,YAAa9b,MAC5DA,KAAKmX,SAASnX,KAAKqkB,SAAU,cAAerkB,KAAKirB,aAAcjrB,MAC/DA,KAAKmX,SAASnX,KAAKqkB,SAAU,kBAAmBrkB,KAAKolB,gBAAiBplB,MACtEA,KAAKmX,SAASnX,KAAKmkB,cAAe,SAAUnkB,KAAKkrB,uBAAwBlrB,MACzEA,KAAKmX,SAASnX,KAAKmkB,cAAe,kBAAmBnkB,KAAKmrB,eAAgBnrB,MAC1EA,KAAKmX,SAASnX,KAAKmkB,cAAe,gBAAiBnkB,KAAKorB,aAAcprB,MACtEA,KAAKmX,SAASnX,KAAKmkB,cAAe,qBAAsBnkB,KAAKqrB,kBAAmBrrB,MAChFA,KAAKmX,SAASnX,KAAKmkB,cAAe,mBAAoBnkB,KAAKsrB,gBAAiBtrB,MAE5EA,KAAKmX,SAASnX,KAAKyW,MAAO,oBAAqBzW,KAAKurB,mBAAoBvrB,MACxEA,KAAKmX,SAASnX,KAAKyW,MAAO,eAAgBzW,KAAKslB,YAAatlB,MAC5DA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKulB,eAAgBvlB,MAClEA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKwlB,aAAcxlB,MAEhEgY,IAAE,QAAQzH,GAAG,YAAavQ,KAAKylB,mBAC1BlV,GAAG,UAAWvQ,KAAK4c,iBACnBrM,GAAG,YAAavQ,KAAK6c,mBAE1B7E,IAAE/U,QAAQsN,GAAG,SAAUvQ,KAAK0qB,qBAGhCniB,OAAQ,WAmBJ,OAjBAvI,KAAK6X,IAAIxJ,QACTrO,KAAK6X,IAAIrJ,OAAOwJ,IAAEhY,KAAKgD,SAAShD,KAAKwrB,0BAErCxrB,KAAKqkB,SAASnI,mBAEdlc,KAAK6X,IAAI3V,KAAK,yBAAyBsM,OAAOxO,KAAKqkB,SAASQ,IAE5D7kB,KAAKqkB,SAAS9b,SAEdvI,KAAKqkB,SAAShc,MAAM1J,SAAOqB,KAAKqkB,SAAS1J,OAAQ3a,KAAKqkB,WAEtDrkB,KAAKqkB,SAASxI,iBAEd7b,KAAKyrB,WAELzrB,KAAK0rB,uBAEE1rB,MAGXyrB,SAAU,WACN,IAAIrhB,EAAOpK,KAGNA,KAAK2rB,qBAEN7B,GAA+B,CAC3BjF,GAAI7kB,KAAK6X,IACT4L,IAAK,CAAC,MAAS,SACf+F,QAAS,OAASzf,aAA4B,OAAS,IACvDgR,SAAU,SAASlD,GACfzN,EAAKwhB,gBAAkBte,KAAKue,MAAMhU,EAAI3V,KAAK,2BAA2B2X,eACtEzP,EAAK0hB,uBAAyBxe,KAAKue,MAAMhU,EAAI3V,KAAK,oCAAoC2X,kBAI9F7Z,KAAK2rB,oBAAqB,GAG9B3rB,KAAK6X,IAAI3V,KAAK,yBAAyBuhB,IAAI,CACvC,OAAU,OACV,cAAezjB,KAAK4rB,gBACpB,iBAAkB5rB,KAAK8rB,0BAI/BhU,WAAY,WAER,OADA9X,KAAKqkB,SAASvM,aACP9X,MAKXgrB,aAAc,SAASha,GACfA,IACIhR,KAAK+rB,gCACE/rB,KAAK+rB,uBACZ/rB,KAAKmkB,cAAcrP,oBAAoB9D,EAAOvQ,MAAOuQ,EAAOb,QAGhEnQ,KAAKqkB,SAASnJ,SAASlK,EAAOb,SAItCib,aAAc,SAASrjB,GACnB/H,KAAKyW,MAAMlP,IAAI,SAASQ,EAAUtH,QAAS,EAC3CT,KAAKyW,MAAMzO,QAAQ,iBAGvBqjB,kBAAmB,SAASW,GAMxB,IALA,IAAIjkB,EAAYikB,EAAMjkB,UAClBtH,EAAYT,KAAKyW,MAAMlP,IAAI,SAC3B0kB,EAAY,EACZC,EAAYnkB,EAAUhF,OAEhBkpB,EAAKC,EAAMD,GAAK,EACtBxrB,EAAMsH,EAAUkkB,KAAO,EAG3BjsB,KAAKyW,MAAMzO,QAAQ,iBAGvBsjB,gBAAiB,SAASvjB,UACf/H,KAAKyW,MAAMlP,IAAI,SAASQ,EAAUtH,OAEzCT,KAAKyW,MAAMzO,QAAQ,iBAGvBmjB,eAAgB,WACZnrB,KAAKyW,MAAM1N,WAAWtI,MAAQ,IAGlC0rB,YAAa,WACJnsB,KAAKyW,MAAMlP,IAAI,cAChBvH,KAAKqkB,SAASpJ,KAAK,mBAAoBjb,KAAKosB,2BAA4BpsB,MACxEA,KAAKsI,YAAY3J,SAAOqB,KAAKqkB,SAASjP,UAAWpV,KAAKqkB,aAI9DgI,aAAc,WACLrsB,KAAKyW,MAAMlP,IAAI,cAChBvH,KAAKqkB,SAASpJ,KAAK,mBAAoBjb,KAAKosB,2BAA4BpsB,MACxEA,KAAKsI,YAAY3J,SAAOqB,KAAKqkB,SAASvE,WAAY9f,KAAKqkB,aAI/DiI,kBAAmB,WACVtsB,KAAKyW,MAAMlP,IAAI,cAChBvH,KAAKqkB,SAASpJ,KAAK,mBAAoBjb,KAAKosB,2BAA4BpsB,MACxEA,KAAKsI,YAAY3J,SAAOqB,KAAKqkB,SAAS/O,gBAAiBtV,KAAKqkB,aAIpE4G,aAAc,WACVjrB,KAAKgI,QAAQ,gBAGjBod,gBAAiB,SAAS9R,EAAgBnS,GACtCnB,KAAKgI,QAAQ,kBAAmBsL,EAAgBnS,IAGpD+pB,uBAAwB,WACpB,QAA4C,IAAjClrB,KAAKyW,MAAMlP,IAAI,eAA+B,CACrD,IAAIsL,EAAQ7S,KAAKmkB,cAAc5c,IAAI,SAE/B5I,aAAWkU,KAAWlU,UAAQkU,IAC9B7S,KAAKyW,MAAMrU,IAAI,cAAeyQ,KAK1C0Y,mBAAoB,WAChBvrB,KAAKqkB,SAAS1J,UAGlB+Q,qBAAsB,WAClB,GAAK1rB,KAAK6X,IAAI+C,GAAG,YAAjB,CAMA,IAAI2R,EAAiBvsB,KAAK6X,IAAI2U,aAE9B,GAAID,IAAmBvsB,KAAKysB,gBAA5B,CAIIzsB,KAAKysB,gBAAkBF,EAG3B,IAAIG,EAAkB1sB,KAAK6X,IAAI3V,KAAK,oCAChCyqB,EAAsBD,EAAgBF,aACtCI,EAAyB5sB,KAAK6X,IAAIgV,SAAS,iBAE/C/C,GAA+B,CAC3BjF,GAAI6H,EACJjJ,IAAK,CACD,KAAU,EAA2B,EAAtBkJ,EAA4B,KAC3C,MAAUA,EAAsB,MAEpCnD,QAAS,OAASzf,aAA4B,OAAS,IACvD2f,aAAa,EACb3O,SAAU,SAAS+R,GACfnuB,SAAO2rB,IAAc,SAASyC,GAC1B,IAAIC,GAAU,EAEdruB,SAAOouB,EAAWvC,SAAS,SAASyC,GAChC,IAAID,EAAJ,CAIA,IAAIE,EAAUJ,EAAO5qB,KAAK6qB,EAAWxC,UACjC4C,EAAcD,EAAQhrB,KAAK,uCACtB2G,KAAKokB,IACCC,EAAQ,GAAG3E,wBAAwBhM,MACnC4Q,EAAY,GAAG5E,wBAAwBhM,OAE3B,GAAsB,KAAjB0Q,GAAuBL,KACnDI,GAAU,EACVN,EAAgBxqB,KAAK6qB,EAAWxC,SAAW,wCACtC1hB,KAAKokB,iBAQlC3H,YAAa,WACTtlB,KAAKgI,QAAQ,mBAAoBhI,KAAKsf,aAG1CiG,eAAgB,WACZ,IAAItc,EAAWjJ,KAAKyW,MAAMlP,IAAI,YAE1B0B,EACAjJ,KAAK6X,IAAI3V,KAAK,sBAAsBoM,KAAK,WAAY,YAErDtO,KAAK6X,IAAI3V,KAAK,sBAAsBklB,WAAW,YAGnDpnB,KAAKqkB,SAAStE,YAAY9W,IAG9B4d,eAAgB,WACZ7mB,KAAK+mB,WAGTA,QAAS,WAGL,IAAIqG,EAAQptB,KAAK6X,IAAI3V,KAAK,SACtBkrB,EAAM7jB,OAAS6jB,EAAM9e,KAAK,iBAC1B8e,EAAM7jB,IAAI,IACV6jB,EAAM9O,YAAY,uCAI1B0I,OAAQ,WAEJ,IAAIoG,EAAQptB,KAAK6X,IAAI3V,KAAK,SAO1B,GANoB,KAAhBkrB,EAAM7jB,OAAgB6jB,EAAM7jB,QAAU6jB,EAAM9e,KAAK,iBACjD8e,EAAMzO,SAAS,qCACfyO,EAAM7jB,IAAI6jB,EAAM9e,KAAK,iBAIrBtO,KAAKwmB,YACL,OAAO,GAIf1K,YAAa,WACJ/R,eACD/J,KAAKwmB,aAAc,IAI3BvF,UAAW,WACHjhB,KAAKwmB,qBACExmB,KAAKwmB,YAEZxmB,KAAK6X,IAAI3V,KAAK,0BAA0BukB,UAIhDhB,kBAAmB,SAASza,GACpBhL,KAAKwmB,aACDxb,EAAM0M,SAAW1X,KAAK6kB,IAA6C,IAAvC7kB,KAAK6X,IAAI3V,KAAK8I,EAAM0M,QAAQ3U,gBACjD/C,KAAKwmB,YACZxmB,KAAKgnB,WAKjBpK,gBAAiB,WACb5c,KAAKihB,aAGTpE,kBAAmB,SAAS7R,GACpBhL,KAAKwmB,aACLxb,EAAMuG,mBAIdoZ,SAAU,WACN3qB,KAAK2a,UAKT0M,QAAS,SAASrc,GACd,IAAIZ,EAAOpK,KAEXA,KAAKqtB,oBAAoBriB,GAAO,WAC5BZ,EAAKia,SAAS1D,sBACf,WACCvW,EAAKia,SAAS7D,mBAItB8G,UAAW,SAAStc,GAChB,IAAIZ,EAAOpK,KAEXA,KAAKqtB,oBAAoBriB,GAAO,WAC5BZ,EAAKia,SAAS5D,kBACf,WACCrW,EAAKia,SAAS9D,oBAItB8M,oBAAqB,SAASriB,EAAOsiB,EAAcC,GAC/C,IACIC,EAAaxtB,KAAKqkB,SAASvD,iBAE3B0M,GACIxiB,EAAMmU,WACNnf,KAAK+rB,wBAAyB,GAGlCuB,IAEattB,KAAKqkB,SAASvD,iBAEZ3Q,QAAUqd,EAAWrd,OAChCod,KAGJA,KAIRhG,WAAY,SAASvc,GACjBA,EAAMwH,iBAEN,IAAIxB,EAAShR,KAAKqkB,SAASvD,iBACtB9P,IAIDhG,EAAMmU,SACNnf,KAAKmkB,cAAcrP,oBAAoB9D,EAAOvQ,MAAOuQ,EAAOb,OACrDnF,EAAMoU,SAAWpU,EAAMqU,SAC9Brf,KAAKmkB,cAAchP,iBACnBnV,KAAKmkB,cAAcvP,oBAAoB5D,EAAOvQ,MAAOuQ,EAAOb,QAE5DnQ,KAAKmkB,cAAclP,gBAAgBjE,EAAOvQ,MAAOuQ,EAAOb,SAIhEqX,SAAU,aAIVC,UAAW,SAASzc,GAEZA,EAAMmU,WACNnf,KAAK+rB,wBAAyB,GAGlC/rB,KAAKqkB,SAAS9D,iBAGlBmH,SAAU,SAAS1c,GAEXA,EAAMmU,WACNnf,KAAK+rB,wBAAyB,GAGlC/rB,KAAKqkB,SAAS7D,gBAGlBmH,YAAa,SAAS3c,GAEdA,EAAMmU,WACNnf,KAAK+rB,wBAAyB,GAGlC/rB,KAAKqkB,SAASxD,UAGlB+G,cAAe,SAAS5c,GAEhBA,EAAMmU,WACNnf,KAAK+rB,wBAAyB,GAGlC/rB,KAAKqkB,SAASzD,YAGlBiH,SAAU,aAIV4F,OAAQ,SAASziB,GACRA,EAAMoU,SAAYpU,EAAMqU,SAGzBrU,EAAMuG,kBACNvR,KAAKmsB,eAHLnsB,KAAK+jB,gBAAgB9R,4BAA4BjH,IASzDkZ,eAAgB,WACZlkB,KAAKyW,MAAMrU,IAAI,WAAYpC,KAAK6X,IAAI3V,KAAK,0BAA0BqH,QAGvEic,aAAc,SAASzK,GACnB,IAAI3Q,EAAOpK,KACPshB,EAAWthB,KAAKyW,MAAMlP,IAAI,iBAEP,IAAZ+Z,GAAwC,KAAbA,GAClCthB,KAAKyW,MAAMkQ,MAAM,cAAe,CAAC1V,QAAQ,IAG7CjR,KAAKqkB,SAASnJ,SAAS,GACvB9Q,EAAKia,SAAS5T,SAAS,KAAM,CAACQ,QAAQ,IAEtCjR,KAAK4Q,QAAQ,CACT0Q,SAAUA,EACVzQ,OAAQ,EACRC,MAAO9Q,KAAKqkB,SAAS5N,MAAM/D,aAC5BhM,MAAK,WACJ0D,EAAK+Z,cAAclJ,KAAK,SAAUF,GAAgC,mBAAbA,EAA0BA,EAAW,WAEtF3Q,EAAKia,SAASlc,SAASxJ,SAAOyL,EAAKqM,MAAMlP,IAAI,UAAW,CAAC0J,QAAQ,IACjE7G,EAAKia,SAAS5T,SAAS,KAE3BrG,EAAKia,SAAShc,YAItBC,YAAa,SAASyS,GACd/a,KAAKyW,MAAMlP,IAAI,aACfvH,KAAK6X,IAAI3V,KAAK,SAASqH,IAAI,IAC3BvJ,KAAKyW,MAAMrU,IAAI,WAAY,GAAI,CAAC6O,QAAQ,IAExCjR,KAAKwlB,aAAazK,KAElB/a,KAAKyW,MAAMkQ,MAAM,cAAe,CAAC1V,QAAQ,IACzC8J,GAAYA,MAIpBqR,2BAA4B,SAASrkB,EAAW/G,GAC5C,IAAIP,EAAQ,GACRwrB,EAAQ,EACRC,EAAQnkB,EAAUhF,OAItB,IAFA/C,KAAKmrB,iBAEIc,EAAKC,EAAMD,GAAM,EACtBxrB,EAAMsH,EAAUkkB,KAAO,EAG3BjsB,KAAKyW,MAAM1N,WAAWtI,MAAQA,EACzBO,GAAYA,EAAQiQ,QACrBjR,KAAKyW,MAAMzO,QAAQ,iBAI3B0lB,iCAAkC,SAAS3lB,GACvC,OAAOA,GAKXyjB,qBAAsB,WAClB,MAAO,CACH9qB,MAAOV,KAAKU,MACZilB,OAAQ5b,aACRd,SAAUjJ,KAAKyW,MAAMlP,IAAI,YACzBse,KAAMA,IAMdxd,MAAO,SAAS0S,EAAU/Z,GACtB,IAAIsgB,EAAWthB,KAAKyW,MAAMlP,IAAI,iBAEN,IAAb+Z,GAAyC,KAAbA,GACnCthB,KAAKyW,MAAMkQ,MAAM,cAAe,CAAC1V,QAAQ,IAG7CjR,KAAKqkB,SAAShc,MAAM0S,EAAU/Z,IAGlC2Z,OAAQ,WACJ3a,KAAKqkB,SAAS1J,SACd3a,KAAK0rB,wBAGT5iB,MAAO,SAAS9H,GACZ,IAAIoJ,EAAOpK,KAEXA,KAAKsI,aAAY,WACb8B,EAAKia,SAASvb,MAAM9H,OAI5Bse,SAAU,WACN,OAAO3gB,SAAOqB,KAAKyW,MAAMlP,IAAI,WAGjCY,SAAU,SAAS1H,EAAOO,GACtBA,EAAUA,GAAW,GAErBhB,KAAKmkB,cAAclJ,KAAK,oBAAoB,WACxCjb,KAAKmrB,iBAKL,IAJA,IAAIpjB,EAAY/H,KAAKmkB,cAAc3P,eAC/B9G,EAAI,EACJ3K,EAASgF,EAAUhF,OAEf2K,EAAI3K,EAAQ2K,IAChB1N,KAAKyW,MAAM1N,WAAWtI,MAAMsH,EAAU2F,KAAM,EAG3C1M,GAAYA,EAAQiQ,QACrBjR,KAAKslB,gBAEVtlB,MAEErB,YAAU8B,IAA2B,iBAAVA,IAC5BA,EAAQT,KAAK0tB,iCAAiCjtB,IAGlDT,KAAKmkB,cAAcrQ,OAAOrT,EAAOO,EAAQ6e,eAG7CE,YAAa,SAAS9W,GAClBjJ,KAAKyW,MAAMrU,IAAI,WAAY6G,IAG/B6T,YAAa,WACT,OAAO9c,KAAKyW,MAAMlP,IAAI,aAG1ByY,OAAQ,WACJhgB,KAAKqkB,SAASrE,SACdvN,+BAAoCzS,MAEpCgY,IAAE,QAAQ1H,IAAI,YAAatQ,KAAKylB,mBAC3BnV,IAAI,UAAWtQ,KAAK4c,iBACpBtM,IAAI,YAAatQ,KAAK6c,mBAE3B7E,IAAE/U,QAAQqN,IAAI,SAAUtQ,KAAK0qB,uBG3rBrC,SAXmC1J,SAA0B,CACzDrD,aAAc,SAAU3S,EAAOvK,EAAO0P,GAC9B6H,IAAEhN,EAAM0M,QAAQmV,SAAS,8BACpB7sB,KAAKyW,MAAMvB,kBAAkBzU,EAAO0P,IACrCnQ,KAAKkd,cAAclS,EAAOvK,EAAO0P,GAGrC6Q,8BAA+ChhB,KAAMgL,EAAOvK,EAAO0P,MCyM/E,SAnMwBsC,gBAAqB,CACzCgY,UAAW,iDACXjU,OAAQ,WACJ,MAAO,CACH,gBAAiBxW,KAAK+jB,gBAAgBlS,UACtC,cAAe,UACf,aAAc,SACd,sCAAuC,0BACvC,UAAa,cACb,QAAW,cAGnBR,gBAAiB1S,WAAS,CACtB,GAAM,SACN,EAAK,cACL,GAAM,eACPwS,6BACHzN,WAAY,SAAU1C,GACbhB,KAAKyW,QACNzW,KAAKyW,MAAQ,IAAIhE,YAErBzS,KAAKyW,MAAMrU,IAAI,WAAW,EAAO,CAAE6O,QAAQ,IAC3CjR,KAAKgD,SAAWrE,aC1DxB,4jBD2DQqB,KAAK+jB,gBAAkB,IAAI5S,EAAgB,CACvCE,gBAAiBrR,KAAKqR,gBACtBG,eAAgBxQ,EAAQwQ,eACxBC,QAASzR,KACT0R,uBAAwB1R,KAAKkkB,eAC7BvS,yBAA0B3R,KAAK2R,yBAC/BC,wBAAyB5R,KAAK4R,wBAC9BL,iBAAiB,IAErB,IAAI4O,EAA0BnK,SAA8BC,GAC5DjW,KAAKmkB,cAAgBnjB,EAAQmjB,eAAiB,IAAIhE,EAAwB,CACtEvP,QAAS5P,EAAQ4P,QACjB8B,WAAY1R,EAAQ0R,WACpBC,WAAY3R,EAAQ2R,aAExB3S,KAAKqkB,SAAWrjB,EAAQqjB,UAAY1lB,WAAS,IAAIqiB,GAAmB,CAChE6D,GAAI7jB,EAAQ8jB,aAAe9M,IAAE8S,IAC7BrU,MAAOzW,KAAKmkB,cACZzN,eAAgB1V,EAAQ0V,eACxBC,cAAe3V,EAAQ2V,eE9EnC,otBF+EY/M,cAAe5I,EAAQ4I,cACvBmN,MAAM,EACN4E,cAAe,cACf5T,UAAW,CACPqU,SAAS,EACTI,UAAU,KAEduO,IACJ/qB,KAAKkX,gBACLlX,KAAKuI,SAASoS,UAElBzD,cAAe,WACXlX,KAAKmX,SAASnX,KAAKqkB,SAAU,iBAAkBrkB,KAAKgrB,aAAchrB,MAClEA,KAAKmX,SAASnX,KAAKyW,MAAO,iBAAkBzW,KAAK2tB,kBAAmB3tB,MACpEA,KAAKmX,SAASnX,KAAKyW,MAAO,kBAAmBzW,KAAKulB,eAAgBvlB,MAClEA,KAAKmX,SAASnX,KAAKmkB,cAAe,SAAUnkB,KAAKoX,cAAepX,OAEpEuI,OAAQ,WACJvI,KAAKqkB,SAASnI,mBACd,IAAI0R,EAAoB5V,IAAEhY,KAAKgD,SAAS,CACpCiG,SAAUjJ,KAAKyW,MAAMlP,IAAI,YACzBse,KAAMA,KAKV,OAHA7lB,KAAK6X,IAAIxJ,QAAQG,OAAOof,GAAmB1rB,KAAK,yBAAyBsM,OAAOxO,KAAKqkB,SAASQ,IAC9F7kB,KAAKqkB,SAAS9b,SACdvI,KAAKqkB,SAASxI,iBACP7b,MAEX8X,WAAY,WAER,OADA9X,KAAKqkB,SAASvM,aACP9X,MAEXgrB,aAAc,SAAUha,GAChBA,EACAhR,KAAKqkB,SAASnJ,SAASlK,EAAOb,OAE9BnQ,KAAKmkB,cAAchP,kBAG3BoQ,eAAgB,WACZ,IAAItc,EAAWjJ,KAAKyW,MAAMlP,IAAI,YAC1B0B,GACAjJ,KAAK6X,IAAI3V,KAAK,sBAAwBoM,KAAK,WAAY,YACvDtO,KAAKqkB,SAASlc,SAAS,IACvBnI,KAAKqkB,SAAS5T,cAAS/H,IAEvB1I,KAAK6X,IAAI3V,KAAK,sBAAwBklB,WAAW,YAErDpnB,KAAKqkB,SAAStE,YAAY9W,IAE9B0kB,kBAAmB,WACX3tB,KAAKyW,MAAMlP,IAAI,WACfvH,KAAK6X,IAAI3V,KAAK,8BAA8Byc,SAAS,WAErD3e,KAAK6X,IAAI3V,KAAK,8BAA8Boc,YAAY,YAGhElH,cAAe,WACNpX,KAAKmkB,cAAc5c,IAAI,SAGxBvH,KAAKqkB,SAASxM,IAAIyO,OAFlBtmB,KAAKqkB,SAASxM,IAAI0O,QAK1BQ,QAAS,WACL/mB,KAAKyW,MAAMrU,IAAI,WAAW,IAE9B4kB,OAAQ,WACChnB,KAAKwmB,aACNxmB,KAAKyW,MAAMrU,IAAI,WAAW,IAGlCyrB,wBAAyB,SAAU7iB,GAC/BhL,KAAK8tB,YAAY9iB,IAErB8Q,YAAa,WACJ/R,eACD/J,KAAKwmB,aAAc,EACdxmB,KAAKyW,MAAMlP,IAAI,YAChBvH,KAAK6X,IAAI3V,KAAK,SAASukB,UAInCxF,UAAW,WACHjhB,KAAKwmB,cACLxmB,KAAK6X,IAAI3V,KAAK,SAASukB,eAChBzmB,KAAKwmB,cAGpBa,QAAS,SAAUrc,GACfhL,KAAKqkB,SAAS1D,oBAElB2G,UAAW,SAAUtc,GACJhL,KAAKqkB,SAASvD,iBAEvB9gB,KAAKqkB,SAAS5D,eAEdzgB,KAAKqkB,SAAS9D,iBAGtBgH,WAAY,SAAUvc,KAEtByc,UAAW,SAAUzc,GACjBhL,KAAKqkB,SAAS9D,iBAElBmH,SAAU,SAAU1c,GAChBhL,KAAKqkB,SAAS7D,gBAElBmH,YAAa,SAAU3c,GACnBhL,KAAKqkB,SAASxD,UAElB+G,cAAe,SAAU5c,GACrBhL,KAAKqkB,SAASzD,YAElBiH,SAAU,aAEV4F,OAAQ,SAAUziB,KAElB8iB,YAAa,SAAU9iB,GACnB,IAAIvK,EAAQT,KAAKqkB,SAAS/E,WAC1B,GAAI7e,GAASA,EAAMsC,OAAS,EAAG,CAC3B,IAAIgrB,GAAiB,EACrB,IAAK,IAAI5d,KAAS1P,EACd,GAAIA,EAAMgV,eAAetF,SAA2BzH,IAAjBjI,EAAM0P,GAAsB,CAC3D4d,GAAiB,EACjB,MAGHA,GACD/tB,KAAKgI,QAAQ,mBAAoBvH,KAI7C4H,MAAO,SAAU0S,EAAU/Z,GACvBhB,KAAKqkB,SAASlc,SAAS,IACvBnI,KAAKqkB,SAAS5T,cAAS/H,GACvB1I,KAAKqkB,SAAShc,MAAM0S,EAAU/Z,IAElC2Z,OAAQ,WACJ3a,KAAKqkB,SAAS1J,UAElBoF,YAAa,SAAU9W,GACnBjJ,KAAKyW,MAAMrU,IAAI,WAAY6G,IAE/B6T,YAAa,WACT,OAAO9c,KAAKyW,MAAMlP,IAAI,aAE1ByY,OAAQ,WACJhgB,KAAKqkB,SAASrE,SACdvN,+BAAoCzS,SG7M5C,IAAIguB,GAAwB,SAAUzpB,GAClC5F,YAAUqB,KAAM,UAAW,oBAC3BA,KAAKuE,KAAOA,GAAQ,IAExB5F,WAASqvB,GAAsBxd,UAAW,CACtCyd,QAAS,SAAU1pB,GACfvE,KAAKuE,KAAOA,GAAQ,IAExB2pB,iBAAkB,WACd,OAAOluB,KAAKuE,MAEhBqM,QAAS,SAAU5P,GACf,IAAIqgB,EAAW,IAAIrJ,cACf+J,EAAQ/gB,GAAWA,EAAQ6P,OAAS7P,EAAQ6P,OAAS,EACrDmR,EAAOhhB,GAAWA,EAAQ8P,MAAQiR,EAAQ/gB,EAAQ8P,MAAQ9Q,KAAKuE,KAAKxB,OACpEkf,EAAcjiB,KAAKkiB,gBAAgBliB,KAAKuE,KAAMwd,EAAOC,GAKzD,OAJAX,EAAS1a,QAAQ,CACbpC,KAAM0d,EACNpP,MAAO7S,KAAKuE,KAAKxB,SAEdse,EAASG,WAEpBU,gBAAiB,SAAU9gB,EAAQ2gB,EAAOC,GACtCA,EAAO1U,KAAKC,IAAIyU,EAAM5gB,EAAO2B,QAE7B,IADA,IAAI5C,EAAS,GACJuN,EAAIqU,EAAOrU,EAAIsU,EAAMtU,IAC1BvN,EAAOsZ,KAAK,CACR/Y,MAAOU,EAAOsM,GAAGhN,MACjBD,MAAOW,EAAOsM,GAAGjN,QAGzB,OAAON,KAGf,YClCA,IAAIguB,GAA4B,SAAUntB,GACtCA,EAAUA,GAAW,GACrBrC,aAAWqC,EAAS,CAChBotB,SAAUpuB,KAAKquB,UACfC,YAAatuB,KAAKuuB,eAEtBvuB,KAAKouB,SAAWptB,EAAQotB,SACxBpuB,KAAKsuB,YAActtB,EAAQstB,YAC3BN,QAA2BhuB,KAAMgB,EAAQuD,OAE7C5F,WAASwvB,GAA0B3d,UAAWwd,cAC9CrvB,WAASwvB,GAA0B3d,UAAW,CAC1Cyd,QAAS,SAAU1pB,GACfA,EAAOvE,KAAKwuB,uBAAuBjqB,GACnCA,EAAOvE,KAAKyuB,UAAUlqB,GACtBypB,0BAA6ChuB,KAAMuE,IAEvD8pB,UAAW,SAAUK,EAAOC,GACxB,OAAOD,EAAMhuB,MAAMkuB,cAAcD,EAAMjuB,QAE3C6tB,aAAc,SAAU9tB,GACpB,OAAOA,GAEXguB,UAAW,SAAUlqB,GAEjB,OADAA,EAAOA,GAAQ,IACHsqB,KAAK7uB,KAAKouB,WAE1BI,uBAAwB,SAAUjqB,GAC9B,IAAI6F,EAAOpK,KACX,OAAOrB,QAAM4F,GAAM,SAAU9D,GACzB,MAAO,CACHA,MAAOA,EACPC,MAAO0J,EAAKkkB,YAAY7tB,UAKxC,Y,gBC/BIquB,I,SAAMC,cAAgB,UAE1B,SAAetc,gBAAqB,CAChCzP,SAAUrE,aChCd,uLDiCIkmB,GAAI,WACA,OAAO7kB,KAAKgD,YAEhBU,WAAY,SAAU1C,GAClBhB,KAAKmO,UAAYnN,EAAQmN,UACzBnO,KAAKgvB,aAAerwB,UAAQqC,UACrBhB,KAAKgvB,aAAa7gB,UACzBnO,KAAKivB,WAAajX,IAAEhY,KAAKmO,WACzBnO,KAAKuI,UAETA,OAAQ,WAMJ,OALA5J,aAAWqB,KAAKgvB,aAAc,CAC1BE,UAAWlvB,KAAKivB,WAAWvV,SAC3ByV,QAAS,CAAEC,EAAGpvB,KAAK6X,OAEvB7X,KAAKivB,WAAWI,UAAUrvB,KAAKgvB,cACxBhvB,MAEXsmB,KAAM,WAEF,OADAtmB,KAAK6X,IAAIyG,YAAY,kBACdte,MAEXumB,KAAM,WAEF,OADAvmB,KAAK6X,IAAI8G,SAAS,kBACX3e,MAEXsvB,aAAc,SAAUC,GACpBvvB,KAAKivB,WAAWI,UAAU,SAAU,YAAaE,EAAWL,WAC5DlvB,KAAKivB,WAAWI,UAAU,SAAU,YAAaE,EAAWC,YAEhExP,OAAQ,WACJ,IACIhgB,KAAKivB,WAAWI,UAAU,WAC5B,MAAO7tB,GACLstB,GAAIW,MAAMjuB,GAEdiR,gCAAqCzS,KAAM4G,cElCnD,IAAI8oB,GAA8B3F,EAE9B4F,GAAc,IAAIC,IAItB,SAAend,gBAAqB,CAChCgY,UAAW,qBACXjU,OAAQ,WACJ,MAAO,CAAE,iCAAkC,gBAE/C9S,WAAY,SAAU1C,GAClBhB,KAAKgD,SAAWrE,aC/CxB,+cDgDQqB,KAAK6lB,KAAO,CACRllB,SAAUklB,qCACVgK,UAAWhK,uCAEf7lB,KAAK8vB,uBAAuBnxB,gBAAcqC,EAAQ8uB,uBAA+B9uB,EAAQ8uB,qBACzF9vB,KAAK+vB,wBAA0B/vB,KAAKgwB,+BAA+BhvB,GACnEhB,KAAKiwB,mBAAqBjwB,KAAKkwB,0BAA0BlvB,GACzDhB,KAAKmwB,0BAA4BnwB,KAAKowB,qCAAqCpvB,GAC3EhB,KAAK4tB,kBAAoB5tB,KAAKqwB,yBAAyBrvB,GACvDhB,KAAK0Z,OAAS1Y,EAAQ0Y,OACtB1Z,KAAKqvB,UAAYruB,GAAWA,EAAQquB,UACpCrvB,KAAKkX,qBACwB,IAAlBlW,EAAQP,QACfT,KAAKiR,QAAS,EACdjR,KAAKiwB,mBAAmB9nB,SAASnH,EAAQP,QAEzCO,GAAWA,EAAQquB,YACnBrvB,KAAKswB,MAAQ,IAAIC,GAAM,CACnBpiB,UAAWnO,KAAK6X,IAChBzH,KAAMzR,UAAO,WACTqB,KAAK2a,WACN3a,SAGXA,KAAKuI,UAETynB,+BAAgC,SAAUhvB,GACtC,OAAO,IAAIyR,YAEfyd,0BAA2B,SAAUlvB,GACjC,OAAOA,EAAQivB,oBAAsB,IAAIO,GAAmB,CACxD/Z,MAAOzW,KAAK+vB,wBACZnf,QAAS5P,EAAQ4P,QACjB8B,WAAY1R,EAAQ0R,WACpBC,WAAY3R,EAAQ2R,WACpB+D,eAAgB1V,EAAQ0V,eACxB9M,cAAe5I,EAAQ4I,cACvB4H,eAAgBxQ,EAAQwQ,kBAGhC4e,qCAAsC,SAAUpvB,GAC5C,OAAOA,EAAQmvB,2BAA6B,IAAIhC,GAA0BntB,EAAQyvB,sBAEtFJ,yBAA0B,SAAUrvB,GAEhC,OADAhB,KAAKqpB,YAAcroB,EAAQqoB,YACpB,IAAIqH,GAAkB,CACzB9f,QAAS5Q,KAAKmwB,0BAA0Bvf,QACxC8B,WAAY1R,EAAQ0R,WACpBC,WAAY3R,EAAQ2R,WACpB+D,eAAgB1V,EAAQ0V,eACxB9M,cAAe5I,EAAQ4I,iBAG/BsN,cAAe,WACXlX,KAAKmX,SAASnX,KAAKiwB,mBAAoB,mBAAoBjwB,KAAKklB,gBAAiBllB,MACjFA,KAAKmX,SAASnX,KAAKiwB,mBAAoB,kBAAmBjwB,KAAKolB,gBAAiBplB,MAChFA,KAAKmX,SAASnX,KAAK+vB,wBAAyB,qBAAsB/vB,KAAK2wB,gCAAiC3wB,MACxGA,KAAKmX,SAASnX,KAAK4tB,kBAAmB,mBAAoB5tB,KAAK4wB,iBAAkB5wB,OAErFuI,OAAQ,WAgBJ,OAfAvI,KAAKswB,OAAStwB,KAAKswB,MAAMzY,IAAIgZ,SAC7B7wB,KAAK6X,IAAIgR,KAAK7Q,IAAEhY,KAAKgD,SAAS,CAAE6iB,KAAMA,MACtC7lB,KAAK8wB,iBAAmB9wB,KAAK6X,IAAI3V,KAAK,oCACtClC,KAAKiwB,mBAAmB/T,mBACxBlc,KAAK4tB,kBAAkB1R,mBACvBlc,KAAK4tB,kBAAkB/V,IAAIkZ,YAAY/wB,KAAK8wB,kBAC5C9wB,KAAKiwB,mBAAmBpY,IAAIkZ,YAAY/wB,KAAK8wB,kBAC7C9wB,KAAKiwB,mBAAmB1nB,SACxBvI,KAAK4tB,kBAAkBrlB,SACvBvI,KAAKgxB,kCACLhxB,KAAKixB,iCACLjxB,KAAKiwB,mBAAmBpU,iBACxB7b,KAAK4tB,kBAAkB/R,iBACvB7b,KAAKyrB,WACLzrB,KAAKkxB,eACElxB,MAEXkxB,aAAc,WACNlxB,KAAKswB,QACLtwB,KAAK8vB,sBAAwB9vB,KAAKmxB,gBAClCnxB,KAAK6X,IAAIrJ,OAAOxO,KAAKswB,MAAMzY,OAGnC4T,SAAU,WACN,IAAIrhB,EAAOpK,KACNA,KAAKoxB,wBACN1B,GAA4B,CACxB7K,GAAI7kB,KAAK6X,IACT4L,IAAK,CAAE,MAAS,SAChB+F,QAAS,KACTE,aAAa,EACb3O,SAAU,SAAUlD,GAKhB,IAAI6B,EAJJtP,EAAKinB,sBAAwBxZ,EAAI3V,KAAK,oCAAoC2X,cAC1EzP,EAAKknB,iBAAiBzZ,GACtBA,EAAI3V,KAAK,qBAAqBuhB,IAAI,CAAE/J,OAAQ,MAC5CtP,EAAKmnB,sBAAwB1Z,EAAIgC,cAG7BH,EADAtP,EAAKsP,OACItP,EAAKsP,OAELtP,EAAKonB,wBA7GJ,IA+GdpnB,EAAKyN,IAAI4L,IAAI,SAAU/J,MAG/B1Z,KAAKoxB,uBAAwB,GAEjCpxB,KAAKsxB,iBAAiBtxB,KAAK6X,MAE/ByZ,iBAAkB,SAAUzZ,GACxB,IAAIwZ,EAAwBrxB,KAAKqxB,sBACjCtnB,cAA6B/J,KAAK6X,IAAI8G,SAAS,QAC/C9G,EAAI3V,KAAK,kCAAkCuhB,IAAI,cAAe4N,IAElEjM,gBAAiB,SAAU9R,EAAgBnS,GACvCnB,KAAKgI,QAAQ,kBAAmBsL,EAAgBnS,IAEpDswB,YAAa,SAAUC,GACnBA,EAAIngB,kBACAyG,IAAE0Z,EAAIzU,eAAe4P,SAAS,iBAGlC7sB,KAAK6X,IAAI3V,KAAK,2BAA2ByvB,YAAY,6BACrD3xB,KAAK6X,IAAI3V,KAAK,kCAAkCyvB,YAAY,6BACvD5nB,cACD/J,KAAK6X,IAAI3V,KAAK,oDAAoDukB,UAG1EvB,gBAAiB,SAAUnd,GACvBsC,aAAarK,KAAK4xB,wBAClB5xB,KAAK4xB,uBAAyBtnB,WAAW3L,SAAOqB,KAAK6xB,wBAAyB7xB,KAAM+H,GA5I7D,MA8I3B6oB,iBAAkB,SAAU7oB,GACxB,IAAsE+pB,EAAlEC,EAAsB/xB,KAAKiwB,mBAAmBxZ,MAAMlP,IAAI,SAAwByqB,EAAiBjqB,EAAUhF,OAC/G,IAAK+uB,EAAe,EAAGA,EAAeE,EAAgBF,GAAgB,SAC3DC,EAAoBhqB,EAAU+pB,IAEzC9xB,KAAKiwB,mBAAmB9nB,SAASxJ,SAAOozB,KAE5CF,wBAAyB,SAAU9pB,GAC/B,IAAIqC,EAAOpK,KAAM0mB,EAAc1mB,KAAK4tB,kBAAkBvJ,SAASvD,iBAAkBnJ,EAAY3X,KAAK4tB,kBAAkBvJ,SAASxM,IAAIF,YACjI3X,KAAKmwB,0BAA0BlC,QAAQlmB,GACvC/H,KAAK4tB,kBAAkBvlB,OAAM,WAIzB,GAHA+B,EAAK6mB,iCACL7mB,EAAKwjB,kBAAkBjT,SACvBvQ,EAAKwjB,kBAAkBvJ,SAASxM,IAAIF,UAAUA,GAC1C+O,GAAetc,EAAKwjB,kBAAkB/V,IAAIgV,SAAS,YAAa,CAChE,IAAIha,EAAQzI,EAAKwjB,kBAAkBvJ,SAAS5N,MAAMlP,IAAI,SAClDsL,GAASA,EAAQ6T,EAAYvW,MAC7B/F,EAAKwjB,kBAAkBvJ,SAAS5T,SAASiW,EAAYvW,OAC9C0C,GACPzI,EAAKwjB,kBAAkBvJ,SAAS5T,SAASiW,EAAYvW,MAAQ,OAIpEnQ,KAAKiR,cAGCjR,KAAKiR,OAFZjR,KAAKiyB,0BAKbC,gBAAiB,SAAUxa,EAAQya,EAAOtpB,GACtC,IAAuHupB,EAAYvpB,EAAO,KAAzH8mB,GAAY0C,aAAaF,GAAmBnyB,KAAK6X,IAAI3V,KAAKwV,EAAS,kCAC3E7O,KAAKupB,GAAW9jB,KAAK,QAASwa,eAAmBsJ,KAE9DjB,cAAe,WACX,IAAIvY,EAAa5Y,KAAKiwB,mBAAmBxZ,MAAMlP,IAAI,gBAAkB,EACrE,GAAKvH,KAAKoxB,uBAA0BxY,EAApC,CAGA,IAAI0Z,EAAgBtyB,KAAK6X,IAAI6B,SAAUA,EAAS1Z,KAAK6X,IAAI6B,SACrDwV,EAAYlvB,KAAKwxB,wBAnLC,GAoLlBhC,EAAYxvB,KAAKwxB,wBAAwB5Y,GACzCA,GAtLsB,GAuLtBsW,EAAYM,EAAY9V,EAAS1Z,KAAKwxB,wBAAwBlkB,KAAKE,IAtLjD,EAsL8EoL,IACzF0Z,EAAgB9C,IACvB9V,EAAS1Z,KAAKwxB,wBAAwB5Y,IAE1C5Y,KAAK6X,IAAI4L,IAAI,SAAU/J,EAAS,MAChC1Z,KAAKuyB,uBAAuB,CACxBrD,UAAWA,EACXM,UAAWA,MAGnB+C,uBAAwB,SAAUhD,GACzBvvB,KAAKswB,QAGVtwB,KAAKswB,MAAMhB,aAAaC,GACpBA,EAAWL,YAAcK,EAAWC,UACpCxvB,KAAKswB,MAAM/J,OAEXvmB,KAAKswB,MAAMhK,SAGnBkL,wBAAyB,SAAUzhB,GAE/B,OAAOA,EADU/P,KAAKiwB,mBAAmB5L,SAASxL,WACtB7Y,KAAKuxB,uBAErCZ,gCAAiC,WAC7B3wB,KAAKgxB,kCACLhxB,KAAK8vB,sBAAwB9vB,KAAKmxB,iBAEtCH,gCAAiC,WAC7B,IAAIne,EAAQ7S,KAAKiwB,mBAAmBxZ,MAAMlP,IAAI,gBAAkB,EAChEvH,KAAKkyB,gBAAgB,mCAAoCrf,GAAS,EAAG7S,KAAK6lB,KAAKgK,YAEnFoB,+BAAgC,WAC5B,IAAIuB,EAAexyB,KAAK6X,IAAI3V,KAAK,iCAAkCiwB,EAAQnyB,KAAK4tB,kBAAkBvJ,SAAS5N,MAAMlP,IAAI,UAAY,EACjIvH,KAAKkyB,gBAAgB,kCAAmCC,EAAOnyB,KAAK6lB,KAAKllB,UAC3D,IAAVwxB,EACAK,EAAalU,YAAY,eAEzBkU,EAAa7T,SAAS,gBAG9BsT,uBAAwB,WACpBjyB,KAAKgI,QAAQ,mBAAoBhI,KAAKsf,aAE1CxH,WAAY,WAGR,OAFA9X,KAAKiwB,mBAAmBnY,aACxB9X,KAAK4tB,kBAAkB9V,aAChB9X,MAEXqI,MAAO,SAAU0S,EAAU/Z,GACvBhB,KAAKiwB,mBAAmB5nB,MAAM0S,EAAU/Z,IAE5C8H,MAAO,SAAU9H,GACbhB,KAAKiwB,mBAAmBnnB,MAAM9H,IAElC2Z,OAAQ,WACJhc,aAAWA,UAAO,WACdqB,KAAKiwB,mBAAmBtV,SACxB3a,KAAK4tB,kBAAkBjT,WACxB3a,MAAO,IAHVrB,IAKJwJ,SAAU,SAAU1H,EAAOO,GACnBA,GAAWA,EAAQiQ,SACnBjR,KAAKiR,QAAS,UAEXjQ,EAAQiQ,OACfjR,KAAKiwB,mBAAmB9nB,SAAS1H,EAAOO,IAE5Cse,SAAU,WACN,IAAI7e,EAAQT,KAAKiwB,mBAAmB3Q,WAChCnf,EAAS,GACTuN,EAAI,EACR,IAAK,IAAIyC,KAAS1P,EACVA,EAAMgV,eAAetF,SAA2BzH,IAAjBjI,EAAM0P,KACrChQ,EAAOuN,KAAOjN,EAAM0P,IAG5B,OAAOhQ,GAEX4f,YAAa,SAAU9W,GAGnB,OAFAjJ,KAAKiwB,mBAAmBlQ,YAAY9W,GACpCjJ,KAAK4tB,kBAAkB7N,YAAY9W,GAC5BjJ,MAEX8c,YAAa,WACT,OAAO9c,KAAKiwB,mBAAmBnT,eAEnCkD,OAAQ,WACJhgB,KAAKiwB,mBAAmBjQ,SACxBhgB,KAAK4tB,kBAAkB5N,SACvBhgB,KAAKswB,OAAStwB,KAAKswB,MAAMtQ,SACzBvN,+BAAoCzS,OAExCsI,YAAa,WACTtI,KAAKiwB,mBAAmB3nB,iB,gBExShC,SACY,SAAUmqB,GACd,OAAO,SAAU/D,EAAOC,GACpB,OAAID,EAAMhuB,QAAU+xB,GACR,EACD9D,EAAMjuB,QAAU+xB,EAChB,EAEA/D,EAAMhuB,MAAMkuB,cAAcD,EAAMjuB,S,2LCpBlCgyB,G,WAQjB,WAAY1xB,I,4FAA2C,cAPtCqL,0BAOsC,OALtCI,eAKsC,OAF/CkmB,sBAE+C,EACnD3yB,KAAKyM,UAAYzL,EAAQyL,UACzBzM,KAAKqM,qBAAuBrL,EAAQqL,qBACpCrM,KAAK2yB,iBAAmB,G,8CAG5B,SAAQlzB,EAAamzB,GAA0C,WAyB3D,OAxBe5yB,KAAKqM,qBACfwmB,gCAAgCpzB,EAAKmzB,GAAgBltB,MAAK,SAACxG,GACxD,IACM4zB,GAD4B5zB,GAAYA,EAASmB,kBAAoBnB,EAASmB,kBAAoB,IAC9E6B,MAAK,SAACD,GAC5B,OAAOA,EAAQf,KAAO,EAAKuL,cACzB,CACFvL,GAAI,GACJzB,IAAK,GACLuB,QAAS,GACT+xB,WAAY,KAShB,MAAO,CACHxuB,KAPSuuB,EAAY9xB,SAAW8xB,EAAY9xB,QAAQ5B,KAAI,SAACmB,GACzD,wBACOA,MAMPsS,MAAOiD,SAASgd,EAAYC,WAAY,a,6MCpCvCC,G,WAKjB,WAAYhyB,I,4FAA4D,cAJvDiyB,+BAIuD,OAFvDC,mBAEuD,EACpElzB,KAAKkzB,cAAgB,GACrBlzB,KAAKizB,0BAA4BjyB,EAAQiyB,0B,8CAG7C,SAAQxzB,EAAauB,GAAmC,WACpD,OAAOhB,KAAKizB,0BAA0BriB,QAAQnR,EAAKuB,GAAS0E,MAAK,SAACxG,GAAa,IAEvEqF,EAEArF,EAFAqF,KACAsO,EACA3T,EADA2T,MAOJ,OAJAtO,EAAKiI,SAAQ,SAACjM,GACV,EAAK2yB,cAAc3yB,EAAOE,OAASF,EAAOG,SAGvC,CACH6D,OACAsO,c,6BAKZ,SAAgBpS,GACZ,OAAOT,KAAKkzB,cAAczyB,Q,maCnClC,kBACIO,GAOC,IAEGuL,EAEAvL,EAFAuL,uBACG4mB,EAHN,GAIGnyB,EAJH,4BAMD,OAAIuL,GAA0BA,EAAuBxJ,OAAS,EACnDwJ,EAAuBnN,KAAI,SAACmB,GAC/B,OAAIA,EAAO6yB,OAASD,EAAeC,KAC/B,iBAAY7yB,EAAW4yB,GAGpB5yB,KAIR,CAAC,OAAD,UAEI4yB,K,yICwBf,IAAME,GAAqC,SAAC/mB,GACxC,OAAOA,EAAsBuX,QAAO,SAACyP,EAAMC,GAEvC,OADAD,EAAKC,EAAc9yB,OAAS8yB,EAAc7yB,OAAS6yB,EAAc9yB,MAC1D6yB,IACR,KAGPx0B,cAAgB,SAAUwC,EAAQ3C,EAAGC,GAsBjC,SAAS40B,EAAeC,GACpB,IAAMC,EAAgB90B,EAASiI,YAAY2J,UAAUjJ,IAAI4K,KAAKnS,KAAM,aAC/D0zB,GAAiBA,EAAc,KAAOD,GACvCzzB,KAAKoC,IAAI,CAAE2F,UAAW,CAAC0rB,KAI/B,SAASE,EAA2BC,GAEhC,OADsBA,EAASC,cAAcn0B,QAAQ,mBAAoB,IAClDA,QAAQ,qBAAsB,MAGzD,OAAOf,EAAEK,OAAOJ,EAAU,CACtBk1B,KAAMl1B,EAASiI,YAAY7H,OAAO,CAE9BmJ,SAAS,SAAU2qB,GACf,IACI1F,EADYptB,KAAKkH,UACChF,KAAK,SACR,QAAf4wB,EACA1F,EAAM5jB,KAAK,WAAW,GAEtB4jB,EAAM5jB,KAAK,WAAW,IAI9BnC,yBAAyB,WACrBrH,KAAKkH,WAAalH,KAAKkH,UAAUqJ,GAAG,SAAU,QAAS5R,EAAEgH,MAAK,SAAU+rB,GACpE,IAAIjxB,EAAiC,MAAzBixB,EAAIha,OAAO4H,WAAqB,QAAU,OACtDtf,KAAKoC,IAAI,CAAE2F,UAAW,CAACtH,OACxBT,UAIX+zB,gBAAiBn1B,EAASiI,YAAY7H,OAAO,CAEzCmJ,SAAS,SAAU2qB,GACf,IAAIryB,EAAQqyB,GAAekB,6BAAuCA,6BAAuClB,EACrG3kB,EAAYnO,KAAKkH,UACjBiH,IACAA,EAAUjM,KAAK,SAASoM,KAAK,QAAS7N,GACtC0N,EAAUjM,KAAK,SAASqH,IAAI9I,KAIpC4G,yBAAyB,WACrBrH,KAAKkH,WAAalH,KAAKkH,UAAUqJ,GAAG,SAAU,QAAS5R,EAAEgH,MAAK,SAAU+rB,GACpE,IAAIuC,EAAavC,EAAIha,OAAOjX,MACxBA,EAAQwzB,GAAcD,6BAAuCA,6BAAuCC,EACxGj0B,KAAKoC,IAAI,CAAE2F,UAAW,CAACtH,OACxBT,UAKXk0B,kBAAmBt1B,EAASiI,YAAY7H,OAAO,CAE3CmJ,SAAS,SAAU2qB,GACf9yB,KAAKkH,UAAUhF,KAAK,SAASoM,KAAK,QAASwkB,GAC3C9yB,KAAKkH,UAAUhF,KAAK,SAASqH,IAAIupB,IAGrCzrB,yBAAyB,WACrBrH,KAAKkH,WAAalH,KAAKkH,UAAUqJ,GAAG,SAAU,QAAS5R,EAAEgH,MAAK,SAAU+rB,GACpE1xB,KAAKoC,IAAI,CAAE2F,UAAW,CAAC2pB,EAAIha,OAAOjX,WACnCT,UAIXm0B,gBAAiBv1B,EAASiI,YAAY7H,OAAO,CAEzC0E,WAAW,SAAUsD,GACjBhH,KAAK4H,WAAWZ,GAChBA,EAAK2B,SAAW3I,KAAKkH,WAAalH,KAAKo0B,iBAG3C7sB,IAAK,SAASiB,GACV,IAAI6rB,EAAgBz1B,EAASiI,YAAY2J,UAAUjJ,IAAI4K,KAAKnS,KAAMwI,GAClE,OAAO8rB,4BAAgCD,IAG3CjyB,IAAK,SAAS2G,EAAYC,GACnBD,EAAW3H,SACV2H,EAAW3H,OAASkzB,4BAAgCvrB,EAAW3H,SAEnExC,EAASiI,YAAY2J,UAAUpO,IAAI+P,KAAKnS,KAAM+I,EAAYC,IAG9DorB,cAAc,WACV,IAAIhH,EAAQptB,KAAKkH,UAAUhF,KAAK,SAEhClC,KAAKu0B,OAAS,IAAIC,KAAkB,CAChC3P,GAAIuI,EACJqH,OAAQ,SACRC,WAAY51B,gCACZmK,SAAUmkB,EAAM,GAAGnkB,SACnB0rB,SAAUh2B,EAAEgH,KAAK6tB,EAAgBxzB,QAGrCotB,EAAMwH,OAAOj2B,EAAEgH,MAAK,SAAU+rB,GAE1BA,EAAIngB,kBAGJjQ,EAAOowB,EAAIha,QAAQnO,IAAIoqB,EAA2BjC,EAAIha,OAAOjX,QAE7D+yB,EAAerhB,KAAKnS,KAAMsB,EAAOowB,EAAIha,QAAQnO,SAC9CvJ,OAEHotB,EAAMyH,MAAM,UACC70B,KAAKkH,UAAUhF,KAAK,UAC1B4yB,KAAKd,yBAAiC3lB,SAGjDlG,SAAS,SAAU2qB,GACf,IAAI3kB,EAAYnO,KAAKkH,UACrBiH,EAAUjM,KAAK,SAASoM,KAAK,QAASwkB,GACtC3kB,EAAUjM,KAAK,SAASqH,IAAIupB,MAKpCiC,oBAAqBn2B,EAASiI,YAAY7H,OAAO,CAE7C0E,WAAW,SAAUsD,GACjBhH,KAAK4H,WAAWZ,GAChBA,EAAK2B,SAAW3I,KAAKkH,WAAalH,KAAKo0B,iBAG3CY,SAAU,WACN,IAAInd,EAAM7X,KAAKkH,UAEf,OAAO2Q,GAAOA,EAAI3V,KAAK,UAG3B+yB,gBAAiB,WACAj1B,KAAKg1B,WACX1kB,MAEPtQ,KAAKu0B,QAAUv0B,KAAKu0B,OAAOvU,UAG/BoU,cAAc,WACV,IAAIvc,EAAM7X,KAAKkH,UACXgf,EAASlmB,KAAKg1B,WAElBh1B,KAAKi1B,kBAELj1B,KAAKu0B,OAAS,IAAIC,KAAkB,CAChC3P,GAAIqB,EAAO,GACXuO,OAAQ,SACRC,WAAY51B,gCACZo2B,WAAYp2B,oCACZmK,SAAUid,EAAO,GAAGjd,SACpB0rB,SAAUh2B,EAAEgH,KAAK6tB,EAAgBxzB,QAGrCkmB,EAAO0O,OAAOj2B,EAAEgH,MAAK,SAAU+rB,GAE3BA,EAAIngB,kBAGJjQ,EAAOowB,EAAIha,QAAQnO,IAAIoqB,EAA2BjC,EAAIha,OAAOjX,QAC7D+yB,EAAerhB,KAAKnS,KAAMsB,EAAOowB,EAAIha,QAAQnO,SAC9CvJ,OACHkmB,EAAO2O,MAAM,UAEAhd,EAAI3V,KAAK,UAEf4yB,KAAKd,yBAAiC3lB,SAGjD9G,IAAK,SAASiB,GACV,IAAI2sB,EAAoBv2B,EAASiI,YAAY2J,UAAUjJ,IAAI4K,KAAKnS,KAAMwI,GACtE,OAAO8rB,sCAA0Ca,IAGrD/yB,IAAK,SAAS2G,EAAYC,GACnBD,EAAW3H,SACV2H,EAAW3H,OAASkzB,sCAA0CvrB,EAAW3H,SAGxE2H,EAAW3H,QAAW2H,EAAWhB,YAAa/H,KAAKg1B,YACpDh1B,KAAKo0B,gBAGTx1B,EAASiI,YAAY2J,UAAUpO,IAAI+P,KAAKnS,KAAM+I,EAAYC,IAE9Db,SAAS,SAAU2qB,GACf,IAAI3kB,EAAYnO,KAAKkH,UACrBiH,EAAUjM,KAAK,SAASoM,KAAK,QAASwkB,GACtC3kB,EAAUjM,KAAK,SAASqH,IAAIupB,MAIpCsC,gBAAiBx2B,EAASiI,YAAY7H,OAAO,CAEzC0E,WAAW,SAAUsD,GACjBhH,KAAK4H,WAAWZ,GAChBA,EAAK2B,SAAW3I,KAAKkH,WAAalH,KAAKo0B,iBAG3CY,SAAU,WACN,IAAInd,EAAM7X,KAAKkH,UAEf,OAAO2Q,GAAOA,EAAI3V,KAAK,UAG3B+yB,gBAAiB,WACAj1B,KAAKg1B,WACX1kB,MAEPtQ,KAAKu0B,QAAUv0B,KAAKu0B,OAAOvU,UAG/BoU,cAAc,WACV,IAAIvc,EAAM7X,KAAKkH,UACXgf,EAASlmB,KAAKg1B,WAElBh1B,KAAKi1B,kBAELj1B,KAAKu0B,OAAS,IAAIC,KAAkB,CAChC3P,GAAIqB,EAAO,GACXuO,OAAQ,SACRS,WAAYp2B,oCACZmK,SAAUid,EAAO,GAAGjd,SACpBosB,QAAS12B,EAAEgH,KAAK6tB,EAAgBxzB,QAEpCkmB,EAAO0O,OAAOj2B,EAAEgH,MAAK,SAAU+rB,GAE3BA,EAAIngB,kBAGJjQ,EAAOowB,EAAIha,QAAQnO,IAAIoqB,EAA2BjC,EAAIha,OAAOjX,QAC7D+yB,EAAerhB,KAAKnS,KAAMsB,EAAOowB,EAAIha,QAAQnO,SAC9CvJ,OAEHkmB,EAAO2O,MAAM,UACAhd,EAAI3V,KAAK,UACf4yB,KAAKd,yBAAiC3lB,SAGjD9G,IAAK,SAASiB,GACV,IAAI8sB,EAAgB12B,EAASiI,YAAY2J,UAAUjJ,IAAI4K,KAAKnS,KAAMwI,GAClE,OAAO8rB,4BAAgCgB,IAG3ClzB,IAAK,SAAS2G,EAAYC,GAClBD,EAAW3H,SACX2H,EAAW3H,OAASkzB,4BAAgCvrB,EAAW3H,SAG9D2H,EAAW3H,QAAW2H,EAAWhB,YAAa/H,KAAKg1B,YACpDh1B,KAAKo0B,gBAGTx1B,EAASiI,YAAY2J,UAAUpO,IAAI+P,KAAKnS,KAAM+I,EAAYC,IAE9Db,SAAS,SAAU2qB,GACf,IAAI3kB,EAAYnO,KAAKkH,UACrBiH,EAAUjM,KAAK,SAASoM,KAAK,QAASwkB,GACtC3kB,EAAUjM,KAAK,SAASqH,IAAIupB,MAIpC1J,aAAcxqB,EAASiI,YAAY7H,OAAO,CACtC0E,WADsC,SAC3B9D,GAAuC,WAArB21B,EAAqB,uDAAJ,GAEtCjpB,EACAipB,EADAjpB,sBAGJtM,KAAKoM,QAAUmpB,EAAenpB,QAC9BpM,KAAKqM,qBAAuBkpB,EAAelpB,qBAC3CrM,KAAKuM,uBAAyBgpB,EAAehpB,uBAExCvM,KAAK0lB,eACN1lB,KAAKw1B,2CAA6C,IAAIxC,GAA2C,CAC7FC,0BAA2B,IAAIP,GAA0B,CACrDjmB,UAAW7M,EAAiBsB,GAC5BmL,qBAAsBrM,KAAKqM,yBAInCrM,KAAKy1B,sBAAwB,IAAIC,KAA4B,CACzDC,SAAU,IACVC,mBAAoB,EACpBC,kBAAkB,EAClBC,QAAS,SAAC90B,GACNA,EAAU+0B,GAA2CnS,OAAOoS,OAAO,CAC/D5C,KAAM,EAAKlyB,GACXqL,uBAAwB,EAAKA,wBAC9BvL,IAEH,IAAIi1B,EAAM,EAAKT,2CAA2C5kB,QAAQ,EAAKxE,QAASpL,GAEhF,OADApC,EAASgH,MAAMC,oBAAoBowB,EAAK,MAAM,GACvCA,KAKfj2B,KAAKk2B,gCAAkC7C,GAAmC/mB,GAE1EtM,KAAK0lB,aAAe,IAAI0D,EAAJ,IAChBxY,QAAS5Q,KAAKy1B,sBAAsB7kB,QACpCY,eAAgBwiB,sBAChB3K,YAAa,SAAC5oB,GAAU,MACpB,iBAAO,EAAK+0B,2CAA2CW,gBAAgB11B,UAAvE,QACO,EAAKy1B,gCAAgCz1B,KALhC,iBAOAuzB,wBACjBjU,YAAYngB,EAAiBL,UAE5BK,GACAjB,EAAEK,OAAOgB,KAAMJ,KAK3B2I,OArDsC,WAsDlC,IAAMvF,EAAWpE,EAASuF,eAAe+D,eAAelI,KAAK0E,MAE7D,GAAI1B,EAAU,CACVhD,KAAK0lB,aAAaxJ,mBAElB,IAAM9U,EAAU9F,EAAO0B,EAAShD,OAEhCA,KAAK0lB,aAAand,SAASuP,aAE3B1Q,EAAQlF,KAAK,kBAAkBsM,OAAOxO,KAAK0lB,aAAab,IAExD7kB,KAAKmH,QAAQC,GACbpH,KAAK0lB,aAAa7J,iBAElB7b,KAAKo2B,eAAiBp2B,KAAKo2B,gBAC3Bp2B,KAAK6H,UAAU7H,OAASA,KAAKqH,6BAIrCc,SAzEsC,SAyE7BC,GACLpI,KAAK0lB,aAAavd,SAASC,EAAgB,CAAE6I,QAAQ,KAGzDolB,8BA7EsC,SA6ERtuB,GAC1B/H,KAAKk2B,gCAAkC7C,GAAmCtrB,IAG9EM,MAjFsC,SAiFhC5I,EAAK8M,GAAwB,WAC/BvM,KAAKoM,QAAU3M,EACfO,KAAKuM,uBAAyBA,EAE9B,IAAM0pB,EAAM30B,EAAOgF,WAenB,OAbAtG,KAAK0lB,aAAapV,IAAI,mBAAmB2K,KAAK,mBAAmB,SAACqb,IAC9DC,SAAeD,EAAIE,aAAa5zB,SAChCqzB,EAAI5vB,OAAOiwB,GAEX,EAAKjvB,8BAGTrH,KAAKy1B,sBAAsBgB,QAE3Bz2B,KAAK0lB,aAAard,OAAM,WACpB4tB,EAAItvB,QAAJ,MAAAsvB,EAAG,cAGAA,GAGX5uB,yBAvGsC,WAwGlCrH,KAAK0lB,aAAapV,IAAI,oBAAoBC,GAAG,oBAAoB,SAAUxI,GACvE/H,KAAK8H,gCAAgC,CAACC,MACvC/H,MAEHA,KAAK0lB,aAAapV,IAAI,mBAAmBC,GAAG,mBAAmB,SAAC+lB,IAC5DC,SAAeD,EAAIE,aAAa5zB,eAK5C8zB,YAAa93B,EAASiI,YAAY7H,OAAO,CACrC0E,WADqC,SAC1B9D,GAAuC,WAArB21B,EAAqB,uDAAJ,GAEtCjpB,EACAipB,EADAjpB,sBAGJtM,KAAKoM,QAAUmpB,EAAenpB,QAC9BpM,KAAKqM,qBAAuBkpB,EAAelpB,qBAC3CrM,KAAKuM,uBAAyBgpB,EAAehpB,uBAExCvM,KAAK22B,cACN32B,KAAKw1B,2CAA6C,IAAIxC,GAA2C,CAC7FC,0BAA2B,IAAIP,GAA0B,CACrDjmB,UAAW7M,EAAiBsB,GAC5BmL,qBAAsBrM,KAAKqM,yBAInCrM,KAAKy1B,sBAAwB,IAAIC,KAA4B,CACzDC,SAAU,IACVC,mBAAoB,EACpBC,kBAAkB,EAElBC,QAAS,SAAC90B,GACNA,EAAU+0B,GAA2CnS,OAAOoS,OAAO,CAC/D5C,KAAM,EAAKlyB,GACXqL,uBAAwB,EAAKA,wBAC9BvL,IAEH,IAAIi1B,EAAM,EAAKT,2CAA2C5kB,QAAQ,EAAKxE,QAASpL,GAEhF,OADApC,EAASgH,MAAMC,oBAAoBowB,EAAK,MAAM,GACvCA,KAIfj2B,KAAKk2B,gCAAkC7C,GAAmC/mB,GAE1EtM,KAAK22B,YAAc,IAAID,GAAY,CAC/B9lB,QAAS5Q,KAAKy1B,sBAAsB7kB,QACpC6f,oBAAqB,CACjBnC,YAAa,SAAC7tB,GAAU,MACpB,iBAAO,EAAK+0B,2CAA2CW,gBAAgB11B,UAAvE,QACQ,EAAKy1B,gCAAgCz1B,IAEjD2tB,SAAUwI,GAA8C5C,+BAE5D3E,WAAY,EACZ7d,eAAgBwiB,wBAGpBh0B,KAAK22B,YAAY5W,YAAYngB,EAAiBL,UAE9CS,KAAK62B,QAAUl4B,EAAEm4B,SAASn4B,EAAEgH,KAAK3F,KAAK22B,YAAYhc,OAAQ3a,KAAK22B,aAAc,KAEzE/2B,GACAjB,EAAEK,OAAOgB,KAAMJ,KAK3B2I,OA5DqC,WA6DjC,IAAMvF,EAAWpE,EAASuF,eAAe+D,eAAelI,KAAK0E,MAE7D,GAAI1B,EAAU,CACVhD,KAAK22B,YAAYza,mBAEjB,IAAM9U,EAAU9F,EAAO0B,EAAShD,OAEhCA,KAAK22B,YAAYpuB,SAASuP,aAE1B1Q,EAAQlF,KAAK,kBAAkBsM,OAAOxO,KAAK22B,YAAY9R,IAEvD7kB,KAAKmH,QAAQC,GACbpH,KAAK22B,YAAY9a,iBAEjB7b,KAAKo2B,eAAiBp2B,KAAKo2B,gBAC3Bp2B,KAAK6H,UAAU7H,OAASA,KAAKqH,6BAIrCc,SAhFqC,SAgF5BC,GACLA,EAAiBzJ,EAAEsC,QAAQmH,IAAmBzJ,EAAEojB,MAAM3Z,KAAmBuB,6BAA4C,GAAKvB,EAC1HpI,KAAK22B,YAAYxuB,SAASC,EAAgB,CAAC6I,QAAQ,IACnDjR,KAAK62B,WAGTR,8BAtFqC,SAsFPtuB,GAC1B/H,KAAKk2B,gCAAkC7C,GAAmCtrB,IAG9EM,MA1FqC,SA0F/B5I,EAAK8M,GAAwB,WACzB0pB,EAAM30B,EAAOgF,WAkBnB,OAhBAtG,KAAKoM,QAAU3M,EACfO,KAAKuM,uBAAyBA,EAE9BvM,KAAKy1B,sBAAsBgB,QAE3Bz2B,KAAK22B,YAAYrmB,IAAI,mBAAmB2K,KAAK,mBAAmB,SAACqb,IAC7DC,SAAeD,EAAIE,aAAa5zB,SAChCqzB,EAAI5vB,OAAOiwB,GAEX,EAAKjvB,8BAGTrH,KAAK22B,YAAYtuB,OAAM,WACnB4tB,EAAItvB,QAAJ,MAAAsvB,EAAG,cAGAA,GAGX3tB,YAhHqC,WAiHjCtI,KAAK22B,YAAYruB,eAGrBjB,yBApHqC,WAqHjCrH,KAAK22B,YAAYrmB,IAAI,oBAAoBC,GAAG,oBAAoB,SAAUxI,GACtE/H,KAAK8H,gCAAgCC,KACtC/H,MAEHA,KAAK22B,YAAYrmB,IAAI,mBAAmBC,GAAG,mBAAmB,SAAC+lB,IAC3DC,SAAeD,EAAIE,aAAa5zB,aAIxC2E,IA9HqC,SA8HjCiB,GACA,IAAMrI,EAASH,KAAKwI,GAEpB,MAAkB,cAAdA,GAA6B7J,EAAEkG,QAAQ1E,GAChC,GAEAA,GAIfi2B,cAxIqC,WAyIjC,IAAMW,EAAS/2B,KAAK22B,YAAY9e,IAAI3V,KAAK,cAGrC60B,EAAOh0B,QACPg0B,EAAOlG,SAASE,YAAY/wB,KAAKkH,WAAalH,KAAKkH,UAAUhF,KAAK,sBAK9E80B,kBAAmBp4B,EAASiI,YAAY7H,OAAO,CAC3C0E,WAD2C,SAChC9D,GAAgC,IAAdoB,EAAc,uDAAJ,GACnCpB,GAAoBjB,EAAEK,OAAOgB,KAAMJ,GAEnCI,KAAKoM,QAAUpL,EAAQoL,QACvBpM,KAAKqM,qBAAuBrL,EAAQqL,qBACpCrM,KAAKuM,uBAAyBvL,EAAQuL,uBACtCvM,KAAKizB,0BAA4B,IAAIP,GAA0B,CAC3DjmB,UAAW7M,EAAiBsB,GAC5BmL,qBAAsBrM,KAAKqM,wBAInC9D,OAb2C,WAcvC,IAAMvF,EAAWpE,EAASuF,eAAe+D,eAAelI,KAAK0E,MAE7D,GAAI1B,EAAU,CACV,IAAMoE,EAAU9F,EAAO0B,EAAShD,OAChCA,KAAKmH,QAAQC,GAEbpH,KAAKo2B,eAAiBp2B,KAAKo2B,gBAC3Bp2B,KAAK6H,UAAU7H,OAASA,KAAKqH,2BAGjC,OAAOrH,KAAKqI,MAAMrI,KAAKoM,QAASpM,KAAKuM,yBAGzClE,MA3B2C,SA2BrC5I,EAAK8M,GAAwB,WAC/B,OAAOvM,KAAKi3B,WAAWx3B,EAAK8M,GAAwB7G,MAAK,SAACvF,GACtD,EAAK+2B,YAAY/2B,EAAOoE,UAIhC0yB,WAjC2C,SAiChCx3B,EAAK8M,GACZvM,KAAKoM,QAAU3M,EACfO,KAAKuM,uBAAyBA,EAE9B,IAAMvL,EAAU+0B,GAA2C,CACvD3C,KAAMpzB,KAAKkB,GACXqL,uBAAwBvM,KAAKuM,uBAC7BsE,OAAQ,IAGZ,OAAO7Q,KAAKizB,0BAA0BriB,QAAQ5Q,KAAKoM,QAASpL,IAGhEk2B,YA9C2C,SA8C/BpE,GAAa,WACjBjI,EAAO7qB,KAAKkH,WAAalH,KAAKkH,UAAUhF,KAAK,MAAM,GACvD,GAAG2oB,EAAK,CACJ,IAAMtmB,EAAOuuB,EAAY1zB,KAAI,SAACmK,GAC1B,IAAMpJ,EAASxB,EAAEirB,MAAMrgB,GAMvB,OAJApJ,EAAOZ,SAAW,EAAKA,SACvBY,EAAOizB,KAAO,EAAK+D,gBACnBh3B,EAAOi3B,KAAOz4B,EAAE04B,SAAS,EAAKn2B,IAEvBf,KAGL6C,EAAWhD,KAAKyH,mBAAmB,QAEzC7I,EAASgH,MAAM0xB,aAAazM,EAAM7nB,EAAU,CACxCuB,UAGJsmB,EAAOvpB,EAAOupB,IACThC,KAAKgC,EAAKhC,OAAS,UAGpBgC,EAAK3oB,KAAK,MAAMa,OAAS,GAAK/C,KAAKkH,UAAU,GAAGqwB,aAAe,KAC/Dv3B,KAAKkH,UAAUhF,KAAK,cAAcyc,SAAS,UAC3C3e,KAAKkH,UAAUhF,KAAK,aAAaoc,YAAY,WAAWhQ,KAAK,SAAS,IAElEtO,KAAKqvB,YACLrvB,KAAKkH,UAAUhF,KAAK,cAAcoc,YAAY,UAC9Cte,KAAKkH,UAAUhF,KAAK,aAAayc,SAAS,cAO1DwY,cAlF2C,WAmFvC,OAAOn3B,KAAKkB,GAAK,WAGrBmG,yBAtF2C,WAsFhB,WACvBrH,KAAKkH,UAAUqJ,GAAG,SAAU,SAAS,SAACmhB,GAClC,IAAM3pB,EAAY2pB,EAAIha,OAAOjX,MAE7B6J,YAAW,WACP,EAAKlI,IAAI,CAAC2F,UAAU,CAACA,YAMjCquB,cAjG2C,WAkGvCp2B,KAAKqvB,WAAY,EAEjB,IAAMxE,EAAO7qB,KAAKkH,UAAUhF,KAAK,MAC3BouB,EAAQtwB,KAAKkH,UAAUhF,KAAK,cAAcoc,YAAY,UAE5DgS,EAAM3R,SAAS,kBACfkM,EAAKwE,UAAU,CACXF,QAAQ,CACJ,EAAKmB,QAMrBkH,oBAAqB54B,EAASiI,YAAY7H,OAAO,CAC7C0E,WAD6C,SAClC9D,GAAgC,IAAdoB,EAAc,uDAAJ,GACnCpB,GAAoBjB,EAAEK,OAAOgB,KAAMJ,GAEnCI,KAAKoM,QAAUpL,EAAQoL,QACvBpM,KAAKqM,qBAAuBrL,EAAQqL,qBACpCrM,KAAKuM,uBAAyBvL,EAAQuL,uBAEtCvM,KAAKizB,0BAA4B,IAAIP,GAA0B,CAC3DjmB,UAAW7M,EAAiBsB,GAC5BmL,qBAAsBrM,KAAKqM,wBAInC9D,OAd6C,WAezC,IAAMvF,EAAWpE,EAASuF,eAAe+D,eAAelI,KAAK0E,MAE7D,GAAI1B,EAAU,CACV,IAAMoE,EAAU9F,EAAO0B,EAAShD,OAChCA,KAAKmH,QAAQC,GAEbpH,KAAKo2B,eAAiBp2B,KAAKo2B,gBAC3Bp2B,KAAK6H,UAAU7H,OAASA,KAAKqH,2BAGjC,OAAOrH,KAAKqI,MAAMrI,KAAKoM,QAASpM,KAAKuM,yBAGzClE,MA5B6C,SA4BvC5I,EAAK8M,GAAwB,WAC/B,OAAOvM,KAAKi3B,WAAWx3B,EAAK8M,GAAwB7G,MAAK,SAACvF,GACtD,EAAK+2B,YAAY/2B,EAAOoE,UAIhC0yB,WAlC6C,SAkClCx3B,EAAK8M,GACZvM,KAAKoM,QAAU3M,EACfO,KAAKuM,uBAAyBA,EAE9B,IAAMvL,EAAU+0B,GAA2C,CACvD3C,KAAMpzB,KAAKkB,GACXqL,uBAAwBvM,KAAKuM,uBAC7BsE,OAAQ,IAGZ,OAAO7Q,KAAKizB,0BAA0BriB,QAAQ5Q,KAAKoM,QAASpL,IAGhEk2B,YA/C6C,SA+CjCpE,GAAa,WACfvuB,EAAOuuB,EAAY1zB,KAAI,SAACmK,GAC1B,IAAMpJ,EAASxB,EAAEirB,MAAMrgB,GAKvB,OAHApJ,EAAOZ,SAAW,EAAKA,SACvBY,EAAOi3B,KAAOz4B,EAAE04B,SAAS,EAAKn2B,IAEvBf,KAGL0qB,EAAO7qB,KAAKkH,WAAalH,KAAKkH,UAAUhF,KAAK,MAAM,GACzD,GAAG2oB,EAAK,CACJ,IAAM7nB,EAAWhD,KAAKyH,mBAAmB,QAEzC7I,EAASgH,MAAM0xB,aAAazM,EAAM7nB,EAAU,CAACuB,KAAKA,IAG9CjD,EAAOupB,GAAM3oB,KAAK,MAAMa,OAAS,GAAK/C,KAAKkH,UAAU,GAAGqwB,aAAe,KACvEv3B,KAAKkH,UAAUhF,KAAK,cAAcyc,SAAS,UAC3C3e,KAAKkH,UAAUhF,KAAK,aAAaoc,YAAY,WAAWhQ,KAAK,SAAS,IAElEtO,KAAKqvB,YACLrvB,KAAKkH,UAAUhF,KAAK,cAAcoc,YAAY,UAC9Cte,KAAKkH,UAAUhF,KAAK,aAAayc,SAAS,cAO1DnK,aA7E6C,WA8EzC,IAAMijB,EAAQz3B,KAAKkH,UAAUhF,KAAK,aAAaoN,OAAO,YAEtD,OAAO3Q,EAAES,IAAIq4B,GAAO,SAAUC,GAC1B,OAAOp2B,EAAOo2B,GAAKnuB,UAI3BlC,yBArF6C,WAqFlB,WACvBrH,KAAKkH,UAAUqJ,GAAG,SAAU,SAAS,SAACmhB,GAClC,IAAM3pB,EAAY,EAAKyM,eAEvBlK,YAAW,WACP,EAAKlI,IAAI,CAAC2F,UAAUA,UAI5B/H,KAAKkH,UAAUqJ,GAAG,QAAQ,KAAK,SAACmhB,GAC5B,IAAM1wB,EAAU,EAAKkG,UAAUhF,KAAK,SAC9BkxB,EAAO9xB,EAAOowB,EAAIha,QAAQ,GAAG0b,KAEtB,mBAATA,GAAsC,oBAATA,EAC7Bz0B,EAAEmB,KAAKkB,GAAS,SAASR,GACrBA,EAAIm3B,QAAmB,mBAATvE,KAEF,uBAATA,GACPz0B,EAAEmB,KAAKkB,GAAU,SAASR,GACtBA,EAAIm3B,SAAWn3B,EAAIm3B,WAI3B,EAAKzwB,UAAUhF,KAAK,SAAS0yB,aAIrCrtB,IAhH6C,SAgHzCiB,GACA,IAAMrI,EAASH,KAAKwI,GAEpB,MAAkB,cAAdA,GAA6B7J,EAAEkG,QAAQ1E,GAChC,GAEAA,GAKfi2B,cA3H6C,WA4HzCp2B,KAAKqvB,WAAY,EAEjB,IAAMxE,EAAO7qB,KAAKkH,UAAUhF,KAAK,MAC3BouB,EAAQtwB,KAAKkH,UAAUhF,KAAK,cAAcoc,YAAY,UAE5DgS,EAAM3R,SAAS,kBACfkM,EAAKwE,UAAU,CACXF,QAAQ,CACJ,EAAKmB,UAtxBb,CA6xBZhvB,IACA3C,IACAG,eAGWA,KAAf,S,oMC/0BqB84B,G,WAGjB,WAAY52B,I,4FAAsC,cAFjC80B,aAEiC,EAC9C91B,KAAK81B,QAAU90B,EAAQ80B,SAAWA,K,qEAGtC,SAA+BlyB,GAC3B,OAAO5D,KAAK81B,QAAQ,CAChBpxB,KAAM,MACNJ,IAAK,GAAF,OAAKuzB,eAAL,2BAA6Cj0B,EAA7C,iCACHuB,QAAS,CACL2yB,OAAQ,wB,sCAKpB,SAAyBl0B,GACrB,OAAO5D,KAAK81B,QAAQ,CAChBpxB,KAAM,MACNJ,IAAK,GAAF,OAAKuzB,eAAL,2BAA6Cj0B,EAA7C,gCACHuB,QAAS,CACL2yB,OAAQ,wB,oCAKpB,SAAuBl0B,EAAmBm0B,GAEtC,OAAO/3B,KAAK81B,QAAQ,CAChBpxB,KAAM,MACNJ,IAAK,GAAF,OAAKuzB,eAAL,2BAA6Cj0B,EAA7C,0BAAwEm0B,EAAgB7zB,KAAK,KAA7F,kDACHiB,QAAS,CACL2yB,OAAQ,wB,+CAKpB,SAAkCl0B,EAAmB5C,GACjD,IAAMgD,EAAa4f,OAAOta,KAAKtI,GAAS5B,KAAI,SAAC44B,GAAD,OAAQA,KAAI9zB,KAAK,KAC7D,OAAOlE,KAAK81B,QAAQ,CAChBpxB,KAAM,OACNJ,IAAK,GAAF,OAAKuzB,eAAL,2BAA6Cj0B,EAA7C,0BAAwEI,EAAxE,6CACHO,KAAMlD,KAAK0D,UAAU/D,GACrBmE,QAAS,CACL2yB,OAAQ,mBACR,eAAgB,wB,6CAK5B,SAAgCl0B,EAAmB5C,GAC/C,IAAMgD,EAAahD,EAAQ5B,KAAI,SAAC64B,GAAD,OAAOA,EAAE7E,QAAMlvB,KAAK,KAEnD,OAAOlE,KAAK81B,QAAQ,CAChBpxB,KAAM,OACNJ,IAAK,GAAF,OAAKuzB,eAAL,2BAA6Cj0B,EAA7C,0BAAwEI,EAAxE,6DACHO,KAAMlD,KAAK0D,UAAU,CACjBmzB,gBAAiBl3B,IAErBmE,QAAS,CACL2yB,OAAQ,mBACR,eAAgB,2B,yMChEhC,IAAMK,GAAc,SAACv0B,EAAmB5C,GAGpC,OAFsBrC,WAASqC,EAAS,QAEnB6iB,QAAO,SAACyP,EAAM/yB,GAAW,IAOpC63B,EAAS,CAFX73B,EAHA6yB,KAGA7yB,EAFAsQ,OAEAtQ,EADAuQ,OAICunB,OAAO93B,EAAO+gB,UAAY,IAC1B+W,OAAO93B,EAAOE,OAAS,IACvB43B,OAAO93B,EAAOuT,QAAU,IAE7B,gBAAUwf,EAAV,YAAkBjyB,KAAK0D,UAAUqzB,MAZ9B,UAaDx0B,KAeW00B,G,WAKjB,WAAYt3B,I,4FAAsC,cAJjCqL,0BAIiC,OAF1CzH,WAE0C,EAC9C5E,KAAK4E,MAAQ,GACb5E,KAAKqM,qBAAuBrL,EAAQqL,qB,qEAGxC,SAA+BzI,GAC3B,OAAO5D,KAAKqM,qBAAqBksB,+BAA+B30B,K,sCAGpE,SAAyBA,GACrB,OAAO5D,KAAKqM,qBAAqBmsB,yBAAyB50B,K,oCAG9D,SAAuBA,EAAmBm0B,GACtC,OAAO/3B,KAAKqM,qBAAqBosB,uBAAuB70B,EAAWm0B,K,+CAGvE,SAAkCn0B,EAAmB5C,GACjD,OAAOhB,KAAKqM,qBAAqBqsB,kCAAkC90B,EAAW5C,K,6CAGlF,SAAgC4C,EAAmB5C,GAAmC,WAC5E23B,EAAWR,GAAYv0B,EAAW5C,GAClC43B,EAAa54B,KAAK4E,MAAM+zB,GAExB1C,EAAMje,eAqBZ,OAnBI4gB,EACA3C,EAAItvB,QAAQiyB,GAEZ54B,KAAKqM,qBAAqBwmB,gCACtBjvB,EACA5C,GACF0E,MAAK,WAAa,2BAATsB,EAAS,yBAATA,EAAS,oBAEZ9H,EACA8H,EAHY,GAKhB,EAAKpC,MAAM+zB,GAAYz5B,EAEvB+2B,EAAItvB,QAAQzH,MACb,WACC+2B,EAAI5vB,OAAJ,MAAA4vB,EAAG,cAIJA,I,oDAGX,SACIryB,EACA5C,EACA43B,GAEA,IAAMD,EAAWR,GAAYv0B,EAAW5C,GAExChB,KAAK4E,MAAM+zB,GAAYC,I,wBAG3B,WACI54B,KAAK4E,MAAQ,Q,kCChGrB,SAAe,SACkBi0B,GACzB,OAAOA,EAASx5B,aAAaD,KAAI,SAAC6C,GAAD,wBAC1BA,EAD0B,CAE7BxC,IAAKwC,EAAQxC,IAAIC,QAAQ,QAAS,U,IChBzCo5B,I,SAAAA,K,YAAAA,E,oCAAAA,E,wCAAAA,E,oCAAAA,E,6CAAAA,E,oCAAAA,E,6BAAAA,E,wCAAAA,E,2BAAAA,E,6CAAAA,Q,KAaL,Y,gICRA,IAEMC,GAAY,SAACxsB,GACf,OAAO5N,SAAO4N,EAAwB,CAAC,WAQrCysB,IAAoD,SACrDF,wBAA2C,SAACvsB,GACzC,OAAOwsB,GAAUxsB,MAFiC,MAIrDusB,0BAA6C,SAACvsB,GAC3C,OAAOwsB,GAAUxsB,MALiC,IAS1D,kBACIrL,EACAwD,GAKC,IAJD1D,EAIC,uDADG,GAEEb,EAAS,OAAH,QACRizB,KAAMlyB,EACN2P,OAAQ,EACRC,MA/BM,KAgCH9P,GAGDi4B,EAA4BD,GAA0Bt0B,GAE5D,OAAIu0B,EACOA,EAA0B94B,GAG9BA,GC5CX,IAAM+4B,GAAgB,CAClBJ,iBACAA,gBACAA,uBACAA,0BAGJ,MCSA,YACI93B,GAIC,IAEG0J,EACA1J,EADA0J,SAGJ,OACIkZ,OAAOta,KAAKoB,GAAUtL,KAAI,SAAC8B,GACvB,wBACOi4B,GACCj4B,EACAwJ,EAASxJ,GAAIwD,KACbgG,EAASxJ,GAAIT,MAAQ9B,SAAO+L,EAASxJ,GAAK,CAAC,UAAYvC,SAAO+L,EAASxJ,GAAK,CAAC,iB,2uCCRjG,IAAMk4B,GAA4C,SAC9Cr5B,EACAs5B,EAGAC,EACAve,GAEA,OAAOhb,EAAU8jB,QAAO,SAACyP,EAAMrxB,GAC3B,GF1BR,SAAgBA,GAGZ,OAAOi3B,GAAcv2B,QAAQV,EAAQyC,OAAS,EEuBtC60B,CAAet3B,GAAU,CACzB,IAAMu3B,EAEF,OAAH,UACMlG,EADN,MAEIrxB,EAAQf,GAAKu4B,GAAwC,CAClDhtB,UAAWxK,EAAQf,GACnBwJ,SAAU2uB,IACXj6B,IAAIk6B,KAOX,YAJwB,IAAbve,GACPA,EAASye,EAAQv3B,EAAQf,KAGtBs4B,EAGX,OAAOlG,IACR,KAiEcoG,G,WAGjB,WAAY14B,I,4FAAkB,cAFbqL,0BAEa,EAC1BrM,KAAKqM,qBAAuBrL,EAAQqL,qB,qEAGxC,SAA+B5M,EAAak6B,GAAmD,WAE3F,OAAO35B,KAAKqM,qBAAqBmsB,yBAAyB/4B,GAAKiG,MAAK,SAACxG,GACjE,GAAIA,EAAU,CACV,IAAMa,EAAY65B,GAA+D16B,GACjF,OAAO,EAAK26B,iDAAiDp6B,EAAKM,EAAW45B,GAEjF,OAAO3hB,eAAarR,QAAQzH,Q,kDAIpC,SAAqCO,EAAaM,EAA+B+5B,GAC7E,OAAO95B,KAAK65B,iDAAiDp6B,EAAKM,EAAW+5B,K,wDAGjF,SACI/xB,EAGAtI,EACAM,GAEA,IAAMs5B,EAEFt5B,EAAU8jB,QAAO,SAACkW,EAAe93B,GACjC,wBACO83B,EADP,MAEK93B,EAAQf,GAAKe,MAEnB,IAEG+3B,EAAoBr7B,QAAMoJ,GAAW,SAACtH,EAAOgM,GAC/C,OAAO0sB,GACH1sB,EACA4sB,EAAY5sB,GAAW/H,KACvB,CACIjE,MAAOA,GAA0B,IAAjBA,EAAMsC,OAAe,CAAC4G,8BAA6C5B,EAAU0E,IAAc,QAKjHwtB,EAA8Bb,GAChCr5B,EACAs5B,GACA,SAAC94B,GACG,wBACOA,EADP,CAEIE,MAAOsH,EAAUxH,EAAO6yB,OAAS,QAK7C,OAAOpzB,KAAKk6B,wDAAwD,CAChEF,oBACAC,8BACAx6B,QACDiG,MAAK,SAACxG,GACL,OAAO8Y,eAAarR,QAAQzH,EAAU86B,EAAmBC,Q,8DAIjE,SAAiDj5B,GAW9C,IAEKyL,EAKAzL,EALAyL,UACAhM,EAIAO,EAJAP,MACAhB,EAGAuB,EAHAvB,IACAM,EAEAiB,EAFAjB,UACAgI,EACA/G,EADA+G,UAYEiyB,EA/JmD,SAACh5B,GAS5D,IAEEyL,EAIAzL,EAJAyL,UACAhM,EAGAO,EAHAP,MACAiK,EAEA1J,EAFA0J,SACA3C,EACA/G,EADA+G,UAGEoyB,EAAsCx7B,WAAS+L,GAAU,SAAC0vB,EAAan4B,GACzE,IAAIo4B,EAAoB,GAaxB,OAVIA,EADAp4B,EAAQf,KAAOuL,EACK,CAChBhM,MAAOA,EAAMsC,OAAS,EAAItC,EAAQ,CAACkJ,+BAGnB,CAChBlJ,MAAOsH,EAAU9F,EAAQf,IACzB4S,OAAQnK,mBAIhB,iBACOywB,EADP,MAEKn4B,EAAQf,GAFb,eAGQo5B,mBAAoBr4B,EAAQq4B,oBAAsB,GAClDpvB,kBAAmBjJ,EAAQiJ,mBAAqB,GAChDxG,KAAMzC,EAAQyC,MACX21B,OAGZ,IAEH,OAAOZ,GAAwC,CAC3ChtB,YACA/B,SAAUyvB,IAmHgBI,CAAyD,CAC/E9tB,YACAhM,QACAsH,YACA2C,SAXA3K,EAAU8jB,QAAO,SAACuW,EAAan4B,GAC/B,wBACOm4B,EADP,MAEKn4B,EAAQf,GAAKe,MAEnB,MAQGu4B,EAA4C,OAAH,UAAQzyB,GACjD0yB,EAA2C97B,SAAO67B,EAAc77B,UAAQq7B,EAAmB,SACjGS,EAAoBhuB,GAAahM,EAEjC,IAAMi6B,EAA0B16B,KAAKqM,qBAChCqsB,kCAAkCj5B,EAAKg7B,GAE5C,OAAOz6B,KAAKk6B,wDAAwD,CAChEF,oBACAv6B,QACDiG,MAAK,SAACxG,GACL,OAAO8Y,SAA6B0iB,GAAyBh1B,MAAK,SAACpG,GAAQ,IAC/De,EAAsBf,EAAtBe,kBACFs6B,EAAsBt6B,GAAqBA,EAAkBwjB,QAAO,SAAC+W,EAAazrB,GACpF,wBACOyrB,EADP,MAEKzrB,EAAiBjO,GAAKiO,EAAiBnO,QAAUrC,UAAQwQ,EAAiBnO,QAAS,UAAY,GAC1FmO,EAAiB1O,UAE5B,IACH,OAAOuX,eAAarR,QAAQzH,EAAUy7B,EAAqBX,W,8DAKvE,SACIv6B,EACAM,EACA86B,GACF,WACQf,EAnJuB,SAAC/5B,EAA+B45B,GACjE,IAAMmB,EAAsCn8B,UAAQoB,EAAW,MACzDg7B,EAAmCp8B,SAAOg7B,GAC1CqB,EAAgC,GAChCC,EAA6Ct8B,iBAAem8B,EAAsBC,GAOxF,OALIE,EAA4Bl4B,OAAS,GACrCk4B,EAA4BzuB,SAAQ,SAACjD,GACjCyxB,EAAyBzxB,GAAOowB,EAAqBpwB,MAGtDyxB,EAwIkDE,CAA6Bn7B,EAAW86B,GACvFM,EAAgCp7B,EAAUX,KAAI,SAAC6C,GACjD,OAAOk3B,GACHl3B,EAAQf,GACRe,EAAQyC,KACRo1B,EAAgB73B,EAAQf,IAAM,CAC1BT,MAAOq5B,EAAgB73B,EAAQf,KAE7B,CACE4S,OAAQnK,uBAKlByxB,EAAgCp7B,KAAKqM,qBACtCwmB,gCAAgCpzB,EAAK07B,GAEpCE,EAAwBr7B,KAAKqM,qBAC9BksB,+BAA+B94B,GAEpC,OAAOuY,SAGLojB,EAA+BC,GAC5B31B,MAAK,SACF41B,EACAC,GACC,IAEGnzB,EAFH,GAGGmzB,EAHH,MAKKC,EAAkBF,aAAmCxtB,MACrDwtB,EAAwB,GACxBA,EAEFvzB,EAAY,GAChBA,EAAYK,EAAiBA,EAAemrB,cAAc1P,QAAO,SAAC4X,EAActsB,GAC5E,wBACOssB,EADP,MAEKtsB,EAAiBjO,GAAKiO,EAAiBnO,SAAW,OAExD,IAAM,GAET,IAAMq4B,EAAct5B,EAAU8jB,QAAO,SAACkW,EAAe93B,GACjD,wBACO83B,EADP,MAEK93B,EAAQf,GAAK44B,EAAgB73B,EAAQf,IAAxB,iBACPe,EADO,CAEVxB,MAAOq5B,EAAgB73B,EAAQf,MAFrB,iBAIPe,EAJO,CAKV6R,OAAQnK,wBAGjB,IAEGswB,EAA8Bb,GAChCr5B,EACAs5B,GACA,SAAC94B,GACG,OAAOu5B,EAAgBv5B,EAAO6yB,MAAvB,iBACA7yB,EADA,CAEHE,MAAOq5B,EAAgBv5B,EAAO6yB,QAF3B,iBAIA7yB,EAJA,CAKHuT,OAAQnK,uBAGhB,SAAC3I,GACG,EAAKqL,qBAAqBqvB,uCACtBj8B,EACAuB,EACAw6B,MAMZ,IAAK78B,YAAUm7B,GAAkB,CAC7B,IAAMU,EAA4C,OAAH,UAAQzyB,GACnD4zB,EAAgD,GACpD/X,OAAOta,KAAKkxB,GAAchuB,SAAQ,SAACwrB,GAC/B2D,EAAiB3D,GAAMr5B,UAAQ67B,EAAaxC,GAAK,YAErD2D,EAAmB,OAAH,UAAQA,EAAqB7B,GAC7C,IAAMY,EAA0B,EAAKruB,qBAChCqsB,kCAAkCj5B,EAAKk8B,GAC5C,OAAO3jB,SAA6B0iB,GAAyBh1B,MAAK,SAACpG,GAAQ,IAC/De,EAAsBf,EAAtBe,kBASR,OARA0H,EAAY1H,GAAqBA,EAAkBwjB,QAAO,SAAC+X,EAAWzsB,GAClE,wBACOysB,EADP,MAEKzsB,EAAiBjO,GAAKiO,EAAiBnO,QAAUmO,EAAiBnO,QAAQ5B,KAAI,SAAC44B,GAAD,OAAQr5B,SAAOq5B,EAAI,gBAAgB,GAC5G,CAAC,CAAEv3B,MAAO0O,EAAiB1O,MAAOC,MAAOyO,EAAiB1O,YAErE,IAEIuX,eAAarR,QAAQ,CACxB5G,YACAgI,YACAkyB,8BACAqB,wBAAyBE,OAIrC,OAAOxjB,eAAarR,QAAQ,CACxB5G,YACAgI,YACAkyB,8BACAqB,wBAAyBE,S,qEAKzC,SAAgEx6B,GAM7D,WAEKg5B,EAGAh5B,EAHAg5B,kBAFL,EAKKh5B,EAFAi5B,mCAHL,MAGmC,GAHnC,EAIKx6B,EACAuB,EADAvB,IAKJ,OAFAO,KAAKqM,qBAAqBwvB,aAEnB77B,KAAKqM,qBAAqBwmB,gCAAgCpzB,EAAKu6B,GACjEt0B,MAAK,SAACxG,GAYH,OAXA86B,EAAkBxtB,SAAQ,SAACsvB,GACvB,IAAMrvB,EAAYqvB,EAAyB1I,KAEvC6G,EAA4BxtB,IAC5B,EAAKJ,qBAAqBqvB,uCACtBj8B,EACAw6B,EAA4BxtB,GAC5BvN,MAILA,U,ixBC7VvB,IAAM68B,GAAkC,SAAC78B,EAAUwL,GAC/C,IAAMsxB,EAAe98B,GAAYA,EAASmB,kBAAoBnB,EAASmB,kBAAoB,GACvF47B,GAAmB,EA8BvB,OA5BAD,EAAaxvB,SAAQ,SAACsmB,GAClB,IAAM7wB,EAAUyI,EAASooB,EAAY5xB,IAEjCe,GAAWA,EAAQsF,IAAI,UACvBtF,EAAQG,IAAI,CACRjB,MAAO,OAIX2xB,EAAY3xB,QACZc,EAAQG,IAAI,CACRjB,MAAO2xB,EAAY3xB,QAGvB86B,GAAmB,IAIlBnJ,EAAY3xB,OACbc,GAAW62B,yBAA6C72B,EAAQyC,MAChEouB,EAAYryB,OAEZwB,EAAQG,IAAI,CACRhB,OAAQ,CAAC0xB,EAAYryB,YAK1Bw7B,IAGV,SAAU36B,EAAO3C,EAAGC,GAoBVD,EAAEK,OAAOJ,EAAU,CAGtBs9B,WAAat9B,EAASG,KAAKC,OAAO,CAE9BwE,YAAa,SAASxC,GAAS,WAC3BrC,EAAEgM,QAAQ3K,KACN,eACA,2BACA,YAGJA,KAAKqM,qBAAuB,IAAIisB,GAA8B,CAC1DjsB,qBAAsB,IAAIurB,GAAqB,CAC3C9B,iBAIR91B,KAAKm8B,iCAAmC,IAAIzC,GAAiC,CACzErtB,qBAAsBrM,KAAKqM,uBAG/BrM,KAAK6B,UAAYb,GAAWA,EAAQa,UAAYb,EAAQa,UAAY,IAAIjD,EAAS2L,UAGjFvK,KAAK0D,WAAW1C,GAEhBpC,EAASiM,OAAO,mCAChBjM,EAASmM,OAAO,CACZ,8BAA+B,WAC3B,EAAKqxB,4BAAL,QAAI,YAGR,kCAAmC,WAC/B,EAAKC,iCAAL,QAAI,cAIZz9B,EAAS09B,cAAe39B,EAAEgH,MAAK,WAC3B,OAAO3F,OACRA,MAKH,IAAIgL,EAAQ,IAAIuxB,YAAY,uBAAwB,CAChDC,OAAQx8B,KAAK8B,iBAGjBU,SAASi6B,cAAczxB,IAG3BoxB,4BAA6B,SAASpxB,EAAO0xB,EAA2Bj8B,EAAOk8B,GAAW,WAChF96B,EAAY7B,KAAK8B,eACjB4I,EAAW7I,EAAUqK,cAC3B,GAAIzL,GAASk8B,EAAW,CACpB,IAAM1G,EAAMj2B,KAAKm8B,iCAAiCS,iDAAiD,CAC/FnwB,UAAWiwB,EACXj8B,QACAhB,IAAKO,KAAKoM,QACVrM,UAAW8B,EAAU9B,UACrBgI,UAAWlG,EAAU0F,IAAI,aACzB+E,sBAAuBzK,EAAU8L,gBAAgBrB,wBAClD5G,MAAK,SAACxG,EAAUy7B,EAAqBX,GACpC,IAAM6C,EAAW7C,EAAkB56B,KAAI,SAAC08B,GACpC,IAAMrvB,EAAYqvB,EAAyB1I,KAE3C,OADA1oB,EAAS+B,GAAWF,uBAAyBytB,EACtC0C,IAA8BjwB,GAAa/B,EAAS+B,GAAWpE,MAAM,EAAK+D,QAAS4tB,MAG9F,OAAO14B,EAAOw7B,KAAP,MAAAx7B,EAAM,GAASu7B,IAAUn3B,MAAK,WACjC,OAAOpE,EAAOgF,WAAWK,QAAQg0B,EAAqBz7B,SAE3DwG,MAAK,SAACi1B,EAAqBz7B,GAC1By7B,EAAsB/W,OAAOoS,OAAO,GAAI2E,E,sHAAlB,IACjB+B,EAA4Bj8B,IAGjC9B,EAAEmB,KAAK66B,GAAqB,SAACv5B,EAAQF,GACjCwJ,EAASxJ,GAAIkB,IAAI,CAAEhB,cAGvB26B,GAAgC78B,EAAUwL,MA1BlC,OA2BH,SAAC4rB,GACN,IAAMr0B,EAAUyI,EAASgyB,GAQzB,OANAz6B,EAAQG,IAAI,CACRhB,OAAQa,EAAQ8F,aAGpBwuB,SAAeD,EAAIE,aAAa5zB,SAEzBtB,EAAOgF,WAAWD,OAAOiwB,MAGpC13B,EAASgH,MAAMC,oBAAoBowB,EAAK,MAAM,QAE9CyG,GAA6B18B,KAAK6B,UAAU6I,SAASgyB,GAA2Bt6B,IAAI,CAAC,UAAY3B,IAAO,IAIhH47B,iCAAkC,SAASrxB,EAAOzG,GAAM,WAEhDw4B,EAEAx4B,EAFAw4B,aACAC,EACAz4B,EADAy4B,qBAGEn7B,EAAY7B,KAAK6B,UACjB6I,EAAW7I,EAAUqK,cAE3BlM,KAAKoM,QAAU2wB,GAAgBA,EAAat9B,KAAOO,KAAKoM,QAExD,IAAM6pB,EAAMj2B,KAAKm8B,iCAAiCc,qCAC9Cj9B,KAAKoM,QACLvK,EAAU9B,UACVwE,EAAKiB,cACPE,MAAK,SAAC1E,GAAY,IAEZ+G,EACA/G,EADA+G,UAAWuzB,EACXt6B,EADWs6B,wBAAyBrB,EACpCj5B,EADoCi5B,4BAGlC4C,EAAWl+B,EAAES,IAAI66B,GAA6B,SAACiD,EAAyBh8B,GAC1E,IAAMe,EAAUyI,EAASxJ,GAIzB,OAFAe,EAAQo0B,+BAAiCp0B,EAAQo0B,8BAA8BtuB,EAAU7G,IAAO,IAEzFe,EAAQoG,MAAM,EAAK+D,QAAS8wB,MAGvC,OAAO57B,EAAOw7B,KAAP,MAAAx7B,EAAM,GAASu7B,IAAUn3B,MAAK,WACjC,OAAOpE,EAAOgF,WAAWK,QAAQoB,EAAWuzB,SAEjD51B,MAAK,SAACqC,EAAW7I,GAChBP,EAAEmB,KAAK4K,GAAS,SAACzI,EAAQoH,GACrBpH,EAAQG,IAAI,CACRhB,OAAQzC,EAAEqP,MAAMjG,EAAUsB,GAAM,cAIxC0yB,GAAgC78B,EAAUwL,MA3BlC,OA4BH,SAAC4rB,GAON,OANAC,SAAeD,EAAIE,aAAa5zB,SAEhChE,EAASu+B,cAAc/6B,IAAI,CACvB2F,UAAWi1B,IACZ,GAEI17B,EAAOgF,WAAWD,OAAOiwB,MAGpC13B,EAASgH,MAAMC,oBAAoBowB,EAAK,MAAM,IAOlDvyB,WAAa,SAAS1C,GAClBhB,KAAKoM,QAAUpL,EAAQo8B,iBAAmBp8B,EAAQ4C,WAGtDy5B,8BAA+B,SAAU1D,GAAsB,WACvD1D,EAAMj2B,KAAKm8B,iCAAiCmB,+BAC5Ct9B,KAAKoM,QAASutB,GAChBj0B,MAAK,SAAC1E,GACJ,GAAGA,EAAS,CACR,EAAKa,UAAUO,IAAI,CACfrC,UAAWiB,EAAQjB,UACnB4N,gBAAiB,CACbvB,QAAS,EAAKA,QACdC,qBAAsB,EAAKA,qBAC3BC,sBAAuBtL,EAAQ+G,UAC/BwE,uBAAwBvL,EAAQi5B,4BAChCqB,wBAAyBt6B,EAAQs6B,2BAIzC,IACM5wB,EADY,EAAK5I,eACIoK,cAE3B6vB,GAAgC/6B,EAAQs6B,wBAAyB5wB,GAErE,OAAOpJ,EAAOgF,WAAWK,QAAQ3F,MAGrC,OADApC,EAASgH,MAAMC,oBAAoBowB,EAAK,MAAM,GACvCA,GAIXn0B,aAAa,WACT,OAAO9B,KAAK6B,WAIhB07B,yBAA0B,SAAS/3B,GAAc,WACvC3D,EAAY7B,KAAK8B,eACjB4I,EAAW7I,EAAUqK,cAM3B,OAJK1G,IACDA,EAAe3D,EAAU0F,IAAI,cAG1BvH,KAAKm8B,iCAAiCqB,2CACzCh4B,EACAxF,KAAKoM,QACLvK,EAAU9B,WACZ2F,MAAK,SAACxG,EAAU86B,EAAmBC,GACjC,IAAM4C,EAAW7C,EAAkB56B,KAAI,SAAC08B,GACpC,IAAM75B,EAAUyI,EAASoxB,EAAyB1I,MAElD,OADAnxB,EAAQqG,cACDrG,EAAQoG,MAAM,EAAK+D,QACtB6tB,EAA4B6B,EAAyB1I,OAAS4G,MAGtE,OAAO14B,EAAOw7B,KAAP,MAAAx7B,EAAM,GAASu7B,IAAUn3B,MAAK,WACjC,OAAOxG,QAEZwG,MAAK,SAACxG,GACL68B,GAAgC78B,EAAUwL,GAE1C/L,EAAEmB,KAAK4K,GAAU,SAACzI,EAASf,GACvB,IACIF,EADEP,EAAQ+E,EAAatE,GAIvBF,EADAP,EACU,CACNW,OAAQX,GAGF,CACNU,MAAO,KACPC,YAAQsH,EACRX,eAAWW,GAInBzG,EAAQ6G,MAAM9H,UAM1By8B,SAAU,WACN,IAAM57B,EAAY7B,KAAK8B,eACjB4I,EAAW7I,EAAUqK,cAErB1G,EAAe3D,EAAU0F,IAAI,aAC7B0uB,EAAMj2B,KAAKm8B,iCAAiCqB,2CAC9Ch4B,EACAxF,KAAKoM,QACLvK,EAAU9B,WACZ2F,MAAK,SAACxG,GACJ,IAAM+8B,EAAmBF,GAAgC78B,EAAUwL,GACnE,OAAOpJ,EAAOgF,WAAWK,QAAQs1B,MAGrC,OADAr9B,EAASgH,MAAMC,oBAAoBowB,EAAK,MAAM,GACvCA,OApRtB,CAyRG30B,IACA3C,IACAG,eAGWA,KAAf,U,4CCnVAA,cAgBSmE,OAAOy6B,UACRz6B,OAAOy6B,QAAY,CAEf5O,IAAI,aAIJW,MAAM,aAGNtuB,MAAQ,gBAQLrC,KAAf,K,wHCrCA,SAASy3B,EAAeoH,EAAc38B,IAC7B28B,GAAgBA,EAAah7B,QAAQ,sCAAwC,EAC9EQ,2BAA+Bw6B,GAE/Bx6B,oBAAwBw6B,GAAc,EAAO38B,GAGrD,SAAS48B,EAAiBC,GAEtB,GAAwB,KAApBA,EAAUt7B,OAEV,OADAg0B,EAAesH,EAAUl8B,eAClB,EAGX,GADqBk8B,EAAUv7B,kBAAkB,kBAC7B,CAGhB,OADAE,SAASC,SADI,KAEN,EAGX,GADkBo7B,EAAUv7B,kBAAkB,qBAC7B,CAEb,IADoBu7B,EAAUv7B,kBAAkB,iBAI5C,GAAiC,GADRhB,IAAO,uBACTyB,OACnBzB,IAAOkB,SAASs7B,MAAMjV,KAAKgV,EAAUl8B,cACxBL,IAAO,IAAMxC,SAASmE,OAAOoN,OAAO7N,UAC1C8b,YAAY,UAAUgI,YAG7BiQ,EAAesH,EAAUl8B,cAGjC,OAAO,EAEX,OAAO,EAGX,SAASo8B,KACT,SAASC,O,gHCjET,MCKA,EACqC,+BADrC,EAGwC,KAHxC,EAIoB,GAJpB,EAKkC,I,eCmBlC,SACInZ,GAAI7M,IAAErZ,aF9BV,oGE8BqD,CAACknB,KAAMA,OACxDoY,gCAAiCC,EACjCC,iBAAkB,WACd,IAAI/F,EAAS,GAETgG,EAAQ57B,SAASC,SAAS47B,OAAOC,OAAO,GAAGC,MAAM,KACrD5/B,SAAOy/B,GAAO,SAAUI,GACpB,IAAIC,EAAMD,EAAKD,MAAM,KAAMl1B,EAAMo1B,EAAI,GAAIh+B,EAAQg+B,EAAI,GACvC,KAAVh+B,IAGJ23B,EAAO/uB,GAAOq1B,mBAAmBj+B,OAGrC,IAAIk+B,EAAOn8B,SAASC,SAASk8B,KAAKL,OAAO,GAEA,IAArCK,EAAKh8B,QAAQ,sBACbg8B,EAAOA,EAAKj/B,QAAQ,mBAAoB,KAE5C,IAAIk/B,EAAYD,EAAKJ,MAAM,MAU3B,OATAnG,EAAM,UAAgBwG,EAAUC,QAEhClgC,SAAOigC,GAAW,SAAUJ,GACxB,IAAIC,EAAMD,EAAKD,MAAM,KAAMl1B,EAAMo1B,EAAI,GAAIh+B,EAAQg+B,EAAI,GACvC,KAAVh+B,IAGJ23B,EAAO/uB,GAAOq1B,mBAAmBj+B,OAE9B23B,GAEX0G,oBAAqB,YACgC,IAA7Ct8B,SAASu8B,SAASp8B,QAAQ,eAC1BM,OAAO+7B,cAAgBA,aAAaC,QAAQj/B,KAAKi+B,gCAAiCiB,mBAAmB18B,SAASu8B,YAGtHI,0BAA2B,WACvB,IAAIC,EAAaF,mBAAmB18B,SAASC,SAAS48B,MAClDC,EAAUr8B,OAAO+7B,aAAeA,aAAaO,QAAQv/B,KAAKi+B,iCAAmC,GACjG,GAAIqB,GAAWA,IAAYF,EAAY,CACnC,IAAI96B,EAAMo6B,mBAAmBY,GAC7B,GAAIh7B,EAEA,YADAk7B,SAAcl7B,IAKtBk7B,SAAcC,gBAAqB,kCAEvCC,mBAAoB,SAA4BC,EAAWC,GACvDjhC,YAAUqB,KAAM,mBAChBgY,IAAE/U,QAAQsN,GAAG,SAAUvQ,KAAK6/B,iBAC5B,IAAIC,EAAOL,gBAAqBG,EAE5BG,EAAe//B,KAAKggC,iBAAiBL,EAD5B,MACiD,IAAM3/B,KAAKggC,iBAAiBL,EAD7E,MACkG,GAE3GM,EAAMH,GAAQ9nB,kBAAgB2nB,GAAa,GAAKI,GAEpD,GAAIH,EAAe,CACf,IAAI9B,EAAO9lB,IAAE,QACTkoB,EAAeloB,IAAE,QAAQ9V,KAAK,aAAa2X,aAAY,IAAS,EAEpE7Z,KAAKmgC,aACLngC,KAAK6kB,GAAGvW,KAAK,MAAO2xB,GAAKxc,IAAI,CACzB,MAAS,OACT,OAASqa,EAAK57B,KAAK,YAAYwX,SAAWwmB,EAC1C,UAAWhC,EACX,SAAY,WACZ,IAAsB,EAAfgC,EAAmB,OAC3B5Z,OACHwX,EAAKtvB,OAAOxO,KAAK6kB,MAGzBmb,iBAAkB,SAA0BL,EAAWS,GACnD,IAAIjgC,EAAS+9B,EAEb,IAAK,IAAI9K,KAAQuM,EACR/b,OAAO9iB,YAAYsyB,KACpBjzB,GAAU,IAAMizB,EAAO,KAAOgN,EAASlB,mBAAmBS,EAAUvM,IAASuM,EAAUvM,KAI/F,OADAjzB,EAASA,IAAW+9B,EAAqC/9B,EAAOkgC,UAAU,GAAKnC,GAGnFoC,cAAe,SAAuBX,GAClC3/B,KAAK0/B,mBAAmBC,EAAW,yBAEvCY,sBAAuB,WACnBvoB,IAAE,yBAAyBwoB,QAAQ,QAAO,WACtCv9B,OAAOoN,OAAO7N,SAASi+B,uBAAuB,0BAA0B,GAAGla,OAC3EtjB,OAAOoN,OAAO7N,SAASk+B,eAAe,gBAAgBna,WAG9D4Z,WAAY,WACHnoB,IAAE,iBAAiBjV,QAInB/C,KAAK2gC,UAAY3gC,KAAK2gC,QAAU3oB,IAAE,mBAHnChY,KAAK2gC,QAAU3oB,IAAE,+DAAsEkmB,EAAkD,4BACzIlmB,IAAE,QAAQxJ,OAAOxO,KAAK2gC,UAI1B3gC,KAAK2gC,QAAQriB,YAAY,UAAUgI,QAEvCuZ,gBAAiB,WACb,IAAI/B,EAAO9lB,IAAE,QACTkoB,EAAeloB,IAAE,QAAQ9V,KAAK,aAAa2X,aAAY,IAAS,EACpE7Z,KAAK4gC,aAAev2B,aAAarK,KAAK4gC,aACtC5gC,KAAK4gC,YAAct2B,WAAW3L,UAAO,WACjCqB,KAAK6kB,IAAM7kB,KAAK6kB,GAAGnL,OAAOokB,EAAK57B,KAAK,YAAYwX,SAAWwmB,GAC3DlgC,KAAK6kB,IAAM7kB,KAAK6kB,GAAGtB,MAAMua,EAAKva,WAC/BvjB,MAAO,MAEd6gC,cAAe,WACX7oB,IAAE/U,QAAQqN,IAAI,SAAUtQ,KAAK6/B,iBAC7B7/B,KAAK6kB,GAAGpB,IAAI,UAAU,W,uGCtH9B,QAAeqd,WAAc,CACzBt9B,YAAa,SAAUxC,GACnBA,IAAYA,EAAU,IACtBhB,KAAK+gC,sBAAwB//B,EAAQ+/B,uBAAyBpiC,aAAWoiC,KACzED,+BAAkC9gC,KAAM,CACpCghC,OAAO,EACPC,qBAAsBjgC,EAAQigC,sBAAwB,qBACtDC,MAAOlgC,EAAQkgC,OAASrb,4BACxBsb,QAASnhC,KAAK+gC,sBAAsB,CAAEl4B,KAAM7H,EAAQ6H,OACpDu4B,QAAS,CACL,CACI1gC,MAAOM,EAAQqgC,UAAYxb,kBAC3Byb,OAAQ,MACRC,SAAS,GAEb,CACI7gC,MAAOM,EAAQwgC,SAAW3b,iBAC1Byb,OAAQ,KACRC,SAAS,OAKzB79B,WAAY,WACRo9B,+BAAkC9gC,KAAM4G,WACxC5G,KAAKuQ,GAAG,aAAcvQ,KAAKyhC,OAC3BzhC,KAAKuQ,GAAG,YAAavQ,KAAKyhC,QAE9BC,WAAY,SAAUP,GAClBL,8BAAiC9gC,KAAMA,KAAK+gC,sBAAsB,CAAEl4B,KAAMs4B,S,sEChC9EQ,EAAiB,EACrB,SACIC,kBAAmB,WACf,GAAID,EACA,OAAOA,EAEX,IAAIE,EAAYr/B,SAASs/B,cAAc,OASvC,OARAD,EAAUE,MAAMxe,MAAQ,QACxBse,EAAUE,MAAMroB,OAAS,QACzBmoB,EAAUE,MAAMC,SAAW,SAC3BH,EAAUE,MAAM1e,SAAW,WAC3Bwe,EAAUE,MAAMxuB,IAAM,UACtB/Q,SAASs7B,KAAKmE,YAAYJ,GAC1BF,EAAiBE,EAAUK,YAAcL,EAAUM,YACnD3/B,SAASs7B,KAAK7kB,YAAY4oB,GACnBF,GAEXS,aAAc,SAAUvd,EAAIwd,GAExB,IAAIliC,IAAW0kB,EADfwd,EAA0B,aAAdA,EAA2B,YAAc,cAOrD,OALKliC,IACD0kB,EAAGwd,GAAa,EAChBliC,IAAW0kB,EAAGwd,GACdxd,EAAGwd,GAAa,GAEbliC,GAEXmiC,aAAc,SAAUzd,GACpB,IAAIkd,EAAQ9+B,OAAOs/B,iBAAmBt/B,OAAOs/B,iBAAiB1d,GAAMA,EAAG2d,aACvE,GAAKT,EAGL,MAAyB,UAAlBA,EAAMC,UAA0C,QAAlBD,EAAMC,UAAyC,UAAnBD,EAAMU,WAA4C,QAAnBV,EAAMU,WAA0C,UAAnBV,EAAMW,WAA4C,QAAnBX,EAAMW,WAEtKC,iBAAkB,SAAU9d,GACxB,IAAIvI,EAAO,EAAG/I,EAAM,EACpB,GAAIsR,EAAG+d,aAGH,IAFAtmB,EAAOuI,EAAGge,WACVtvB,EAAMsR,EAAGie,UACFje,EAAKA,EAAG+d,cACXtmB,GAAQuI,EAAGge,WACXtvB,GAAOsR,EAAGie,UAGlB,MAAO,CACHxmB,KAAMA,EACN/I,IAAKA,IAGbwvB,WAAY,SAAUC,GAClB,IAAI5hC,EAAS,CACTmS,IAAKuC,SAASktB,EAASvf,IAAI,cAAe,IAC1ClH,MAAOzG,SAASktB,EAASvf,IAAI,gBAAiB,IAC9CjQ,OAAQsC,SAASktB,EAASvf,IAAI,iBAAkB,IAChDnH,KAAMxG,SAASktB,EAASvf,IAAI,eAAgB,KAOhD,OALA9kB,SAAOyC,GAAQ,SAAUyJ,EAAQxB,GACzB45B,MAAM7hC,EAAOiI,MACbjI,EAAOiI,GAAO,MAGfjI,GAEX8hC,YAAa,SAAUF,GACnB,IAAI5hC,EAAS,CACTmS,IAAKuC,SAASktB,EAASvf,IAAI,eAAgB,IAC3ClH,MAAOzG,SAASktB,EAASvf,IAAI,iBAAkB,IAC/CjQ,OAAQsC,SAASktB,EAASvf,IAAI,kBAAmB,IACjDnH,KAAMxG,SAASktB,EAASvf,IAAI,gBAAiB,KAOjD,OALA9kB,SAAOyC,GAAQ,SAAUyJ,EAAQxB,GACzB45B,MAAM7hC,EAAOiI,MACbjI,EAAOiI,GAAO,MAGfjI,GAEX+hC,wBAAyB,WACrBlgC,OAAOmgC,WAAa,WACZp4B,MAAMq4B,WACNpgC,OAAOR,SAAS6gC,a,6HClE5BC,G,SAAqB,CACjBC,SAAU,EACVC,WAAY,EACZC,WAAY,EACZC,YAAY,EACZC,aAAa,EACbC,YAAY,EACZC,iBAAiB,EACjBC,kBAAmB,KACnBC,gBAAgB,IAEpBC,EAAgB,CACZN,YAAW,EACXK,gBAAe,GAGnBlV,EAAMC,aAAgB,qBAE1B/W,mBAAmB,SAAUxW,GAEzBstB,EAAIoV,KAAK1iC,IAGb,QAAeiR,gBAAqB,CAehCjP,YAAa,SAAUxC,GACnBhB,KAAKmkC,cAAgBxlC,UAAQqC,GAEzBhB,KAAKmkC,cAAc1uB,eAAe,gBAAkB9W,aAAWqB,KAAKmkC,cAAczP,oBAC3E10B,KAAKmkC,cAAczP,WAE1B10B,KAAKmkC,cAAc1uB,eAAe,gBAAkB9W,aAAWqB,KAAKmkC,cAAcjP,oBAC3El1B,KAAKmkC,cAAcjP,WAG9Bl1B,KAAKokC,SAAWpkC,KAAKmkC,cAActf,KAAM,EACzC7kB,KAAKqkC,WAAarkC,KAAKmkC,cAAcE,aAAc,SAE5CrkC,KAAKmkC,cAActf,UACnB7kB,KAAKmkC,cAAcE,WAE1BrkC,KAAKskC,WAAaC,EAAmBvkC,KAAKmkC,eAE1CnkC,KAAKmkC,cAAgBK,EAA4BxkC,KAAKmkC,cAAenkC,KAAKskC,YAE1EtkC,KAAKmkC,cAAgBM,EAA2BzkC,KAAKmkC,cAAenkC,KAAKqkC,YAEzErkC,KAAK8uB,IAAM9tB,EAAQ8tB,IAAM9tB,EAAQ8tB,IAAMA,EAEvCrc,eAAoBzS,KAAM4G,YAG9BlD,WAAY,WACR,IAAI0G,EAAOpK,KAGXA,KAAK6X,IAAI7X,KAAKskC,YAAYtkC,KAAKmkC,eAE/BnkC,KAAK0kC,kBAAoB,SAAU1jC,GAC/BoJ,EAAKyN,IAAIzN,EAAKk6B,YAAYtjC,KASlC2jC,QAAS,WAQL,MALwB,eAApB3kC,KAAKskC,WACEtkC,KAAK6X,IAAI7X,KAAKskC,YAAYK,UAE1B3kC,KAAK6X,IAAI7X,KAAKskC,YAAYp6B,WAUzC06B,QAAS,SAASC,GAEd,IAAKA,EAAM,OAAO7kC,KAElB,IAGQrB,aAAWkmC,KACa,mBAApB7kC,KAAKskC,WACLO,EAAO7sB,6BAA2BhY,KAAKmkC,cAAczP,WAAY10B,KAAKmkC,cAAcjP,WAAa2P,GACtE,eAApB7kC,KAAKskC,aACZO,EAAO7sB,yBAAuBhY,KAAKmkC,cAAczP,WAAYmQ,KAI7C,eAApB7kC,KAAKskC,WACLtkC,KAAK6X,IAAI7X,KAAKskC,YAAY,UAAWO,GACX,eAApB7kC,KAAKskC,WACXtkC,KAAK6X,IAAI7X,KAAKskC,YAAY,UAAWO,GACX,mBAApB7kC,KAAKskC,aACXtkC,KAAK6X,IAAI7X,KAAKskC,YAAY,UAAWO,GACrC7kC,KAAK6X,IAAI7X,KAAKskC,YAAY,UAAWO,IAG5C,MAAMrjC,GACHxB,KAAK8uB,IAAIW,MAAMjuB,GAEnB,OAAOxB,MAOXsmB,KAAM,WAEF,OADAtmB,KAAK0kC,kBAAkB,QAChB1kC,MAOXumB,KAAM,WAEF,OADAvmB,KAAK0kC,kBAAkB,QAChB1kC,MAGXggB,OAAQ,WACJhgB,KAAK0kC,kBAAkB,WACnB1kC,KAAKokC,QACLpkC,KAAK6X,IAAIxJ,QAAQiC,MACjBtQ,KAAK8kC,iBAELryB,gCAAqCzS,KAAM4G,aAKpD,CAOCm+B,YAAc,SAASC,GACnBhtB,wBAAsBgtB,EAAQC,QAAUD,EAAQH,KAChD7sB,2BAAyBgtB,EAAQH,MACjC7sB,2BAAyBgtB,EAAQE,OAGrCC,QAAU,CAENV,2BAA4BA,EAE5BW,kCAAmCA,EAEnCC,oBAAqBA,EAErBd,mBAAoBA,EAEpBC,4BAA6BA,KAIrC,SAASD,EAAmBvjC,GACxB,IAAIb,EAAS,iBACb,OAAIa,EAAQ0zB,YAAc1zB,EAAQk0B,aAEvBl0B,EAAQ0zB,WACfv0B,EAAS,aACFa,EAAQk0B,aACf/0B,EAAS,eAJFA,EASf,SAASqkC,EAA4BxjC,EAAS0D,GAE1C,IAAIvE,EAASa,EAQb,MANI,kBAAoB0D,GAAQ,cAAgBA,EAC5CvE,EAASxB,aAAWqC,EAASuiC,GACxB,cAAgB7+B,IACrBvE,EAASxB,aAAWqC,EAASijC,IAG1B9jC,EAGX,SAASskC,EAA2BzjC,EAASqjC,GAEzC,IAAIiB,EAAuBtkC,EAAQukC,WAYnC,OAVAvkC,EAAQukC,WAAa,WACjBF,EAAoBp+B,MAAMjH,KAAM4G,WAChCy9B,GAAce,EAAkCn+B,MAAMjH,KAAM4G,WAC5D0+B,GAAwBA,EAAqBr+B,MAAMjH,KAAM4G,YAG7D5F,EAAQwkC,YAAc,WAClBH,EAAoBp+B,MAAMjH,KAAM,CAACA,KAAKkmB,OAAO,GAAIlmB,KAAKylC,QAGnDzkC,EAGX,SAASokC,EAAkChY,EAAOqY,GAC9C,IAAI50B,EAASmH,IAAEoV,GAAOvc,SAASyL,KAC3BiH,EAAQmiB,WAAWD,EAAKE,MAAMliB,IAAI,SAAS/jB,QAAQ,KAAM,KACzDkmC,EAAO/0B,EAASuc,EAAM8U,YAAc3e,EAAQvL,IAAE/U,QAAQsgB,QAC1DkiB,EAAKE,MAAMliB,IAAI,CACXoiB,WAAYD,EAAOxY,EAAM8U,YAAc,KAAO,IAItD,SAASmD,EAAoBjY,EAAOqY,GAChC,IAEIK,EAFAC,EAAkBN,EAAKE,MACvBK,EAAUD,EAAgB11B,SAG1B21B,GAAWA,EAAQprB,GAAG,UACtBkrB,EAASC,EAAgBlV,UACzBkV,EAAkB/tB,ICrR1B,yGDsRwBxJ,OAAOs3B,GACvB9tB,IAAE,QAAQxJ,OAAOu3B,M,8CEvRzB,mI,6DCGQ,IAAIpiB,EAEA,QAAU,KACV,QAAe,SAAgB,GAC/BA,EAAS,SAETA,EAASC,OAAOta,KAAK,KAAOua,QAAO,CAACC,EAAKza,KAC9B,IACAya,KACA,IAAMza,MAEd,IAGP","file":"_chunks/chunk.154.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: agodovanets, inesterenko\n * @version: $Id$\n */\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport './controls.core';\n\n(function (exp, _, Controls) {\n    var DataConverter = Controls.Base.extend({\n        //Clean up input structure from mess\n        structureFormater: function (response) {\n            if (!response) {\n                return response;\n            }\n            var formatedResponse = _.map(response.inputControl, function (res) {\n                res.readOnly = String(res.readOnly) == 'true';\n                res.uri = res.uri.replace('repo:', '');\n                return res;\n            });\n            var state = _.map(formatedResponse, function (controlStructure) {\n                return controlStructure.state;\n            });\n            state = _.compact(state);\n            _.each(formatedResponse, function (structure) {\n                delete structure['state'];\n            });\n            return _.extend({ structure: formatedResponse }, this.convertResponseToControlsState(state));\n        },\n        //Convert controls update response to data structure compatible with controls\n        convertResponseToControlsState: function (rawState) {\n            var result = {};\n            var requestStates = rawState.inputControlState ? rawState.inputControlState : rawState;\n            var convertOptionFunc = function (option) {\n                var opt = {\n                    value: option.value,\n                    label: option.label\n                };\n                if (String(option.selected) == 'true') {\n                    opt.selected = true;\n                }\n                return opt;\n            };\n            var convertOptionsFunc = function (options) {\n                var values;\n                if (_.isArray(options)) {\n                    values = _.map(options, convertOptionFunc);\n                } else {\n                    values = [];\n                }\n                return values;\n            };\n            var convertToValues = function (requestState) {\n                if (!_.isUndefined(requestState.value) && !_.isNull(requestState.value)) {\n                    return requestState.value;\n                }\n                return convertOptionsFunc(requestState.options);\n            };\n            _.each(requestStates, function (requestState) {\n                if (requestState && requestState.uri) {\n                    result[requestState.id] = {\n                        error: _.isUndefined(requestState.error) ? null : requestState.error,\n                        values: convertToValues(requestState)\n                    };\n                }\n            });\n            return { state: result };\n        }\n    });\n    exp.DataConverter = DataConverter;\n    return exp;\n}(JRS.Controls, _, JRS.Controls));\n\nexport default JRS.Controls;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\n\n/* global errorObject, statusText*/\n\nimport {JRS} from \"../namespace/namespace\";\nimport __jrsConfigs__ from 'js-sdk/src/jrs.configs';\nimport dialogs from '../components/components.dialogs';\nimport _ from 'underscore';\nimport jQuery from 'jquery';\n\nimport './controls.core';\nimport './controls.dataconverter';\n\nJRS.Controls = (function (JSON, jQuery, _, Controls) {\n\n    //module:\n    //\n    //  controls.datatransfer\n    //\n    //summary:\n    //\n    //DataTransfer    - REST wrapper, returns normalized data\n    //\n    //dependencies:\n    //\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls,       - controls.core module\n\n\n    //Common error handing\n    function commonErrorHandler(err) {\n        var errorObject;\n        try {\n            try {\n                errorObject = JSON.parse(err.responseText);\n            } catch (e) {}\n\n            if (errorObject && errorObject.error) {\n                _.each(errorObject.error, function (error) {\n                    //TODO: try to avoid it\n                    var viewModel = Controls.getViewModel();\n                    var controlUri = error.inputControlUri.replace(\"repo:\", \"\");\n                    var control = viewModel.find({uri:controlUri});\n                    if (error.errorCode) {\n                        control.set({error:error.errorCode});\n                    } else if (error.defaultMessage) {\n                        control.set({error:error.defaultMessage});\n                    }\n                });\n            } else {\n                if (err.getResponseHeader(\"LoginRequested\") || err.status === 401) {\n                    document.location = __jrsConfigs__.urlContext;\n                } else if ([400, 500].indexOf(err.status) >= 0 || (err.getResponseHeader(\"JasperServerError\")\n                    && !err.getResponseHeader(\"SuppressError\"))) {\n\n                    var message = \"\";\n                    if (errorObject) {\n                        var errorObjectMessage = errorObject.message || \"Unknown error\";\n                        if (errorObject.parameters && errorObject.parameters.length > 0) {\n                            var template = _.template(\"<div><b>{{-message}}</b></div><p>{{ if (parameters) for (var i = 0; i < parameters.length; i++) { }}<div>{{-parameters[i]}}</div>{{ } }}</p>\");\n                            message = template({\n                                message: errorObjectMessage,\n                                parameters: errorObject.parameters\n                            });\n                        } else {\n                            message = errorObjectMessage\n                        }\n                    } else {\n                        message = window.statusText;\n                    }\n\n                    dialogs.errorPopup.show(message);\n                }\n            }\n        } catch (e) {\n            // In this scenario security error is handled earlier, in errorHandler, so we can ignore exception here.\n            // Comment this because it will not work in IE, but can be uncommented for debug purpose.\n            // console.error(\"Can't parse server response: %s\", \"controls.core\", err.responseText);\n        }\n    }\n\n    return _.extend(Controls, {\n\n        //REST wrapper, returns normalized data\n        DataTransfer:Controls.Base.extend({\n            CONTROLS_STRUCTURE_TEMPLATE_URI:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}\",\n\n            INITIAL_CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/values\",\n\n            CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values\",\n\n            constructor : function(options) {\n                this.dataConverter = options.dataConverter;\n                this.initialize(options);\n            },\n\n            initialize : function(options) {},\n\n            setReportUri:function (reportUri) {\n                this.currentReportUri = reportUri;\n            },\n            buildUrl : function(reportPath, controlIds, urlTemplate) {\n                controlIds = _.isArray(controlIds) ? controlIds.join(\";\") : controlIds || \"\";\n\n                return Controls.TemplateEngine.renderUrl(urlTemplate, {\n                    reportUri: reportPath,\n                    controlIds: controlIds\n                });\n\n            },\n            /**\n             * Send request\n             * @param url\n             * @param data\n             * @param settings\n             * @returns {*}\n             */\n            sendRequest : function(url, data, settings) {\n                var defaultSettings = {\n                    url : url,\n                    type : \"GET\",\n                    dataType : \"json\",\n                    cache : false\n                };\n                if (!_.isEmpty(data)) {\n                    _.extend(defaultSettings, {\n                        type : \"POST\",\n                        processData : false,\n                        data : JSON.stringify(data),\n                        contentType : \"application/json\"\n                    });\n                }\n\n                var requestSettings = _.defaults(settings || {}, defaultSettings);\n                requestSettings.headers || (requestSettings.headers = {});\n\n                _.defaults(requestSettings.headers, {\n                    /**\n                     *  Use custom HTTP header to prevent 401 response from server.\n                     *  401 response makes browsers to show native login dialog.\n                     *  We don't want that.\n                     */\n                    \"X-Suppress-Basic\" : \"true\",\n\n                    /**\n                     * Overwrite locale of browser, use locale of current user\n                     */\n                    \"Accept-Language\": __jrsConfigs__.userLocale.replace(/_/g, \"-\")\n                });\n\n                return jQuery.ajax(requestSettings)\n                    .fail(commonErrorHandler);\n            },\n\n            fetchControlsStructure:function (uris, selectedData) {\n                var url = this.buildUrl(this.currentReportUri, uris, this.CONTROLS_STRUCTURE_TEMPLATE_URI);\n\n                var controlsStructure = this.sendRequest(url, selectedData).then(_.bind(this.dataConverter.structureFormater, this.dataConverter));\n\n                Controls.Utils.showLoadingDialogOn(controlsStructure, null, true);\n                return  controlsStructure;\n            },\n\n            updateControlsStructure: function(updatedStructure, uri){\n                var url = this.buildUrl(uri || this.currentReportUri, null, this.CONTROLS_STRUCTURE_TEMPLATE_URI);\n\n                return this.sendRequest(url, updatedStructure, {type : \"PUT\"}).then(_.bind(this.dataConverter.structureFormater, this.dataConverter));\n            },\n\n            fetchInitialControlValues:function (reportUri, selectedData) {\n                var url = this.buildUrl(reportUri, null, this.INITIAL_CONTROLS_VALUES_TEMPLATE_URL);\n\n                var initialControlsValues = this.sendRequest(url, selectedData).\n                    then(this.dataConverter.convertResponseToControlsState);\n\n                Controls.Utils.showLoadingDialogOn(initialControlsValues, null, true);\n                return initialControlsValues;\n            },\n\n            fetchControlsUpdatedValues:function (ids, selectedData) {\n                var url = this.buildUrl(this.currentReportUri, ids, this.CONTROLS_VALUES_TEMPLATE_URL);\n                var dataConverter = this.dataConverter;\n                if (this.fullUpdateDeferred && this.fullUpdateDeferred.state() == \"pending\") {\n                    this.fullUpdateDeferred.reject();\n                }\n\n                var fullUpdateDeferred = new jQuery.Deferred();\n\n                var triggerRequestDeferred = Controls.Utils.wait(Controls.DataTransfer.FREQUENT_CHANGES_MIN_DELAY);\n\n                triggerRequestDeferred.done(_.bind(function () {\n                    this.sendRequest(url, selectedData).\n                        then(dataConverter.convertResponseToControlsState).done(\n                            function (data) {\n                                if (fullUpdateDeferred.state() == \"pending\") {\n                                    fullUpdateDeferred.resolve(data);\n                                }\n                            }).\n                        fail(function() {\n                            fullUpdateDeferred.reject(this, arguments);\n                        });\n                }, this));\n\n                fullUpdateDeferred.fail(function () {\n                    triggerRequestDeferred.reject();\n                });\n\n                Controls.Utils.showLoadingDialogOn(fullUpdateDeferred, null, true);\n\n                this.fullUpdateDeferred = fullUpdateDeferred;\n\n                return fullUpdateDeferred;\n            }\n\n        }, {\n\n            //Static props\n\n            CONTROLS_STRUCTURE_TEMPLATE_URI:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}\",\n\n            INITIAL_CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/values\",\n\n            CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values\",\n\n            FREQUENT_CHANGES_MIN_DELAY : 400\n        })\n    });\n\n})(\n    JSON,\n    jQuery,\n    _,\n    JRS.Controls\n);\n\nexport default JRS.Controls;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport jQuery from 'jquery';\nimport './controls.core';\n\nJRS.Controls = function (jQuery, _, Controls) {\n    //module:\n    //\n    //  controls.basecontrol\n    //\n    //summary:\n    //\n    //BaseControl - prototype for all input controls\n    //\n    //dependencies:\n    //\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls,       - controls.core module\n    function getSelectedValues(values) {\n        if (_.isArray(values)) {\n            var filteredValues = _.filter(values, function (val) {\n                return val.selected;\n            });\n            return _.map(filteredValues, function (opt) {\n                //TODO: decouple from controls.options data structure\n                if (opt.id || opt.id === '') {\n                    return opt;\n                }\n                return opt.value;\n            });\n        } else {\n            return values;\n        }\n    }\n    return _.extend(Controls, {\n        //Base object for all input controls types\n        BaseControl: Controls.Base.extend({\n            /* Id of the control. */\n            id: null,\n            /* Store jQuery object presentation of each control. */\n            elem: null,\n            /* Validation message:\n             In case of incorrect value it will contain error message from server.\n             In case of correct value it will be null. */\n            error: null,\n            // Store template's chunks functions\n            templateChunks: {},\n            constructor: function (args) {\n                this.initialize.apply(this, arguments);\n            },\n            // Return jQuery object\n            getElem: function () {\n                return this.elem;\n            },\n            //Save reference to control's DOM as jQuery object\n            setElem: function (element) {\n                this.elem = element;\n            },\n            //bind custom events in inherited objects\n            bindCustomEventListeners: function () {\n            },\n            isSingleSelect: function () {\n                return !_.isArray(this.get('selection'));\n            },\n            isSingleValue: function () {\n                return !_.isArray(this.get('values'));\n            },\n            //get template function for chunk of template\n            getTemplateSection: function (section) {\n                if (!this.templateChunks[this.type + '_' + section]) {\n                    this.templateChunks[this.type + '_' + section] = Controls.TemplateEngine.createTemplateSection(section, this.type);\n                }\n                return this.templateChunks[this.type + '_' + section];\n            },\n            initialize: function(...args) {\n                this.baseRender(...args);\n                this.isVisible(...args) && this.bindCustomEventListeners();\n            },\n            fireControlSelectionChangeEvent: function (selection) {\n                //this.selection = selection;\n                jQuery(document).trigger(Controls.CHANGE_CONTROL, {\n                    control: this,\n                    selection\n                });\n            },\n            // Render the control from main template\n            baseRender: function (controlStructure) {\n                controlStructure && _.extend(this, controlStructure);\n                var template = Controls.TemplateEngine.createTemplate(this.type);\n                if (template) {\n                    var element = jQuery(template(this));\n                    this.setElem(element);\n                }\n            },\n            // Refresh values of the control.\n            setValue: function (selectedValues) {},\n\n            fetch: function(options) {},\n\n            clearFilter: function() {},\n\n            render: function() {},\n            // Returns selected values from the control.\n            get: function (attribute) {\n                return this[attribute];\n            },\n            // Check for validation\n            isValid: function () {\n                return this.error === null || this.error && this.error instanceof String && this.error.length === 0;\n            },\n            //Check whether control is visible\n            //Also returns true if visible property was not set at all\n            isVisible: function (args) {\n                return !args || args.visible === undefined || args.visible === true;\n            },\n            //render message\n            updateWarningMessage: function () {\n                var message = this.error != null ? this.error : '';\n                this.getElem() && this.getElem().find('.warning').text(message);\n            },\n\n            reset: function(options) {\n                this.set(options);\n\n                const values = this.get('values');\n\n                if (this.isVisible(this) && typeof values === 'undefined') {\n                    this.setValue(values);\n                }\n            },\n            // Store attributes and do some actions according changed attribute\n            set: function (attributes, preventNotification) {\n                _.extend(this, attributes);\n\n                if (attributes.values !== undefined) {\n                    const { values } = attributes;\n\n                    this.isVisible(this) && this.setValue(values);\n\n                    if (this.isSingleValue()) {\n                        this['selection'] = values;\n                    } else {\n                        if (this.isSingleSelect()) {\n                            this['selection'] = values[0];\n                        } else {\n                            this['selection'] = values;\n                        }\n                    }\n                }\n                if (attributes['selection'] !== undefined) {\n                    if (this.isSingleValue()) {\n                        this['values'] = attributes['selection'];\n                    }\n                    !preventNotification && this.fireControlSelectionChangeEvent(\n                        attributes['selection']\n                    );\n                }\n                if (attributes['disabled'] !== undefined && !this.get('readOnly')) {\n                    var disabled = attributes['disabled'];\n                    if (!preventNotification) {\n                        disabled ? this.disable() : this.enable();\n                    }\n                }\n                if (attributes['error'] !== undefined) {\n                    this.updateWarningMessage();\n                    if (this.mandatory && this['selection'] === undefined) {\n                        this['selection'] = [];\n                    }\n                }\n            },\n            find: function (attributes) {\n                if (attributes !== undefined && attributes && typeof attributes == 'object') {\n                    var key = _.keys(attributes)[0];\n                    var value = _.values(attributes)[0];\n                    return _.find(this.get('values'), function (val) {\n                        return val[key] === value;\n                    });\n                }\n            },\n            enable: function () {\n                this.getElem().find('input').prop('disabled', false);\n                this.getElem().find('select').prop('disabled', false);\n            },\n            disable: function () {\n                this.getElem().find('input').prop('disabled', true);\n                this.getElem().find('select').prop('disabled', true);\n            }\n        }, {\n            //merge  values  with selection\n            merge: function (values, selections) {\n                if (_.isNull(values) || _.isUndefined(values)) {\n                    return selections;\n                }\n                if (_.isNull(selections) || _.isUndefined(selections)) {\n                    return values;\n                }\n                if (_.isArray(selections)) {\n                    return _.map(values, function (option) {\n                        var selectedValue = _.find(selections, function (selection) {\n                            return selection === option.value;\n                        });\n                        if (selectedValue !== undefined) {\n                            option.selected = true;\n                        } else {\n                            delete option.selected;\n                        }\n                        return option;\n                    });\n                } else {\n                    return this.merge(values, [selections]);\n                }\n            }\n        }),\n        CHANGE_CONTROL: 'changed:control'\n    });\n}(jQuery, _, JRS.Controls);\n\nexport default JRS.Controls;","enum RestParamsEnum {\n    SELECTED_VALUES = 'selectedValues',\n    NOTHING_SUBSTITUTION_VALUE= '~NOTHING~'\n}\n\nexport default RestParamsEnum;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\n/* global Report */\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport jQuery from 'jquery';\nimport browserDetection from 'js-sdk/src/common/util/browserDetection';\n\nimport './controls.core';\nimport './controls.basecontrol';\n\nimport 'jquery-ui/ui/widgets/sortable';\n\nimport RestParamsEnum from './rest/enum/restParamsEnum';\nimport isControlInCascade from './predicate/isControlInCascade';\n\nJRS.Controls = function (jQuery, _, Controls) {\n    //module:\n    //\n    //  controls.viewmodel\n    //\n    //main types:\n    //\n    // ViewModel      - initialize, draw, update controls, no any communication with server\n    //\n    //dependencies:\n    //\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls,       - controls.components\n    var isIE = browserDetection.isIE();\n\n    // JS-33242\n    var scrollStartStopCallback = (function() {\n        var lastScrollAt = (new Date()).getTime(),\n            scrollTimeout;\n\n        return function() {\n            var now = (new Date()).getTime();\n            var self = this;\n\n            if (now - lastScrollAt > 400) {\n                lastScrollAt = now;\n\n                jQuery(this).trigger(\"scrollstart\");\n            }\n\n            clearTimeout(scrollTimeout);\n\n            scrollTimeout = setTimeout(function(){\n                jQuery(self).trigger(\"scrollstop\");\n            }, 300);\n        }\n    })();\n\n    // ViewModel initialize, updates and adds controls to the DOM\n    var ViewModel = Controls.Base.extend({\n\n        constructor:function (args) {\n            this.containerSelector = (args && args.containerSelector) || Controls.ViewModel.DEFAULT_CONTAINER;\n            this.controls = {};\n\n            //save reference to initialized manager object\n            Controls.getViewModel = _.bind(function () {\n                return this;\n            }, this);\n\n            _.bindAll(this,\n                \"registerEvents\",\n                \"onControlChange\"\n            );\n\n            this.registerEvents();\n        },\n\n        registerEvents : function() {\n            Controls.ignore(\"changed:control\", this.onControlChange);\n            Controls.listen({\n                \"changed:control\":this.onControlChange\n            });\n        },\n\n        /* Listens for controls change and triggers controls update */\n        onControlChange:function (event, options) {\n            const {\n                control,\n                selection\n            } = options;\n\n            const controlInCascade = isControlInCascade(control);\n\n            jQuery(document).trigger(Controls.ViewModel.CHANGE_SELECTION, [\n                control.id,\n                selection,\n                controlInCascade\n            ]);\n\n            if (!controlInCascade) {\n                //TODO: update state before sending it to subscribers\n                jQuery(document).trigger(Controls.ViewModel.CHANGE_VALUES, [this.state]);\n            }\n        }\n    }, {\n        //Static props\n        DEFAULT_CONTAINER: '#inputControlsContainer',\n        CHANGE_VALUES: 'viewmodel:values:changed',\n        CHANGE_SELECTION: 'viewmodel:selection:changed',\n        CHANGE_ORDER: 'viewmodel:order:changed',\n        //check for changes between two objects\n        isSelectionChanged: function (previous, next) {\n            var previousControlIds = previous ? _(previous).keys() : [];\n            var nextControlIds = next ? _(next).keys() : [];\n            var controlsIdUnion = _.union(previousControlIds, nextControlIds);\n            if (controlsIdUnion.length === previousControlIds.length) {\n                var previousFlattenValues = previous ? _.flatten(_(previous).values()) : [];\n                var nextFlattenValues = next ? _.flatten(_(next).values()) : [];\n                return _.difference(previousFlattenValues, nextFlattenValues).length > 0 || _.difference(nextFlattenValues, previousFlattenValues).length > 0;\n            }\n            return true;\n        }\n    });\n\n    var Model = {\n\n        //Get array of all instantiated controls\n        getControls: function () {\n            return this.controls;\n        },\n\n        // Creates instances of all controls. Not adding them to DOM\n        instantiate: function (controlsStructure, options) {\n            this.controls = {};\n\n            const {\n                dataUri,\n                inputControlsService,\n                initialSelectedValues,\n                paginatedValuesOptions,\n            } = options;\n\n            controlsStructure.forEach((controlStructure) => {\n                const controlId = controlStructure.id;\n\n                this.createControl(controlStructure,{\n                    dataUri,\n                    inputControlsService,\n                    initialSelectedValues: initialSelectedValues[controlId] || [],\n                    paginatedValuesOptions: paginatedValuesOptions[controlId] || []\n                });\n            });\n        },\n\n        // Create control and add it to controls but do not add to the DOM\n        createControl: function (controlStructure, options) {\n            // Find instantiated control by it's type\n            var Control = function (type) {\n                for (var property in Controls) {\n                    if (type.toLowerCase() === property.toLowerCase()) {\n                        return Controls[property];\n                    }\n                }\n            }(controlStructure.type);    // Is such control implementation present?\n\n            if (Control) {\n                this.controls[controlStructure.id] = new Control(controlStructure, options);\n            } else {\n                throw new Error('Can not find implementation of the control type: ' + controlStructure.type);\n            }\n            return this.controls[controlStructure.id];\n        },\n\n        // Remove control from state\n        removeControl: function (controlId) {\n            delete this.controls[controlId];\n        },\n\n        // reorders controls in state\n        reorderControl: function (oldIndex, newIndex) {\n            if (this.structure.length == 1) {\n                // nothing to reorder\n                return;\n            }\n\n            var shiftDirection = oldIndex < newIndex ? 1 : -1;\n            var start = oldIndex < newIndex ? Math.min(oldIndex, newIndex) : Math.max(oldIndex, newIndex);\n            var end = oldIndex < newIndex ? Math.max(oldIndex, newIndex) : Math.min(oldIndex, newIndex);\n            var t;\n            for (var i = start; i != end; i = i + shiftDirection) {\n                t = this.structure[i];\n                this.structure[i] = this.structure[i + shiftDirection];\n                this.structure[i + shiftDirection] = t;\n            }\n            jQuery(document).trigger(Controls.ViewModel.CHANGE_ORDER, [this.structure]);\n        },\n\n        // Invoke specific actions according specified attributes\n        set: function (attributes, preventNotification) {\n            if (attributes) {\n                _.extend(this, attributes);\n\n                const {\n                    structure,\n                } = attributes;\n\n                const {\n                    initialSelectedValues,\n                } = attributes.controlsOptions || {};\n\n                if (structure) {\n                    this.instantiate(structure, attributes.controlsOptions);\n                    this.draw(structure);\n                }\n\n                if (initialSelectedValues) {\n                    this.update(initialSelectedValues);\n\n                    !preventNotification && jQuery(document)\n                        .trigger(Controls.ViewModel.CHANGE_VALUES, initialSelectedValues);\n                }\n            }\n        },\n        get: function (attribute) {\n            if (!attribute) {\n                return;\n            }\n            if (attribute === 'selection') {\n                var result = {};\n                _.each(this.getControls(), function (control) {\n                    var selectedData = control.get('selection');    // Should be array of values, so check it.\n                    // Also check if value is undefined then do not pass it to the result array.\n                    // Should be array of values, so check it.\n                    // Also check if value is undefined then do not pass it to the result array.\n                    if (selectedData instanceof Array) {\n                        result[control.id] = result[control.id] = selectedData.length > 0 ? selectedData : control.mandatory ? [] : [RestParamsEnum.NOTHING_SUBSTITUTION_VALUE];\n                    } else if (!_.isUndefined(selectedData)) {\n                        result[control.id] = [selectedData];\n                    }\n\n                });\n                return result;\n            }\n            return this[attribute];\n        },\n        // Find control by specified attribute\n        findControl: function (attribute) {\n            var key = _.keys(attribute)[0];\n            var value = _.values(attribute)[0];\n            return _.find(this.getControls(), function (control) {\n                return control[key] === value;\n            });\n        },\n\n        // Returns specified properties from all controls\n        pluck: function (property) {\n            return _.pluck(this.getControls(), property);\n        }\n    };\n\n    var View = {\n        // Draw structure of all controls. Put them to already selected container\n        draw: function (jsonStructure) {\n            const container = this.getContainer();\n\n            container.empty();\n\n            if (isIE) {\n                // https://jira.tibco.com/browse/JS-32279 - Scroll jumps up on any click inside control aria (item select, title, tab)\n                // Solution is to skip stdnav handling on root container of this component.\n                container.attr('js-stdnav', 'false');\n                container.attr('js-navtype', 'none');\n            }\n\n            jsonStructure.forEach((controlJson) => {\n                if (controlJson.visible) {\n                    const control = this.findControl({ id: controlJson.id });\n\n                    control.render();\n\n                    container.append(control.getElem());\n                }\n            });\n\n            if (window.Report && window.Report.icReorderEnabled) {\n                const horizontalLayout = window.Controls.layouts.LAYOUT_TOP_OF_PAGE === Report.reportControlsLayout;\n\n                if(!(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))) {\n                    this._initSortable({\n                        container: container,\n                        horizontalLayout: horizontalLayout\n                    });\n                }\n            }\n        },\n\n        // Fill content of all controls\n        update: function (initialSelectedValues) {\n            _.each(initialSelectedValues, (controlSelection, controlId) => {\n                const control = this.findControl({ id: controlId });\n\n                control.set({\n                    values: Array.isArray(controlSelection) ? controlSelection.map(option => option.value) : controlSelection,\n                    error: null\n                });\n            });\n        },\n\n        // Getter for IC container.\n        // Fetch DOM object only once.\n        getContainer: function () {\n            if (this.container && this.container.length == 1) {\n                return this.container;\n            } else {\n                this.container = jQuery(this.containerSelector);\n                return this.container;\n            }\n        },\n\n        // Clear all warning messages\n        removeValidationMessages: function () {\n            _.each(this.getControls(), function (control) {\n                control.set({ error: null });\n            });\n        },\n\n        // check valid\n        areAllControlsValid: function () {\n            return _.isEmpty(_.filter(this.getControls(), function (control) {\n                return !control.isValid();\n            }));\n        },\n        // Setter for IC container.\n        setContainer: function (containerSelector) {\n            this.container = jQuery(containerSelector);\n        },\n\n        // Reload container, used in case when DOM has been changed.\n        reloadContainer: function () {\n            this.container = jQuery(this.containerSelector);\n            return this.container;\n        },\n\n        // Prevent user action on control\n        disable: function () {\n            _.each(this.getControls(), function (control) {\n                control.set({ disabled: true });\n            });\n        },\n\n        // Allow user action on control\n        enable: function () {\n            _.each(this.getControls(), function (control) {\n                control.set({ disabled: false });\n            });\n        },\n\n        _initSortable: function(options) {\n            var container = options.container,\n                horizontalLayout = options.horizontalLayout,\n                keepSortableAlive = false;\n\n            var self = this;\n\n            var sortableContainer = jQuery(container).sortable({\n                delay: 200,\n                placeholder: horizontalLayout ? \"verticalPlaceholder\" : \"horizontalPlaceholder\",\n                axis: horizontalLayout ? \"x\" : \"y\",\n                items: \"> .leaf\",\n                cancel: \"input,textarea,button,select,option,.list.inputSet,.jr-mSizer\",\n                start: function(event, ui) {\n                    ui.item.data('oldIndex', ui.item.index());\n                    keepSortableAlive = true;\n                },\n                stop: _.bind(function(event, ui) {\n                    var oldIndex = ui.item.data('oldIndex');\n                    var newIndex = ui.item.index();\n                    oldIndex != newIndex && this.reorderControl(oldIndex, newIndex);\n                    keepSortableAlive = false;\n                }, this)\n            });\n\n            // JS-33242\n            if (isIE) {\n                var parent = options.parent || sortableContainer.parent();\n\n                parent.off(\"scroll\", scrollStartStopCallback);\n                parent.off(\"scrollstart\");\n                parent.off(\"scrollstop\");\n\n                parent.on(\"scroll\", scrollStartStopCallback);\n\n                parent.on(\"scrollstart\", function () {\n                    if (!keepSortableAlive) {\n                        try {\n                            sortableContainer.sortable(\"destroy\");\n                        } catch (e) {}\n                    }\n                });\n\n                parent.on(\"scrollstop\", function () {\n                    !keepSortableAlive && self._initSortable({\n                        parent: parent,\n                        container: container,\n                        horizontalLayout: horizontalLayout\n                    });\n                });\n            }\n        }\n    };\n    _.extend(ViewModel.prototype, Model, View);\n    return _.extend(Controls, { ViewModel: ViewModel });\n}(jQuery, _, JRS.Controls);\n\nexport default JRS.Controls;\n","export default (\n    control: {\n       // masterDependencies?: string[],\n        slaveDependencies?: string[],\n       // selection?: any\n    }\n) => {\n    const {\n        // masterDependencies,\n        slaveDependencies,\n        // selection\n    } = control;\n\n    // const hasMasterDependencies = masterDependencies ? masterDependencies.length > 0 : false;\n    const hasSlaveDependencies = slaveDependencies ? slaveDependencies.length > 0 : false;\n\n    // return hasMasterDependencies || hasSlaveDependencies;\n    return hasSlaveDependencies;\n};\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar listWithNavigationModelTrait = {\n    activate: function (index, options) {\n        if (typeof index !== 'number') {\n            this.setActive(_.extend({}, options));\n            return;\n        }\n        options = options || {};\n        if (index >= this.get('bufferStartIndex') && index <= this.get('bufferEndIndex')) {\n            var item = this.get('items')[index - this.get('bufferStartIndex')];\n            if (item) {\n                this.setActive(_.extend(options, {\n                    index: index,\n                    item: item\n                }));\n            }\n        } else {\n            var that = this;\n            this.getData({\n                offset: index,\n                limit: 1\n            }).done(function (values) {\n                that.setActive(_.extend(options, {\n                    index: index,\n                    item: values.data[0]\n                }));\n            }).fail(this.fetchFailed);\n        }\n    },\n    setActive: function (options) {\n        if (this.active && options.index === this.active.index && options.item.value === this.active.value) {\n            return;\n        }\n        this.active = options && typeof options.index === 'number' ? {\n            index: options.index,\n            value: options.item.value,\n            label: options.item.label\n        } : undefined;\n        if (!options || !options.silent) {\n            this.trigger('change');\n            this.trigger('active:changed', this.active);\n        }\n    },\n    getActive: function () {\n        return this.active;\n    }\n};\nexport default listWithNavigationModelTrait;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar DEFAULT_KEY_DOWN_TIMEOUT = 200;\nvar KeyboardManager = function (options) {\n    this.initialize(options);\n    return this;\n};\n_.extend(KeyboardManager.prototype, {\n    systemKeyCodes: [\n        16,\n        17,\n        18,\n        91\n    ],\n    keydownHandlers: {\n        '38': 'onUpKey',\n        '40': 'onDownKey',\n        '13': 'onEnterKey',\n        '27': 'onEscKey',\n        '36': 'onHomeKey',\n        '35': 'onEndKey',\n        '9': 'onTabKey',\n        '33': 'onPageUpKey',\n        '34': 'onPageDownKey'\n    },\n    preventKeydownHandlers:{\n        '33': 'onPageUpKey',\n        '34': 'onPageDownKey'\n    },\n    initialize: function (options) {\n        _.bindAll(this, 'onKeydown');\n        if (options.keydownHandlers) {\n            this.keydownHandlers = options.keydownHandlers;\n        }\n        this.stopPropagation = options.stopPropagation;\n        this.keydownTimeout = options.keydownTimeout || DEFAULT_KEY_DOWN_TIMEOUT;\n        this.context = options.context;\n        this.deferredKeydownHandler = options.deferredKeydownHandler;\n        this.immediateHandleCondition = options.immediateHandleCondition;\n        this.immediateKeydownHandler = options.immediateKeydownHandler;\n    },\n    onKeydown: function (event) {\n        if (this._isSystemKeyPressed(event)) {\n            return;\n        } else if (this._canImmediatelyHandleKeyboardEvent(event)) {\n            this._immediatelyHandleKeyboardEvent(event);\n        } else {\n            this.deferredHandleKeyboardEvent(event);\n        }\n        if (this.stopPropagation) {\n            event.stopPropagation();\n        }\n    },\n    deferredHandleKeyboardEvent: function (event) {\n        if (this.deferredKeydownHandler) {\n            if (this.keydownTimeout > 0) {\n                clearTimeout(this.deferredTimeout);\n                this.deferredTimeout = setTimeout(_.bind(this.deferredKeydownHandler, this.context, event), this.keydownTimeout);\n            } else {\n                this.deferredKeydownHandler.call(this.context, event);\n            }\n        }\n    },\n    _isSystemKeyPressed: function (event) {\n        return _.indexOf(this.systemKeyCodes, event.which) > -1;\n    },\n    _immediateHandleCondition: function (event) {\n        return this.immediateHandleCondition && this.immediateHandleCondition.call(this.context, event);\n    },\n    _canImmediatelyHandleKeyboardEvent: function (event) {\n        var keydownHandler = this.keydownHandlers['' + event.which];\n        return keydownHandler && typeof this.context[keydownHandler] === 'function' || this._immediateHandleCondition(event);\n    },\n    _immediatelyHandleKeyboardEvent: function (event) {\n        var keydownHandler = this.keydownHandlers['' + event.which];\n        if (keydownHandler && typeof this.context[keydownHandler] === 'function') {\n            this.context[keydownHandler].call(this.context, event);\n            this._immediatePreventdefaultHandler(event);\n        } else if (this._immediateHandleCondition(event)) {\n            this.immediateKeydownHandler && this.immediateKeydownHandler.call(this.context, event);\n        }\n    },\n    _immediatePreventdefaultHandler:function(event){\n        if(this.preventKeydownHandlers['' + event.which]){\n            event.preventDefault();\n        }\n    }\n});\nexport default KeyboardManager;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nvar DEFAULT_BUFFER_SIZE = 100;\nvar DEFAULT_LOAD_FACTOR = 0.95;\nvar ScalableListModel = Backbone.Model.extend({\n    initialize: function (options) {\n        options = options || {};\n        _.bindAll(this, '_fetchComplete', 'fetchFailed', 'afterFetchComplete', 'fetch');\n        this.set({ items: [] }, { silent: true });\n        this.getData = options.getData;\n        this.bufferSize = options.bufferSize || DEFAULT_BUFFER_SIZE;\n        this.loadFactor = options.loadFactor || DEFAULT_LOAD_FACTOR;\n    },\n    _fetchComplete: function (values) {\n        this.attributes.total = values.total;\n        this.set({ items: values.data }, { silent: true });\n        this.attributes.bufferEndIndex = Math.max(0, Math.min(this.attributes.bufferStartIndex + this.bufferSize - 1, this.attributes.bufferStartIndex + values.data.length - 1));\n        if (this.attributes.bufferEndIndex < this.attributes.bufferStartIndex + this.bufferSize - 1) {\n            this.attributes.total = Math.min(values.total, this.attributes.bufferEndIndex + 1);\n        }\n        this.afterFetchComplete && this.afterFetchComplete(values.data, this.attributes.total);\n        this.trigger('change', this);\n    },\n    _isBufferReloadNecessary: function (topVisibleItem, bottomVisibleItem) {\n        if (typeof this.get('bufferStartIndex') === 'undefined' || typeof this.get('bufferEndIndex') === 'undefined') {\n            return true;\n        }\n        if (topVisibleItem >= 0 && topVisibleItem < this.get('bufferStartIndex') || bottomVisibleItem < this.get('total') && bottomVisibleItem > this.get('bufferEndIndex')) {\n            return true;\n        }\n        if (topVisibleItem === this.get('bufferStartIndex') && bottomVisibleItem === this.get('bufferEndIndex')) {\n            return false;\n        }\n        var topLoadFactor = 1 - (topVisibleItem - this.get('bufferStartIndex')) / this.bufferSize;\n        var bottomLoadFactor = 1 - (this.get('bufferEndIndex') - bottomVisibleItem) / this.bufferSize;\n        return this.get('bufferStartIndex') > 0 && topLoadFactor >= this.loadFactor || this.get('bufferEndIndex') < this.get('total') && bottomLoadFactor >= this.loadFactor;\n    },\n    afterFetchComplete: function (items, total) {\n    },\n    fetchFailed: function (responseStatus, error) {\n        this.trigger('fetchFailed', responseStatus, error);\n    },\n    fetch: function (options) {\n        options = _.extend({\n            top: this.get('bufferStartIndex') || 0,\n            bottom: this.get('bufferEndIndex') || this.bufferSize - 1\n        }, options);\n        if (options.force || this._isBufferReloadNecessary(options.top, options.bottom)) {\n            if (options.top !== this.attributes.bufferStartIndex || options.bottom !== this.attributes.bufferEndIndex || options.force) {\n                var bufferCenter = options.top + Math.floor((options.bottom - options.top) / 2);\n                var bufferHalf = Math.floor(this.bufferSize / 2);\n                this.attributes.bufferStartIndex = Math.max(0, bufferCenter - bufferHalf);\n                if (this.get('total') && !options.force) {\n                    this.attributes.bufferEndIndex = Math.min(this.get('total'), this.attributes.bufferStartIndex + this.bufferSize) - 1;\n                } else {\n                    this.attributes.bufferEndIndex = this.attributes.bufferStartIndex + this.bufferSize - 1;\n                }\n            }\n            this.getData({\n                offset: this.get('bufferStartIndex'),\n                limit: this.get('bufferEndIndex') - this.get('bufferStartIndex') + 1\n            }).done(this._fetchComplete).fail(this.fetchFailed);\n        } else {\n            this.afterFetchComplete && this.afterFetchComplete(this.get('items'), this.get('total'));\n        }\n    },\n    reset: function (options) {\n        this.attributes = {};\n        this.set({ items: [] }, { silent: true });\n        if (!options || !options.silent) {\n            this.trigger('change', this);\n        }\n    }\n});\nexport default ScalableListModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @author: Sergey Prilukin\n * @version: $Id$\n */\n\n/**\n * @class BaseListWithSelectionModel\n * @classdesc Model extended from ScalableListModel which allows to work with selection.\n * Base class for other selection implementations\n *\n * Model API (in addition to ScalableListModel API):\n *      addValueToSelection         - adds one value to selection and triggers \"selection:add\" event\n *      addRangeToSelection         - adds range from last adding of single selection to passed\n *                                    index and triggers \"selection:addRange\"\n *      removeValueFromSelection    - removes value from selection and triggers \"selection:remove\"\n *      toggleSelection             - toggles selection and triggers appropriate event\n *      selectionContains           - return true if value is selected and false otherwise\n *      clearSelection              - clear selection and trigger \"selection:clear\" event\n *      getSelection                - returns current selection as sparse array\n *      select                      - select passed values\n *      selectAll                   - select all values\n *      invertSelection             - inverts selection\n *\n * this Model implementation looks for following additional options in hash provided to constructor:\n *      selection       - initial selection\n */\n\nimport _ from 'underscore';\nimport ScalableListModel from './ScalableListModel';\n\nvar BaseListWithSelectionModel = ScalableListModel.extend(\n    /** @lends BaseListWithSelectionModel.prototype */\n    {\n\n        initialize: function(options) {\n            ScalableListModel.prototype.initialize.call(this, options);\n\n            this.select(options.value, {silent: true});\n        },\n\n        /* Methods which supposed to be overridden */\n\n        /**\n         * Adding to selection should be done only through this method.\n         * No direct change of this.selection object is allowed\n         */\n        _addToSelection: function(value, index) {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Removing from selection should be done only through this method.\n         * No direct change of this.selection object is allowed\n         */\n        _removeFromSelection: function(value, index) {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Clearing selection should be done only through this method.\n         * No direct change of this.selection object is allowed\n         */\n        _clearSelection: function() {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Selection contains should be checked only through this method\n         * No direct change of this.selection object is allowed\n         */\n        _selectionContains: function(value, index) {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Returns current selection\n         * No direct change of this.selection object is allowed\n         */\n        _getSelection: function() {\n            throw \"Not implemented\";\n        },\n\n        /* Internal helper methods */\n\n        _triggerSelectionChange: function(options) {\n            if (!options || !options.silent) {\n                this.trigger(\"change\");\n            }\n\n            this.trigger(\"selection:change\");\n        },\n\n        _addRangeToSelection: function(data, rangeStart, rangeEnd) {\n            for (var i = 0; i < data.length; i++) {\n                this._addToSelection(data[i].value, i + rangeStart);\n            }\n\n            this.trigger(\"selection:addRange\", {start: rangeStart, end: rangeEnd, selection: this.getSelection()});\n        },\n\n        _fetchAllDataAndModifySelection: function(modifySelection, onDone) {\n            this.getData().done(function(values) {\n                for (var i = 0; i < values.data.length; i++) {\n                    modifySelection(values.data[i].value, i);\n                }\n\n                onDone && onDone();\n            }).fail(this.fetchFailed);\n\n            return this;\n        },\n\n        /*-------------------------\n         * API\n         -------------------------*/\n\n        /*\n            Adds value selection and triggers add event\n        */\n        addValueToSelection: function(value, index) {\n            this.selectionStartIndex = index;\n            this._addToSelection(value, index);\n            return this.trigger(\"selection:add\", {value: value, index: index});\n        },\n\n        /*\n            Adds value selection and triggers add event\n        */\n        addRangeToSelection: function(value, index) {\n\n            //No range determined - use single item selection\n            if (typeof this.selectionStartIndex === \"undefined\") {\n                this.addValueToSelection(value, index);\n                return;\n            }\n\n            //Same element selected no need to fire range selection\n            if (this.selectionStartIndex === index) {\n                return;\n            }\n\n            //Calculate range dimensions\n            var rangeStart = Math.min(this.selectionStartIndex, index);\n            var rangeEnd = Math.max(this.selectionStartIndex, index);\n            this.selectionStartIndex = index;\n\n            if (rangeStart >= this.get(\"bufferStartIndex\") && rangeEnd <= this.get(\"bufferEndIndex\")) {\n                //All data from this range already fetched\n                var data = Array.prototype.slice.call(this.get(\"items\"),\n                    rangeStart - this.get(\"bufferStartIndex\"), rangeEnd - this.get(\"bufferStartIndex\") + 1);\n                this._addRangeToSelection(data, rangeStart, rangeEnd);\n            } else {\n                //Need to fetch data\n                var that = this;\n                this.getData({\n                    offset: rangeStart,\n                    limit: rangeEnd - rangeStart + 1}\n                ).done(function(values) {\n                    that._addRangeToSelection(values.data, rangeStart, rangeEnd);\n                }).fail(this.fetchFailed);\n            }\n        },\n\n        /*\n             Removes value from selection and triggers remove event\n         */\n        removeValueFromSelection: function(value, index) {\n            this._removeFromSelection(value, index);\n            this.trigger(\"selection:remove\", {value: value, index: index});\n        },\n\n        /*\n            Does selection toggle for passed value\n         */\n        toggleSelection: function(value, index) {\n            if (this.selectionContains(value, index)) {\n                this.removeValueFromSelection(value, index);\n            } else {\n                this.addValueToSelection(value, index);\n            }\n        },\n\n        /*\n            Returns true if value present in selection\n        */\n        selectionContains: function(value, index) {\n            return this._selectionContains(value, index);\n        },\n\n        /*\n            Removes all items from selection\n         */\n        clearSelection: function() {\n            this._clearSelection();\n            return this.trigger(\"selection:clear\");\n        },\n\n        /*\n            Returns all selected values\n        */\n        getSelection: function() {\n            return this._getSelection();\n        },\n\n        /*\n            Selects passed selection\n         */\n        select: function(selection, options) {\n            throw \"Not implemented\";\n        },\n\n        /*\n            Selects all values\n         */\n        selectAll: function() {\n            var self = this,\n                firstIteration = true;\n\n            this._fetchAllDataAndModifySelection(function(value, index) {\n\n                //this is necessary when getData is slow operation\n                //so model will not be empty too early\n                if (firstIteration) {\n                    self._clearSelection();\n                    firstIteration = false;\n                }\n\n                self._addToSelection(value, index);\n            }, _.bind(this._triggerSelectionChange, this));\n        },\n\n        /*\n            Inverts selection\n         */\n        invertSelection: function() {\n            var self = this;\n\n            this._fetchAllDataAndModifySelection(function(value, index) {\n                if (self._selectionContains(value, index)) {\n                    self._removeFromSelection(value, index);\n                } else {\n                    self._addToSelection(value, index);\n                }\n            }, _.bind(this._triggerSelectionChange, this));\n        }\n    });\n\nexport default BaseListWithSelectionModel;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport BaseListWithSelectionModel from './BaseListWithSelectionModel';\nvar ListWithSelectionModel = BaseListWithSelectionModel.extend({\n    _addToSelection: function (value, index) {\n        this.selection[index] = value;\n    },\n    _removeFromSelection: function (value, index) {\n        this.selection[index] = undefined;\n    },\n    _clearSelection: function () {\n        this.selection = [];\n    },\n    _selectionContains: function (value, index) {\n        return this.selection[index] === value;\n    },\n    _getSelection: function () {\n        return this.selection;\n    },\n    _isSelectionEmpty: function (selection) {\n        if (!selection) {\n            return true;\n        } else if (_.isArray(selection) && selection.length === 0) {\n            return true;\n        } else if (_.isArray(selection) || typeof selection === 'string') {\n            return false;\n        }\n        for (var index in selection) {\n            if (selection.hasOwnProperty(index) && selection[index] !== undefined) {\n                return false;\n            }\n        }\n        return true;\n    },\n    _selectPendingSelection: function (pendingSelection, options) {\n        if (this.get('bufferStartIndex') === 0 && this.get('bufferEndIndex') == this.get('total') - 1) {\n            this._convertInitialArrayToSelection(this.get('items'), pendingSelection, options);\n        } else {\n            var that = this;\n            this.getData().done(function (values) {\n                that._convertInitialArrayToSelection(values.data, pendingSelection, options);\n            }).fail(this.fetchFailed);\n        }\n    },\n    _convertInitialArrayToSelection: function (data, pendingSelection, options) {\n        for (var i = 0; i < data.length; i++) {\n            if (pendingSelection[data[i].value]) {\n                this._addToSelection(data[i].value, i);\n            }\n        }\n        this._triggerSelectionChange(options);\n    },\n    _triggerSelectionChange: function (options) {\n        this._calcSelectionStartIndex && this._calcSelectionStartIndex();\n        BaseListWithSelectionModel.prototype._triggerSelectionChange.call(this, options);\n    },\n    _calcSelectionStartIndex: function () {\n        if (typeof this.selectionStartIndex !== 'undefined') {\n            return;\n        }\n        for (var index in this.selection) {\n            if (this.selection.hasOwnProperty(index) && this.selection[index] !== undefined) {\n                this.selectionStartIndex = parseInt(index, 10);\n                break;\n            }\n        }\n    },\n    select: function (selection, options) {\n        this._clearSelection();\n        if (this._isSelectionEmpty(selection)) {\n            this._triggerSelectionChange(options);\n            return;\n        }\n        if (_.isArray(selection) || typeof selection === 'string') {\n            var pendingSelection = {};\n            if (typeof selection === 'string') {\n                pendingSelection[selection] = true;\n            } else {\n                for (var i = 0; i < selection.length; i++) {\n                    pendingSelection[selection[i]] = true;\n                }\n            }\n            this._selectPendingSelection(pendingSelection, options);\n        } else {\n            for (var index in selection) {\n                if (selection.hasOwnProperty(index)) {\n                    var value = selection[index];\n                    if (value !== undefined) {\n                        this._addToSelection(value, index);\n                    }\n                }\n            }\n            this._triggerSelectionChange(options);\n        }\n    }\n});\nexport default ListWithSelectionModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport ListWithSelectionModel from '../../scalableList/model/ListWithSelectionModel';\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nvar SingleSelectListModel = ListWithSelectionModel.extend(listWithNavigationModelTrait);\nSingleSelectListModel = SingleSelectListModel.extend({\n    setActive: function (options) {\n        listWithNavigationModelTrait.setActive.call(this, _.extend(options, { silent: true }));\n        var selection = {};\n        if (typeof options.index === 'number') {\n            selection[options.index] = options.item.value;\n        }\n        this.select(selection);\n    },\n    _convertInitialArrayToSelection: function (data, pendingSelection, options) {\n        for (var i = 0; i < data.length; i++) {\n            if (pendingSelection[data[i].value]) {\n                this._addToSelection(data[i].value, i);\n                if (!this.getActive()) {\n                    listWithNavigationModelTrait.setActive.call(this, {\n                        index: i,\n                        item: data[i],\n                        silent: true\n                    });\n                }\n            }\n        }\n        this._triggerSelectionChange(options);\n    },\n    _convertSelectionObject: function (selection) {\n        for (var index in selection) {\n            if (selection.hasOwnProperty(index) && selection[index] !== undefined) {\n                var value = selection[index];\n                return {\n                    index: parseInt(index, 10),\n                    value: value\n                };\n            }\n        }\n    },\n    _select: ListWithSelectionModel.prototype.select,\n    select: function (selection, options) {\n        var convertedSelection;\n        var shouldFetchLabel = false;\n        if (!selection || typeof selection === 'string' || _.isArray(selection)) {\n            listWithNavigationModelTrait.setActive.call(this, { silent: true });\n        } else {\n            convertedSelection = this._convertSelectionObject(selection);\n            if (!convertedSelection) {\n                listWithNavigationModelTrait.setActive.call(this, { silent: true });\n            } else {\n                var active = this.getActive();\n                if (!active || convertedSelection.value !== active.value || convertedSelection.index !== active.index) {\n                    shouldFetchLabel = true;\n                }\n            }\n        }\n        if (shouldFetchLabel) {\n            this.activate(convertedSelection.index);\n        } else {\n            this._select(selection, options);\n        }\n        return this;\n    }\n});\nexport default SingleSelectListModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport ScalableListModel from '../model/ScalableListModel';\nimport defaultChunksTemplate from '../templates/viewPortChunksTemplate.htm';\nimport defaultItemsTemplate from '../templates/itemsTemplate.htm';\nvar DEFAULT_VIEW_PORT_CHUNK_HEIGHT = 1000000;\nvar DEFAULT_SCROLL_TIMEOUT = 50;\nvar DEFAULT_MANUAL_SCROLL_INTERVAL = 50;\nvar DEFAULT_LIST_ITEM_HEIGHT = 21;\nvar MIN_ITEM_HEIGHT_TRESHOLD = 2;\nvar ScalableList = Backbone.View.extend({\n    ListModel: ScalableListModel,\n    listItemSelector: 'li',\n    events: {\n        'scroll': 'onScroll',\n        'touchmove': 'onScroll'\n    },\n    attributes: { 'style': 'overflow-y: auto; height: 100px; min-height: 100px;' },\n    initialize: function (options) {\n        _.bindAll(this, '_fetchVisibleData');\n        this.model = options.model || new this.ListModel(options);\n        this.chunksTemplate = _.template(options.chunksTemplate || defaultChunksTemplate);\n        this.itemsTemplate = _.template(options.itemsTemplate || defaultItemsTemplate);\n        this.defaultChunkHeight = this.chunkHeight = options.chunkHeight || DEFAULT_VIEW_PORT_CHUNK_HEIGHT;\n        this.scrollTimeout = typeof options.scrollTimeout !== 'undefined' ? options.scrollTimeout : DEFAULT_SCROLL_TIMEOUT;\n        this.manualScrollInterval = options.manualScrollInterval || DEFAULT_MANUAL_SCROLL_INTERVAL;\n        this.lazy = options.lazy;\n        this.defaultItemHeight = options.listItemHeight || DEFAULT_LIST_ITEM_HEIGHT;\n        this.listItemSelector = options.listItemSelector || this.listItemSelector;\n        this.render();\n        this.initListeners();\n        if (!this.lazy) {\n            this.model.fetch();\n        }\n        return this;\n    },\n    initListeners: function () {\n        this.listenTo(this.model, 'change', this.onModelChange, this);\n        this.listenTo(this.model, 'fetchFailed', this.onFetchFailed, this);\n    },\n    render: function () {\n        return this;\n    },\n    onScroll: function (event) {\n        if (this.scrollTimeout > 0) {\n            clearTimeout(this.scrollTimer);\n            this.scrollTimer = setTimeout(this._fetchVisibleData, this.scrollTimeout);\n        } else {\n            this._fetchVisibleData();\n        }\n        this.scrollPos = event && event.target && event.target.scrollTop;\n    },\n    restoreScrollPos: function () {\n        this.$el.scrollTop(this.scrollPos);\n    },\n    onModelChange: function () {\n        this.renderData();\n    },\n    onFetchFailed: function (responseStatus, error) {\n        this.trigger('listRenderError', responseStatus, error);\n    },\n    postProcessChunkModelItem: function (item, i) {\n        item.index = this.model.get('bufferStartIndex') + i;\n        if (item.label === undefined) {\n            item.label = item.value;\n        }\n        item.label = $.trim(item.label);\n    },\n    _renderItems: function () {\n        var bufferStart = this.model.get('bufferStartIndex');\n        var bufferEnd = this.model.get('bufferEndIndex');\n        var firstChunkWithData = this.itemsPerChunk ? Math.ceil((bufferStart + 1) / this.itemsPerChunk) : 1;\n        var lastChunkWithData = this.itemsPerChunk ? Math.ceil((bufferEnd + 1) / this.itemsPerChunk) : 1;\n        var that = this;\n        this.$el.find('.jr-jViewPortChunk').each(function (index, chunk) {\n            var $chunk = $(chunk);\n            var chunkModel = that._getChunkModel({\n                index: index + 1,\n                firstChunkWithData: firstChunkWithData,\n                lastChunkWithData: lastChunkWithData,\n                bufferStart: bufferStart,\n                bufferEnd: bufferEnd,\n                total: that.totalItems,\n                itemsPerChunk: that.itemsPerChunk,\n                itemHeight: that.itemHeight,\n                chunkHeight: that.chunkHeight,\n                model: that.model\n            });\n            var chunkHtml = chunkModel ? that.itemsTemplate(chunkModel) : '';\n            var child = chunk.children[0];\n            child && chunk.removeChild(child);\n            $chunk.append(chunkHtml);\n        });\n    },\n    _renderViewChunks: function (force) {\n        var self = this, childChunks;\n        if (this.totalItems !== this.model.get('total') || force) {\n            this.totalItems = this.model.get('total');\n            childChunks = Array.prototype.slice.call(this.$el[0].children);\n            childChunks.forEach(function (chunk) {\n                self.$el[0].removeChild(chunk);\n            });\n            this.$el.append(this.chunksTemplate({\n                _: _,\n                chunks: this._getViewChunksModel()\n            }));\n            this.$firstViewChunk = this.$el.find('.jr-jViewPortChunk:first');\n        }\n    },\n    _getViewChunksModel: function () {\n        var totalChunksToShow = this.itemsPerChunk ? Math.ceil(this.totalItems / this.itemsPerChunk) : 1;\n        var lastChunkHeight = totalChunksToShow > 0 ? this.itemHeight ? this.totalItems * this.itemHeight - (totalChunksToShow - 1) * this.chunkHeight : this.chunkHeight : 1;\n        var viewChunks = [];\n        for (var i = 1; i < totalChunksToShow; i++) {\n            viewChunks.push({ height: this.chunkHeight });\n        }\n        viewChunks.push({ height: lastChunkHeight });\n        return viewChunks;\n    },\n    _calcViewPortConstants: function () {\n        if (!this.viewPortConstantsInitialized) {\n            this.itemHeight = this.defaultItemHeight;\n            if (this.$firstViewChunk) {\n                this.itemHeight = this.$el.find(this.listItemSelector + ':first').outerHeight(true);\n                if (!this.itemHeight || this.itemHeight <= MIN_ITEM_HEIGHT_TRESHOLD) {\n                    this.itemHeight = this.defaultItemHeight;\n                    this.viewPortConstantsInitialized = false;\n                } else {\n                    this.viewPortConstantsInitialized = true;\n                }\n            }\n            this._calcViewPortHeight();\n            this.itemsPerChunk = Math.floor(this.defaultChunkHeight / this.itemHeight);\n            this.chunkHeight = this.itemsPerChunk * this.itemHeight;\n            this._renderViewChunks(true);\n            this._renderItems();\n        }\n    },\n    resizeViewPort: function (viewPortHeight) {\n        this.viewPortHeight = viewPortHeight;\n        this.$el.outerHeight(this.viewPortHeight);\n        this.itemsPerView = Math.floor(this.viewPortHeight / this.itemHeight) - 1;\n        this.itemsPerChunk = Math.floor(this.defaultChunkHeight / this.itemHeight);\n        this.chunkHeight = this.itemsPerChunk * this.itemHeight;\n        this._renderViewChunks(true);\n        this._renderItems();\n    },\n    _calcViewPortHeight: function () {\n        this.viewPortHeight = this.$el.height();\n        this.itemsPerView = Math.floor(this.viewPortHeight / this.itemHeight) - 1;\n    },\n    _getItemsPerView: function () {\n        this._calcViewPortConstants();\n        return this.itemsPerView;\n    },\n    _getChunkModel: function (options) {\n        var index = options.index;\n        if (index < options.firstChunkWithData || index > options.lastChunkWithData) {\n            return null;\n        }\n        var firstItemForChunk = options.itemsPerChunk ? Math.max(options.bufferStart, options.itemsPerChunk * (index - 1)) : options.bufferStart;\n        var lastItemForChunk = options.itemsPerChunk ? Math.min(options.bufferEnd, options.itemsPerChunk * index - 1) : options.bufferEnd;\n        var top = options.itemHeight ? firstItemForChunk * options.itemHeight - (index - 1) * options.chunkHeight : 0;\n        var items = Array.prototype.slice.call(options.model.get('items'), firstItemForChunk - options.bufferStart, lastItemForChunk - options.bufferStart + 1);\n        _.each(items, function (item, i) {\n            this.postProcessChunkModelItem(item, i + (firstItemForChunk - options.bufferStart));\n        }, this);\n        return {\n            top: top,\n            items: items\n        };\n    },\n    _fetchVisibleData: function () {\n        var visibleItems = this._getVisibleItems();\n        this.model.fetch({\n            top: visibleItems.top,\n            bottom: visibleItems.bottom\n        });\n    },\n    _getVisibleItems: function () {\n        var scrollPos = this._getScrollPos();\n        var total = this.model.get('total');\n        var topVisibleItem = Math.min(total - this.itemsPerView, Math.floor(scrollPos / this.itemHeight));\n        var bottomVisibleItem = Math.min(total - 1, topVisibleItem + this.itemsPerView + 1);\n        return {\n            top: topVisibleItem,\n            bottom: bottomVisibleItem\n        };\n    },\n    _getScrollPos: function () {\n        this._calcViewPortConstants();\n        var scrollPos = 0;\n        if (this.$firstViewChunk) {\n            var elOffset = this.$el.offset();\n            var viewChunkOffset = this.$firstViewChunk.offset();\n            if (elOffset && viewChunkOffset) {\n                scrollPos = elOffset.top - viewChunkOffset.top;\n            }\n        }\n        return scrollPos;\n    },\n    renderData: function () {\n        if (this.lazy || !this.model.has('bufferStartIndex') || !this.model.has('bufferEndIndex')) {\n            this.lazy = null;\n            this.model.fetch();\n        } else {\n            this.trigger('before:render:data');\n            this._renderViewChunks();\n            this._renderItems();\n            this._calcViewPortConstants();\n            this.trigger('render:data');\n        }\n        return this;\n    },\n    resize: function () {\n        if (!this.$el.is(':visible')) {\n            return;\n        }\n        var componentHeight = this.$el.outerHeight();\n        if (componentHeight === this._componentHeight) {\n            return;\n        } else {\n            this._componentHeight = componentHeight;\n        }\n        this.viewPortConstantsInitialized = false;\n        this._calcViewPortConstants();\n    },\n    fetch: function (callback, options) {\n        this.lazy = false;\n        options = options || {};\n        var scrollPos;\n        if (options.keepPosition) {\n            scrollPos = this.$el.get(0).scrollTop;\n        } else {\n            this.reset({\n                silent: true,\n                lazy: false\n            });\n        }\n        this.model.once('change', function () {\n            if (options.keepPosition) {\n                this.$el.scrollTop(scrollPos);\n            }\n            callback && callback.apply(this, arguments);\n        }, this).fetch({ force: true });\n    },\n    reset: function (options) {\n        options = _.defaults(options || {}, { lazy: true });\n        this.$el.scrollTop(0);\n        this.lazy = options.lazy;\n        this.model.reset(options);\n    },\n    scrollTo: function (index) {\n        if (typeof index !== 'number') {\n            return;\n        }\n        var scrollPos = this._getScrollPos();\n        if (!this.viewPortConstantsInitialized) {\n            return;\n        }\n        this._calcViewPortHeight();\n        var newTopVisibleItemPos = null;\n        var itemPos = index * this.itemHeight;\n        if (itemPos < scrollPos) {\n            newTopVisibleItemPos = itemPos;\n        } else if (itemPos + this.itemHeight > scrollPos + this.viewPortHeight) {\n            newTopVisibleItemPos = itemPos + this.itemHeight - this.viewPortHeight;\n        }\n        if (newTopVisibleItemPos !== null) {\n            this.$el.scrollTop(newTopVisibleItemPos);\n        }\n    }\n});\nexport default ScalableList;","export default \"{{_.each(chunks, function(chunk) { }}\\n<div class=\\\"jr-jViewPortChunk\\\" style=\\\"height: {{- chunk.height}}px\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n{{ }); }}\\n\";","export default \"<ul class=\\\"jr-mSelectlist jr\\\" style=\\\"top: {{- top}}px; position: relative;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{_.each(items, function(item) { }}\\n    <li class=\\\"jr-mSelectlist-item {{ if (item.selected) print('jr-isSelected'); }} {{ if (item.active) print(' jr-isHovered'); }} jr\\\" title=\\\"{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}\\\" data-index=\\\"{{- item.index}}\\\">\\n        <div class=\\\"jr-mSelectlist-item-wrapper jr\\\">\\n            <a class=\\\"jr-mSelectlist-item-text jr\\\">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}</a>\\n        </div>\\n    </li>\\n    {{ }); }}\\n</ul>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport ListWithSelectionModel from '../model/ListWithSelectionModel';\nimport ScalableList from './ScalableList';\nvar MOUSE_MOVE_MIN_PIXELS = 1;\nvar BUTTONS = {\n    LEFT: 'left',\n    RIGHT: 'right'\n};\nvar ListWithSelection = ScalableList.extend({\n    ListModel: ListWithSelectionModel,\n    initialize: function (options) {\n        _.bindAll(this, 'onGlobalMouseup', 'onGlobalMousemove', '_autoScroll', 'fetch');\n        this.eventListenerPattern = options.eventListenerPattern || 'li';\n        this.markerClass = options.markerClass ? options.markerClass : '';\n        this.selectedClass = options.selectedClass ? options.selectedClass : 'jr-isSelected';\n        this._initSelection(options.selection);\n        return ScalableList.prototype.initialize.call(this, options);\n    },\n    delegateEvents: function () {\n        var res = ScalableList.prototype.delegateEvents.apply(this, arguments);\n        this.$el.on('mousedown', this.eventListenerPattern, _.bind(this.onMousedown, this)).on('mousemove', this.eventListenerPattern, _.bind(this.onMousemove, this)).on('dblclick', this.eventListenerPattern, _.bind(this.onMousedblclick, this)).on('contextmenu', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el)).on('click', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el)).on('mouseout', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el)).on('mouseover', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el));\n        return res;\n    },\n    undelegateEvents: function () {\n        var res = ScalableList.prototype.undelegateEvents.apply(this, arguments);\n        this.$el.off('mouseup').off('mousedown').off('mousemove').off('dblclick').off('contextmenu').off('click').off('mouseout').off('mouseover');\n        return res;\n    },\n    _initSelection: function (selection) {\n        selection = _.extend({ allowed: {} }, selection);\n        var selectionAllowed = selection.allowed ?? {}, leftButtonSelection = !_.isObject(selectionAllowed) ? selectionAllowed : selectionAllowed.left;\n        this.selection = {\n            allowed: {\n                left: typeof leftButtonSelection !== 'undefined' ? leftButtonSelection : true,\n                right: typeof selectionAllowed.right !== 'undefined' ? selectionAllowed.right : false\n            },\n            multiple: typeof selection.multiple !== 'undefined' ? selection.multiple : true\n        };\n    },\n    initListeners: function () {\n        ScalableList.prototype.initListeners.call(this);\n        this.listenTo(this.model, 'selection:clear', this.clearSelection, this);\n        this.listenTo(this.model, 'selection:add', this.selectValue, this);\n        this.listenTo(this.model, 'selection:addRange', this.selectRange, this);\n        this.listenTo(this.model, 'selection:remove', this.deselectValue, this);\n        $('body').on('mouseup', this.onGlobalMouseup).on('mousemove', this.onGlobalMousemove);\n    },\n    postProcessChunkModelItem: function (item, i) {\n        ScalableList.prototype.postProcessChunkModelItem.call(this, item, i);\n        item.selected = this.model.selectionContains && this.model.selectionContains(item.value, item.index);\n    },\n    onMousedblclick: function (event) {\n        if (!this.selection.multiple) {\n            if ((this.selection.allowed.left || this.selection.allowed.right) && !this.getDisabled()) {\n                var itemData = this._getDomItemData(event.currentTarget);\n                this._singleSelect(event, itemData.value, itemData.index);\n                if (this.selectionChanged) {\n                    this._triggerSelectionChanged();\n                    this._triggerDblclicked();\n                    this.selectionChanged = false;\n                }\n            }\n        }\n    },\n    getItemByEvent: function (e) {\n        return this._getDomItemData(e.currentTarget).item;\n    },\n    onItemEvent: function (element, e) {\n        var eventType = e.type, item = this.getItemByEvent(e);\n        this.trigger('list:item:' + eventType, item, e);\n    },\n    onMousedown: function (event) {\n        if (!this.getDisabled() && (this.selection.allowed.left && event.which === 1 || this.selection.allowed.right && event.which === 3)) {\n            var buttonType = event.which === 1 ? BUTTONS.LEFT : BUTTONS.RIGHT;\n            if (this.selection.multiple) {\n                this[buttonType + 'MouseButtonPressed'] = true;\n                this.mouseDownPos = this._getMousePos(event);\n            }\n            var itemData = this._getDomItemData(event.currentTarget);\n            this.selection.multiple ? this._multiSelect(event, itemData.value, itemData.index) : this._singleSelect(event, itemData.value, itemData.index);\n        }\n    },\n    onMousemove: function (event) {\n        if (this._allowMouseMoveSelection()) {\n            this._stopAutoScroll();\n            if (this._mouseMoved(event, this.mouseDownPos)) {\n                this.mouseDownPos = this._getMousePos(event);\n                var itemData = this._getDomItemData(event.currentTarget);\n                if (!this.model.selectionContains(itemData.value, itemData.index)) {\n                    this.model.addRangeToSelection(itemData.value, itemData.index);\n                }\n            }\n        }\n    },\n    onGlobalMouseup: function (event) {\n        var self = this;\n        if (this.leftMouseButtonPressed || this.rightMouseButtonPressed) {\n            _.each(BUTTONS, function (buttonType) {\n                self[buttonType + 'MouseButtonPressed'] = false;\n            });\n            delete this.mouseDownPos;\n            this._stopAutoScroll();\n            if (this.selectionChanged) {\n                this._triggerSelectionChanged();\n                this.selectionChanged = false;\n            }\n        }\n    },\n    onGlobalMousemove: function (event) {\n        if (this._allowMouseMoveSelection()) {\n            this.mousePosY = event.clientY;\n            if (!this.scrollInterval) {\n                this.scrollInterval = setInterval(this._autoScroll, this.manualScrollInterval);\n            }\n        }\n    },\n    clearSelection: function () {\n        this.$el.find('li.' + this.selectedClass + this.markerClass).removeClass(this.selectedClass);\n        this.selectionChanged = true;\n    },\n    selectValue: function (selection) {\n        this._selectItemByIndex(selection.index);\n        if (this.selection.multiple) {\n            this.selectionChanged = true;\n        } else {\n            this._triggerSelectionChanged();\n        }\n    },\n    selectRange: function (options) {\n        var self = this;\n        var visibleRangeStart = Math.max(this.model.get('bufferStartIndex'), options.start);\n        var visibleRangeEnd = Math.min(this.model.get('bufferEndIndex'), options.end);\n        this.$el.find('li' + this.markerClass + ':not(.' + this.selectedClass + ')').each(function () {\n            var $item = $(this);\n            var index = parseInt($item.attr('data-index'), 10);\n            if (index >= visibleRangeStart && index <= visibleRangeEnd) {\n                var item = self.model.get('items')[index - self.model.get('bufferStartIndex')];\n                if (self.model.selectionContains(item && item.value, index)) {\n                    $item.addClass(self.selectedClass);\n                }\n            }\n        });\n        this.selectionChanged = true;\n    },\n    deselectValue: function (selection) {\n        this._deselectItemByIndex(selection.index);\n        if (this.selection.multiple) {\n            this.selectionChanged = true;\n        } else {\n            this._triggerSelectionChanged();\n        }\n    },\n    _selectItemByIndex: function (index) {\n        this.$el.find('li' + this.markerClass + '[data-index=\\'' + index + '\\']:not(.' + this.selectedClass + ')').addClass(this.selectedClass);\n    },\n    _deselectItemByIndex: function (index) {\n        this.$el.find('li[data-index=\\'' + index + '\\'].' + this.selectedClass + this.markerClass).removeClass(this.selectedClass);\n    },\n    _autoScroll: function () {\n        var viewPortTop = this.$el.offset().top;\n        var scrollTop = this.$el.scrollTop();\n        var scrollPos = typeof this.scrollTop !== 'undefined' ? this.scrollTop : scrollTop;\n        var newScrollPos;\n        var shouldScroll = false;\n        if (this.mousePosY < viewPortTop) {\n            newScrollPos = scrollPos - this.itemHeight * 3;\n            shouldScroll = newScrollPos < scrollTop;\n        } else if (this.mousePosY > viewPortTop + this.viewPortHeight) {\n            newScrollPos = scrollPos + this.itemHeight * 3;\n            shouldScroll = newScrollPos > scrollTop;\n        }\n        if (shouldScroll) {\n            this.$el.scrollTop(newScrollPos);\n            this.scrollTop = this.$el.scrollTop();\n            this._fetchVisibleData();\n        }\n        this._selectRangeOnAutoScroll(scrollPos, newScrollPos);\n    },\n    _selectRangeOnAutoScroll: function (oldScrollPos, newScrollPos) {\n        var index;\n        if (oldScrollPos < newScrollPos) {\n            index = this._getVisibleItems().bottom;\n        } else if (oldScrollPos > newScrollPos) {\n            index = this._getVisibleItems().top;\n        }\n        if (index) {\n            var item = this.model.get('items')[index - this.model.get('bufferStartIndex')];\n            if (item) {\n                if (!this.model.selectionContains(item.value, index)) {\n                    this.model.addRangeToSelection(item.value, index);\n                }\n            }\n        }\n    },\n    _stopAutoScroll: function () {\n        if (this.scrollInterval) {\n            clearInterval(this.scrollInterval);\n            this.scrollInterval = undefined;\n            this.scrollTop = undefined;\n        }\n    },\n    _multiSelect: function (event, value, index) {\n        if (event.shiftKey) {\n            this.model.addRangeToSelection(value, index);\n        } else if (event.ctrlKey || event.metaKey) {\n            this._singleSelect(event, value, index);\n        } else {\n            this.model.toggleSelection(value, index);\n        }\n    },\n    _singleSelect: function (event, value, index) {\n        this.model.clearSelection().addValueToSelection(value, index);\n    },\n    _triggerSelectionChanged: function () {\n        this.trigger('selection:change', this.getValue());\n    },\n    _triggerDblclicked: function () {\n        this.trigger('item:dblclick', this.getValue());\n    },\n    _getDomItemData: function (item) {\n        var $item = $(item);\n        var index = $item.attr('data-index');\n        while (index === undefined) {\n            $item = $item.parent();\n            index = $item.attr('data-index');\n        }\n        index = parseInt(index, 10);\n        var modelItem = this.model.get('items')[index - this.model.get('bufferStartIndex')];\n        return {\n            item: modelItem,\n            value: modelItem && modelItem.value,\n            index: index\n        };\n    },\n    _mouseMoved: function (event, mousePos) {\n        return Math.abs(mousePos.x - event.clientX) + Math.abs(mousePos.y - event.clientY) >= MOUSE_MOVE_MIN_PIXELS;\n    },\n    _getMousePos: function (event) {\n        return {\n            x: event.clientX,\n            y: event.clientY\n        };\n    },\n    _allowMouseMoveSelection: function () {\n        return (this.selection.allowed.left && this.leftMouseButtonPressed || this.selection.allowed.right && this.rightMouseButtonPressed) && this.selection.multiple && !this.getDisabled();\n    },\n    getValue: function () {\n        return this.model.getSelection();\n    },\n    setValue: function (selection, options) {\n        options = options || {};\n        if (!options.silent && (!options.modelOptions || !options.modelOptions.silent)) {\n            this.model.once('selection:change', this._triggerSelectionChanged, this);\n        }\n        options = options.modelOptions;\n        this.model.select(selection, options);\n        return this;\n    },\n    selectAll: function (options) {\n        if (!options || !options.silent) {\n            this.model.once('selection:change', this._triggerSelectionChanged, this);\n        }\n        this.model.selectAll();\n        return this;\n    },\n    selectNone: function (options) {\n        return this.setValue({}, options);\n    },\n    invertSelection: function (options) {\n        if (!options || !options.silent) {\n            this.model.once('selection:change', this._triggerSelectionChanged, this);\n        }\n        this.model.invertSelection();\n        return this;\n    },\n    setDisabled: function (disabled) {\n        this.disabled = disabled;\n        this.disabled ? this.$el.addClass('disabled') : this.$el.removeClass('disabled');\n        return this;\n    },\n    getDisabled: function () {\n        return this.disabled;\n    },\n    remove: function () {\n        $('body').off('mouseup', this.onGlobalMouseup).off('mousemove', this.onGlobalMousemove);\n        return ScalableList.prototype.remove.call(this);\n    }\n});\nexport default ListWithSelection;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport ListWithSelection from './ListWithSelection';\nimport ListWithSelectionModel from '../model/ListWithSelectionModel';\nimport listWithNavigationModelTrait from '../model/listWithNavigationModelTrait';\nvar ListWithNavigation = ListWithSelection.extend({\n    canActivate: true,\n    initialize: function (options) {\n        options = options || {};\n        var ListWithNavigationModel = ListWithSelectionModel.extend(listWithNavigationModelTrait);\n        options.model = options.model || new ListWithNavigationModel(options);\n        ListWithSelection.prototype.initialize.call(this, options);\n    },\n    onMousemove: function (event) {\n        ListWithSelection.prototype.onMousemove.call(this, event);\n        if (!this.mouseMovePos || this._mouseMoved(event, this.mouseMovePos)) {\n            this.mouseMovePos = this._getMousePos(event);\n            var itemData = this._getDomItemData(event.currentTarget);\n            this.activate(itemData.index);\n        }\n    },\n    setCanActivate: function (canActivate) {\n        this.canActivate = canActivate;\n    },\n    getCanActivate: function () {\n        return this.canActivate && !this.getDisabled();\n    },\n    activateFirst: function () {\n        this.activate(0);\n    },\n    activateLast: function () {\n        this.activate(Math.max(0, this.model.get('total') - 1));\n    },\n    activateNext: function () {\n        this.activate(Math.min(this.model.get('total') - 1, this._getActiveIndex() + 1));\n    },\n    activatePrevious: function () {\n        this.activate(Math.max(0, this._getActiveIndex() - 1));\n    },\n    pageDown: function () {\n        this.activate(Math.min(this.model.get('total') - 1, this._getActiveIndex() + this._getItemsPerView()));\n    },\n    pageUp: function () {\n        this.activate(Math.max(0, this._getActiveIndex() - this._getItemsPerView()));\n    },\n    getActiveValue: function () {\n        return this.model.getActive && this.model.getActive();\n    },\n    activate: function (index, options) {\n        if (this.getCanActivate()) {\n            var active = this.getActiveValue();\n            if (active && active.index === index) {\n                return;\n            }\n            if (!options || !options.silent) {\n                var that = this;\n                this.model.once('active:changed', function () {\n                    that.trigger('active:changed', that.getActiveValue());\n                });\n            }\n            this.model.activate(index, options);\n        }\n    },\n    postProcessChunkModelItem: function (item, i) {\n        ListWithSelection.prototype.postProcessChunkModelItem.call(this, item, i);\n        var activeIndex = this._getActiveIndex && this._getActiveIndex();\n        item.active = typeof activeIndex !== 'undefined' && activeIndex === this.model.get('bufferStartIndex') + i;\n    },\n    _getActiveIndex: function () {\n        var active = this.getActiveValue();\n        return active && active.index;\n    }\n});\nexport default ListWithNavigation;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport SingleSelectListModel from '../model/SingleSelectListModel';\nimport ListWithNavigation from '../../scalableList/view/ListWithNavigation';\nvar SingleSelectList = ListWithNavigation.extend({\n    events: _.extend({}, ListWithNavigation.prototype.events, { 'mouseup li': 'onMouseup' }),\n    initialize: function (options) {\n        var model = options.model || new SingleSelectListModel(options);\n        ListWithNavigation.prototype.initialize.call(this, _.extend({\n            model: model,\n            lazy: true,\n            selection: {\n                allowed: true,\n                multiple: false\n            }\n        }, options));\n    },\n    onMouseup: function () {\n        this.trigger('item:mouseup');\n    },\n    activate: function (index) {\n        if (this.getCanActivate()) {\n            var active = this.getActiveValue();\n            if (active && active.index === index) {\n                return;\n            }\n            this.model.once('selection:change', this._triggerSelectionChanged, this).activate(index);\n        }\n    }\n});\nexport default SingleSelectList;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nvar SearcheableDataProvider = function (options) {\n    _.bindAll(this, 'getData', '_filterValues', '_shouldFilter');\n    this.indexMapping = {};\n    this.internalGetData = options.getData;\n};\n_.extend(SearcheableDataProvider.prototype, {\n    getData: function (options) {\n        var deferred = new $.Deferred();\n        if (options && typeof options.criteria !== 'undefined') {\n            this.dataCache = null;\n            this.criteria = options.criteria;\n            deferred.resolve();\n            return deferred.promise();\n        }\n        let that = this;\n\n        if (that._shouldFilter()) {\n            if (this.dataCache) {\n                this._resolvePromise(options, deferred);\n            } else {\n                this.internalGetData().done(function (values) {\n                    that.indexMapping = {};\n                    that.reverseIndexMapping = {};\n                    that.dataCache = that._filterValues(values.data);\n                    that._resolvePromise(options, deferred);\n                }).fail(deferred.reject);\n            }\n            return deferred.promise();\n        } else {\n            this.indexMapping = null;\n            this.reverseIndexMapping = null;\n            this.dataCache = null;\n            return this.internalGetData(options);\n        }\n    },\n    getIndexMapping: function () {\n        return this.indexMapping;\n    },\n    getReverseIndexMapping: function () {\n        return this.reverseIndexMapping;\n    },\n    _resolvePromise: function (options, deferred) {\n        var first = options && options.offset ? options.offset : 0;\n        var last = options && options.limit ? first + options.limit : this.dataCache.length;\n        var dataSegment = this._getDataSegment(this.dataCache, first, last);\n        deferred.resolve({\n            data: dataSegment,\n            total: this.dataCache.length\n        });\n    },\n    _shouldFilter: function () {\n        return this.criteria;\n    },\n    _filterValues: function (data) {\n        var filteredData = [];\n        var j = 0;\n        for (var i = 0; i < data.length; i++) {\n            var value = data[i];\n            var searchIn = value.label === undefined ? value.value : value.label;\n            if (searchIn.toLowerCase().indexOf(this.criteria.toLowerCase()) > -1) {\n                filteredData[j] = value;\n                this.indexMapping[j] = i;\n                this.reverseIndexMapping[i] = j;\n                j += 1;\n            }\n        }\n        return filteredData;\n    },\n    _getDataSegment: function (values, first, last) {\n        last = Math.min(last, values.length);\n        var result = [];\n        for (var i = first; i < last; i++) {\n            result.push({\n                label: values[i].label,\n                value: values[i].value\n            });\n        }\n        return result;\n    }\n});\nexport default SearcheableDataProvider;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport $ from 'jquery';\nvar RECALC_DROP_DOWN_POS_INTERVAL = 500;\nvar $body = $('body');\nvar DropDownManager = function (options) {\n    this.initialize(options);\n    return this;\n};\n_.extend(DropDownManager.prototype, {\n    initialize: function (options) {\n        _.bindAll(this, 'checkOffset', 'setNewOffset');\n        this.$dropDownEl = options.dropDownEl;\n        this.calcOffset = options.calcOffset;\n        this.isOffsetChanged = options.isOffsetChanged || this._isOffsetChanged;\n        this.recalcInterval = options.recalcInterval || RECALC_DROP_DOWN_POS_INTERVAL;\n        this.onOffsetChanged = options.onOffsetChanged;\n    },\n    startCalc: function () {\n        this.checkOffset(this.setNewOffset);\n        clearInterval(this.recalcTimer);\n        this.recalcTimer = setInterval(_.bind(this.checkOffset, this, this.onOffsetChanged), this.recalcInterval);\n    },\n    stopCalc: function () {\n        clearInterval(this.recalcTimer);\n    },\n    checkOffset: function (callback) {\n        var whereItNeedsToBe = this.calcOffset();\n        var currentOffset = this.$dropDownEl.position();\n        var bodyOffset = $body.offset();\n        if (bodyOffset.top || bodyOffset.left) {\n            currentOffset.top += bodyOffset.top;\n            currentOffset.left += bodyOffset.left;\n        }\n        if (this.$dropDownEl.width() !== whereItNeedsToBe.width) {\n            this.setNewOffset(whereItNeedsToBe);\n        }\n        if (this.isOffsetChanged(currentOffset, whereItNeedsToBe)) {\n            callback && callback(whereItNeedsToBe);\n        }\n    },\n    setNewOffset: function (newDimensions) {\n        this.$dropDownEl.css('top', newDimensions.top - $body.offset().top).css('left', newDimensions.left - $body.offset().left).css('width', newDimensions.width);\n    },\n    _isOffsetChanged: function (currentDimensions, newDimensions) {\n        return Math.floor(currentDimensions.top) !== Math.floor(newDimensions.top) || Math.floor(currentDimensions.left) !== Math.floor(newDimensions.left);\n    }\n});\nexport default DropDownManager;","\n        import {store, MERGED_BUNDLES_NAME} from 'bundleStore';\n        \n        let bundle;\n        \n        if ('ScalableInputControlsBundle' !== MERGED_BUNDLES_NAME) {\n            store['ScalableInputControlsBundle'] = store['ScalableInputControlsBundle'] || {};\n            bundle = store['ScalableInputControlsBundle'];\n        } else {\n            bundle = Object.keys(store).reduce((acc, key) => {\n                return {\n                    ...acc,\n                    ...store[key]\n                }\n            }, {});\n        }\n                                     \n        export default bundle;\n    ","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n* @author Sergey Prilukin\n* @version: $Id: SingleSelect.js 2411 2016-03-14 18:03:07Z psavushc $\n*/\n\n/**\n* Single select component which supports view port, and filtering via search.\n*/\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport KeyboardManager from '../manager/KeyboardManager';\nimport SingleSelectList from './SingleSelectList';\nimport SingleSelectListModel from '../model/SingleSelectListModel';\nimport SearcheableDataProvider from '../dataprovider/SearcheableDataProvider';\nimport DropDownManager from '../manager/DropDownManager';\nimport singleSelectTemplate from '../templates/singleSelectTemplate.htm';\nimport singleSelectTemplate_IE10_11 from '../templates/singleSelectTemplate_IE10_11.htm';\nimport singleSelectListTemplate from '../templates/listTemplate.htm';\nimport singleSelectItemsTemplate from '../templates/itemsTemplate.htm';\nimport dropDownTemplate from '../templates/dropDownTemplate.htm';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\nimport browserDetection from '../../../common/util/browserDetection';\nimport xssUtil from '../../../common/util/xssUtil';\n\nvar $body = $(\"body\");\n\nvar SingleSelect = Backbone.View.extend({\n\n    events: function() {\n        return {\n            \"keydown\": this.keyboardManager.onKeydown,\n            \"input\": this.keyboardManager.onKeydown,\n            \"focus input\": \"onFocus\",\n            \"blur input\": \"onBlur\",\n            \"mousedown\": \"onMousedown\",\n            \"mouseup\": \"onMouseup\",\n            \"click .jr-mSingleselect-input\": \"onClickOnInput\"\n        };\n    },\n\n    initialize: function(options) {\n        _.bindAll(this, \"onGlobalMouseup\", \"onGlobalMousedown\",\n            \"onGlobalMousemove\", \"onMousedown\", \"calcOffsetForListView\", \"collapse\");\n\n        if (!this.model) {\n            this.model = new Backbone.Model();\n        }\n\n        this.model.set(\"expanded\", false, {silent: true});\n        this.model.set(\"criteria\", \"\", {silent: true});\n        this.model.set(\"value\", {}, {silent: true});\n\n        let template = singleSelectTemplate;\n\n        // THIS IS A HACK TO COMPENSATE FOR AN IE10 and IE11 BUGS:\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/274987/\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/101220/\n        if (browserDetection.isIE10() || browserDetection.isIE11()) {\n            template = singleSelectTemplate_IE10_11;\n        }\n\n        this.dropUpDirection = false;\n        this.label = options.label;\n        this.template = _.template(options.template || template);\n        this.dropDownTemplate = _.template(options.dropDownTemplate || dropDownTemplate);\n\n        this.keyboardManager = new KeyboardManager({\n            keydownTimeout: options.keydownTimeout,\n            context: this,\n            deferredKeydownHandler: this.processKeydown,\n            immediateHandleCondition: this.immediateHandleCondition,\n            immediateKeydownHandler: this.immediateKeydownHandler,\n            stopPropagation: true\n        });\n\n        //Initialize internal list view model\n        this.listViewModel = this._createListViewModel(options);\n\n        //initialize list view\n        this.listView = this._createListView(options);\n\n        this.render();\n\n        this.dropDownManager = new DropDownManager({\n            dropDownEl: this.$dropDownElContainer,\n            calcOffset: this.calcOffsetForListView,\n            isOffsetChanged: this.isDimensionsChangedForListView,\n            onOffsetChanged: this.collapse\n        });\n\n        this.initListeners();\n        this.setValue(options.value, {\n            modelOptions: {silent: true}\n        });\n    },\n\n    _createListView: function(options) {\n        return new SingleSelectList({\n            el: options.listElement || $(singleSelectListTemplate),\n            model: this.listViewModel,\n            chunksTemplate: options.chunksTemplate,\n            itemsTemplate: options.itemsTemplate || singleSelectItemsTemplate,\n            scrollTimeout: options.scrollTimeout\n        });\n    },\n\n    _createListViewModel: function(options) {\n        this.searcheableDataProvider = new SearcheableDataProvider({getData: options.getData});\n\n        return new SingleSelectListModel({\n            getData: this._getGetData(),\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor\n        });\n    },\n\n    _getGetData: function() {\n        return this.searcheableDataProvider.getData;\n    },\n\n    _getActiveValueIndex: function(active) {\n        var indexMapping = this.searcheableDataProvider.getIndexMapping();\n        return indexMapping ? indexMapping[active.index] : active.index;\n    },\n\n    /*\n     Bind event listeners\n     */\n    initListeners: function() {\n        this.listenTo(this.listView, \"selection:change\", this.selectionChange, this);\n        this.listenTo(this.listView, \"item:mouseup\", this.itemMouseup, this);\n        this.listenTo(this.listView, \"listRenderError\", this.listRenderError, this);\n        this.listenTo(this.model, \"change:expanded\", this.changeExpandedState, this);\n        this.listenTo(this.model, \"change:value\", this.changeValue, this);\n        this.listenTo(this.model, \"change:disabled\", this.changeDisabled, this);\n        this.listenTo(this.model, \"change:criteria\", this.changeFilter, this);\n\n        this.$dropDownEl.on(\"mousedown\", this.onMousedown);\n\n        $body.on(\"mousedown\", this.onGlobalMousedown)\n            .on(\"dataavailable\", this.onGlobalMousedown) /* hack to handle prototype custom events */\n            .on(\"mouseup\", this.onGlobalMouseup)\n            .on(\"mousemove\", this.onGlobalMousemove);\n    },\n\n    render: function() {\n\n        var singleSelect = $(this.template({\n            label: this.label,\n            isIPad: browserDetection.isIPad(),\n            value: this.model.get(\"value\").label,\n            expanded: this.model.get(\"expanded\"),\n            i18n: i18n\n        }));\n\n        this.renderListView();\n\n        this.$el.empty();\n        this.$el.append(singleSelect);\n\n        this.$singleSelect = singleSelect;\n        this.$searchBlock = this.$el.find(\".jr-mSingleselect-search\");\n        this.$inputBlock = this.$el.find(\".jr-mSingleselect-input\");\n        this.$input = this.$searchBlock.find(\"input\");\n\n        return this;\n    },\n\n    renderListView: function() {\n        if (!this.listRendered) {\n            this.$dropDownElContainer = $(this.dropDownTemplate(\n                {isIPad: navigator.platform === \"iPad\"}\n            ));\n            this.$dropDownEl = this.$dropDownElContainer.find(\".jr-mSingleselect-dropdown\");\n\n            this.listView.undelegateEvents();\n            this.$dropDownEl.append(this.listView.$el);\n            $body.append(this.$dropDownElContainer);\n            this.listView.delegateEvents();\n\n            this.listRendered = true;\n        }\n\n        this.$scalablelist = this.$dropDownElContainer.find(\".jr-mScalablelist\");\n\n        this.model.get(\"expanded\")\n            ? this.$dropDownElContainer.show()\n            : this.$dropDownElContainer.hide();\n    },\n\n    renderData: function() {\n        this.listView.renderData();\n        return this;\n    },\n\n    /* Event handlers */\n    listRenderError: function(responseStatus, error) {\n        this.trigger(\"listRenderError\", responseStatus, error);\n    },\n\n    itemMouseup: function() {\n        if (this.model.get(\"disabled\")) {\n            return;\n        }\n\n        //Remove flag to allow blur\n        delete this.preventBlur;\n\n        //Preserve focus\n        this.$input.focus();\n\n        var activeValue = this.model.get(\"activeValue\");\n\n        if (activeValue.value !== this.model.get(\"value\").value) {\n            this.model.unset(\"activeValue\");\n            this.model.set(\"value\", activeValue);\n        } else {\n            this.collapse();\n        }\n    },\n\n    selectionChange: function() {\n        var active = this.listView.getActiveValue();\n\n        if (active) {\n            this.listView.scrollTo(active.index);\n\n            this.model.set(\"activeValue\", {\n                value: active.value,\n                label: active.label,\n                index: this._getActiveValueIndex(active)\n            });\n\n            this.updateValueFromActive();\n        } else {\n            this.model.unset(\"activeValue\");\n        }\n    },\n\n    onClickOnInput: function() {\n        this.model.get(\"expanded\") ? this.collapse() : this.expand();\n    },\n\n    onFocus: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.$inputBlock.addClass(\"jr-isFocused\")\n        }\n    },\n\n    onBlur: function() {\n        if (!this.preventBlur) {\n            this.collapse();\n\n            this.$inputBlock.removeClass(\"jr-isFocused\");\n        }\n    },\n\n    onMousedown: function() {\n        this.preventBlur = true;\n    },\n\n    onMouseup: function() {\n        if (this.preventBlur) {\n            delete this.preventBlur;\n\n            if (this.model.get(\"expanded\")) {\n                this.$input.focus();\n            }\n        }\n    },\n\n    changeExpandedState: function(model) {\n        if (model.get(\"expanded\")) {\n            this.doExpand();\n        } else {\n            this.doCollapse();\n        }\n    },\n\n    changeValue: function() {\n        this.collapse();\n        this.updateControlLabel();\n\n        if (!this.silent) {\n            this.trigger(\"selection:change\", this.model.get(\"value\").value);\n        } else {\n            delete this.silent;\n        }\n\n        this.$input.val(\"\");\n        this.model.set(\"criteria\", \"\");\n    },\n\n    changeDisabled: function() {\n        var disabled = this.model.get(\"disabled\");\n\n        if (disabled) {\n            this.$input.attr(\"disabled\", \"disabled\");\n            this.collapse();\n        } else {\n            this.$input.removeAttr(\"disabled\");\n        }\n\n        this.listView.setDisabled(disabled);\n    },\n\n    onGlobalMousedown: function(event) {\n        if (this.model.get(\"expanded\")) {\n            if (event.target === this.el || this.$el.find(event.target).length > 0 ||\n                event.target === this.$dropDownEl[0] || this.$dropDownEl.find(event.target).length > 0) {\n                //Do not collapse if mousedown performed on this component\n                this.$input.focus();\n                return;\n            }\n\n            this.preventBlur = false;\n        }\n        this.onBlur();\n    },\n\n    onGlobalMouseup: function() {\n        this.onMouseup();\n    },\n\n    onGlobalMousemove: function(event) {\n        if (this.preventBlur) {\n            event.stopPropagation();\n        }\n    },\n\n    /* Key handlers for KeyboardManager */\n\n    onUpKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            var active = this.listView.getActiveValue();\n\n            if (!active || active.index === 0) {\n                this.collapse();\n                return;\n            } else {\n                this.listView.activatePrevious();\n            }\n        }\n    },\n\n    onDownKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            var active = this.listView.getActiveValue();\n\n            if (active) {\n                this.listView.activateNext();\n            } else {\n                this.listView.activateFirst();\n            }\n        }\n    },\n\n    onEnterKey: function(event) {\n        event.preventDefault();\n\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            if (this.model.get(\"activeValue\")) {\n                this.itemMouseup();\n            } else {\n                this.collapse();\n            }\n        }\n    },\n\n    onEscKey: function() {\n        if (this.model.get(\"expanded\")) {\n            this.collapse();\n        }\n    },\n\n    onHomeKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.activateFirst();\n        }\n    },\n\n    onEndKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.activateLast();\n        }\n    },\n\n    onPageUpKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.pageUp();\n        }\n    },\n\n    onPageDownKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.pageDown();\n        }\n    },\n\n    onTabKey: function() {\n        /* do nothing */\n    },\n\n    /* Internal helper methods */\n\n    updateDropDirection: function() {\n        // calc max height up and down\n        var scrollHeight = $(\"html\").scrollTop();\n        var offset = this.$el.offset();\n        var elHeight = this.$el.height();\n        var searchBlockHeight = this.$searchBlock.outerHeight();\n\n        var topHeight = offset.top - scrollHeight;\n        var bottomHeight = $(window).height() - topHeight - elHeight;\n\n        this.dropUpDirection = topHeight > bottomHeight;\n\n        // set list max height\n        var maxSize = this.dropUpDirection ? topHeight : (bottomHeight);\n        maxSize -= searchBlockHeight + elHeight;\n\n        this.$scalablelist.css(\"max-height\", (maxSize) + \"px\");\n    },\n\n    doExpand: function() {\n        this.updateDropDirection();\n\n        if (this.dropUpDirection) {\n            this.$dropDownEl.addClass(\"jr-mSingleselect-dropdownTop\");\n            this.$singleSelect.addClass(\"jr-mSingleselectTop\");\n        }\n\n        this.$searchBlock.addClass(\"jr-isOpen\");\n        this.$inputBlock.addClass(\"jr-isOpen\");\n        this.$inputBlock.removeClass(\"jr-isFocused\");\n        this.$input.focus();\n\n        this.listView.onScroll();\n        this.expandListView();\n\n        if (this.listView.lazy) {\n            this.listView.fetch(_.bind(this.listView.resize, this.listView));\n        } else {\n            this.listView.resize();\n        }\n\n        if (typeof this.model.get(\"value\").value !== \"undefined\") {\n            this.setValueToList();\n        }\n\n        this.trigger(\"expand\", this);\n    },\n\n    expandListView: function() {\n        this.$dropDownElContainer.show();\n        this.dropDownManager.startCalc();\n    },\n\n    doCollapse: function() {\n        this.model.unset(\"activeValue\");\n        this.$searchBlock.removeClass(\"jr-isOpen\");\n        this.$inputBlock.removeClass(\"jr-isOpen\");\n\n        this.$dropDownEl.removeClass(\"jr-mSingleselect-dropdownTop\");\n        this.$singleSelect.removeClass(\"jr-mSingleselectTop\");\n\n        this.$inputBlock.addClass(\"jr-isFocused\");\n        this.$input.val(\"\");\n        this.$dropDownElContainer.hide();\n        this.model.set(\"criteria\", \"\");\n        this.dropDownManager.stopCalc();\n        this.trigger(\"collapse\", this);\n    },\n\n    calcOffsetForListView: function() {\n        var top;\n        var offset = this.$el.offset();\n        var left = $body.offset().left + offset.left;\n        var elHeight = this.$el.height();\n\n        if (this.dropUpDirection) {\n            top = $body.offset().top + offset.top  - this.$searchBlock.outerHeight();\n        } else {\n            top = $body.offset().top + offset.top + elHeight + this.$searchBlock.height();\n        }\n\n\n        return {\n            top: top,\n            left: left,\n            width: this.el.getBoundingClientRect().width\n        }\n    },\n\n    isDimensionsChangedForListView: function(currentDimensions, newDimensions) {\n        // we allow some slight change in dimensions which we don't notice as a change\n        const threshold = 2;\n        return (Math.abs(currentDimensions.top - newDimensions.top) > threshold\n            || Math.abs(currentDimensions.left - newDimensions.left) > threshold);\n    },\n\n    immediateHandleCondition: function(event) {\n        return !this.model.get(\"expanded\");\n    },\n\n    immediateKeydownHandler: function(event) {\n        this.expand();\n        this.keyboardManager.deferredHandleKeyboardEvent(event);\n    },\n\n    processKeydown: function() {\n        this.model.set(\"criteria\", this.$input.val());\n    },\n\n    changeFilter: function() {\n        var that = this;\n        this._getGetData()({criteria: this.model.get(\"criteria\")}).done(function() {\n            that.listView.fetch(function () {\n                that.setValueToList();\n            });\n        });\n    },\n\n    setValueToList: function(options) {\n        var value = this.model.get(\"value\");\n\n        var selection = value.value;\n\n        if (typeof value.index !== \"undefined\") {\n            var indexMapping = this.searcheableDataProvider.getReverseIndexMapping();\n\n            var index = (indexMapping ? indexMapping[value.index] : value.index);\n            selection = {};\n\n            if (typeof index !== \"undefined\") {\n                selection[index] = value.value;\n            }\n        }\n\n        this.listView.setValue(selection, options);\n    },\n\n    //value is external usual value: either string, or array of strings or object\n    convertExternalValueToInternalFormat: function(value) {\n        var internalValue = {};\n\n        if (typeof value !== \"undefined\") {\n            if (typeof value === \"string\" || value === null) {\n                internalValue = {value: value};\n            } else {\n                for (var index in value) {\n                    if (value.hasOwnProperty(index) && value[index] !== undefined) {\n\n                        if (typeof value[index] === 'object') {\n                            internalValue = {\n                                value: value[index].value,\n                                index: parseInt(index, 10),\n                                label: value[index].label\n                            };\n                        } else {\n                            internalValue = {\n                                value: value[index],\n                                index: parseInt(index, 10)\n                            };\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n\n        return internalValue;\n    },\n\n    updateValueFromActive: function() {\n        var value = this.model.get(\"value\");\n        var activeValue = this.model.get(\"activeValue\");\n\n        if (value.value === activeValue.value && typeof value.label === \"undefined\") {\n            value.label = activeValue.label;\n            this.updateControlLabel();\n        }\n    },\n\n    updateControlLabel: function() {\n        var value = this.model.get(\"value\");\n        var $inputBlockPlaceholder = this.$inputBlock.find(\".jr-mSingleselect-input-placeholder\");\n        var $inputBlockSelection = this.$inputBlock.find(\".jr-mSingleselect-input-selection\");\n        var label;\n\n        if (_.isEmpty(value) || value.value == null){\n            $inputBlockPlaceholder.removeClass(\"jr-isHidden\");\n            this.render();\n        } else {\n            label = this.getControlLabelByValue(value);\n            $inputBlockPlaceholder.addClass(\"jr-isHidden\");\n            this.$inputBlock.attr(\"title\", label);\n            $inputBlockSelection.html(xssUtil.hardEscape(label));\n        }\n    },\n\n    getControlLabelByValue: function (value) {\n        return value.label == null\n            ? value.value\n            : value.label;\n    },\n\n    /* API */\n\n    fetch: function(callback, options) {\n        this.listView.fetch(callback, options);\n        return this;\n    },\n\n    reset: function(options) {\n        this.listView.reset(options);\n        return this;\n    },\n\n    expand: function() {\n        if (this.model.get(\"disabled\")) {\n            return;\n        }\n\n        this.model.set(\"expanded\", true);\n        return this;\n    },\n\n    collapse: function() {\n        this.model.set(\"expanded\", false);\n        return this;\n    },\n\n    getValue: function() {\n        return this.model.get(\"value\").value;\n    },\n\n    setValue: function(value, options) {\n        value = this.convertExternalValueToInternalFormat(value);\n\n        if (options && options.silent) {\n            this.silent = true;\n        }\n\n        this.model.set(\"value\", value);\n        this.setValueToList();\n    },\n\n    setDisabled: function(disabled) {\n        this.model.set(\"disabled\", disabled);\n        return this;\n    },\n\n    getDisabled: function() {\n        return this.model.get(\"disabled\");\n    },\n\n    remove: function() {\n        this.$dropDownEl.off(\"mousedown\", this.onMousedown).remove();\n        this.listView.remove();\n        this.$dropDownElContainer.remove();\n        Backbone.View.prototype.remove.call(this);\n        $body.off(\"mousedown\", this.onGlobalMousedown)\n            .off(\"dataavailable\", this.onGlobalMousedown)\n            .off(\"mouseup\", this.onGlobalMouseup)\n            .off(\"mousemove\", this.onGlobalMousemove);\n    }\n});\n\nexport default SingleSelect;\n","export default \"<div class=\\\"jr-mSingleselect jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <a class=\\\"jr-mSingleselect-input jr\\\">\\n        <span class=\\\"jr-mSingleselect-input-placeholder jr\\\">{{- i18n['sic.singleselect.select.one'] }}</span>\\n        <span class=\\\"jr-mSingleselect-input-selection jr\\\">{{- value}}</span>\\n        <div class=\\\"jr-mSingleselect-input-expander jr\\\"></div>\\n    </a>\\n    <div class=\\\"jr-mSingleselect-search jr\\\">\\n        <input type=\\\"text\\\" placeholder=\\\"{{- i18n['sic.multiselect.search'] }}\\\" class=\\\"jr-mInput-search jr\\\" value=\\\"{{- value}}\\\">\\n    </div>\\n</div>\\n\";","export default \"<div class=\\\"jr-mSingleselect jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <a class=\\\"jr-mSingleselect-input jr\\\">\\n        <span class=\\\"jr-mSingleselect-input-placeholder jr\\\">Click to select item...</span>\\n        <span class=\\\"jr-mSingleselect-input-selection jr\\\">{{- value}}</span>\\n        <div class=\\\"jr-mSingleselect-input-expander jr\\\"></div>\\n    </a>\\n    <div class=\\\"jr-mSingleselect-search jr\\\">\\n        <input type=\\\"text\\\" class=\\\"jr-mInput-search jr\\\" value=\\\"{{- value}}\\\">\\n    </div>\\n</div>\\n\";","export default \"<div class=\\\"jr-mSingleselect-dropdownContainer jr\\\">\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"jr-mSingleselect-dropdown jr\\\"></div>\\n</div>\\n\";","export default \"<div class=\\\"jr-mScalablelist jr\\\" draggable=\\\"false\\\" ondragstart=\\\"return false\\\" unselectable=\\\"on\\\" onselectstart=\\\"return false\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\";","export default \"<ul class=\\\"jr-mSelectlist jr\\\" style=\\\"top: {{- top}}px;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{_.each(items, function(item) { }}\\n    <li class=\\\"jr-mSelectlist-item {{ if (item.selected) print('jr-isSelected'); }} jr\\\" title=\\\"{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}\\\" data-index=\\\"{{- item.index}}\\\">\\n        <div class=\\\"jr-mSelectlist-item-wrapper jr\\\">\\n            <a class=\\\"jr-mSelectlist-item-text jr\\\">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}</a>\\n        </div>\\n    </li>\\n    {{ }); }}\\n</ul>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport BaseListWithSelectionModel from './BaseListWithSelectionModel';\nvar ListWithSelectionAsObjectHashModel = BaseListWithSelectionModel.extend({\n    _addToSelection: function (value, index) {\n        this.selection[value] = true;\n    },\n    _removeFromSelection: function (value, index) {\n        delete this.selection[value];\n    },\n    _clearSelection: function () {\n        this.selection = {};\n    },\n    _selectionContains: function (value, index) {\n        return this.selection[value];\n    },\n    _getSelection: function () {\n        return _.keys(this.selection);\n    },\n    select: function (selection, options) {\n        this._clearSelection();\n        if (typeof selection === 'string') {\n            this._addToSelection(selection);\n        } else if (_.isArray(selection)) {\n            for (var i = 0; i < selection.length; i++) {\n                this._addToSelection(selection[i]);\n            }\n        } else if (typeof selection !== 'undefined') {\n            for (var key in selection) {\n                if (selection.hasOwnProperty(key)) {\n                    var value = selection[key];\n                    if (value !== undefined) {\n                        this._addToSelection(value, key);\n                    }\n                }\n            }\n        }\n        this._afterSelect && this._afterSelect(selection, options);\n        this._triggerSelectionChange(options);\n    }\n});\nexport default ListWithSelectionAsObjectHashModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport SingleSelectListModel from './SingleSelectListModel';\nimport ListWithSelectionAsObjectHashModel from '../../scalableList/model/ListWithSelectionAsObjectHashModel';\nvar listPrototype = ListWithSelectionAsObjectHashModel.prototype;\nvar SingleSelectListModelNew = SingleSelectListModel.extend({\n    _addToSelection: listPrototype._addToSelection,\n    _removeFromSelection: listPrototype._removeFromSelection,\n    _clearSelection: listPrototype._clearSelection,\n    _selectionContains: listPrototype._selectionContains,\n    _getSelection: listPrototype._getSelection,\n    _calcSelectionStartIndex: undefined,\n    _select: listPrototype.select\n});\nexport default SingleSelectListModelNew;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nimport SingleSelect from './SingleSelect';\nimport SingleSelectListModelNew from '../model/SingleSelectListModelNew';\nfunction afterSelect(getSelectionIndex, selection) {\n    if (selection && typeof selection === 'string') {\n        if (!this.getActive()) {\n            var index = getSelectionIndex(selection);\n            if (typeof index !== 'undefined') {\n                listWithNavigationModelTrait.setActive.call(this, {\n                    index: index,\n                    item: { value: selection },\n                    silent: true\n                });\n            }\n        }\n    }\n}\nvar SingleSelectNew = SingleSelect.extend({\n    initialize: function (options) {\n        _.bindAll(this, '_getSelectionIndex');\n        this.formatValue = options.formatValue;\n        SingleSelect.prototype.initialize.call(this, options);\n    },\n    _createListViewModel: function (options) {\n        this.getData = options.getData;\n        return options.model || _.extend(new SingleSelectListModelNew(options), { _afterSelect: _.partial(afterSelect, this._getSelectionIndex) });\n    },\n    _getSelectionIndex: function (selection) {\n        var bufferStartIndex = this.listViewModel.get('bufferStartIndex');\n        var items = this.listViewModel.get('items');\n        for (var i = 0; i < items.length; i++) {\n            if (selection === items[i].value) {\n                return bufferStartIndex + i;\n            }\n        }\n        return undefined;\n    },\n    _getGetData: function () {\n        return this.getData;\n    },\n    _getActiveValueIndex: function (active) {\n        return this._getSelectionIndex(active.value);\n    },\n    changeFilter: function () {\n        var self = this;\n        var criteria = this.model.get('criteria');\n        this.listView.scrollTo(0);\n        this._getGetData()({\n            criteria: criteria,\n            offset: 0,\n            limit: 1\n        }).done(function () {\n            self.listView.fetch(function () {\n                self.listView.resize();\n                self.setValueToList();\n            });\n        });\n    },\n    getControlLabelByValue: function (value) {\n        return value.label == null ? this.formatValue ? this.formatValue(value.value) : value.value : value.label;\n    },\n    setValue: function (value, options) {\n        value = this.convertExternalValueToInternalFormat(value);\n        if (options && options.silent) {\n            this.silent = true;\n        }\n        this.model.set('value', value);\n        this.setValueToList(options);\n        if(this.silent) {\n            delete this.silent;\n        }\n    },\n    setValueToList: function (options) {\n        var selection = this.model.get('value'), value = {};\n        if (selection && selection.index) {\n            value[selection.index] = selection.value;\n        } else if (selection) {\n            value = selection.value;\n        }\n        this.listView.setValue(value, options);\n    }\n});\nexport default SingleSelectNew;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport $ from 'jquery';\nexport default {\n    doCalcOnVisibleNodeClone: function (options) {\n        if (!options || !options.el) {\n            throw 'Missing required option: el';\n        }\n        _.defaults(options, {\n            css: {},\n            classes: '',\n            container: '<div></div>',\n            appendTo: 'body',\n            callback: function () {\n                throw 'no callback was defined';\n            },\n            alwaysClone: false,\n            cloneHandlers: false\n        });\n        _.defaults(options.css, {\n            'position': 'absolute',\n            'left': '-9999px'\n        });\n        if (!options.alwaysClone && $(options.el).is(':visible')) {\n            options.callback($(options.el));\n        } else {\n            var $el = $(options.el).clone();\n            var $tmp = $(options.container).css(options.css).addClass(options.classes).appendTo($(options.appendTo)).append($el);\n            options.callback($el);\n            $tmp.remove();\n        }\n    }\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport ScalableListModel from '../../scalableList/model/ScalableListModel';\nimport browserDetection from '../../../common/util/browserDetection';\nimport doCalcOnVisibleNodeClone from '../../scalableList/util/domAndCssUtil';\n\nlet doCalcOnVisibleNodeCloneObject = doCalcOnVisibleNodeClone.doCalcOnVisibleNodeClone;\n\nvar scalableListItemHeightCalculationTrait = {\n    render: function () {\n        if (!this._itemHeightSet) {\n            this._calcItemHeight();\n            this._itemHeightSet = true;\n        }\n        return this;\n    },\n    _calcItemHeight: function () {\n        var self = this;\n        this._model = this.model;\n        this._lazy = this.lazy;\n        this._visibility = this.$el.css('visibility');\n        this._display = this.$el.css('display');\n        this.model = new ScalableListModel({\n            getData: function () {\n                var deferred = new $.Deferred();\n                deferred.resolve({\n                    total: 1,\n                    data: [{\n                        value: 'test value',\n                        label: 'test label'\n                    }]\n                });\n                return deferred;\n            }\n        });\n        this.$el.css({\n            'visibility': 'hidden',\n            'display': 'block'\n        });\n        this.model.once('change', this.onModelChange, this);\n        this.renderData();\n        doCalcOnVisibleNodeCloneObject({\n            el: this.$el,\n            css: { 'width': '100px' },\n            classes: ' jr ' + (browserDetection.isIPad() ? 'ipad' : ''),\n            callback: function ($el) {\n                self.itemHeight = $el.find('li').outerHeight(true);\n                self.itemsPerChunk = Math.floor(self.defaultChunkHeight / self.itemHeight);\n                self.chunkHeight = self.itemsPerChunk * self.itemHeight;\n            }\n        });\n        this.$el.empty().css({\n            'visibility': this._visibility,\n            'display': this._display\n        });\n        delete this._visibility;\n        delete this._display;\n        this.totalItems = undefined;\n        this.$firstViewChunk = undefined;\n        this.model = this._model;\n        delete this._model;\n        this.lazy = this._lazy;\n        this._lazy && delete this._lazy;\n    },\n    _calcViewPortConstants: function () {\n        if (!this.viewPortConstantsInitialized) {\n            if (!this._itemHeightSet) {\n                return;\n            }\n            this._calcViewPortHeight();\n            this._renderViewChunks(true);\n            this._renderItems();\n            this.viewPortConstantsInitialized = true;\n        }\n    }\n};\nexport default scalableListItemHeightCalculationTrait;","export default \"<div class=\\\"jr-mScalablelist jr j-scalable-list\\\" onselectstart=\\\"return false\\\" unselectable=\\\"on\\\" ondragstart=\\\"return false\\\" draggable=\\\"false\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author Sergey Prilukin; modified by Ken Penn\n * @version: $Id: AvailableItemsList.js 812 2015-01-27 11:01:30Z psavushchik $\n */\n\n/**\n * AvailableItems list -  Part of Tabbed MultiSelect\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport browserDetection from '../../../common/util/browserDetection';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\n\nimport KeyboardManager from '../../singleSelect/manager/KeyboardManager';\nimport ListWithNavigation from '../../scalableList/view/ListWithNavigation';\n\nimport doCalcOnVisibleNodeClone from '../../scalableList/util/domAndCssUtil';\n\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nimport ListWithSelectionAsObjectHashModel from '../../scalableList/model/ListWithSelectionAsObjectHashModel';\nimport scalableListItemHeightCalculationTrait from '../mixin/scalableListItemHeightCalculationTrait';\nimport availableItemsTabTemplate from '../templates/availableItemsTemplate.htm';\nimport availableItemsTabTemplate_IE10_11 from '../templates/availableItemsTemplate_IE10_11.htm';\nimport listTemplate from '../templates/listTemplate.htm';\n\nlet doCalcOnVisibleNodeCloneObject = doCalcOnVisibleNodeClone.doCalcOnVisibleNodeClone;\n\nvar BUTTON_TESTS = [\n    {\n        selector: \".jr-jSelectAll\",\n        strings: [\n            i18n[\"sic.multiselect.selectAll\"],\n            i18n[\"sic.multiselect.all\"],\n            \"\"\n        ]\n    },\n    {\n        selector: \".jr-jSelectNone\",\n        strings: [\n            i18n[\"sic.multiselect.deselectAll\"],\n            i18n[\"sic.multiselect.none\"],\n            \"\"\n        ]\n    },\n    {\n        selector: \".jr-jInvert\",\n        strings: [\n            i18n[\"sic.multiselect.inverse\"],\n            \"\"\n        ]\n    }\n];\n\nvar AvailableItemsList = Backbone.View.extend({\n\n    className: \"jr-mMultiselect-listContainer jr-isActive jr\",\n\n    events: function() {\n        return {\n            \"keydown input.jr-mInput-search\": this.keyboardManager.onKeydown,\n            \"focus input.jr-mInput-search\": \"onFocus\",\n            \"blur input.jr-mInput-search\": \"onBlur\",\n            \"click .jr-jSelectAll\": \"onSelectAll\",\n            \"click .jr-jSelectNone\": \"onSelectNone\",\n            \"click .jr-jInvert\": \"onInvertSelection\",\n            \"click input.jr-mInput-search\": \"onClickOnInput\",\n            \"touchend input.jr-mInput-search\": \"onClickOnInput\",\n            \"mousedown\": \"onMousedown\",\n            \"mouseup\": \"onMouseup\"\n        };\n    },\n\n    keydownHandlers: _.extend({\n        \"65\": \"onAKey\"\n    }, KeyboardManager.prototype.keydownHandlers),\n\n    initialize: function(options) {\n        _.bindAll(this, \"onGlobalMouseup\", \"onGlobalMousedown\", \"onResize\", \"onGlobalMousemove\",\n            \"onMousedown\", \"onMouseup\", \"onEscKey\", \"onSelectAll\", \"onSelectNone\",\n            \"onInvertSelection\");\n\n        this._debouncedOnResize = _.debounce(this.onResize, 500);\n\n        if (!this.model) {\n            this.model = new Backbone.Model();\n        }\n\n        this.model.set(\"criteria\", \"\", {silent: true});\n\n        // THIS IS A HACK TO COMPENSATE FOR AN IE10 and IE11 BUGS:\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/274987/\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/101220/\n        let template;\n\n        if (browserDetection.isIE10() || browserDetection.isIE11()) {\n            template = availableItemsTabTemplate_IE10_11;\n        } else {\n            template = availableItemsTabTemplate;\n        }\n\n        this.label = options.label;\n        this.template = _.template(options.availableItemsTemplate || template);\n\n        this.keyboardManager = new KeyboardManager({\n            keydownHandlers: this.keydownHandlers,\n            keydownTimeout: options.keydownTimeout,\n            context: this,\n            deferredKeydownHandler: this.processKeydown,\n            immediateHandleCondition: this.immediateHandleCondition,\n            immediateKeydownHandler: this.immediateKeydownHandler,\n            stopPropagation: true\n        });\n\n        this.listViewModel = this._createListViewModel(options);\n\n        this.setValue(options.value, {silent: true});\n\n        this.listView = this._createListView(options);\n\n        this.render();\n\n        this.initListeners();\n    },\n\n    _createListViewModel: function(options) {\n        this.getData = options.getData;\n\n        var Model = ListWithSelectionAsObjectHashModel.extend(listWithNavigationModelTrait);\n        return options.listViewModel || new Model({\n            getData: options.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor\n        });\n    },\n\n    _createListView: function(options) {\n        var list = options.listView || new ListWithNavigation({\n            el: options.listElement || $(listTemplate),\n            model: this.listViewModel,\n            chunksTemplate: options.chunksTemplate,\n            itemsTemplate: options.itemsTemplate,\n            scrollTimeout: options.scrollTimeout,\n            lazy: true,\n            selectedClass: \"jr-isSelected\",\n            selection: {\n                allowed: true,\n                multiple: true\n            }\n        });\n\n        _.extend(list, scalableListItemHeightCalculationTrait);\n\n        return list;\n    },\n\n    initListeners: function() {\n        this.listenTo(this.listView, \"active:changed\", this.activeChange, this);\n        this.listenTo(this.listView, \"mousedown\", this.onMousedown, this);\n        this.listenTo(this.listView, \"render:data\", this.onRenderData, this);\n        this.listenTo(this.listView, \"listRenderError\", this.listRenderError, this);\n        this.listenTo(this.listViewModel, \"change\", this.onListViewModelChanged, this);\n        this.listenTo(this.listViewModel, \"selection:clear\", this.selectionClear, this);\n        this.listenTo(this.listViewModel, \"selection:add\", this.selectionAdd, this);\n        this.listenTo(this.listViewModel, \"selection:addRange\", this.selectionAddRange, this);\n        this.listenTo(this.listViewModel, \"selection:remove\", this.selectionRemove, this);\n\n        this.listenTo(this.model, \"change:totalValue\", this.onChangeTotalValue, this);\n        this.listenTo(this.model, \"change:value\", this.changeValue, this);\n        this.listenTo(this.model, \"change:disabled\", this.changeDisabled, this);\n        this.listenTo(this.model, \"change:criteria\", this.changeFilter, this);\n\n        $(\"body\").on(\"mousedown\", this.onGlobalMousedown)\n            .on(\"mouseup\", this.onGlobalMouseup)\n            .on(\"mousemove\", this.onGlobalMousemove);\n\n        $(window).on(\"resize\", this._debouncedOnResize);\n    },\n\n    render: function() {\n\n        this.$el.empty();\n        this.$el.append($(this.template(this.getModelForRendering())));\n\n        this.listView.undelegateEvents();\n\n        this.$el.find('.jr-mMultiselect-list').append(this.listView.el);\n\n        this.listView.render();\n\n        this.listView.fetch(_.bind(this.listView.resize, this.listView));\n\n        this.listView.delegateEvents();\n\n        this._tuneCSS();\n\n        this.setBulkSelectionText();\n\n        return this;\n    },\n\n    _tuneCSS: function() {\n        var self = this;\n\n        // only need to do this once\n        if (!this._paddingHeightsSet) {\n\n            doCalcOnVisibleNodeCloneObject({\n                el: this.$el,\n                css: {\"width\": \"500px\"},\n                classes: \"jr \" + (browserDetection.isIPad() ? \"ipad\" : \"\"),\n                callback: function($el) {\n                    self.searchBarHeight = Math.round($el.find(\".jr-mMultiselect-search\").outerHeight());\n                    self.buttonsContainerHeight = Math.round($el.find(\".jr-mMultiselect-buttonContainer\").outerHeight());\n                }\n            });\n\n            this._paddingHeightsSet = true;\n        }\n\n        this.$el.find(\".jr-mMultiselect-list\").css({\n            \"height\": \"100%\",\n            \"padding-top\": this.searchBarHeight,\n            \"padding-bottom\": this.buttonsContainerHeight\n        });\n    },\n\n    renderData: function() {\n        this.listView.renderData();\n        return this;\n    },\n\n    /* Event Handlers */\n\n    activeChange: function(active) {\n        if (active) {\n            if (this.activeChangedWithShift) {\n                delete this.activeChangedWithShift;\n                this.listViewModel.addRangeToSelection(active.value, active.index);\n            }\n\n            this.listView.scrollTo(active.index);\n        }\n    },\n\n    selectionAdd: function(selection) {\n        this.model.get(\"value\")[selection.value] = true;\n        this.model.trigger(\"change:value\");\n    },\n\n    selectionAddRange: function(range) {\n        var selection = range.selection,\n            value     = this.model.get(\"value\"),\n            sx        = 0,\n            sLen      = selection.length;\n\n        for ( sx; sx < sLen; sx +=1 ) {\n            value[selection[sx]] = true;\n        }\n\n        this.model.trigger(\"change:value\");\n    },\n\n    selectionRemove: function(selection) {\n        delete this.model.get(\"value\")[selection.value];\n\n        this.model.trigger(\"change:value\");\n    },\n\n    selectionClear: function() {\n        this.model.attributes.value = {};\n    },\n\n    onSelectAll: function() {\n        if (!this.model.get(\"disabled\")) {\n            this.listView.once(\"selection:change\", this.processSelectionThroughApi, this);\n            this.clearFilter(_.bind(this.listView.selectAll, this.listView));\n        }\n    },\n\n    onSelectNone: function() {\n        if (!this.model.get(\"disabled\")) {\n            this.listView.once(\"selection:change\", this.processSelectionThroughApi, this);\n            this.clearFilter(_.bind(this.listView.selectNone, this.listView));\n        }\n    },\n\n    onInvertSelection: function() {\n        if (!this.model.get(\"disabled\")) {\n            this.listView.once(\"selection:change\", this.processSelectionThroughApi, this);\n            this.clearFilter(_.bind(this.listView.invertSelection, this.listView));\n        }\n    },\n\n    onRenderData: function() {\n        this.trigger(\"render:data\");\n    },\n\n    listRenderError: function(responseStatus, error) {\n        this.trigger(\"listRenderError\", responseStatus, error);\n    },\n\n    onListViewModelChanged: function() {\n        if (typeof this.model.get(\"totalValues\") == \"undefined\") {\n            var total = this.listViewModel.get(\"total\");\n\n            if (_.isNumber(total) && !_.isNaN(total)) {\n                this.model.set(\"totalValues\", total);\n            }\n        }\n    },\n\n    onChangeTotalValue: function() {\n        this.listView.resize();\n    },\n\n    setBulkSelectionText: function() {\n        if (!this.$el.is(\":visible\")) {\n            //We can not measure bulk buttons width\n            //so no text will be changed\n            return;\n        }\n\n        var componentWidth = this.$el.outerWidth();\n\n        if (componentWidth === this._componentWidth) {\n            //no need to check text since size was not changed since last check\n            return;\n        } else {\n            this._componentWidth = componentWidth;\n        }\n\n        var $bulkButtonsBar = this.$el.find(\".jr-mMultiselect-buttonContainer\"),\n            bulkButtonsBarWidth = $bulkButtonsBar.outerWidth(),\n            isAvailableTabInActive = this.$el.hasClass('jr-isInactive')\n\n        doCalcOnVisibleNodeCloneObject({\n            el: $bulkButtonsBar,\n            css: {\n                \"left\" : (0 - (bulkButtonsBarWidth * 2)) + \"px\",\n                \"width\" : bulkButtonsBarWidth + \"px\"\n            },\n            classes: \"jr \" + (browserDetection.isIPad() ? \"ipad\" : \"\"), //add additional classes to parent container of cloned node\n            alwaysClone: true,\n            callback: function($clone) {\n                _.each(BUTTON_TESTS, function(buttonTest) {\n                    var widthOk = false;\n\n                    _.each(buttonTest.strings, function(buttonString) {\n                        if (widthOk) {\n                            return;\n                        }\n\n                        var $button = $clone.find(buttonTest.selector),\n                            $buttonText = $button.find(\".jr-mItemselector-button-label span\")\n                                .text(buttonString),\n                            btnRight = $button[0].getBoundingClientRect().right,\n                            txtRight = $buttonText[0].getBoundingClientRect().right;\n\n                        if (btnRight - txtRight >= 3 || buttonString === \"\" || isAvailableTabInActive) {\n                            widthOk = true;\n                            $bulkButtonsBar.find(buttonTest.selector + \" .jr-mItemselector-button-label span\")\n                                .text(buttonString);\n                        }\n                    });\n                });\n            }\n        });\n    },\n\n    changeValue: function() {\n        this.trigger(\"selection:change\", this.getValue());\n    },\n\n    changeDisabled: function() {\n        var disabled = this.model.get(\"disabled\");\n\n        if (disabled) {\n            this.$el.find(\"input[type='text']\").attr(\"disabled\", \"disabled\");\n        } else {\n            this.$el.find(\"input[type='text']\").removeAttr(\"disabled\");\n        }\n\n        this.listView.setDisabled(disabled);\n    },\n\n    onClickOnInput: function() {\n        this.onFocus();\n    },\n\n    onFocus: function() {\n\n        //Workaround for input's HTML5 placeholder attribute\n        var input = this.$el.find(\"input\");\n        if (input.val() == input.attr('placeholder')) {\n            input.val('');\n            input.removeClass('jr-mMultiselect-input-placeholder');\n        }\n    },\n\n    onBlur: function() {\n        //Workaround for input's HTML5 placeholder attribute\n        var input = this.$el.find(\"input\");\n        if (input.val() === '' || input.val() === input.attr('placeholder')) {\n            input.addClass('jr-mMultiselect-input-placeholder');\n            input.val(input.attr('placeholder'));\n        }\n        // End of workaround\n\n        if (this.preventBlur) {\n            return false;\n        }\n    },\n\n    onMousedown: function() {\n        if (!browserDetection.isIPad()) {\n            this.preventBlur = true;\n        }\n    },\n\n    onMouseup: function() {\n        if (this.preventBlur) {\n            delete this.preventBlur;\n\n            this.$el.find(\"input.jr-mInput-search\").focus();\n        }\n    },\n\n    onGlobalMousedown: function(event) {\n        if (this.preventBlur) {\n            if (event.target !== this.el && this.$el.find(event.target).length === 0) {\n                delete this.preventBlur;\n                this.onBlur();\n            }\n        }\n    },\n\n    onGlobalMouseup: function() {\n        this.onMouseup();\n    },\n\n    onGlobalMousemove: function(event) {\n        if (this.preventBlur) {\n            event.stopPropagation();\n        }\n    },\n\n    onResize: function() {\n        this.resize();\n    },\n\n    /* Key handlers for KeyboardManager */\n\n    onUpKey: function(event) {\n        var self = this;\n\n        this._onUpDownNavigation(event, function() {\n            self.listView.activatePrevious();\n        }, function() {\n            self.listView.activateLast();\n        });\n    },\n\n    onDownKey: function(event) {\n        var self = this;\n\n        this._onUpDownNavigation(event, function() {\n            self.listView.activateNext();\n        }, function() {\n            self.listView.activateFirst();\n        });\n    },\n\n    _onUpDownNavigation: function(event, activateItem, resetToInitialActiveItem) {\n        var nextActive,\n            prevActive = this.listView.getActiveValue();\n\n        if (prevActive) {\n            if (event.shiftKey) {\n                this.activeChangedWithShift = true;\n            }\n\n            activateItem();\n\n            nextActive = this.listView.getActiveValue();\n\n            if (nextActive.index === prevActive.index) {\n                resetToInitialActiveItem();\n            }\n        } else {\n            resetToInitialActiveItem();\n        }\n    },\n\n    onEnterKey: function(event) {\n        event.preventDefault();\n\n        var active = this.listView.getActiveValue();\n        if (!active) {\n            return;\n        }\n\n        if (event.shiftKey) {\n            this.listViewModel.addRangeToSelection(active.value, active.index);\n        } else if (event.ctrlKey || event.metaKey) {\n            this.listViewModel.clearSelection();\n            this.listViewModel.addValueToSelection(active.value, active.index);\n        } else {\n            this.listViewModel.toggleSelection(active.value, active.index);\n        }\n    },\n\n    onEscKey: function() {\n        /* do nothing */\n    },\n\n    onHomeKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.activateFirst();\n    },\n\n    onEndKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.activateLast();\n    },\n\n    onPageUpKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.pageUp();\n    },\n\n    onPageDownKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.pageDown();\n    },\n\n    onTabKey: function() {\n        /* do nothing */\n    },\n\n    onAKey: function(event) {\n        if (!event.ctrlKey && !event.metaKey) {\n            this.keyboardManager.deferredHandleKeyboardEvent(event);\n        } else {\n            event.stopPropagation();\n            this.onSelectAll();\n        }\n    },\n\n    /* Internal helper methods */\n\n    processKeydown: function() {\n        this.model.set(\"criteria\", this.$el.find(\"input.jr-mInput-search\").val());\n    },\n\n    changeFilter: function(callback) {\n        var self = this,\n            criteria = this.model.get(\"criteria\");\n\n        if (typeof criteria == \"undefined\" || criteria === \"\") {\n            this.model.unset(\"totalValues\", {silent: true});\n        }\n\n        this.listView.scrollTo(0);\n        self.listView.activate(null, {silent: true}); //we have to drop active element before filter change\n\n        this.getData({\n            criteria: criteria,\n            offset: 0,\n            limit: this.listView.model.bufferSize\n        }).done(function () {\n            self.listViewModel.once(\"change\", callback && typeof callback === \"function\" ? callback : function() {\n                //need to set selected values again after change search criteria\n                self.listView.setValue(_.keys(self.model.get(\"value\")), {silent: true});\n                self.listView.activate(0);\n            });\n            self.listView.fetch();\n        });\n    },\n\n    clearFilter: function(callback) {\n        if (this.model.get(\"criteria\")) {\n            this.$el.find(\"input\").val(\"\");\n            this.model.set(\"criteria\", \"\", {silent: true});\n\n            this.changeFilter(callback);\n        } else {\n            this.model.unset(\"totalValues\", {silent: true});\n            callback && callback();\n        }\n    },\n\n    processSelectionThroughApi: function(selection, options) {\n        var value = {},\n            sx    = 0,\n            sLen  = selection.length;\n\n        this.selectionClear();\n\n        for (sx; sx < sLen; sx += 1) {\n            value[selection[sx]] = true;\n        }\n\n        this.model.attributes.value = value;\n        if (!options || !options.silent) {\n            this.model.trigger(\"change:value\");\n        }\n    },\n\n    convertSelectionForListViewModel: function(selection) {\n        return selection;\n    },\n\n    /* Internal methods */\n\n    getModelForRendering: function() {\n        return {\n            label: this.label,\n            isIPad: browserDetection.isIPad(),\n            disabled: this.model.get(\"disabled\"),\n            i18n: i18n\n        }\n    },\n\n    /* API */\n\n    fetch: function(callback, options) {\n        var criteria = this.model.get(\"criteria\");\n\n        if (typeof criteria === \"undefined\" || criteria === \"\") {\n            this.model.unset(\"totalValues\", {silent: true});\n        }\n\n        this.listView.fetch(callback, options);\n    },\n\n    resize: function() {\n        this.listView.resize();\n        this.setBulkSelectionText();\n    },\n\n    reset: function(options) {\n        var self = this;\n\n        this.clearFilter(function() {\n            self.listView.reset(options);\n        });\n    },\n\n    getValue: function() {\n        return _.keys(this.model.get(\"value\"));\n    },\n\n    setValue: function(value, options) {\n        options = options || {};\n\n        this.listViewModel.once(\"selection:change\", function () {\n            this.selectionClear();\n            var selection = this.listViewModel.getSelection(),\n                i = 0,\n                length = selection.length;\n\n            for (i; i < length; i++) {\n                this.model.attributes.value[selection[i]] = true;\n            }\n\n            if (!options || !options.silent) {\n                this.changeValue();\n            }\n        }, this);\n\n        if (!_.isArray(value) && typeof value !== \"string\") {\n            value = this.convertSelectionForListViewModel(value);\n        }\n\n        this.listViewModel.select(value, options.modelOptions);\n    },\n\n    setDisabled: function(disabled) {\n        this.model.set(\"disabled\", disabled);\n    },\n\n    getDisabled: function() {\n        return this.model.get(\"disabled\");\n    },\n\n    remove: function() {\n        this.listView.remove();\n        Backbone.View.prototype.remove.call(this);\n\n        $(\"body\").off(\"mousedown\", this.onGlobalMousedown)\n            .off(\"mouseup\", this.onGlobalMouseup)\n            .off(\"mousemove\", this.onGlobalMousemove);\n\n        $(window).off(\"resize\", this._debouncedOnResize);\n    }\n\n});\n\nexport default AvailableItemsList;\n","export default \"<div class=\\\"jr-mMultiselect-search jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <input class=\\\"jr-mInput-search jr\\\" type=\\\"text\\\">\\n</div>\\n\\n<div class=\\\"jr-mMultiselect-list jr\\\"></div>\\n\\n<div class=\\\"jr-mMultiselect-buttonContainer jr\\\">\\n    <ul class=\\\"jr-mItemselector jr\\\">\\n        <li  title=\\\"{{- i18n['sic.multiselect.selectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.selectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.deselectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.deselectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.inverse'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.inverse'] }}</span>\\n            </a>\\n        </li>\\n    </ul>\\n</div>\";","export default \"<div class=\\\"jr-mMultiselect-search jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <input class=\\\"jr-mInput-search jr\\\" type=\\\"text\\\" placeholder=\\\"{{- i18n['sic.multiselect.search']}}\\\">\\n</div>\\n\\n<div class=\\\"jr-mMultiselect-list jr\\\"></div>\\n\\n<div class=\\\"jr-mMultiselect-buttonContainer jr\\\">\\n    <ul class=\\\"jr-mItemselector jr\\\">\\n        <li  title=\\\"{{- i18n['sic.multiselect.selectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.selectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.deselectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.deselectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.inverse'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.inverse'] }}</span>\\n            </a>\\n        </li>\\n    </ul>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport ListWithNavigation from '../../scalableList/view/ListWithNavigation';\nvar ListViewForSelectedItemsList = ListWithNavigation.extend({\n    _multiSelect: function (event, value, index) {\n        if ($(event.target).hasClass('jr-mSelectlist-item-delete')) {\n            if (!this.model.selectionContains(value, index)) {\n                this._singleSelect(event, value, index);\n            }\n        } else {\n            ListWithNavigation.prototype._multiSelect.call(this, event, value, index);\n        }\n    }\n});\nexport default ListViewForSelectedItemsList;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport browserDetection from '../../../common/util/browserDetection';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\n\nimport KeyboardManager from '../../singleSelect/manager/KeyboardManager';\nimport ListWithSelectionModel from '../../scalableList/model/ListWithSelectionModel';\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nimport scalableListItemHeightCalculationTrait from '../mixin/scalableListItemHeightCalculationTrait';\nimport selectedItemsListTemplate from '../templates/selectedItemsTemplate.htm';\nimport itemsTemplate from '../templates/selectedItemsListTemplate.htm';\nimport listTemplate from '../templates/listTemplate.htm';\nimport ListWithNavigation from '../view/ListViewForSelectedItemsList';\n\nvar SelectedItemsList = Backbone.View.extend({\n    className: 'jr-mMultiselect-listContainer jr-isInactive jr',\n    events: function () {\n        return {\n            'keydown input': this.keyboardManager.onKeydown,\n            'focus input': 'onFocus',\n            'blur input': 'onBlur',\n            'mouseup .jr-mSelectlist-item-delete': 'onMouseupOnDeleteButton',\n            'mousedown': 'onMousedown',\n            'mouseup': 'onMouseup'\n        };\n    },\n    keydownHandlers: _.extend({\n        '65': 'onAKey',\n        '8': 'onDeleteKey',\n        '46': 'onDeleteKey'\n    }, KeyboardManager.prototype.keydownHandlers),\n    initialize: function (options) {\n        if (!this.model) {\n            this.model = new Backbone.Model();\n        }\n        this.model.set('focused', false, { silent: true });\n        this.template = _.template(selectedItemsListTemplate);\n        this.keyboardManager = new KeyboardManager({\n            keydownHandlers: this.keydownHandlers,\n            keydownTimeout: options.keydownTimeout,\n            context: this,\n            deferredKeydownHandler: this.processKeydown,\n            immediateHandleCondition: this.immediateHandleCondition,\n            immediateKeydownHandler: this.immediateKeydownHandler,\n            stopPropagation: true\n        });\n        var ListWithNavigationModel = ListWithSelectionModel.extend(listWithNavigationModelTrait);\n        this.listViewModel = options.listViewModel || new ListWithNavigationModel({\n            getData: options.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor\n        });\n        this.listView = options.listView || _.extend(new ListWithNavigation({\n            el: options.listElement || $(listTemplate),\n            model: this.listViewModel,\n            chunksTemplate: options.chunksTemplate,\n            itemsTemplate: options.itemsTemplate || itemsTemplate,\n            scrollTimeout: options.scrollTimeout,\n            lazy: true,\n            selectedClass: 'is-selected',\n            selection: {\n                allowed: true,\n                multiple: false\n            }\n        }), scalableListItemHeightCalculationTrait);\n        this.initListeners();\n        this.render().resize();\n    },\n    initListeners: function () {\n        this.listenTo(this.listView, 'active:changed', this.activeChange, this);\n        this.listenTo(this.model, 'change:focused', this.focusStateChanged, this);\n        this.listenTo(this.model, 'change:disabled', this.changeDisabled, this);\n        this.listenTo(this.listViewModel, 'change', this.onModelChange, this);\n    },\n    render: function () {\n        this.listView.undelegateEvents();\n        var selectedItemsList = $(this.template({\n            disabled: this.model.get('disabled'),\n            i18n: i18n\n        }));\n        this.$el.empty().append(selectedItemsList).find('.jr-mMultiselect-list').append(this.listView.el);\n        this.listView.render();\n        this.listView.delegateEvents();\n        return this;\n    },\n    renderData: function () {\n        this.listView.renderData();\n        return this;\n    },\n    activeChange: function (active) {\n        if (active) {\n            this.listView.scrollTo(active.index);\n        } else {\n            this.listViewModel.clearSelection();\n        }\n    },\n    changeDisabled: function () {\n        var disabled = this.model.get('disabled');\n        if (disabled) {\n            this.$el.find('input[type=\\'text\\']').attr('disabled', 'disabled');\n            this.listView.setValue({});\n            this.listView.activate(undefined);\n        } else {\n            this.$el.find('input[type=\\'text\\']').removeAttr('disabled');\n        }\n        this.listView.setDisabled(disabled);\n    },\n    focusStateChanged: function () {\n        if (this.model.get('focused')) {\n            this.$el.find('.mSelect-svListPlaceholder').addClass('focused');\n        } else {\n            this.$el.find('.mSelect-svListPlaceholder').removeClass('focused');\n        }\n    },\n    onModelChange: function () {\n        if (!this.listViewModel.get('total')) {\n            this.listView.$el.hide();\n        } else {\n            this.listView.$el.show();\n        }\n    },\n    onFocus: function () {\n        this.model.set('focused', true);\n    },\n    onBlur: function () {\n        if (!this.preventBlur) {\n            this.model.set('focused', false);\n        }\n    },\n    onMouseupOnDeleteButton: function (event) {\n        this.onDeleteKey(event);\n    },\n    onMousedown: function () {\n        if (!browserDetection.isIPad()) {\n            this.preventBlur = true;\n            if (!this.model.get('focused')) {\n                this.$el.find('input').focus();\n            }\n        }\n    },\n    onMouseup: function () {\n        if (this.preventBlur) {\n            this.$el.find('input').focus();\n            delete this.preventBlur;\n        }\n    },\n    onUpKey: function (event) {\n        this.listView.activatePrevious();\n    },\n    onDownKey: function (event) {\n        var active = this.listView.getActiveValue();\n        if (active) {\n            this.listView.activateNext();\n        } else {\n            this.listView.activateFirst();\n        }\n    },\n    onEnterKey: function (event) {\n    },\n    onHomeKey: function (event) {\n        this.listView.activateFirst();\n    },\n    onEndKey: function (event) {\n        this.listView.activateLast();\n    },\n    onPageUpKey: function (event) {\n        this.listView.pageUp();\n    },\n    onPageDownKey: function (event) {\n        this.listView.pageDown();\n    },\n    onTabKey: function () {\n    },\n    onAKey: function (event) {\n    },\n    onDeleteKey: function (event) {\n        var value = this.listView.getValue();\n        if (value && value.length > 0) {\n            var emptySelection = true;\n            for (var index in value) {\n                if (value.hasOwnProperty(index) && value[index] !== undefined) {\n                    emptySelection = false;\n                    break;\n                }\n            }\n            if (!emptySelection) {\n                this.trigger('selection:remove', value);\n            }\n        }\n    },\n    fetch: function (callback, options) {\n        this.listView.setValue({});\n        this.listView.activate(undefined);\n        this.listView.fetch(callback, options);\n    },\n    resize: function () {\n        this.listView.resize();\n    },\n    setDisabled: function (disabled) {\n        this.model.set('disabled', disabled);\n    },\n    getDisabled: function () {\n        return this.model.get('disabled');\n    },\n    remove: function () {\n        this.listView.remove();\n        Backbone.View.prototype.remove.call(this);\n    }\n});\nexport default SelectedItemsList;","export default \"<!--\\nthis input only for technical purposes:\\nit allows selected items list to get focus\\nand have proper tab position\\n(simple tabindex=\\\"0\\\" on DOM element will broke tab index sequence)\\n-->\\n\\n    <js-templateNonce></js-templateNonce>\\n<div class=\\\"jr-mMultiselect-list jr\\\">\\n    <input type=\\\"text\\\" style=\\\"position: absolute; left: -9999px\\\" {{ if (disabled) { }}disabled=\\\"disabled\\\"{{ } }}>\\n    <!-- list position -->\\n    <div class=\\\"jr-mMultiselect-list-message jr-isHidden jr\\\">\\n        {{- i18n['sic.multiselect.noSelection'] }}\\n    </div>\\n</div>\";","export default \"<ul class=\\\"jr-mSelectlist jr-mSelectlistSelected jr\\\" style=\\\"top: {{- top}}px; position: relative;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{_.each(items, function(item) { }}\\n    <li class=\\\"jr-mSelectlist-item jr-isSelected {{ if (item.active) print(' jr-isHovered'); }} jr\\\" title=\\\"{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}\\\" data-index=\\\"{{- item.index}}\\\">\\n        <div class=\\\"jr-mSelectlist-item-wrapper jr\\\">\\n            <a class=\\\"jr-mSelectlist-item-delete jr\\\"></a>\\n            <a class=\\\"jr-mSelectlist-item-text jr\\\">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}</a>\\n        </div>\\n    </li>\\n    {{ }); }}\\n</ul>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nvar CacheableDataProvider = function (data) {\n    _.bindAll(this, 'getData', 'getAllCachedData');\n    this.data = data || [];\n};\n_.extend(CacheableDataProvider.prototype, {\n    setData: function (data) {\n        this.data = data || [];\n    },\n    getAllCachedData: function () {\n        return this.data;\n    },\n    getData: function (options) {\n        var deferred = new $.Deferred();\n        var first = options && options.offset ? options.offset : 0;\n        var last = options && options.limit ? first + options.limit : this.data.length;\n        var dataSegment = this._getDataSegment(this.data, first, last);\n        deferred.resolve({\n            data: dataSegment,\n            total: this.data.length\n        });\n        return deferred.promise();\n    },\n    _getDataSegment: function (values, first, last) {\n        last = Math.min(last, values.length);\n        var result = [];\n        for (var i = first; i < last; i++) {\n            result.push({\n                label: values[i].label,\n                value: values[i].value\n            });\n        }\n        return result;\n    }\n});\nexport default CacheableDataProvider;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport CacheableDataProvider from '../../singleSelect/dataprovider/CacheableDataProvider';\nvar SelectedItemsDataProvider = function (options) {\n    options = options || {};\n    _.defaults(options, {\n        sortFunc: this._sortFunc,\n        formatLabel: this._formatLabel\n    });\n    this.sortFunc = options.sortFunc;\n    this.formatLabel = options.formatLabel;\n    CacheableDataProvider.call(this, options.data);\n};\n_.extend(SelectedItemsDataProvider.prototype, CacheableDataProvider.prototype);\n_.extend(SelectedItemsDataProvider.prototype, {\n    setData: function (data) {\n        data = this._convertToStandardData(data);\n        data = this._sortData(data);\n        CacheableDataProvider.prototype.setData.call(this, data);\n    },\n    _sortFunc: function (item1, item2) {\n        return item1.label.localeCompare(item2.label);\n    },\n    _formatLabel: function (value) {\n        return value;\n    },\n    _sortData: function (data) {\n        data = data || [];\n        return data.sort(this.sortFunc);\n    },\n    _convertToStandardData: function (data) {\n        var self = this;\n        return _.map(data, function (value) {\n            return {\n                value: value,\n                label: self.formatLabel(value)\n            };\n        });\n    }\n});\nexport default SelectedItemsDataProvider;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport sizerTemplate from './template/sizerTemplate.htm';\nimport logger from \"../../common/logging/logger\";\n\nimport 'jquery-ui/ui/widgets/resizable';\n\nlet log = logger.register(\"Sizer\");\n\nexport default Backbone.View.extend({\n    template: _.template(sizerTemplate),\n    el: function () {\n        return this.template();\n    },\n    initialize: function (options) {\n        this.container = options.container;\n        this.sizerOptions = _.clone(options);\n        delete this.sizerOptions.container;\n        this.$container = $(this.container);\n        this.render();\n    },\n    render: function () {\n        _.defaults(this.sizerOptions, {\n            minHeight: this.$container.height(),\n            handles: { s: this.$el }\n        });\n        this.$container.resizable(this.sizerOptions);\n        return this;\n    },\n    show: function () {\n        this.$el.removeClass('jr-isInvisible');\n        return this;\n    },\n    hide: function () {\n        this.$el.addClass('jr-isInvisible');\n        return this;\n    },\n    updateMinMax: function (boundaries) {\n        this.$container.resizable('option', 'minHeight', boundaries.minHeight);\n        this.$container.resizable('option', 'maxHeight', boundaries.maxHeight);\n    },\n    remove: function () {\n        try {\n            this.$container.resizable('destroy');\n        } catch (err) {\n            log.debug(err);\n        }\n        Backbone.View.prototype.remove.apply(this, arguments);\n    }\n});","export default \"<div class=\\\"jr-mSizer jr-mSizerVertical ui-resizable-s jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <span class=\\\"ui-icon ui-icon-grip-solid-horizontal\\\"></span>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport NumberUtils from '../../../common/util/parse/NumberUtils';\nimport doCalcOnVisibleNodeClone from '../../scalableList/util/domAndCssUtil';\nimport browserDetection from '../../../common/util/browserDetection';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\nimport xssUtil from '../../../common/util/xssUtil';\nimport AvailableItemsList from '../view/AvailableItemsList';\nimport SelectedItemsList from '../view/SelectedItemsList';\nimport multiSelectTemplate from '../templates/multiSelectTemplate.htm';\nimport SelectedItemsDataProvider from '../dataprovider/SelectedItemsDataProvider';\nimport Sizer from '../../sizer/Sizer';\n\nlet doCalcOnVisibleNodeCloneObj = doCalcOnVisibleNodeClone.doCalcOnVisibleNodeClone;\n\nvar numberUtils = new NumberUtils();\nvar SELECTION_CHANGE_TIMEOUT = 300;\nvar DEFAULT_VISIBLE_ITEMS_COUNT = 10;\nvar DEFAULT_MIN_ITEMS_COUNT = 3;\nexport default Backbone.View.extend({\n    className: 'jr-mMultiselect jr',\n    events: function () {\n        return { 'click  .jr-mMultiselect-toggle': 'toggleLists' };\n    },\n    initialize: function (options) {\n        this.template = _.template(multiSelectTemplate);\n        this.i18n = {\n            selected: i18n['sic.multiselect.toggle.selected'],\n            available: i18n['sic.multiselect.toggle.available']\n        };\n        this.heightAutoAdjustment = _.isUndefined(options.heightAutoAdjustment) ? true : options.heightAutoAdjustment;\n        this.availableItemsListModel = this._createAvailableItemsListModel(options);\n        this.availableItemsList = this._createAvailableItemsList(options);\n        this.selectedItemsDataProvider = this._createSelectedItemsListDataProvider(options);\n        this.selectedItemsList = this._createSelectedItemsList(options);\n        this.height = options.height;\n        this.resizable = options && options.resizable;\n        this.initListeners();\n        if (typeof options.value !== 'undefined') {\n            this.silent = true;\n            this.availableItemsList.setValue(options.value);\n        }\n        if (options && options.resizable) {\n            this.sizer = new Sizer({\n                container: this.$el,\n                stop: _.bind(function () {\n                    this.resize();\n                }, this)\n            });\n        }\n        this.render();\n    },\n    _createAvailableItemsListModel: function (options) {\n        return new Backbone.Model();\n    },\n    _createAvailableItemsList: function (options) {\n        return options.availableItemsList || new AvailableItemsList({\n            model: this.availableItemsListModel,\n            getData: options.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor,\n            chunksTemplate: options.chunksTemplate,\n            scrollTimeout: options.scrollTimeout,\n            keydownTimeout: options.keydownTimeout\n        });\n    },\n    _createSelectedItemsListDataProvider: function (options) {\n        return options.selectedItemsDataProvider || new SelectedItemsDataProvider(options.selectedListOptions);\n    },\n    _createSelectedItemsList: function (options) {\n        this.formatValue = options.formatValue;\n        return new SelectedItemsList({\n            getData: this.selectedItemsDataProvider.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor,\n            chunksTemplate: options.chunksTemplate,\n            scrollTimeout: options.scrollTimeout\n        });\n    },\n    initListeners: function () {\n        this.listenTo(this.availableItemsList, 'selection:change', this.selectionChange, this);\n        this.listenTo(this.availableItemsList, 'listRenderError', this.listRenderError, this);\n        this.listenTo(this.availableItemsListModel, 'change:totalValues', this._availableItemsTotalCountChange, this);\n        this.listenTo(this.selectedItemsList, 'selection:remove', this.selectionRemoved, this);\n    },\n    render: function () {\n        this.sizer && this.sizer.$el.detach();\n        this.$el.html($(this.template({ i18n: i18n })));\n        this.$toggleContainer = this.$el.find('.jr-mMultiselect-toggleContainer');\n        this.availableItemsList.undelegateEvents();\n        this.selectedItemsList.undelegateEvents();\n        this.selectedItemsList.$el.insertAfter(this.$toggleContainer);\n        this.availableItemsList.$el.insertAfter(this.$toggleContainer);\n        this.availableItemsList.render();\n        this.selectedItemsList.render();\n        this._updateAvailableItemsCountLabel();\n        this._updateSelectedItemsCountLabel();\n        this.availableItemsList.delegateEvents();\n        this.selectedItemsList.delegateEvents();\n        this._tuneCSS();\n        this._renderSizer();\n        return this;\n    },\n    _renderSizer: function () {\n        if (this.sizer) {\n            this.heightAutoAdjustment && this._handleHeight();\n            this.$el.append(this.sizer.$el);\n        }\n    },\n    _tuneCSS: function () {\n        var self = this;\n        if (!this._cssDepententSizesSet) {\n            doCalcOnVisibleNodeCloneObj({\n                el: this.$el,\n                css: { 'width': '500px' },\n                classes: 'jr',\n                alwaysClone: true,\n                callback: function ($el) {\n                    self.toggleContainerHeight = $el.find('.jr-mMultiselect-toggleContainer').outerHeight();\n                    self._tuneCSSInternal($el);\n                    $el.find('.jr-mScalablelist').css({ height: '0' });\n                    self._emptyContainerHeight = $el.outerHeight();\n                    var height;\n                    if (self.height) {\n                        height = self.height;\n                    } else {\n                        height = self._calcHeightByItemsCount(DEFAULT_VISIBLE_ITEMS_COUNT);\n                    }\n                    self.$el.css('height', height);\n                }\n            });\n            this._cssDepententSizesSet = true;\n        }\n        this._tuneCSSInternal(this.$el);\n    },\n    _tuneCSSInternal: function ($el) {\n        var toggleContainerHeight = this.toggleContainerHeight;\n        browserDetection.isIPad() && this.$el.addClass('ipad');\n        $el.find('.jr-mMultiselect-listContainer').css('padding-top', toggleContainerHeight);\n    },\n    listRenderError: function (responseStatus, error) {\n        this.trigger('listRenderError', responseStatus, error);\n    },\n    toggleLists: function (evt) {\n        evt.stopPropagation();\n        if ($(evt.currentTarget).hasClass('jr-isActive')) {\n            return;\n        }\n        this.$el.find('.jr-mMultiselect-toggle').toggleClass('jr-isActive jr-isInactive');\n        this.$el.find('.jr-mMultiselect-listContainer').toggleClass('jr-isActive jr-isInactive');\n        if (!browserDetection.isIPad()) {\n            this.$el.find('.jr-mMultiselect-listContainer.jr-isActive input').focus();\n        }\n    },\n    selectionChange: function (selection) {\n        clearTimeout(this.selectionChangeTimeout);\n        this.selectionChangeTimeout = setTimeout(_.bind(this.selectionChangeInternal, this, selection), SELECTION_CHANGE_TIMEOUT);\n    },\n    selectionRemoved: function (selection) {\n        var currentRawSelection = this.availableItemsList.model.get('value'), seletedIndex, selectedLength = selection.length;\n        for (seletedIndex = 0; seletedIndex < selectedLength; seletedIndex += 1) {\n            delete currentRawSelection[selection[seletedIndex]];\n        }\n        this.availableItemsList.setValue(_.keys(currentRawSelection));\n    },\n    selectionChangeInternal: function (selection) {\n        var self = this, activeValue = this.selectedItemsList.listView.getActiveValue(), scrollTop = this.selectedItemsList.listView.$el.scrollTop();\n        this.selectedItemsDataProvider.setData(selection);\n        this.selectedItemsList.fetch(function () {\n            self._updateSelectedItemsCountLabel();\n            self.selectedItemsList.resize();\n            self.selectedItemsList.listView.$el.scrollTop(scrollTop);\n            if (activeValue && self.selectedItemsList.$el.hasClass('j-active')) {\n                var total = self.selectedItemsList.listView.model.get('total');\n                if (total && total > activeValue.index) {\n                    self.selectedItemsList.listView.activate(activeValue.index);\n                } else if (total) {\n                    self.selectedItemsList.listView.activate(activeValue.index - 1);\n                }\n            }\n        });\n        if (!this.silent) {\n            this.triggerSelectionChange();\n        } else {\n            delete this.silent;\n        }\n    },\n    _setToggleLabel: function (target, count, text) {\n        var labelCount = numberUtils.formatNumber(count), $labelEl = this.$el.find(target + ' .jr-mMultiselect-toggle-label'), labelText = text + ': ' + labelCount;\n        $labelEl.text(labelText).attr('title', xssUtil.hardEscape(labelText));\n    },\n    _handleHeight: function () {\n        var totalItems = this.availableItemsList.model.get('totalValues') || 0;\n        if (!this._cssDepententSizesSet || !totalItems) {\n            return;\n        }\n        var currentHeight = this.$el.height(), height = this.$el.height();\n        var minHeight = this._calcHeightByItemsCount(DEFAULT_MIN_ITEMS_COUNT);\n        var maxHeight = this._calcHeightByItemsCount(totalItems);\n        if (totalItems <= DEFAULT_VISIBLE_ITEMS_COUNT) {\n            minHeight = maxHeight = height = this._calcHeightByItemsCount(Math.max(DEFAULT_MIN_ITEMS_COUNT, totalItems));\n        } else if (currentHeight > maxHeight) {\n            height = this._calcHeightByItemsCount(totalItems);\n        }\n        this.$el.css('height', height + 'px');\n        this._updateSizerVisibility({\n            minHeight: minHeight,\n            maxHeight: maxHeight\n        });\n    },\n    _updateSizerVisibility: function (boundaries) {\n        if (!this.sizer) {\n            return;\n        }\n        this.sizer.updateMinMax(boundaries);\n        if (boundaries.minHeight === boundaries.maxHeight) {\n            this.sizer.hide();\n        } else {\n            this.sizer.show();\n        }\n    },\n    _calcHeightByItemsCount: function (items) {\n        var itemHeight = this.availableItemsList.listView.itemHeight;\n        return items * itemHeight + this._emptyContainerHeight;\n    },\n    _availableItemsTotalCountChange: function () {\n        this._updateAvailableItemsCountLabel();\n        this.heightAutoAdjustment && this._handleHeight();\n    },\n    _updateAvailableItemsCountLabel: function () {\n        var total = this.availableItemsList.model.get('totalValues') || 0;\n        this._setToggleLabel('.jr-mMultiselect-toggleAvailable', total || 0, this.i18n.available);\n    },\n    _updateSelectedItemsCountLabel: function () {\n        var $noSelection = this.$el.find('.jr-mMultiselect-list-message'), count = this.selectedItemsList.listView.model.get('total') || 0;\n        this._setToggleLabel('.jr-mMultiselect-toggleSelected', count, this.i18n.selected);\n        if (count === 0) {\n            $noSelection.removeClass('jr-isHidden');\n        } else {\n            $noSelection.addClass('jr-isHidden');\n        }\n    },\n    triggerSelectionChange: function () {\n        this.trigger('selection:change', this.getValue());\n    },\n    renderData: function () {\n        this.availableItemsList.renderData();\n        this.selectedItemsList.renderData();\n        return this;\n    },\n    fetch: function (callback, options) {\n        this.availableItemsList.fetch(callback, options);\n    },\n    reset: function (options) {\n        this.availableItemsList.reset(options);\n    },\n    resize: function () {\n        _.debounce(_.bind(function () {\n            this.availableItemsList.resize();\n            this.selectedItemsList.resize();\n        }, this), 500)();\n    },\n    setValue: function (value, options) {\n        if (options && options.silent) {\n            this.silent = true;\n        }\n        delete options.silent;\n        this.availableItemsList.setValue(value, options);\n    },\n    getValue: function () {\n        var value = this.availableItemsList.getValue();\n        var result = [];\n        var i = 0;\n        for (var index in value) {\n            if (value.hasOwnProperty(index) && value[index] !== undefined) {\n                result[i++] = value[index];\n            }\n        }\n        return result;\n    },\n    setDisabled: function (disabled) {\n        this.availableItemsList.setDisabled(disabled);\n        this.selectedItemsList.setDisabled(disabled);\n        return this;\n    },\n    getDisabled: function () {\n        return this.availableItemsList.getDisabled();\n    },\n    remove: function () {\n        this.availableItemsList.remove();\n        this.selectedItemsList.remove();\n        this.sizer && this.sizer.remove();\n        Backbone.View.prototype.remove.call(this);\n    },\n    clearFilter: function () {\n        this.availableItemsList.clearFilter();\n    }\n});\n","export default \"<div class=\\\"jr-mMultiselect-toggleContainer jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"jr-mMultiselect-toggle jr-mMultiselect-toggleAvailable jr-isActive jr\\\" title=\\\"\\\">\\n        <span class=\\\"jr-mMultiselect-toggle-label jr\\\" title=\\\"\\\"></span>\\n    </div>\\n    <div class=\\\"jr-mMultiselect-toggle jr-mMultiselect-toggleSelected jr-isInactive jr\\\">\\n        <span class=\\\"jr-mMultiselect-toggle-label jr\\\" title=\\\"\\\"></span>\\n    </div>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {\n    create: function (specialValue) {\n        return function (item1, item2) {\n            if (item1.label === specialValue) {\n                return -1;\n            } else if (item2.label === specialValue) {\n                return 1;\n            } else {\n                return item1.label.localeCompare(item2.label);\n            }\n        };\n    }\n};","import {\n    InputControlsServiceType, PaginatedControl, PaginatedControlOption,\n    PaginatedValuesOptions\n} from '../rest/types/InputControlsServiceType';\nimport {\n    InputControlsDataProviderType as InputControlsDataProviderInterface,\n    InputControlsDataProviderOptions\n} from './types/InputControlsDataProviderType';\n\nexport default class InputControlsDataProvider implements InputControlsDataProviderInterface {\n    private readonly inputControlsService: InputControlsServiceType;\n\n    private readonly controlId: string;\n\n    // @ts-ignore: unused property TODO: why we need it? it's really never used\n    private additionalParams: {select?: string, value?: string[]};\n\n    constructor(options: InputControlsDataProviderOptions) {\n        this.controlId = options.controlId;\n        this.inputControlsService = options.inputControlsService;\n        this.additionalParams = {};\n    }\n\n    getData(uri: string, serviceOptions: PaginatedValuesOptions[]) {\n        const result = this.inputControlsService\n            .getInputControlsPaginatedValues(uri, serviceOptions).then((response) => {\n                const state: PaginatedControl[] = response && response.inputControlState ? response.inputControlState : [];\n                const controlData = state.find((control) => {\n                    return control.id === this.controlId;\n                }) || {\n                    id: '',\n                    uri: '',\n                    options: [],\n                    totalCount: '0'\n                };\n\n                const data = controlData.options && controlData.options.map((option) => {\n                    return {\n                        ...option\n                    };\n                });\n\n                return {\n                    data,\n                    total: parseInt(controlData.totalCount, 10)\n                }\n            });\n\n        return (result as unknown) as Promise<{\n            data: PaginatedControlOption[],\n            total: number\n        }>\n    }\n}\n","import { InputControlsDataProviderType } from './types/InputControlsDataProviderType';\nimport { InputControlsDataProviderWithDataLabelHashType } from './types/InputControlsDataProviderWithDataLabelHashType';\nimport { PaginatedValuesOptions } from '../rest/types/InputControlsServiceType';\n\ninterface InputControlsDataProviderWithDataLabelHashOptions {\n    inputControlsDataProvider: InputControlsDataProviderType\n}\n\nexport default class InputControlsDataProviderWithDataLabelHash implements InputControlsDataProviderWithDataLabelHashType {\n    private readonly inputControlsDataProvider: InputControlsDataProviderType;\n\n    private readonly dataLabelHash: {[key: string]: string};\n\n    constructor(options: InputControlsDataProviderWithDataLabelHashOptions) {\n        this.dataLabelHash = {};\n        this.inputControlsDataProvider = options.inputControlsDataProvider;\n    }\n\n    getData(uri: string, options: PaginatedValuesOptions[]) {\n        return this.inputControlsDataProvider.getData(uri, options).then((response) => {\n            const {\n                data,\n                total\n            } = response;\n\n            data.forEach((option) => {\n                this.dataLabelHash[option.value] = option.label;\n            });\n\n            return {\n                data,\n                total\n            }\n        });\n    }\n\n    getLabelByValue(value: string) {\n        return this.dataLabelHash[value];\n    }\n}\n","import { PaginatedValuesOptions } from '../../rest/types/InputControlsServiceType';\n\nexport default (\n    options: {\n        criteria?: string,\n        offset: number,\n        limit?: number,\n        name: string,\n        paginatedValuesOptions: PaginatedValuesOptions[] | undefined\n    }\n) => {\n    const {\n        paginatedValuesOptions,\n        ...controlOptions\n    } = options;\n\n    if (paginatedValuesOptions && paginatedValuesOptions.length > 0) {\n        return paginatedValuesOptions.map((option) => {\n            if (option.name === controlOptions.name) {\n                return { ...option, ...controlOptions };\n            }\n\n            return option;\n        });\n    }\n\n    return [\n        {\n            ...controlOptions\n        }\n    ]\n};\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n *\n * TODO: Not_Used_Anywhere\n */\n\n/* global updateYearMonth*/\n\nimport {JRS} from \"../namespace/namespace\";\nimport jQuery from 'jquery';\nimport _ from 'underscore';\nimport './controls.core';\nimport {ControlsBase} from \"./controls.base\";\nimport SingleSelect from \"js-sdk/src/components/singleSelect/view/SingleSelectNew\";\nimport MultiSelect from \"js-sdk/src/components/multiSelect/view/MultiSelect\";\nimport DateAndTimePicker from \"js-sdk/src/components/dateAndTime/DateAndTimePicker\";\nimport selectedItemsDataProviderSorterFactory from \"js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory\";\nimport dateUtil from 'js-sdk/src/common/util/parse/date';\n\nimport InputControlsDataProvider from './dataprovider/InputControlsDataProvider';\nimport InputControlsDataProviderWithDataLabelHash from './dataprovider/InputControlsDataProviderWithDataLabelHash';\nimport DataProviderWithSearchCache from 'js-sdk/src/common/component/tree/dataprovider/DataProviderWithSearchCache';\n\nimport getInputControlsDataProviderNewPageOptions from './dataprovider/util/getInputControlsDataProviderNewPageOptions';\n\nimport \"./controls.basecontrol\";\nimport { showErrorPopup } from '../core/core.ajax.utils';\nimport RestParamsEnum from './rest/enum/restParamsEnum';\n\nconst getInitialSelectedValuesToLabelMap = (initialSelectedValues) => {\n    return initialSelectedValues.reduce((memo, selectedValue) => {\n        memo[selectedValue.value] = selectedValue.label || selectedValue.value;\n        return memo;\n    }, {});\n};\n\nJRS.Controls = (function (jQuery, _, Controls) {\n\n    //module:\n    //\n    //  controls.components\n    //\n    //summary:\n    //\n    //  Provide default input controls types\n    //\n    //main types:\n    //\n    //  Bool, SingleValue, SingleValueDate, SingleSelect, MultiSelect, MultiSelectCheckbox, SingleSelectRadio - default\n    //  input controls\n    //\n    //  ReportOptions - special control, not connected with cascade\n    //\n    //dependencies:\n    //\n    //  jQuery          - jquery v1.7.1\n    //  _,         - underscore.js 1.3.1\n    //  Controls   - controls.core module\n    function changeDateFunc(dateText) {\n        const prevSelection = Controls.BaseControl.prototype.get.call(this, 'selection');\n        if (!prevSelection || prevSelection[0] !== dateText) {\n            this.set({ selection: [dateText] });\n        }\n    }\n\n    function getNormalizedDatetimeValue(rawValue) {\n        var normalizedValue = rawValue.toUpperCase().replace(/([\\s]+$|^[\\s]+)/g, \"\");\n        return normalizedValue.replace(/[\\s]*(\\+|\\-)[\\s]*/g, \"$1\");\n    }\n\n    return _.extend(Controls, {\n        Bool: Controls.BaseControl.extend({\n\n            setValue:function (controlData) {\n                var container = this.getElem();\n                var input = container.find('input');\n                if (controlData == \"true\") {\n                    input.prop('checked', true);\n                } else {\n                    input.prop('checked', false);\n                }\n            },\n\n            bindCustomEventListeners:function () {\n                this.getElem() && this.getElem().on('change', 'input', _.bind(function (evt) {\n                    var value = evt.target.getValue() == null ? \"false\" : \"true\";\n                    this.set({ selection: [value] });\n                }, this));\n            }\n        }),\n\n        SingleValueText: Controls.BaseControl.extend({\n\n            setValue:function (controlData) {\n                var value = controlData == ControlsBase.NULL_SUBSTITUTION_VALUE ? ControlsBase.NULL_SUBSTITUTION_LABEL : controlData;\n                var container = this.getElem();\n                if (container) {\n                    container.find('input').attr('value', value);\n                    container.find('input').val(value);\n                }\n            },\n\n            bindCustomEventListeners:function () {\n                this.getElem() && this.getElem().on('change', 'input', _.bind(function (evt) {\n                    var inputValue = evt.target.value;\n                    var value = inputValue == ControlsBase.NULL_SUBSTITUTION_LABEL ? ControlsBase.NULL_SUBSTITUTION_VALUE : inputValue;\n                    this.set({ selection: [value] });\n                }, this));\n\n            }\n        }),\n\n        SingleValueNumber: Controls.BaseControl.extend({\n\n            setValue:function (controlData) {\n                this.getElem().find('input').attr('value', controlData);\n                this.getElem().find('input').val(controlData);\n            },\n\n            bindCustomEventListeners:function () {\n                this.getElem() && this.getElem().on('change', 'input', _.bind(function (evt) {\n                    this.set({ selection: [evt.target.value] });\n                }, this));\n            }\n        }),\n\n        SingleValueDate: Controls.BaseControl.extend({\n\n            initialize:function (args) {\n                this.baseRender(args);\n                args.visible && this.getElem() && this.setupCalendar();\n            },\n\n            get: function(attribute){\n                var localizedDate = Controls.BaseControl.prototype.get.call(this, attribute);\n                return dateUtil.localizedDateToIsoDate(localizedDate);\n            },\n\n            set: function(attributes, preventNotification){\n                if(attributes.values){\n                    attributes.values = dateUtil.isoDateToLocalizedDate(attributes.values);\n                }\n                Controls.BaseControl.prototype.set.call(this, attributes, preventNotification);\n            },\n\n            setupCalendar:function () {\n                var input = this.getElem().find('input');\n\n                this.picker = new DateAndTimePicker({\n                    el: input,\n                    showOn: \"button\",\n                    dateFormat: JRS.i18n[\"bundledCalendarFormat\"],\n                    disabled: input[0].disabled,\n                    onSelect: _.bind(changeDateFunc, this)\n                });\n\n                input.change(_.bind(function (evt) {\n                    //prevent triggering of global control change event\n                    evt.stopPropagation();\n\n                    //remove all spaces and convert to upper case\n                    jQuery(evt.target).val(getNormalizedDatetimeValue(evt.target.value));\n\n                    changeDateFunc.call(this, jQuery(evt.target).val());\n                }, this));\n\n                input.after('&nbsp;');\n                var button = this.getElem().find('button');\n                button.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty();\n            },\n\n            setValue:function (controlData) {\n                var container = this.getElem();\n                container.find('input').attr('value', controlData);\n                container.find('input').val(controlData);\n            }\n\n        }),\n\n        SingleValueDatetime: Controls.BaseControl.extend({\n\n            initialize:function (args) {\n                this.baseRender(args);\n                args.visible && this.getElem() && this.setupCalendar();\n            },\n\n            getInput: function() {\n                var $el = this.getElem();\n\n                return $el && $el.find('input');\n            },\n\n            destroyCalendar: function() {\n                var $input = this.getInput();\n                $input.off();\n\n                this.picker && this.picker.remove();\n            },\n\n            setupCalendar:function () {\n                var $el = this.getElem(),\n                    $input = this.getInput();\n\n                this.destroyCalendar();\n\n                this.picker = new DateAndTimePicker({\n                    el: $input[0],\n                    showOn: \"button\",\n                    dateFormat: JRS.i18n[\"bundledCalendarFormat\"],\n                    timeFormat: JRS.i18n[\"bundledCalendarTimeFormat\"],\n                    disabled: $input[0].disabled,\n                    onSelect: _.bind(changeDateFunc, this)\n                });\n\n                $input.change(_.bind(function (evt) {\n                    //prevent triggering of global control change event\n                    evt.stopPropagation();\n\n                    //remove all spaces an  d convert to upper case\n                    jQuery(evt.target).val(getNormalizedDatetimeValue(evt.target.value));\n                    changeDateFunc.call(this, jQuery(evt.target).val());\n                }, this));\n                $input.after('&nbsp;');\n\n                var button = $el.find('button');\n\n                button.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty();\n            },\n\n            get: function(attribute){\n                var localizedDateTime = Controls.BaseControl.prototype.get.call(this, attribute);\n                return dateUtil.localizedTimestampToIsoTimestamp(localizedDateTime);\n            },\n\n            set: function(attributes, preventNotification) {\n                if(attributes.values){\n                    attributes.values = dateUtil.isoTimestampToLocalizedTimestamp(attributes.values);\n                }\n\n                if (!attributes.values && !attributes.selection && this.getInput()) {\n                    this.setupCalendar();\n                }\n\n                Controls.BaseControl.prototype.set.call(this, attributes, preventNotification);\n            },\n            setValue:function (controlData) {\n                var container = this.getElem();\n                container.find('input').attr('value', controlData);\n                container.find('input').val(controlData);\n            }\n        }),\n\n        SingleValueTime: Controls.BaseControl.extend({\n\n            initialize:function (args) {\n                this.baseRender(args);\n                args.visible && this.getElem() && this.setupCalendar();\n            },\n\n            getInput: function() {\n                var $el = this.getElem();\n\n                return $el && $el.find('input');\n            },\n\n            destroyCalendar: function() {\n                var $input = this.getInput();\n                $input.off();\n\n                this.picker && this.picker.remove();\n            },\n\n            setupCalendar:function () {\n                var $el = this.getElem(),\n                    $input = this.getInput();\n\n                this.destroyCalendar();\n\n                this.picker = new DateAndTimePicker({\n                    el: $input[0],\n                    showOn: \"button\",\n                    timeFormat: JRS.i18n[\"bundledCalendarTimeFormat\"],\n                    disabled: $input[0].disabled,\n                    onClose: _.bind(changeDateFunc, this)\n                });\n                $input.change(_.bind(function (evt) {\n                    //prevent triggering of global control change event\n                    evt.stopPropagation();\n\n                    //remove all spaces an  d convert to upper case\n                    jQuery(evt.target).val(getNormalizedDatetimeValue(evt.target.value));\n                    changeDateFunc.call(this, jQuery(evt.target).val());\n                }, this));\n\n                $input.after('&nbsp;');\n                var button = $el.find('button');\n                button.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty();\n            },\n\n            get: function(attribute){\n                var localizedTime = Controls.BaseControl.prototype.get.call(this, attribute);\n                return dateUtil.localizedTimeToIsoTime(localizedTime);\n            },\n\n            set: function(attributes, preventNotification){\n                if (attributes.values) {\n                    attributes.values = dateUtil.isoTimeToLocalizedTime(attributes.values);\n                }\n\n                if (!attributes.values && !attributes.selection && this.getInput()) {\n                    this.setupCalendar();\n                }\n\n                Controls.BaseControl.prototype.set.call(this, attributes, preventNotification);\n            },\n            setValue:function (controlData) {\n                var container = this.getElem();\n                container.find('input').attr('value', controlData);\n                container.find('input').val(controlData);\n            }\n        }),\n\n        SingleSelect: Controls.BaseControl.extend({\n            initialize(controlStructure, initialOptions = {}) {\n                const {\n                    initialSelectedValues\n                } = initialOptions;\n\n                this.dataUri = initialOptions.dataUri;\n                this.inputControlsService = initialOptions.inputControlsService;\n                this.paginatedValuesOptions = initialOptions.paginatedValuesOptions\n\n                if (!this.singleSelect) {\n                    this.inputControlsDataProviderWithDataLabelHash = new InputControlsDataProviderWithDataLabelHash({\n                        inputControlsDataProvider: new InputControlsDataProvider({\n                            controlId: controlStructure.id,\n                            inputControlsService: this.inputControlsService\n                        })\n                    });\n\n                    this.dataProviderWithCache = new DataProviderWithSearchCache({\n                        pageSize: 100,\n                        maxSearchCacheSize: 1,\n                        saveLastCriteria: true,\n                        request: (options) => {\n                            options = getInputControlsDataProviderNewPageOptions(Object.assign({\n                                name: this.id,\n                                paginatedValuesOptions: this.paginatedValuesOptions\n                            }, options));\n\n                            var dfd = this.inputControlsDataProviderWithDataLabelHash.getData(this.dataUri, options);\n                            Controls.Utils.showLoadingDialogOn(dfd, null, true)\n                            return dfd;\n\n                        }\n                    });\n\n                    this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(initialSelectedValues);\n\n                    this.singleSelect = new SingleSelect({\n                        getData: this.dataProviderWithCache.getData,\n                        keydownTimeout: ControlsBase.KEY_DOWN_TIMEOUT,\n                        formatValue: (value) => {\n                            return this.inputControlsDataProviderWithDataLabelHash.getLabelByValue(value)\n                                ?? this.initialSelectedValuesToLabelMap[value];\n                        },\n                        keydownTimeout: ControlsBase.KEY_DOWN_TIMEOUT\n                    }).setDisabled(controlStructure.readOnly);\n\n                    if (controlStructure) {\n                        _.extend(this, controlStructure);\n                    }\n                }\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    this.singleSelect.undelegateEvents();\n\n                    const element = jQuery(template(this));\n\n                    this.singleSelect.render().renderData();\n\n                    element.find(\".ssPlaceholder\").append(this.singleSelect.el);\n\n                    this.setElem(element);\n                    this.singleSelect.delegateEvents();\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n            },\n\n            setValue(selectedValues) {\n                this.singleSelect.setValue(selectedValues, { silent: true });\n            },\n\n            updateSelectionOnOptionChange(selection) {\n                this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(selection);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                const dfd = jQuery.Deferred();\n\n                this.singleSelect.off('listRenderError').once('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                    dfd.reject(xhr);\n\n                    this.bindCustomEventListeners();\n                });\n\n                this.dataProviderWithCache.clear();\n\n                this.singleSelect.fetch((...args) => {\n                    dfd.resolve(...args);\n                });\n\n                return dfd;\n            },\n\n            bindCustomEventListeners() {\n                this.singleSelect.off(\"selection:change\").on(\"selection:change\", function (selection) {\n                    this.fireControlSelectionChangeEvent([selection]);\n                }, this);\n\n                this.singleSelect.off('listRenderError').on('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n            }\n        }),\n\n        MultiSelect: Controls.BaseControl.extend({\n            initialize(controlStructure, initialOptions = {}) {\n                const {\n                    initialSelectedValues\n                } = initialOptions;\n\n                this.dataUri = initialOptions.dataUri;\n                this.inputControlsService = initialOptions.inputControlsService;\n                this.paginatedValuesOptions = initialOptions.paginatedValuesOptions;\n\n                if (!this.multiSelect) {\n                    this.inputControlsDataProviderWithDataLabelHash = new InputControlsDataProviderWithDataLabelHash({\n                        inputControlsDataProvider: new InputControlsDataProvider({\n                            controlId: controlStructure.id,\n                            inputControlsService: this.inputControlsService\n                        })\n                    });\n\n                    this.dataProviderWithCache = new DataProviderWithSearchCache({\n                        pageSize: 100,\n                        maxSearchCacheSize: 1,\n                        saveLastCriteria: true,\n\n                        request: (options) => {\n                            options = getInputControlsDataProviderNewPageOptions(Object.assign({\n                                name: this.id,\n                                paginatedValuesOptions: this.paginatedValuesOptions\n                            }, options));\n\n                            var dfd = this.inputControlsDataProviderWithDataLabelHash.getData(this.dataUri, options);\n                            Controls.Utils.showLoadingDialogOn(dfd, null, true)\n                            return dfd;\n                        }\n                    });\n\n                    this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(initialSelectedValues);\n\n                    this.multiSelect = new MultiSelect({\n                        getData: this.dataProviderWithCache.getData,\n                        selectedListOptions: {\n                            formatLabel: (value) => {\n                                return this.inputControlsDataProviderWithDataLabelHash.getLabelByValue(value)\n                                     ?? this.initialSelectedValuesToLabelMap[value];\n                            },\n                            sortFunc: selectedItemsDataProviderSorterFactory.create(ControlsBase.NULL_SUBSTITUTION_LABEL)\n                        },\n                        resizable : true,\n                        keydownTimeout: ControlsBase.KEY_DOWN_TIMEOUT\n                    });\n\n                    this.multiSelect.setDisabled(controlStructure.readOnly);\n\n                    this._resize = _.debounce(_.bind(this.multiSelect.resize, this.multiSelect), 500);\n\n                    if (controlStructure) {\n                        _.extend(this, controlStructure);\n                    }\n                }\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    this.multiSelect.undelegateEvents();\n\n                    const element = jQuery(template(this));\n\n                    this.multiSelect.render().renderData();\n\n                    element.find(\".msPlaceholder\").append(this.multiSelect.el);\n\n                    this.setElem(element);\n                    this.multiSelect.delegateEvents();\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n            },\n\n            setValue(selectedValues) {\n                selectedValues = _.isArray(selectedValues) && _.first(selectedValues)=== RestParamsEnum.NOTHING_SUBSTITUTION_VALUE ? [] : selectedValues\n                this.multiSelect.setValue(selectedValues, {silent: true});\n                this._resize();\n            },\n\n            updateSelectionOnOptionChange(selection) {\n                this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(selection);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                const dfd = jQuery.Deferred();\n\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                this.dataProviderWithCache.clear();\n\n                this.multiSelect.off('listRenderError').once('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                    dfd.reject(xhr);\n\n                    this.bindCustomEventListeners();\n                });\n\n                this.multiSelect.fetch((...args) => {\n                    dfd.resolve(...args);\n                });\n\n                return dfd;\n            },\n\n            clearFilter() {\n                this.multiSelect.clearFilter();\n            },\n\n            bindCustomEventListeners() {\n                this.multiSelect.off(\"selection:change\").on(\"selection:change\", function (selection) {\n                    this.fireControlSelectionChangeEvent(selection);\n                }, this);\n\n                this.multiSelect.off('listRenderError').on('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n            },\n\n            get(attribute) {\n                const result = this[attribute];\n\n                if (attribute === 'selection' && _.isEmpty(result)) {\n                    return [];\n                } else {\n                    return result;\n                }\n            },\n\n            makeResizable() {\n                const $sizer = this.multiSelect.$el.find(\".jr-mSizer\");\n\n                //according to IC specifics, sizer should be after alert message\n                if ($sizer.length){\n                    $sizer.detach().insertAfter(this.getElem() && this.getElem().find('.resizeOverlay'));\n                }\n            }\n        }),\n\n        SingleSelectRadio: Controls.BaseControl.extend({\n            initialize(controlStructure, options = {}) {\n                controlStructure && _.extend(this, controlStructure);\n\n                this.dataUri = options.dataUri;\n                this.inputControlsService = options.inputControlsService;\n                this.paginatedValuesOptions = options.paginatedValuesOptions;\n                this.inputControlsDataProvider = new InputControlsDataProvider({\n                    controlId: controlStructure.id,\n                    inputControlsService: this.inputControlsService\n                });\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    const element = jQuery(template(this));\n                    this.setElem(element);\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n\n                return this.fetch(this.dataUri, this.paginatedValuesOptions);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                return this._fetchData(uri, paginatedValuesOptions).then((result) => {\n                    this._renderData(result.data);\n                });\n            },\n\n            _fetchData(uri, paginatedValuesOptions) {\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                const options = getInputControlsDataProviderNewPageOptions({\n                    name: this.id,\n                    paginatedValuesOptions: this.paginatedValuesOptions,\n                    offset: 0\n                });\n\n                return this.inputControlsDataProvider.getData(this.dataUri, options);\n            },\n\n            _renderData(controlData) {\n                let list = this.getElem() && this.getElem().find('ul')[0];\n                if(list){\n                    const data = controlData.map((val) => {\n                        const result = _.clone(val);\n\n                        result.readOnly = this.readOnly;\n                        result.name = this.getOptionName();\n                        result.uuid = _.uniqueId(this.id);\n\n                        return result;\n                    });\n\n                    const template = this.getTemplateSection('data');\n\n                    Controls.Utils.setInnerHtml(list, template, {\n                        data\n                    });\n\n                    list = jQuery(list);\n                    list.html(list.html() + \"&nbsp;\"); //workaround for IE scrollbar\n\n                    //TODO move to decorator\n                    if (list.find('li').length < 5 && this.getElem()[0].clientHeight < 125) {\n                        this.getElem().find('.jr-mSizer').addClass('hidden');\n                        this.getElem().find('.inputSet').removeClass('sizable').attr('style', false);\n                    } else {\n                        if (this.resizable) {\n                            this.getElem().find('.jr-mSizer').removeClass('hidden');\n                            this.getElem().find('.inputSet').addClass('sizable');\n                        }\n                    }\n                }\n\n            },\n\n            getOptionName() {\n                return this.id + \"_option\";\n            },\n\n            bindCustomEventListeners() {\n                this.getElem().on('change', 'input', (evt) => {\n                    const selection = evt.target.value;\n                    // for better performance in IE7\n                    setTimeout(() => {\n                        this.set({selection:[selection]})\n                    });\n                });\n            },\n\n            //TODO move to decorator\n            makeResizable() {\n                this.resizable = true;\n\n                const list = this.getElem().find('ul');\n                const sizer = this.getElem().find('.jr-mSizer').removeClass('hidden');\n\n                sizer.addClass(\"ui-resizable-s\");\n                list.resizable({\n                    handles:{\n                        's': sizer\n                    }\n                });\n            }\n        }),\n\n        MultiSelectCheckbox: Controls.BaseControl.extend({\n            initialize(controlStructure, options = {}) {\n                controlStructure && _.extend(this, controlStructure);\n\n                this.dataUri = options.dataUri;\n                this.inputControlsService = options.inputControlsService;\n                this.paginatedValuesOptions = options.paginatedValuesOptions;\n\n                this.inputControlsDataProvider = new InputControlsDataProvider({\n                    controlId: controlStructure.id,\n                    inputControlsService: this.inputControlsService\n                });\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    const element = jQuery(template(this));\n                    this.setElem(element);\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n\n                return this.fetch(this.dataUri, this.paginatedValuesOptions);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                return this._fetchData(uri, paginatedValuesOptions).then((result) => {\n                    this._renderData(result.data);\n                });\n            },\n\n            _fetchData(uri, paginatedValuesOptions) {\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                const options = getInputControlsDataProviderNewPageOptions({\n                    name: this.id,\n                    paginatedValuesOptions: this.paginatedValuesOptions,\n                    offset: 0\n                });\n\n                return this.inputControlsDataProvider.getData(this.dataUri, options);\n            },\n\n            _renderData(controlData) {\n                const data = controlData.map((val) => {\n                    const result = _.clone(val);\n\n                    result.readOnly = this.readOnly;\n                    result.uuid = _.uniqueId(this.id);\n\n                    return result;\n                });\n\n                const list = this.getElem() && this.getElem().find('ul')[0];\n                if(list){\n                    const template = this.getTemplateSection('data');\n\n                    Controls.Utils.setInnerHtml(list, template, {data:data});\n\n                    //TODO move to decorator\n                    if (jQuery(list).find('li').length < 5 && this.getElem()[0].clientHeight < 125) {\n                        this.getElem().find('.jr-mSizer').addClass('hidden');\n                        this.getElem().find('.inputSet').removeClass('sizable').attr('style', false);\n                    } else {\n                        if (this.resizable) {\n                            this.getElem().find('.jr-mSizer').removeClass('hidden');\n                            this.getElem().find('.inputSet').addClass('sizable');\n                        }\n                    }\n                }\n\n            },\n\n            getSelection() {\n                const boxes = this.getElem().find(\":checkbox\").filter(\":checked\");\n\n                return _.map(boxes, function (box) {\n                    return jQuery(box).val();\n                });\n            },\n\n            bindCustomEventListeners() {\n                this.getElem().on('change', 'input', (evt) => {\n                    const selection = this.getSelection();\n                    // for better performance in IE7\n                    setTimeout(() => {\n                        this.set({selection:selection})\n                    });\n                });\n\n                this.getElem().on('click','a', (evt) => {\n                    const options = this.getElem().find('input');\n                    const name = jQuery(evt.target)[0].name;\n\n                    if (name === \"multiSelectAll\" || name === \"multiSelectNone\") {\n                        _.each(options, function(opt){\n                            opt.checked = name === \"multiSelectAll\";\n                        });\n                    } else if (name === \"multiSelectInverse\") {\n                        _.each(options,  function(opt){\n                            opt.checked = !opt.checked;\n                        });\n                    }\n\n                    this.getElem().find('input').change(); // trigger the cascading request\n                });\n            },\n\n            get(attribute) {\n                const result = this[attribute];\n\n                if (attribute === 'selection' && _.isEmpty(result)) {\n                    return [];\n                } else {\n                    return result;\n                }\n            },\n\n            //TODO move to decorator\n            makeResizable() {\n                this.resizable = true;\n\n                const list = this.getElem().find('ul');\n                const sizer = this.getElem().find('.jr-mSizer').removeClass('hidden');\n\n                sizer.addClass(\"ui-resizable-s\");\n                list.resizable({\n                    handles:{\n                        's': sizer\n                    }\n                });\n            }\n        })\n    });\n})(\n    jQuery,\n    _,\n    JRS.Controls\n);\n\nexport default JRS.Controls;\n\n","// @ts-ignore\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\n// @ts-ignore\nimport request from 'js-sdk/src/common/transport/request';\nimport RequestOptions from '../types/request';\nimport {\n    InputControlsServiceType as InputControlsServiceInterface,\n    PaginatedValuesOptions, SelectedOnlyOptions\n} from './types/InputControlsServiceType';\n\ninterface InputControlsServiceOptions {\n    request(options: RequestOptions): JQueryXHR\n}\n\nexport default class InputControlsService implements InputControlsServiceInterface {\n    private readonly request: (options: RequestOptions) => JQueryXHR;\n\n    constructor(options: InputControlsServiceOptions) {\n        this.request = options.request || request;\n    }\n\n    getInputControlsSelectedValues(reportUri: string) {\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/selectedValues`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n\n    getInputControlsMetadata(reportUri: string) {\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls?exclude=state`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n\n    getInputControlsValues(reportUri: string, inputControlIds: string[]) {\n\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/${inputControlIds.join(';')}/values?freshData=false&includeTotalCount=true`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n\n    getInputControlsOnlySelectedValue(reportUri: string, options: SelectedOnlyOptions) {\n        const controlIds = Object.keys(options).map((ip) => ip).join(';');\n        return this.request({\n            type: 'POST',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/${controlIds}/values?freshData=false&selectedOnly=true`,\n            data: JSON.stringify(options),\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n        });\n    }\n\n    getInputControlsPaginatedValues(reportUri: string, options: PaginatedValuesOptions[]) {\n        const controlIds = options.map((c) => c.name).join(';');\n\n        return this.request({\n            type: 'POST',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/${controlIds}/values/pagination?freshData=false&includeTotalCount=true`,\n            data: JSON.stringify({\n                reportParameter: options\n            }),\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n        });\n    }\n}\n","import $ from 'jquery';\nimport _ from 'underscore';\n\nimport {\n    InputControlsServiceType as InputControlsServiceInterface,\n    PaginatedValuesOptions, PaginatedValuesResponse, SelectedOnlyOptions\n} from './types/InputControlsServiceType';\n\ninterface InputControlsServiceOptions {\n    inputControlsService: InputControlsServiceInterface\n}\n\nconst getCacheKey = (reportUri: string, options: PaginatedValuesOptions[]) => {\n    const sortedOptions = _.sortBy(options, 'name');\n\n    return sortedOptions.reduce((memo, option) => {\n        const {\n            name,\n            offset,\n            limit\n        } = option;\n\n        const params = [name, offset, limit]\n            .concat(option.criteria || [])\n            .concat(option.value || [])\n            .concat(option.select || []);\n\n        return `${memo} ${JSON.stringify(params)}`;\n    }, `${reportUri}`);\n};\n\nexport interface InputControlsServiceWithCacheInterface\n    extends Pick<InputControlsServiceInterface, 'getInputControlsSelectedValues' | 'getInputControlsMetadata' | 'getInputControlsValues'> {\n    getInputControlsPaginatedValues(reportUri: string, options: PaginatedValuesOptions[]): JQueryDeferred<PaginatedValuesResponse>,\n    setCacheValueForControlPaginatedValues(\n        reportUri: string,\n        options: PaginatedValuesOptions[],\n        cacheValue: PaginatedValuesResponse\n    ): void,\n    getInputControlsOnlySelectedValue(reportUri: string, options: SelectedOnlyOptions): JQueryXHR,\n    clearCache(): void\n}\n\nexport default class InputControlsServiceWithCache implements InputControlsServiceWithCacheInterface {\n    private readonly inputControlsService: InputControlsServiceInterface;\n\n    private cache: { [key: string]: PaginatedValuesResponse };\n\n    constructor(options: InputControlsServiceOptions) {\n        this.cache = {};\n        this.inputControlsService = options.inputControlsService;\n    }\n\n    getInputControlsSelectedValues(reportUri: string) {\n        return this.inputControlsService.getInputControlsSelectedValues(reportUri);\n    }\n\n    getInputControlsMetadata(reportUri: string) {\n        return this.inputControlsService.getInputControlsMetadata(reportUri);\n    }\n\n    getInputControlsValues(reportUri: string, inputControlIds: string[]) {\n        return this.inputControlsService.getInputControlsValues(reportUri, inputControlIds);\n    }\n\n    getInputControlsOnlySelectedValue(reportUri: string, options: SelectedOnlyOptions) {\n        return this.inputControlsService.getInputControlsOnlySelectedValue(reportUri, options)\n    }\n\n    getInputControlsPaginatedValues(reportUri: string, options: PaginatedValuesOptions[]) {\n        const cacheKey = getCacheKey(reportUri, options);\n        const cacheValue = this.cache[cacheKey];\n\n        const dfd = $.Deferred();\n\n        if (cacheValue) {\n            dfd.resolve(cacheValue);\n        } else {\n            this.inputControlsService.getInputControlsPaginatedValues(\n                reportUri,\n                options\n            ).then((...args) => {\n                const [\n                    response\n                ] = args;\n\n                this.cache[cacheKey] = response;\n\n                dfd.resolve(response);\n            }, (...args) => {\n                dfd.reject(...args);\n            });\n        }\n\n        return dfd;\n    }\n\n    setCacheValueForControlPaginatedValues(\n        reportUri: string,\n        options: PaginatedValuesOptions[],\n        cacheValue: PaginatedValuesResponse\n    ) {\n        const cacheKey = getCacheKey(reportUri, options);\n\n        this.cache[cacheKey] = cacheValue;\n    }\n\n    clearCache() {\n        this.cache = {};\n    }\n}\n","import InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\ninterface InputControlsMetadata {\n    inputControl: {\n        uri: string,\n        id: string,\n        type: InputControlTypeEnum,\n        slaveDependencies?: string[],\n        masterDependencies?: string[]\n    }[]\n}\n\nexport default {\n    metadataToViewModelConverter(metadata: InputControlsMetadata) {\n        return metadata.inputControl.map((control) => ({\n            ...control,\n            uri: control.uri.replace('repo:', '')\n        }));\n    }\n};\n","enum InputControlTypeEnum {\n    BOOL = 'bool',\n    SINGLE_VALUE_TEXT = 'singleValueText',\n    SINGLE_VALUE_NUMBER = 'singleValueNumber',\n    SINGLE_VALUE_DATE = 'singleValueDate',\n    SINGLE_VALUE_DATE_TIME = 'singleValueDatetime',\n    SINGLE_VALUE_TIME = 'singleValueTime',\n    SINGLE_SELECT = 'singleSelect',\n    SINGLE_SELECT_RADIO = 'singleSelectRadio',\n    MULTI_SELECT = 'multiSelect',\n    MULTI_SELECT_CHECKBOX = 'multiSelectCheckbox'\n}\n\nexport default InputControlTypeEnum;\n","import _ from 'underscore';\nimport RestParamsEnum from '../rest/enum/restParamsEnum';\nimport { PaginatedValuesOptions } from '../rest/types/InputControlsServiceType';\nimport InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\nconst LIMIT = 100;\n\nconst omitLimit = (paginatedValuesOptions: PaginatedValuesOptions) => {\n    return _.omit(paginatedValuesOptions, ['limit']);\n};\n\ntype ControlSpecificOptionsFn = (paginatedValuesOptions: PaginatedValuesOptions) => PaginatedValuesOptions;\ntype ControlSpecificOptionsMap = {\n    [key: string]: ControlSpecificOptionsFn | undefined\n}\n\nconst controlSpecificOptionsMap: ControlSpecificOptionsMap = {\n    [InputControlTypeEnum.SINGLE_SELECT_RADIO]: (paginatedValuesOptions: PaginatedValuesOptions) => {\n        return omitLimit(paginatedValuesOptions);\n    },\n    [InputControlTypeEnum.MULTI_SELECT_CHECKBOX]: (paginatedValuesOptions: PaginatedValuesOptions) => {\n        return omitLimit(paginatedValuesOptions);\n    }\n};\n\nexport default (\n    id: string,\n    type: string,\n    options: {\n        select?: RestParamsEnum.SELECTED_VALUES\n        value?: string[]\n    } = {}\n) => {\n    const result = {\n        name: id,\n        offset: 0,\n        limit: LIMIT,\n        ...options\n    };\n\n    const addControlSpecificOptions = controlSpecificOptionsMap[type];\n\n    if (addControlSpecificOptions) {\n        return addControlSpecificOptions(result);\n    }\n\n    return result;\n};\n","import InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\nconst queryControls = [\n    InputControlTypeEnum.SINGLE_SELECT,\n    InputControlTypeEnum.MULTI_SELECT,\n    InputControlTypeEnum.SINGLE_SELECT_RADIO,\n    InputControlTypeEnum.MULTI_SELECT_CHECKBOX\n];\n\nexport default (control: {\n    type: InputControlTypeEnum\n}) => {\n    return queryControls.indexOf(control.type) > -1;\n};\n","import _ from 'underscore';\nimport RestParamsEnum from '../rest/enum/restParamsEnum';\n\nimport getControlPaginationOptionsByControlIdAndType from './getControlPaginationOptionsByControlIdAndType';\nimport InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\ninterface Control {\n    slaveDependencies?: string[],\n    masterDependencies?: string[],\n    type: InputControlTypeEnum,\n    select?: RestParamsEnum.SELECTED_VALUES\n    value?: string[]\n}\n\ninterface Controls {\n    [key: string]: Control\n}\n\nexport default (\n    options: {\n        controlId: string,\n        controls: Controls\n    }\n) => {\n    const {\n        controls\n    } = options;\n\n    return (\n        Object.keys(controls).map((id) => {\n            return {\n                ...getControlPaginationOptionsByControlIdAndType(\n                    id,\n                    controls[id].type,\n                    controls[id].value ? _.pick(controls[id], ['value']) : _.pick(controls[id], ['select'])\n                )\n            }\n        })\n    );\n};\n","import $ from 'jquery';\nimport _ from 'underscore';\n\nimport {\n    PaginatedValuesOptions, PaginatedValuesResponse,\n    SelectedValuesResponse, SelectedOnlyResponse, SelectedOnlyOptions\n} from '../rest/types/InputControlsServiceType';\nimport inputControlsToViewModelConverter from '../converter/inputControlsToViewModelConverter';\nimport InputControlTypeEnum from '../enum/inputControlTypeEnum';\nimport getControlPaginationOptionsByControlIdAndType from '../converter/getControlPaginationOptionsByControlIdAndType';\nimport RestParamsEnum from '../rest/enum/restParamsEnum';\nimport isQueryControl from '../predicate/isQueryControl';\nimport getControlsPaginationOptionsByControlId from '../converter/getControlsPaginationOptionsByControlId';\nimport { InputControlsServiceWithCacheInterface } from '../rest/InputControlsServiceWithCache';\n\ninterface ControlStructure {\n    id: string,\n    type: InputControlTypeEnum,\n    slaveDependencies?: string[],\n    masterDependencies?: string[]\n}\n\ninterface Options {\n    inputControlsService: InputControlsServiceWithCacheInterface\n}\n\nconst getPaginatedValuesOptionsForQueryControls = (\n    structure: ControlStructure[],\n    controlsMap: {\n        [key: string]: ControlStructure\n    },\n    mapper: (option: PaginatedValuesOptions) => PaginatedValuesOptions,\n    callback?: (option: PaginatedValuesOptions[]) => void\n) => {\n    return structure.reduce((memo, control) => {\n        if (isQueryControl(control)) {\n            const newMemo: {\n                [key: string]: PaginatedValuesOptions[]\n            } = {\n                ...memo,\n                [control.id]: getControlsPaginationOptionsByControlId({\n                    controlId: control.id,\n                    controls: controlsMap\n                }).map(mapper)\n            };\n\n            if (typeof callback !== 'undefined') {\n                callback(newMemo[control.id]);\n            }\n\n            return newMemo;\n        }\n\n        return memo;\n    }, {});\n};\n\nconst getControlsPaginationOptionsByControlIdOnSelectionChange = (options: {\n    controlId: string,\n    value: string[],\n    selection: {\n        [key: string]: string[]\n    },\n    controls: {\n        [key: string]: ControlStructure\n    }\n}) => {\n    const {\n        controlId,\n        value,\n        controls,\n        selection\n    } = options;\n\n    const controlsWithValueOrDefaultSelection = _.reduce(controls, (controlMemo, control) => {\n        let additionalOptions = {};\n\n        if (control.id === controlId) {\n            additionalOptions = {\n                value: value.length > 0 ? value : [RestParamsEnum.NOTHING_SUBSTITUTION_VALUE]\n            }\n        } else {\n            additionalOptions = {\n                value: selection[control.id],\n                select: RestParamsEnum.SELECTED_VALUES\n            }\n        }\n\n        return {\n            ...controlMemo,\n            [control.id]: {\n                masterDependencies: control.masterDependencies || [],\n                slaveDependencies: control.slaveDependencies || [],\n                type: control.type,\n                ...additionalOptions\n            }\n        }\n    }, {});\n\n    return getControlsPaginationOptionsByControlId({\n        controlId,\n        controls: controlsWithValueOrDefaultSelection\n    });\n};\n\nconst fetchRequestParamsThroughURL = (structure: ControlStructure[], allRequestParameters: any) => {\n    const fetchLabelOfControls: Array<string> = _.pluck(structure, 'id');\n    const fetchKeysOfParams: Array<string> = _.keys(allRequestParameters);\n    const requestedSelectionParams: any = {};\n    const getControlIdInRequestParams: Array<string> = _.intersection(fetchLabelOfControls, fetchKeysOfParams);\n\n    if (getControlIdInRequestParams.length > 0) {\n        getControlIdInRequestParams.forEach((val) => {\n            requestedSelectionParams[val] = allRequestParameters[val]\n        });\n    }\n    return requestedSelectionParams\n};\n\nexport default class InputControlsReportViewerService {\n    private readonly inputControlsService: InputControlsServiceWithCacheInterface;\n\n    constructor(options: Options) {\n        this.inputControlsService = options.inputControlsService;\n    }\n\n    fetchInputControlsInitialState(uri: string, allRequestParameters: { [key: string]: string[] }) {\n        // flow when user is setting values through uri.\n        return this.inputControlsService.getInputControlsMetadata(uri).then((response) => {\n            if (response) {\n                const structure = inputControlsToViewModelConverter.metadataToViewModelConverter(response);\n                return this.fetchInitialInputControlsValuesByUriAndStructure(uri, structure, allRequestParameters);\n            }\n            return $.Deferred().resolve(response);\n        });\n    }\n\n    fetchInitialInputControlsValuesByUri(uri: string, structure: ControlStructure[], preSelectedData: { [key: string]: string[] }) {\n        return this.fetchInitialInputControlsValuesByUriAndStructure(uri, structure, preSelectedData);\n    }\n\n    fetchInputControlsOptionsBySelectionAndUri(\n        selection: {\n            [key: string]: string[]\n        },\n        uri: string,\n        structure: ControlStructure[]\n    ) {\n        const controlsMap: {\n            [key: string]: ControlStructure\n        } = structure.reduce((structureMemo, control) => {\n            return {\n                ...structureMemo,\n                [control.id]: control\n            };\n        }, {});\n\n        const paginationOptions = _.map(selection, (value, controlId) => {\n            return getControlPaginationOptionsByControlIdAndType(\n                controlId,\n                controlsMap[controlId].type,\n                {\n                    value: value && value.length === 0 ? [RestParamsEnum.NOTHING_SUBSTITUTION_VALUE] : selection[controlId] || []\n                }\n            );\n        });\n\n        const paginationOptionsPerControl = getPaginatedValuesOptionsForQueryControls(\n            structure,\n            controlsMap,\n            (option) => {\n                return {\n                    ...option,\n                    value: selection[option.name] || []\n                }\n            }\n        );\n\n        return this.fetchInputControlsOptionsByPaginatedValuesOptionsAndUri({\n            paginationOptions,\n            paginationOptionsPerControl,\n            uri\n        }).then((response) => {\n            return $.Deferred().resolve(response, paginationOptions, paginationOptionsPerControl);\n        });\n    }\n\n    fetchInputControlsValuesOnControlSelectionChange(options: {\n        controlId: string,\n        value: string[],\n        uri: string,\n        structure: ControlStructure[],\n        selection: {\n            [key: string]: string[]\n        },\n        initialSelectedValues: {\n            [key: string]: { value: string }[]\n        }\n    }) {\n        const {\n            controlId,\n            value,\n            uri,\n            structure,\n            selection\n        } = options;\n\n        const controlsMap: {\n            [key: string]: ControlStructure\n        } = structure.reduce((controlMemo, control) => {\n            return {\n                ...controlMemo,\n                [control.id]: control\n            };\n        }, {});\n\n        const paginationOptions = getControlsPaginationOptionsByControlIdOnSelectionChange({\n            controlId,\n            value,\n            selection,\n            controls: controlsMap\n        });\n        const newSelection: { [key: string]: string[] } = { ...selection };\n        const selectedOnlyOptions: SelectedOnlyOptions = _.pick(newSelection, _.pluck(paginationOptions, 'name'));\n        selectedOnlyOptions[controlId] = value;\n\n        const newInitialValuesPromise = this.inputControlsService\n            .getInputControlsOnlySelectedValue(uri, selectedOnlyOptions);\n\n        return this.fetchInputControlsOptionsByPaginatedValuesOptionsAndUri({\n            paginationOptions,\n            uri\n        }).then((response) => {\n            return $.when<SelectedOnlyResponse>(newInitialValuesPromise).then((res) => {\n                const { inputControlState } = res;\n                const selectionPerControl = inputControlState && inputControlState.reduce((ICStateMemo, controlSelection) => {\n                    return {\n                        ...ICStateMemo,\n                        [controlSelection.id]: controlSelection.options ? _.pluck(controlSelection.options, 'value') || []\n                            : controlSelection.value\n                    }\n                }, {});\n                return $.Deferred().resolve(response, selectionPerControl, paginationOptions)\n            })\n        });\n    }\n\n    fetchInitialInputControlsValuesByUriAndStructure(\n        uri: string,\n        structure: ControlStructure[],\n        preSelectionData: { [key: string]: string[] }\n    ) {\n        const preSelectedData: { [key: string]: string[] } = fetchRequestParamsThroughURL(structure, preSelectionData);\n        const initialPaginatedValuesOptions = structure.map((control) => {\n            return getControlPaginationOptionsByControlIdAndType(\n                control.id,\n                control.type,\n                preSelectedData[control.id] ? {\n                    value: preSelectedData[control.id]\n                }\n                    : {\n                        select: RestParamsEnum.SELECTED_VALUES\n                    }\n            );\n        });\n\n        const initialPaginatedValuesPromise = this.inputControlsService\n            .getInputControlsPaginatedValues(uri, initialPaginatedValuesOptions);\n\n        const selectedValuesPromise = this.inputControlsService\n            .getInputControlsSelectedValues(uri);\n\n        return $.when<\n            PaginatedValuesResponse | [PaginatedValuesResponse],\n            [SelectedValuesResponse]\n        >(initialPaginatedValuesPromise, selectedValuesPromise)\n            .then((\n                paginatedValuesResponse,\n                selectedValuesResponse\n            ) => {\n                const [\n                    selectedValues\n                ] = selectedValuesResponse;\n\n                const paginatedValues = paginatedValuesResponse instanceof Array\n                    ? paginatedValuesResponse[0]\n                    : paginatedValuesResponse;\n\n                let selection = {};\n                selection = selectedValues ? selectedValues.selectedValue.reduce((selectedMemo, controlSelection) => {\n                    return {\n                        ...selectedMemo,\n                        [controlSelection.id]: controlSelection.options || []\n                    };\n                }, {}) : {};\n\n                const controlsMap = structure.reduce((structureMemo, control) => {\n                    return {\n                        ...structureMemo,\n                        [control.id]: preSelectedData[control.id] ? {\n                            ...control,\n                            value: preSelectedData[control.id]\n                        } : {\n                            ...control,\n                            select: RestParamsEnum.SELECTED_VALUES\n                        }\n                    };\n                }, {});\n\n                const paginationOptionsPerControl = getPaginatedValuesOptionsForQueryControls(\n                    structure,\n                    controlsMap,\n                    (option) => {\n                        return preSelectedData[option.name] ? {\n                            ...option,\n                            value: preSelectedData[option.name]\n                        } : {\n                            ...option,\n                            select: RestParamsEnum.SELECTED_VALUES\n                        }\n                    },\n                    (options) => {\n                        this.inputControlsService.setCacheValueForControlPaginatedValues(\n                            uri,\n                            options,\n                            paginatedValues\n                        );\n                    }\n                );\n\n                // case when selection is passing through URL\n                if (!_.isEmpty(preSelectedData)) {\n                    const newSelection: { [key: string]: string[] } = { ...selection };\n                    let optionsForValues: { [key: string]: string[] } = {};\n                    Object.keys(newSelection).forEach((ip) => {\n                        optionsForValues[ip] = _.pluck(newSelection[ip], 'value');\n                    });\n                    optionsForValues = { ...optionsForValues, ...preSelectedData };\n                    const newInitialValuesPromise = this.inputControlsService\n                        .getInputControlsOnlySelectedValue(uri, optionsForValues);\n                    return $.when<SelectedOnlyResponse>(newInitialValuesPromise).then((res) => {\n                        const { inputControlState } = res;\n                        selection = inputControlState && inputControlState.reduce((stateMemo, controlSelection) => {\n                            return {\n                                ...stateMemo,\n                                [controlSelection.id]: controlSelection.options ? controlSelection.options.map((ip) => _.omit(ip, 'selected')) || []\n                                    : [{ value: controlSelection.value, label: controlSelection.value }]\n                            };\n                        }, {});\n\n                        return $.Deferred().resolve({\n                            structure,\n                            selection,\n                            paginationOptionsPerControl,\n                            paginatedValuesResponse: paginatedValues\n                        });\n                    })\n                }\n                return $.Deferred().resolve({\n                    structure,\n                    selection,\n                    paginationOptionsPerControl,\n                    paginatedValuesResponse: paginatedValues\n                });\n            });\n    }\n\n    private fetchInputControlsOptionsByPaginatedValuesOptionsAndUri(options: {\n        paginationOptions: PaginatedValuesOptions[],\n        paginationOptionsPerControl?: {\n            [key: string]: PaginatedValuesOptions[]\n        },\n        uri: string\n    }) {\n        const {\n            paginationOptions,\n            paginationOptionsPerControl = {},\n            uri\n        } = options;\n\n        this.inputControlsService.clearCache();\n\n        return this.inputControlsService.getInputControlsPaginatedValues(uri, paginationOptions)\n            .then((response) => {\n                paginationOptions.forEach((controlPaginationOptions) => {\n                    const controlId = controlPaginationOptions.name;\n\n                    if (paginationOptionsPerControl[controlId]) {\n                        this.inputControlsService.setCacheValueForControlPaginatedValues(\n                            uri,\n                            paginationOptionsPerControl[controlId],\n                            response\n                        );\n                    }\n                });\n                return response;\n            });\n    }\n}\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\nimport jQuery from 'jquery';\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\n\nimport './controls.core';\nimport './controls.datatransfer';\nimport './controls.viewmodel';\nimport './controls.components';\n\nimport 'jquery.urldecoder';\n\nimport request from 'js-sdk/src/common/transport/request';\nimport InputControlsService from './rest/InputControlsService';\nimport InputControlsServiceWithCache from './rest/InputControlsServiceWithCache';\nimport InputControlsReportViewerService from './service/InputControlsReportViewerService';\n\nimport { showErrorPopup } from '../core/core.ajax.utils';\n\nimport InputControlTypeEnum from './enum/inputControlTypeEnum';\n\nconst validatePaginatedValuesResponse = (response, controls) => {\n    const controlsData = response && response.inputControlState ? response.inputControlState : [];\n    let areControlsValid = true;\n\n    controlsData.forEach((controlData) => {\n        const control = controls[controlData.id];\n\n        if (control && control.get('error')) {\n            control.set({\n                error: null\n            });\n        }\n\n        if (controlData.error) {\n            control.set({\n                error: controlData.error\n            });\n\n            areControlsValid = false;\n        }\n\n        // singleValueNumber ICs may have a validated value e.g. from \"1.20\" to \"1.2\" that needs to be re-applied\n        if (!controlData.error &&\n            control && InputControlTypeEnum.SINGLE_VALUE_NUMBER === control.type &&\n            controlData.value) {\n\n            control.set({\n                values: [controlData.value]\n            });\n        }\n    });\n\n    return areControlsValid;\n};\n\n;(function(jQuery,_, Controls) {\n\n    //module:\n    //\n    //  controls.controller\n    //\n    //summary:\n    //\n    //  Connect input controls with server\n    //\n    //main types:\n    //\n    //  Controller - provide common functions around input controls, like update, reset, etc.\n    //\n    //dependencies:\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls        - controls.viewmodel and controls.datatransfer\n\n    return _.extend(Controls, {\n\n        //Provides common operations under input controls\n        Controller : Controls.Base.extend({\n\n            constructor: function(options) {\n                _.bindAll(this,\n                    \"getViewModel\",\n                    \"resetControlsToSelection\",\n                    \"validate\"\n                );\n\n                this.inputControlsService = new InputControlsServiceWithCache({\n                    inputControlsService: new InputControlsService({\n                        request\n                    })\n                });\n\n                this.inputControlsReportViewerService = new InputControlsReportViewerService({\n                    inputControlsService: this.inputControlsService\n                });\n\n                this.viewModel = options && options.viewModel?  options.viewModel : new Controls.ViewModel();\n\n                // Common initialization\n                this.initialize(options);\n\n                Controls.ignore('reportoptions:selection:changed');\n                Controls.listen({\n                    \"viewmodel:selection:changed\": (...args) => {\n                        this._onViewModelSelectionChange(...args);\n                    },\n\n                    \"reportoptions:selection:changed\": (...args) => {\n                        this._onReportOptionsSelectionChanged(...args);\n                    }\n                });\n\n                Controls.getController =_.bind(function () {\n                    return this;\n                }, this);\n\n                // Triggered right after controller is initialized but before\n                // this allows custom code to listen when controls are actually initialized\n                // and override draw method of viewModel\n                var event = new CustomEvent('controls:initialized', {\n                    detail: this.getViewModel()\n                });\n\n                document.dispatchEvent(event);\n            },\n\n            _onViewModelSelectionChange: function(event, selectionChangedControlId, value, inCascade) {\n                const viewModel = this.getViewModel();\n                const controls = viewModel.getControls();\n                if (value && inCascade) {\n                    const dfd = this.inputControlsReportViewerService.fetchInputControlsValuesOnControlSelectionChange({\n                        controlId: selectionChangedControlId,\n                        value,\n                        uri: this.dataUri,\n                        structure: viewModel.structure,\n                        selection: viewModel.get('selection'),\n                        initialSelectedValues: viewModel.controlsOptions.initialSelectedValues\n                    }).then((response, selectionPerControl, paginationOptions) => {\n                        const promises = paginationOptions.map((controlPaginationOptions) => {\n                            const controlId = controlPaginationOptions.name;\n                            controls[controlId].paginatedValuesOptions = paginationOptions;\n                            return selectionChangedControlId !== controlId && controls[controlId].fetch(this.dataUri, paginationOptions);\n                        });\n\n                        return jQuery.when(...promises).then(() => {\n                            return jQuery.Deferred().resolve(selectionPerControl, response);\n                        });\n                    }).then((selectionPerControl, response) => {\n                        selectionPerControl = Object.assign({}, selectionPerControl, {\n                            [selectionChangedControlId]: value\n                        });\n\n                        _.each(selectionPerControl, (values, id) => {\n                            controls[id].set({ values });\n                        });\n\n                        validatePaginatedValuesResponse(response, controls);\n                    }).catch((xhr) => {\n                        const control = controls[selectionChangedControlId];\n\n                        control.set({\n                            values: control.selection\n                        });\n\n                        showErrorPopup(xhr.responseJSON.message);\n\n                        return jQuery.Deferred().reject(xhr);\n                    });\n\n                    Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                }else{\n                    selectionChangedControlId && this.viewModel.controls[selectionChangedControlId].set({'selection':value},true);\n                }\n            },\n\n            _onReportOptionsSelectionChanged: function(event, data) {\n                const {\n                    reportOption,\n                    previousReportOption\n                } = data;\n\n                const viewModel = this.viewModel;\n                const controls = viewModel.getControls();\n\n                this.dataUri = reportOption && reportOption.uri || this.dataUri;\n\n                const dfd = this.inputControlsReportViewerService.fetchInitialInputControlsValuesByUri(\n                    this.dataUri,\n                    viewModel.structure,\n                    data.selectedData\n                ).then((options) => {\n                    const {\n                        selection, paginatedValuesResponse, paginationOptionsPerControl\n                    } = options;\n\n                    const promises = _.map(paginationOptionsPerControl, (controlPaginatedOptions, id) => {\n                        const control = controls[id];\n                        // update initialselectedvalues on report option change\n                        control.updateSelectionOnOptionChange && control.updateSelectionOnOptionChange(selection[id] || [])\n\n                        return control.fetch(this.dataUri, controlPaginatedOptions);\n                    });\n\n                    return jQuery.when(...promises).then(() => {\n                        return jQuery.Deferred().resolve(selection, paginatedValuesResponse);\n                    });\n                }).then((selection, response) => {\n                    _.each(controls,(control,key) =>{\n                        control.set({\n                            values: _.pluck(selection[key], 'value')\n                        })\n                    })\n\n                    validatePaginatedValuesResponse(response, controls);\n                }).catch((xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n\n                    Controls.reportOptions.set({\n                        selection: previousReportOption\n                    }, true);\n\n                    return jQuery.Deferred().reject(xhr);\n                });\n\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n            },\n\n            /**\n             * Common initialization method that can be overridden by inherited classes\n             * @param args\n             */\n            initialize : function(options) {\n                this.dataUri = options.reportOptionUri || options.reportUri;\n            },\n\n            fetchAndSetInputControlsState: function (allRequestParameters) {\n                var dfd = this.inputControlsReportViewerService.fetchInputControlsInitialState(\n                    this.dataUri, allRequestParameters\n                ).then((options) => {\n                    if(options) {\n                        this.viewModel.set({\n                            structure: options.structure,\n                            controlsOptions: {\n                                dataUri: this.dataUri,\n                                inputControlsService: this.inputControlsService,\n                                initialSelectedValues: options.selection,\n                                paginatedValuesOptions: options.paginationOptionsPerControl,\n                                paginatedValuesResponse: options.paginatedValuesResponse\n                            }\n                        });\n\n                        const viewModel = this.getViewModel();\n                        const controls = viewModel.getControls();\n\n                        validatePaginatedValuesResponse(options.paginatedValuesResponse, controls);\n                    }\n                    return jQuery.Deferred().resolve(options);\n                });\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                return dfd;\n            },\n\n            //Returns object responsible for initialization and drawing of controls\n            getViewModel:function () {\n                return this.viewModel;\n            },\n\n            //update controls by given selection or by current selection\n            resetControlsToSelection: function(selectedData) {\n                const viewModel = this.getViewModel();\n                const controls = viewModel.getControls();\n\n                if (!selectedData) {\n                    selectedData = viewModel.get(\"selection\");\n                }\n\n                return this.inputControlsReportViewerService.fetchInputControlsOptionsBySelectionAndUri(\n                    selectedData,\n                    this.dataUri,\n                    viewModel.structure\n                ).then((response, paginationOptions, paginationOptionsPerControl) => {\n                    const promises = paginationOptions.map((controlPaginationOptions) => {\n                        const control = controls[controlPaginationOptions.name];\n                        control.clearFilter();\n                        return control.fetch(this.dataUri,\n                            paginationOptionsPerControl[controlPaginationOptions.name] || paginationOptions);\n                    });\n\n                    return jQuery.when(...promises).then(() => {\n                        return response;\n                    });\n                }).then((response) => {\n                    validatePaginatedValuesResponse(response, controls);\n\n                    _.each(controls, (control, id) => {\n                        const value = selectedData[id];\n                        let options;\n\n                        if (value) {\n                            options = {\n                                values: value\n                            };\n                        } else {\n                            options = {\n                                error: null,\n                                values: undefined,\n                                selection: undefined\n                            };\n                        }\n\n                        control.reset(options);\n                    });\n                });\n            },\n\n            //validate controls values and update only invalid controls\n            validate: function() {\n                const viewModel = this.getViewModel();\n                const controls = viewModel.getControls();\n\n                const selectedData = viewModel.get(\"selection\");\n                const dfd = this.inputControlsReportViewerService.fetchInputControlsOptionsBySelectionAndUri(\n                    selectedData,\n                    this.dataUri,\n                    viewModel.structure\n                ).then((response) => {\n                    const areControlsValid = validatePaginatedValuesResponse(response, controls);\n                    return jQuery.Deferred().resolve(areControlsValid);\n                });\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                return dfd;\n            }\n        })\n    });\n})(\n    jQuery,\n    _,\n    JRS.Controls\n);\n\nexport default JRS.Controls;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author; inesterenko\n * @version: $Id$\n */\nimport {JRS} from \"../namespace/namespace\";\n\nJRS.Log = (function (args) {\n\n    //module:\n    //\n    //  controls.logging\n    //\n    //summary:\n    //\n    //  Safe using of console object even in IE\n    //\n    //main object:\n    //\n    //  console\n    //\n\n\n    if (!window.console) {\n        window.console =   {\n\n            log:function () {\n                //stub\n            },\n\n            debug:function () {\n                //stub\n            },\n            error : function(){\n                //stub\n            }\n        };\n    }\n\n})();\n\nexport default JRS.Log;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport dialogs from \"../components/components.dialogs\";\nimport {JRS} from \"../namespace/namespace\";\nimport jQuery from 'jquery';\n\nfunction showErrorPopup(errorMessage, options) {\n    if ((errorMessage && errorMessage.indexOf('sessionAttributeMissingException')) > -1) {\n        dialogs.clusterErrorPopup.show(errorMessage);\n    } else {\n        dialogs.errorPopup.show(errorMessage, false, options);\n    }\n}\nfunction baseErrorHandler(ajaxAgent) {\n    //Handling HTTP 500 - Internal server error\n    if (ajaxAgent.status == 500) {\n        showErrorPopup(ajaxAgent.responseText);\n        return true;\n    }\n    var sessionTimeout = ajaxAgent.getResponseHeader('LoginRequested');\n    if (sessionTimeout) {\n        var newloc = '.';\n        document.location = newloc;\n        return true;\n    }\n    var isErrorPage = ajaxAgent.getResponseHeader('JasperServerError');\n    if (isErrorPage) {\n        var suppressError = ajaxAgent.getResponseHeader('SuppressError');\n        if (!suppressError) {\n            // For dashboard frame we should render error message as frame content.\n            var dashboardViewFrame = jQuery('.dashboardViewFrame');\n            if (dashboardViewFrame.length == 1) {\n                jQuery(document.body).html(ajaxAgent.responseText);\n                var iFrame = jQuery('#' + JRS.fid, window.parent.document);\n                iFrame.removeClass('hidden').show();\n            } else {\n                // In other cases we render error message as popup.\n                showErrorPopup(ajaxAgent.responseText);\n            }\n        }\n        return true;\n    }\n    return false;\n}\n\nfunction errorHandler() {}\nfunction showMessageDialog() {}\n\nexport {\n    showErrorPopup,\n    baseErrorHandler,\n    errorHandler,\n    showMessageDialog\n}","export default \"<iframe class='schedulerOverlayIframe'>\\n    <js-templateNonce></js-templateNonce>\\n</iframe>\\n\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.\n * Licensed pursuant to commercial TIBCO End User License Agreement.\n */\n\nexport default {\n    SCHEDULER_BACK_URL_STORAGE_NAME: 'tibco-jrs-scheduler-back-url',\n    DASHBOARD_SCHEDULAR_IFRAME_MARGIN: 15,\n    DASHBOARD_SCHEDULAR_IFRAME_Z_INDEX: 9999,\n    SCHEDULER_EMPTY:'',\n    DIALOG_DIMMER_IFRAME_Z_INDEX: 5000\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport config from 'js-sdk/src/jrs.configs';\nimport _ from 'underscore';\nimport {redirectToUrl} from \"../../util/utils.common\";\nimport schedulerOverlayIframeTemplate from \"../template/schedulerOverlayIframeTemplate.htm\";\nimport schedulerConstants from './schedulerConstants';\nimport i18n from '../../i18n/all.properties';\n\nexport default {\n    el: $(_.template(schedulerOverlayIframeTemplate, {i18n: i18n})),\n    SCHEDULER_BACK_URL_STORAGE_NAME: schedulerConstants.SCHEDULER_BACK_URL_STORAGE_NAME,\n    getParamsFromUri: function () {\n        var params = {};    // first, let's parse normal query parameters\n        // first, let's parse normal query parameters\n        var parts = document.location.search.substr(1).split('&');\n        _.each(parts, function (part) {\n            var tmp = part.split('='), key = tmp[0], value = tmp[1];\n            if (value === '') {\n                return;\n            }\n            params[key] = decodeURIComponent(value);\n        });    /// then, let's parse hash\n        /// then, let's parse hash\n        var hash = document.location.hash.substr(1);    // get rid of \"runInBackground@\" mark in document.location.hash\n        // get rid of \"runInBackground@\" mark in document.location.hash\n        if (hash.indexOf('runInBackground@') === 0) {\n            hash = hash.replace('runInBackground@', '');\n        }\n        var hashParts = hash.split('@@');\n        params['reportUri'] = hashParts.shift();    // get first element from array\n        // get first element from array\n        _.each(hashParts, function (part) {\n            var tmp = part.split('='), key = tmp[0], value = tmp[1];\n            if (value === '') {\n                return;\n            }\n            params[key] = decodeURIComponent(value);\n        });\n        return params;\n    },\n    saveCurrentLocation: function () {\n        if (document.referrer.indexOf('login.html') === -1) {\n            window.localStorage && localStorage.setItem(this.SCHEDULER_BACK_URL_STORAGE_NAME, encodeURIComponent(document.referrer));\n        }\n    },\n    getBackToPreviousLocation: function () {\n        var currentUrl = encodeURIComponent(document.location.href);\n        var lastUrl = window.localStorage ? localStorage.getItem(this.SCHEDULER_BACK_URL_STORAGE_NAME) : '';\n        if (lastUrl && lastUrl !== currentUrl) {\n            var url = decodeURIComponent(lastUrl);\n            if (url) {\n                redirectToUrl(url);\n                return;\n            }\n        }    // in bad scenario, we need to get to the standard URL\n        // in bad scenario, we need to get to the standard URL\n        redirectToUrl(config.contextPath + '/flow.html?_flowId=searchFlow');\n    },\n    _scheduleDashboard: function _scheduleDashboard(paramsMap, schedulerPage) {\n        _.bindAll(this, '_onWindowResize');\n        $(window).on('resize', this._onWindowResize);\n        let link = config.contextPath + schedulerPage,\n            encode = true,\n            encodeParams = this._serializeParams(paramsMap, encode) ? '?' + this._serializeParams(paramsMap, encode) : '';\n\n        let Url = link + ($.isEmptyObject(paramsMap) ? '' : encodeParams);\n\n        if (schedulerPage) {\n            let body = $('body'),\n                bannerHeight = $(\"body\").find(\"> #banner\").outerHeight(true) || 0;\n\n            this._addDimmer();\n            this.el.attr('src', Url).css({\n                'width': '100%',\n                'height':body.find('> #frame').height() - bannerHeight,\n                'z-index': schedulerConstants.DASHBOARD_SCHEDULAR_IFRAME_Z_INDEX,\n                'position': 'absolute',\n                'top': bannerHeight * 2 + 'px'\n            }).show();\n            body.append(this.el);\n        }\n    },\n    _serializeParams: function _serializeParams(paramsMap, encode) {\n        let result = schedulerConstants.SCHEDULER_EMPTY;\n\n        for (let name in paramsMap) {\n            if (!Object.isUndefined(name)) {\n                result += '&' + name + '=' + (encode ? encodeURIComponent(paramsMap[name]) : paramsMap[name]);\n            }\n        }\n        result = result !== schedulerConstants.SCHEDULER_EMPTY ? result.substring(1) : schedulerConstants.SCHEDULER_EMPTY;\n        return result;\n    },\n    _ParamMapping: function _ParamMapping(paramsMap) {\n        this._scheduleDashboard(paramsMap, '/scheduler/main.html');\n    },\n    _closeScheduleOverlay: function _closeScheduleOverlay() {\n        $('.schedulerAccelerator').slideUp('slow',function () {\n            window.parent.document.getElementsByClassName(\"schedulerOverlayIframe\")[0].hide();\n            window.parent.document.getElementById(\"dialogDimmer\").hide();\n        })\n    },\n    _addDimmer: function () {\n        if (!$('#dialogDimmer').length) {\n            this.$dimmer = $('<div id=\\'dialogDimmer\\' class=\\'dimmer hidden\\' style=\\'z-index:' + schedulerConstants.DIALOG_DIMMER_IFRAME_Z_INDEX + '; display: none;\\'></div>');\n            $('body').append(this.$dimmer);\n        } else {\n            !this.$dimmer && (this.$dimmer = $('#dialogDimmer'));\n        }\n        this.$dimmer.removeClass('hidden').show();\n    },\n    _onWindowResize: function () {\n        let body = $('body'),\n            bannerHeight = $(\"body\").find(\"> #banner\").outerHeight(true) || 0;\n        this.resizeTimer && clearTimeout(this.resizeTimer);\n        this.resizeTimer = setTimeout(_.bind(function () {\n            this.el && this.el.height(body.find('> #frame').height() - bannerHeight);\n            this.el && this.el.width(body.width());\n        }, this), 100);\n    },\n    _detachEvents: function () {\n        $(window).off('resize', this._onWindowResize);\n        this.el.css('display','none');\n    }\n};\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport confirmDialogTemplate from './template/confirmDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.confirmDialogTemplate = options.confirmDialogTemplate || _.template(confirmDialogTemplate);\n        Dialog.prototype.constructor.call(this, {\n            modal: true,\n            additionalCssClasses: options.additionalCssClasses || 'confirmationDialog',\n            title: options.title || i18n['dialog.confirm.title'],\n            content: this.confirmDialogTemplate({ text: options.text }),\n            buttons: [\n                {\n                    label: options.yesLabel || i18n['button.yes'],\n                    action: 'yes',\n                    primary: true\n                },\n                {\n                    label: options.noLabel || i18n['button.no'],\n                    action: 'no',\n                    primary: false\n                }\n            ]\n        });\n    },\n    initialize: function () {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:yes', this.close);\n        this.on('button:no', this.close);\n    },\n    setContent: function (content) {\n        Dialog.prototype.setContent.call(this, this.confirmDialogTemplate({ text: content }));\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar scrollbarWidth = 0;\nexport default {\n    getScrollbarWidth: function () {\n        if (scrollbarWidth) {\n            return scrollbarWidth;\n        }\n        var scrollDiv = document.createElement('div');\n        scrollDiv.style.width = '100px';\n        scrollDiv.style.height = '100px';\n        scrollDiv.style.overflow = 'scroll';\n        scrollDiv.style.position = 'absolute';\n        scrollDiv.style.top = '-9999px';\n        document.body.appendChild(scrollDiv);\n        scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n        document.body.removeChild(scrollDiv);\n        return scrollbarWidth;\n    },\n    hasScrollBar: function (el, direction) {\n        direction = direction === 'vertical' ? 'scrollTop' : 'scrollLeft';\n        var result = !!el[direction];\n        if (!result) {\n            el[direction] = 1;\n            result = !!el[direction];\n            el[direction] = 0;\n        }\n        return result;\n    },\n    isScrollable: function (el) {\n        var style = window.getComputedStyle ? window.getComputedStyle(el) : el.currentStyle;\n        if (!style) {\n            return;\n        }\n        return style.overflow == 'scroll' || style.overflow == 'auto' || style.overflowX == 'scroll' || style.overflowX == 'auto' || style.overflowY == 'scroll' || style.overflowY == 'auto';\n    },\n    getElementOffset: function (el) {\n        var left = 0, top = 0;\n        if (el.offsetParent) {\n            left = el.offsetLeft;\n            top = el.offsetTop;\n            while (el = el.offsetParent) { // jshint ignore: line\n                left += el.offsetLeft;\n                top += el.offsetTop;\n            }\n        }\n        return {\n            left: left,\n            top: top\n        };\n    },\n    getMargins: function ($element) {\n        var values = {\n            top: parseInt($element.css('margin-top'), 10),\n            right: parseInt($element.css('margin-right'), 10),\n            bottom: parseInt($element.css('margin-bottom'), 10),\n            left: parseInt($element.css('margin-left'), 10)\n        };\n        _.each(values, function (ignore, key) {\n            if (isNaN(values[key])) {\n                values[key] = 0;\n            }\n        });\n        return values;\n    },\n    getPaddings: function ($element) {\n        var values = {\n            top: parseInt($element.css('padding-top'), 10),\n            right: parseInt($element.css('padding-right'), 10),\n            bottom: parseInt($element.css('padding-bottom'), 10),\n            left: parseInt($element.css('padding-left'), 10)\n        };\n        _.each(values, function (ignore, key) {\n            if (isNaN(values[key])) {\n                values[key] = 0;\n            }\n        });\n        return values;\n    },\n    disableBackForwordCache: function () {\n        window.onpageshow = function () {\n            if (event.persisted) {\n                window.location.reload();\n            }\n        };\n    }\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n* @author: Igor Nesterenko\n* @version: $Id$\n*/\n\nimport Backbone from 'backbone';\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport popupContainerTemplate from './template/dateTimePopupContainer.htm';\n\nimport logger from \"../../common/logging/logger\";\n\nimport \"../../common/extension/jQueryTimepickerExtension\";\n\nvar DATE_TIME_DEFAULTS = {\n        stepHour: 1,\n        stepMinute: 1,\n        stepSecond: 1,\n        showSecond: true,\n        changeMonth: true,\n        changeYear: true,\n        showButtonPanel: true,\n        onChangeMonthYear: null,\n        constrainInput: false\n    },\n    TIME_DEFAULTS = {\n        showSecond:true,\n        constrainInput:false\n    };\n\nlet log = logger.register(\"DateAndTimePicker\");\n\n$.timepicker.log = function (err) {\n    //redirect error messages to our logger\n    log.warn(err);\n};\n\nexport default Backbone.View.extend({\n\n    /**\n     * @constructor DateAndTimePicker\n     * @class DateAndTimePicker\n     * @classdesc DateAndTimePicker decorator over jQuery datetime pickers\n     * @extends Backbone.View\n     * @param {object} options - mixin on Backbone standard properties and jQuery datetime pickers\n     * @description - You have to pass 'el' property to point to element in DOM. We have next behaviour\n     *  - by default it renders with  datetimepicker\n     *  - if only `dateFormat` it renders with datepicker\n     *  - if only `timeFormat` it renders with  timepicker\n     *  - if `dateFormat` and `timeFormat` specified it renders with datetimepicker\n     */\n\n    constructor: function (options) {\n        this.pickerOptions = _.clone(options);\n\n        if (this.pickerOptions.hasOwnProperty(\"dateFormat\") && !_.isString(this.pickerOptions.dateFormat)) {\n            delete this.pickerOptions.dateFormat;\n        }\n        if (this.pickerOptions.hasOwnProperty(\"timeFormat\") && !_.isString(this.pickerOptions.timeFormat)) {\n            delete this.pickerOptions.timeFormat;\n        }\n\n        this.inline = !!this.pickerOptions.el || false;\n        this.skipMoving = this.pickerOptions.skipMoving || false;\n        //clean up from backbone props\n        delete this.pickerOptions.el;\n        delete this.pickerOptions.skipMoving;\n\n        this.pickerType = discoverPickerType(this.pickerOptions);\n\n        this.pickerOptions = provideDefaultPickerOptions(this.pickerOptions, this.pickerType);\n\n        this.pickerOptions = fixPopupPositionAndStyling(this.pickerOptions, this.skipMoving);\n\n        this.log = options.log ? options.log : log;\n\n        Backbone.View.apply(this, arguments);\n    },\n\n    initialize: function () {\n        var self = this;\n\n        //initialize picker\n        this.$el[this.pickerType](this.pickerOptions);\n\n        this._callPickerAction = function (options) {\n            self.$el[self.pickerType](options);\n        }\n    },\n\n    /**\n     * @return {Date} - standart date object\n     * @description Return Date if components has it\n     */\n\n    getDate: function(){\n        var date;\n\n        if (this.pickerType !== \"timepicker\"){\n            date = this.$el[this.pickerType].getDate();\n        }else{\n            date = this.$el[this.pickerType].getTime();\n        }\n        return date;\n    },\n\n    /**\n     * @params {Date|String} date\n     * @return this\n     */\n\n    setDate: function(date){\n\n        if (!date) return this;\n\n        try{\n            //try to convert string to date object\n            // we don't need to convert time because setTime method accepts string time format\n            if (_.isString(date)){\n                if (this.pickerType === \"datetimepicker\") {\n                    date = $.datepicker.parseDateTime(this.pickerOptions.dateFormat, this.pickerOptions.timeFormat,  date);\n                } else if (this.pickerType === \"datepicker\") {\n                    date = $.datepicker.parseDate(this.pickerOptions.dateFormat, date);\n                }\n            }\n\n            if (this.pickerType === \"datepicker\"){\n                this.$el[this.pickerType](\"setDate\", date);\n            }else if (this.pickerType === \"timepicker\") {\n                this.$el[this.pickerType](\"setTime\", date);\n            }else if (this.pickerType === \"datetimepicker\"){\n                this.$el[this.pickerType](\"setTime\", date);\n                this.$el[this.pickerType](\"setDate\", date);\n            }\n\n        }catch(err){\n            this.log.debug(err);\n        }\n        return this;\n    },\n\n    /**\n     * @description Show picker\n     */\n\n    show: function () {\n        this._callPickerAction(\"show\");\n        return this;\n    },\n\n    /**\n     * @description Hide picker\n     */\n\n    hide: function () {\n        this._callPickerAction(\"hide\");\n        return this;\n    },\n\n    remove: function () {\n        this._callPickerAction(\"destroy\");\n        if (this.inline) {\n            this.$el.empty().off();\n            this.stopListening();\n        } else {\n            Backbone.View.prototype.remove.apply(this, arguments);\n        }\n\n    }\n\n}, {\n\n    /**\n     * @param {object} configs - which should contains 'locale', configs for 'date' amd configs for 'time'\n     * @description Provide defaults for locale specific configuration\n     */\n\n    setDefaults : function(configs){\n        $.datepicker.regional[configs.locale] = configs.date;\n        $.datepicker.setDefaults(configs.date);\n        $.timepicker.setDefaults(configs.time);\n    },\n\n    Helpers : {\n\n        fixPopupPositionAndStyling: fixPopupPositionAndStyling,\n\n        movePickerRelativelyToTriggerIcon: movePickerRelativelyToTriggerIcon,\n\n        stylePopupContainer: stylePopupContainer,\n\n        discoverPickerType: discoverPickerType,\n\n        provideDefaultPickerOptions: provideDefaultPickerOptions\n    }\n});\n\nfunction discoverPickerType(options) {\n    var result = \"datetimepicker\";\n    if (options.dateFormat && options.timeFormat) {\n        return result;\n    } else if (options.dateFormat) {\n        result = \"datepicker\"\n    } else if (options.timeFormat) {\n        result = \"timepicker\"\n    }\n    return result;\n}\n\nfunction provideDefaultPickerOptions(options, type){\n\n    var result = options;\n\n    if (\"datetimepicker\" == type || \"datepicker\" == type){\n        result = _.defaults(options, DATE_TIME_DEFAULTS);\n    }else if(\"timepicker\" == type){\n        result = _.defaults(options, TIME_DEFAULTS)\n    }\n\n    return result;\n}\n\nfunction fixPopupPositionAndStyling(options, skipMoving) {\n\n    var originalBeforeShowFn = options.beforeShow;\n\n    options.beforeShow = function () {\n        stylePopupContainer.apply(this, arguments);\n        skipMoving || movePickerRelativelyToTriggerIcon.apply(this, arguments);\n        originalBeforeShowFn && originalBeforeShowFn.apply(this, arguments);\n    };\n\n    options.afterInject = function() {\n        stylePopupContainer.apply(this, [this.$input[0], this.inst]);\n    };\n\n    return options;\n}\n\nfunction movePickerRelativelyToTriggerIcon(input, inst) {\n    var offset = $(input).offset().left;\n    var width = parseFloat(inst.dpDiv.css(\"width\").replace(\"px\", \"\"));\n    var move = offset + input.offsetWidth + width < $(window).width();\n    inst.dpDiv.css({\n        marginLeft: move ? input.offsetWidth + \"px\" : 0\n    });\n}\n\nfunction stylePopupContainer(input, inst) {\n    var $popupContainer = inst.dpDiv,\n        $parent = $popupContainer.parent(),\n        $dpDiv;\n\n    if ($parent && $parent.is('body')) {\n        $dpDiv = $popupContainer.detach();\n        $popupContainer = $(popupContainerTemplate);\n        $popupContainer.append($dpDiv);\n        $('body').append($popupContainer);\n    }\n}\n","export default \"<div class=\\\"jr-jDatepickerPopupContainer jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n\";","export default \"<p class='confirmationText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{ print(_.xssSoftEscape(text)) }}\\n</p>\";","\n        import {store, MERGED_BUNDLES_NAME} from 'bundleStore';\n        \n        let bundle;\n        \n        if ('all' !== MERGED_BUNDLES_NAME) {\n            store['all'] = store['all'] || {};\n            bundle = store['all'];\n        } else {\n            bundle = Object.keys(store).reduce((acc, key) => {\n                return {\n                    ...acc,\n                    ...store[key]\n                }\n            }, {});\n        }\n                                     \n        export default bundle;\n    "],"sourceRoot":""}