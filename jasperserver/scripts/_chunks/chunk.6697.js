(self.webpackChunkjrs_ui=self.webpackChunkjrs_ui||[]).push([[6697],{6697:(e,t,i)=>{"use strict";i.r(t);var n=i(97836),o=i.n(n),a=i(71914),s=i(17620),r=i(41447),l=i(64155),d=i(10165),c=i(72157),u=i.n(c);const _={STEP1_PAGE_ID:"addResource_query_step1",STEP2_PAGE_ID:"addResource_locateDataSource",STEP3_PAGE_ID:"addResource_query_step3",LABEL_ID:"query.label",RESOURCE_ID_ID:"query.name",DESCRIPTION_ID:"query.description",JUMP_TO_PAGE_ID:"jumpToPage",DONE_BUTTON_ID:"done",NEXT_BUTTON_ID:"next",JUMP_TO_BUTTON_ID:"jumpButton",NEW_DATA_SOURCE_LINK_ID:"newDataSourceLink",LOCAL_DATA_SOURCE_ID:"LOCAL",RESOURCE_URI_INPUT_ID:"resourceUri",QUERY_SQL:"query.sql",_canGenerateId:!0,initialize:function(e){this._step1Page=u()("#"+this.STEP1_PAGE_ID)[0],this._step2Page=u()("#"+this.STEP2_PAGE_ID)[0],this._step3Page=u()("#"+this.STEP3_PAGE_ID)[0],this._step1Page&&(this._form=u()(document.body).find("form")[0],this._label=document.getElementById(this.LABEL_ID),this._resourceId=document.getElementById(this.RESOURCE_ID_ID),this._description=document.getElementById(this.DESCRIPTION_ID),this._label.validator=s.Z.labelValidator.bind(this),this._resourceId.validator=s.Z.resourceIdValidator.bind(this),this._description.validator=s.Z.descriptionValidator.bind(this)),this._step2Page&&(this._form=u()(document.body).find("form")[0],this._dataSourceUri=document.getElementById(this.RESOURCE_URI_INPUT_ID),this._dataSourceUri.validator=s.Z.dataSourceValidator.bind(this)),this._step3Page&&(this._form=u()(document.body).find("form")[0],this._query=document.getElementById(this.QUERY_SQL),this._query.validator=s.Z.queryValidator.bind(this)),this._nextButton=u()("#"+this.NEXT_BUTTON_ID),this._doneButton=u()("#"+this.DONE_BUTTON_ID),this._jumpToPage=u()("#"+this.JUMP_TO_PAGE_ID)[0],this._jumpButton=u()("#"+this.JUMP_TO_BUTTON_ID)[0],this._newDataSourceLink=u()("#"+this.NEW_DATA_SOURCE_LINK_ID)[0],this._localDataSource=u()("#"+this.LOCAL_DATA_SOURCE_ID)[0],this._isEditMode=!!e&&e.isEditMode,r.Z.initialize({resourceInput:"resourceUri",browseButton:"browser_button",newResourceLink:"newDataSourceLink",treeId:"queryTreeRepoLocation",providerId:"dsTreeDataProvider",dialogTitle:s.Z.messages["resource.Query.Title"],selectLeavesOnly:!0}),this._initEvents()},_initEvents:function(){if(this._nextButton.on("click",function(e){this._isDataValid()||e.stopPropagation(),this._localDataSource&&this._localDataSource.checked&&(e.preventDefault(),e.stopPropagation(),this._newDataSourceLink.click())}.bind(this)),this._doneButton.on("click",function(e){this._isDataValid()||e.preventDefault()}.bind(this)),u()(this._form).on("keyup",function(e){var t=e.target;t==this._resourceId&&this._resourceId.getValue()!=s.Z.generateResourceId(this._label.getValue())&&(this._canGenerateId=!1),t==this._label&&!this._isEditMode&&this._canGenerateId&&(this._resourceId.setValue(s.Z.generateResourceId(this._label.getValue())),l.n4K.validate(s.Z.getValidationEntries([this._resourceId])))}.bind(this)),this._newDataSourceLink){var e=this;this._newDataSourceLink.observe("click",function(t){if(e._localDataSource.checked){var i=a.Z.addDataSource?o().clone(a.Z.addDataSource.initOptions):{};i.saveFn=function(t,i){t.type=i.type;var n=document.createElement("input");n.type="hidden",n.name="dataSourceJson",n.value=JSON.stringify(o().extend(i.toJSON(),{name:t.name})),e._form.appendChild(n),(n=document.createElement("input")).type="hidden",n.name="dataSourceType",n.value=i.type,e._form.appendChild(n),(n=document.createElement("input")).type="hidden",n.name="_eventId_saveDatasource",e._form.appendChild(n),e._form.submit()},i.cancelFn=function(){e._form.submit()},i.skipLocation=!0,window.localContext&&window.localContext.initOptions&&window.localContext.initOptions&&(window.localContext.initOptions.dataSourceJson?(i.isEditMode=!0,i.dataSource=window.localContext.initOptions.dataSourceJson,i.dataSourceClientType=window.localContext.initOptions.dataSourceJson.type):window.localContext.initOptions.dataSourceUri&&(i.isEditMode=!0,i.resourceUri=window.localContext.initOptions.dataSourceUri));var n=new d.Z(i);u()("#display").append(n.$el),u()("#selectFromRepository").remove(),n.render()}}.bindAsEventListener(this))}},_isDataValid:function(){var e=!0;return this._label&&(e=e&&l.n4K.validate(s.Z.getValidationEntries([this._label]))),this._resourceId&&(this._resourceId.getValue()!=s.Z.generateResourceId(this._label.getValue())&&(this._canGenerateId=!1),!this._isEditMode&&this._canGenerateId&&(this._resourceId.setValue(s.Z.generateResourceId(this._label.getValue())),e=e&&l.n4K.validate(s.Z.getValidationEntries([this._resourceId])))),this._description&&(e=e&&l.n4K.validate(s.Z.getValidationEntries([this._description]))),this._dataSourceUri&&!this._dataSourceUri.disabled&&(e=e&&l.n4K.validate(s.Z.getValidationEntries([this._dataSourceUri]))),this._query&&(e=e&&l.n4K.validate(s.Z.getValidationEntries([this._query]))),e},jumpTo:function(e){return this._jumpToPage.setValue(e),this._jumpButton.click(),!1}};var h=a.Z.addQuery.localContext.initOptions;o().extend(window.localContext,a.Z.addQuery.localContext),o().extend(s.Z.messages,a.Z.addQuery.resource.messages),_.initialize(h),a.Z.addQuery.buttonFlowControls&&(u()("#steps1_2").on("click",(function(){return _.jumpTo("reportNaming")})),u()("#step3").on("click",(function(){return _.jumpTo("resources")})),u()("#step4").on("click",(function(){return _.jumpTo("dataSource")})),u()("#step5").on("click",(function(){return _.jumpTo("query")})),u()("#step6").on("click",(function(){return _.jumpTo("customization")}))),(0,l.zcy)()&&s.Z.initSwipeScroll()},41447:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var n=i(72157),o=i.n(n),a=i(97836),s=i.n(a),r=i(17620),l=i(32758),d={CONTENT_REPOSITORY:"CONTENT_REPOSITORY",LOCAL:"LOCAL",NONE:"NONE",FILE_SYSTEM:"FILE_SYSTEM",LOCATE_EVENT:"resource:locate",ALLOWED_FILE_RESOURCE_EXTENSIONS:["css","ttf","jpg","jpeg","gif","bmp","png","jar","jrxml","properties","jrtx","xml","agxml","docx","doc","ppt","pptx","xls","xlsx","ods","odt","odp","pdf","rtf","html"],initialize:function(e){var t=function(e){return s().isObject(e)?e:o()("#"+e)[0]};this.resourceUri=t(e.resourceInput),this.browseButton=t(e.browseButton),this.filePath=t(e.fileUploadInput),this.fakeFilePath=t(e.fakeFileUploadInput),this.fakeFileInput=t(e.fakeFileUploadInputText),this.newResourceLink=t(e.newResourceLink);try{this._initFileSelector(e)}catch(e){}finally{this._initEvents(e)}return this},_initEvents:function(e){o()(document).on("click","#CONTENT_REPOSITORY, #FILE_SYSTEM, #NONE, #LOCAL",this._clickHandler),"fileResourceTreeDataProvider"===e.providerId&&(o()("#next").on("click",d._nextClickHandler),o()("#filePath").on("change",d._uploadChangeHandler))},_nextClickHandler:function(e){o()("#fileUpload").hasClass("error")&&e.preventDefault()},_uploadChangeHandler:function(e){o()("#fileUpload").removeClass("error");var t=!0;if(o()("#filePath")[0].value){var i=o()("#filePath")[0].value.match(/.*\.([^\.]+)$/);if(i){var n=i[1];s().indexOf(d.ALLOWED_FILE_RESOURCE_EXTENSIONS,n)<0&&(t=!1)}else t=!1}else t=!1;if(!t){var a=r.Z.messages["resource.report.unsupportedFileType.error"]+" "+d.ALLOWED_FILE_RESOURCE_EXTENSIONS.join(", ");o()("#fileUpload").addClass("error").find("span.warning").html(a)}},_clickHandler:function(e){d._updateResourceSelectorState(e.target.id)},_updateResourceSelectorState:function(e){r.Z.switchButtonState(this.filePath,e===this.FILE_SYSTEM),r.Z.switchButtonState(this.fakeFilePath,e===this.FILE_SYSTEM),r.Z.switchButtonState(this.fakeFileInput,e===this.FILE_SYSTEM),r.Z.switchButtonState(this.browseButton,e===this.CONTENT_REPOSITORY),r.Z.switchDisableState(this.resourceUri,e!==this.CONTENT_REPOSITORY);var t=e===this.LOCAL?["disabled","launcher"]:[];this._switchElementClasses(this.newResourceLink,t)},_initFileSelector:function(e){this.fileSelector=new l.Z.FileSelector(s().extend({},e,{uriTextboxId:this.resourceUri,browseButtonId:this.browseButton,title:e.dialogTitle}))},remove:function(e){this.fileSelector.remove()},_switchElementClasses:function(e,t){e&&t&&o()(e).removeClass(t[0]).addClass(t[1])}};const c=d}}]);
//# sourceMappingURL=chunk.6697.js.map