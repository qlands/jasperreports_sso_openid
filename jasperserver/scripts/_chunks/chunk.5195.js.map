{"version":3,"sources":["webpack://jrs-ui/./src/resource/resource.locate.js","webpack://jrs-ui/./src/resource/resource.add.files.js","webpack://jrs-ui/./src/addResource/fileResource/addFileResource.common.js"],"names":["resourceLocator","CONTENT_REPOSITORY","LOCAL","NONE","FILE_SYSTEM","LOCATE_EVENT","ALLOWED_FILE_RESOURCE_EXTENSIONS","initialize","options","get","element","_","jQuery","this","resourceUri","resourceInput","browseButton","filePath","fileUploadInput","fakeFilePath","fakeFileUploadInput","fakeFileInput","fakeFileUploadInputText","newResourceLink","_initFileSelector","e","_initEvents","document","on","_clickHandler","providerId","_nextClickHandler","_uploadChangeHandler","event","hasClass","preventDefault","removeClass","validFileName","value","match","extension","message","resource","join","addClass","find","html","_updateResourceSelectorState","target","id","classes","_switchElementClasses","fileSelector","picker","uriTextboxId","browseButtonId","title","dialogTitle","remove","PAGE_ID","TYPE_ID","PATH_ID","LABEL_ID","RESOURCE_ID_ID","DESCRIPTION_ID","FOLDER_URI_ID","SAVE_BUTTON_ID","typeToExtMap","_canGenerateId","_form","_type","_path","_label","_resourceId","_description","_folderUri","_saveButton","_isEditMode","isEditMode","validationEntry","validator","_typeValidator","bind","onValid","_manual","fileName","_getFileNameFromPath","getValue","readOnly","_pathValidator","treeId","_isDataValid","bindAsEventListener","_validateTypeAndPath","Form","blank","buttonManager","include","ValidationModule","setValue","matchAny","keyCode","focus","elementsToValidate","result","isValid","errorMessage","_getExtension","_getTypesForExtension","types","type","toLowerCase","push","filename","dotPosition","lastIndexOf","substr","path","startPos","substring","length","jrsConfigs","window","localContext","addFileResource","isIPad"],"mappings":"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","file":"_chunks/chunk.5195.js","sourcesContent":["/*\r\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\r\n * http://www.jaspersoft.com.\r\n *\r\n * Unless you have purchased a commercial license agreement from Jaspersoft,\r\n * the following license terms apply:\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Affero General Public License as\r\n * published by the Free Software Foundation, either version 3 of the\r\n * License, or (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r\n * GNU Affero General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\r\n */\r\n\r\n\r\n/**\r\n * @version: $Id$\r\n */\r\n\r\nimport jQuery from 'jquery';\r\nimport _ from 'underscore';\r\nimport resource from './resource.base';\r\nimport picker from '../components/components.pickers';\r\n\r\nvar resourceLocator = {\r\n    CONTENT_REPOSITORY : 'CONTENT_REPOSITORY',\r\n    LOCAL : 'LOCAL',\r\n    NONE : 'NONE',\r\n    FILE_SYSTEM : 'FILE_SYSTEM',\r\n    LOCATE_EVENT : 'resource:locate',\r\n    ALLOWED_FILE_RESOURCE_EXTENSIONS: [\r\n        \"css\", //css\r\n        \"ttf\", //font\r\n        \"jpg\", \"jpeg\", \"gif\", \"bmp\", \"png\", //img\r\n        \"jar\", //jar\r\n        \"jrxml\", //jrxml\r\n        \"properties\", //properties\r\n        \"jrtx\", //jrtx\r\n        \"xml\", \"agxml\", //xml\r\n        \"docx\", \"doc\", \"ppt\", \"pptx\", \"xls\", \"xlsx\", \"ods\", \"odt\", \"odp\", \"pdf\", \"rtf\", \"html\" //contentResource\r\n    ],\r\n\r\n    /*\r\n     * Initializes Resource Locator common logic.\r\n     * @param options Object with following properties:\r\n     *     options = {\r\n     *          fileUploadInput : 'filePath',\r\n     *          resourceInput : 'resourceUri',\r\n     *          browseButton : 'browser_button',\r\n     *          newResourceLink : 'link_id',\r\n     *          treeId : 'resourceBrowserTreeId',\r\n     *          providerId : 'treeProviderId',\r\n     *          dialogTitle : 'Select Resource From Repository'\r\n     *      }\r\n     *\r\n     */\r\n    initialize: function(options) {\r\n        var get = function(element) {\r\n            return _.isObject(element) ? element : jQuery('#' + element)[0];\r\n        };\r\n\r\n        this.resourceUri = get(options.resourceInput);\r\n        this.browseButton = get(options.browseButton);\r\n        this.filePath = get(options.fileUploadInput);\r\n        this.fakeFilePath = get(options.fakeFileUploadInput);\r\n        this.fakeFileInput = get(options.fakeFileUploadInputText);\r\n        this.newResourceLink = get(options.newResourceLink);\r\n\r\n        try {\r\n            this._initFileSelector(options);\r\n        } catch(e) {\r\n            /* bypass logging to console */\r\n        } finally {\r\n            this._initEvents(options);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    _initEvents: function(options) {\r\n        jQuery(document).on(\"click\", \"#CONTENT_REPOSITORY, #FILE_SYSTEM, #NONE, #LOCAL\", this._clickHandler);\r\n        if (options.providerId === \"fileResourceTreeDataProvider\") {\r\n            jQuery(\"#next\").on(\"click\", resourceLocator._nextClickHandler);\r\n            jQuery(\"#filePath\").on(\"change\", resourceLocator._uploadChangeHandler);\r\n        }\r\n    },\r\n\r\n    _nextClickHandler: function(event) {\r\n        if (jQuery(\"#fileUpload\").hasClass(\"error\")) {\r\n            event.preventDefault();\r\n        }\r\n    },\r\n\r\n    _uploadChangeHandler: function(event) {\r\n        jQuery(\"#fileUpload\").removeClass(\"error\");\r\n\r\n        var validFileName = true;\r\n\r\n        var fileName = jQuery(\"#filePath\")[0].value;\r\n        if (fileName) {\r\n            var match = jQuery(\"#filePath\")[0].value.match(/.*\\.([^\\.]+)$/);\r\n            if (match) {\r\n                var extension = match[1];\r\n                if (_.indexOf(resourceLocator.ALLOWED_FILE_RESOURCE_EXTENSIONS, extension) < 0) {\r\n                    validFileName = false;\r\n                }\r\n            } else {\r\n                validFileName = false;\r\n            }\r\n        } else {\r\n            validFileName = false;\r\n        }\r\n\r\n        if (!validFileName) {\r\n            var message =\r\n                resource.messages['resource.report.unsupportedFileType.error'] +\r\n                    \" \" +resourceLocator.ALLOWED_FILE_RESOURCE_EXTENSIONS.join(\", \");\r\n\r\n            jQuery(\"#fileUpload\").addClass(\"error\").find(\"span.warning\")\r\n                .html(message);\r\n        }\r\n    },\r\n\r\n    _clickHandler : function(event) {\r\n        resourceLocator._updateResourceSelectorState(event.target.id);\r\n    },\r\n\r\n    _updateResourceSelectorState : function(id) {\r\n        // Update File upload component state.\r\n        resource.switchButtonState(this.filePath, id === this.FILE_SYSTEM);\r\n        resource.switchButtonState(this.fakeFilePath, id === this.FILE_SYSTEM);\r\n        resource.switchButtonState(this.fakeFileInput, id === this.FILE_SYSTEM);\r\n        // Update Resource selector component state: button + text input.\r\n        resource.switchButtonState(this.browseButton, id === this.CONTENT_REPOSITORY);\r\n        resource.switchDisableState(this.resourceUri, id !== this.CONTENT_REPOSITORY);\r\n        // Update Create new resource link state.\r\n        var classes = id === this.LOCAL ? ['disabled', 'launcher'] : [];\r\n        this._switchElementClasses(this.newResourceLink, classes);\r\n    },\r\n\r\n    _initFileSelector : function(options) {\r\n        this.fileSelector = new picker.FileSelector(_.extend({}, options, {\r\n            uriTextboxId: this.resourceUri,\r\n            browseButtonId: this.browseButton,\r\n            title: options.dialogTitle\r\n        }));\r\n    },\r\n\r\n    remove : function(options) {\r\n        this.fileSelector.remove();\r\n    },\r\n\r\n    ///////////////////////////\r\n    // Utility methods.\r\n    ///////////////////////////\r\n    _switchElementClasses : function(element, classes) {\r\n        element && classes && jQuery(element).removeClass(classes[0]).addClass(classes[1]);\r\n    }\r\n};\r\n\r\nexport default resourceLocator;\r\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\nimport {Form} from 'prototype';\nimport jQuery from 'jquery';\nimport resource from './resource.base';\nimport {ValidationModule, matchAny} from \"../util/utils.common\";\nimport buttonManager from '../core/core.events.bis';\nimport resourceLocator from './resource.locate';\n\nvar addFileResource = {\n    PAGE_ID: 'addResourceFile',\n    TYPE_ID: 'fileType',\n    PATH_ID: 'filePath',\n    LABEL_ID: 'addFileInputResourceLabelID',\n    RESOURCE_ID_ID: 'addFileInputResourceID',\n    DESCRIPTION_ID: 'addFileInputDescription',\n    FOLDER_URI_ID: 'folderUri',\n    SAVE_BUTTON_ID: 'save',\n    typeToExtMap: {\n        'accessGrantSchema': ['xml'],\n        'css': ['css'],\n        'font': ['ttf'],\n        'img': [\n            'jpg',\n            'jpeg',\n            'gif',\n            'bmp',\n            'png'\n        ],\n        'jar': ['jar'],\n        'jrxml': ['jrxml'],\n        'olapMondrianSchema': ['xml'],\n        'prop': ['properties'],\n        'jrtx': ['jrtx'],\n        'xml': [\n            'xml',\n            'agxml'\n        ],\n        'config': ['config'],\n        'cer': [\n            'p12',\n            'pfx'\n        ],\n        'contentResource': [\n            'docx',\n            'doc',\n            'ppt',\n            'pptx',\n            'xls',\n            'xlsx',\n            'ods',\n            'odt',\n            'odp',\n            'pdf',\n            'rtf',\n            'html',\n            'txt',\n            'csv',\n            'json'\n        ],\n        'secureFile': ['*'],\n        'mongoDbSchema': ['*'],\n        'key': ['key'],\n        'pub': ['pub'],\n        'ppk': ['ppk']\n    },\n    _canGenerateId: true,\n    initialize: function (options) {\n        this._form = jQuery('#' + this.PAGE_ID).find('form')[0];\n        this._type = jQuery('#' + this.TYPE_ID)[0];\n        this._path = jQuery('#' + this.PATH_ID)[0];\n        this._label = jQuery('#' + this.LABEL_ID)[0];\n        this._resourceId = jQuery('#' + this.RESOURCE_ID_ID)[0];\n        this._description = jQuery('#' + this.DESCRIPTION_ID)[0];\n        this._folderUri = jQuery('#' + this.FOLDER_URI_ID)[0];\n        this._saveButton = jQuery('#' + this.SAVE_BUTTON_ID)[0];\n        this._isEditMode = options.isEditMode;\n        this._type.validationEntry = {\n            validator: this._typeValidator.bind(this),\n            element: this._type,\n            onValid: function () {\n                if (!this._manual) {\n                    var fileName = this._getFileNameFromPath(this._path.getValue());\n                    this._label.value = fileName;\n                    if (!this._resourceId.readOnly) {\n                        this._resourceId.value = resource.generateResourceId(this._label.getValue());\n                    }\n                }\n            }.bind(this)\n        };\n        this._path.validator = this._pathValidator.bind(this);\n        this._label.validator = resource.labelValidator.bind(this);\n        this._resourceId.validator = resource.resourceIdValidator.bind(this);\n        this._description.validator = resource.descriptionValidator.bind(this);\n        resourceLocator.initialize({\n            resourceInput: 'folderUri',\n            browseButton: 'browser_button',\n            treeId: 'addFileTreeRepoLocation',\n            providerId: 'repositoryExplorerTreeFoldersProvider',\n            dialogTitle: resource.messages['resource.Add.Files.Title']\n        });\n        this._initEvents();\n    },\n    _initEvents: function () {\n        jQuery(this._saveButton).on('click', function (e) {\n            if (!this._isDataValid()) {\n                e.preventDefault();\n            }\n        }.bindAsEventListener(this));\n        jQuery(this._type).on('change', function (e) {\n            this._validateTypeAndPath();\n        }.bind(this));\n        jQuery(this._path).on('change', function (e) {\n            this._validateTypeAndPath();\n        }.bind(this));\n        this._form && new Form.Observer(this._form, 0.3, function () {\n            if (this._folderUri.getValue().blank()) {\n                buttonManager.disable('#save');\n            } else {\n                buttonManager.enable('#save');\n            }\n        }.bindAsEventListener(this));\n        jQuery(this._form).on('keyup', function (e) {\n            var element = e.target;\n            var targetElements = [\n                this._label,\n                this._resourceId,\n                this._description\n            ];\n            if (targetElements.include(element)) {\n                ValidationModule.validate(resource.getValidationEntries([element]));\n                if (element == this._resourceId && this._resourceId.getValue() != resource.generateResourceId(this._label.getValue())) {\n                    this._canGenerateId = false;\n                }\n                if (element == this._label && !this._isEditMode && this._canGenerateId) {\n                    this._resourceId.setValue(resource.generateResourceId(this._label.getValue()));\n                    ValidationModule.validate(resource.getValidationEntries([this._resourceId]));\n                }\n            }\n            this._manual = true;\n        }.bindAsEventListener(this));\n        jQuery(this._form).on('keydown', function (e) {\n            var targetElement = matchAny(e.target, ['#' + this.DESCRIPTION_ID], true);\n            if (!targetElement) {\n                if (e.keyCode == 13) {\n                    this._saveButton.focus();\n                }\n            }\n        }.bind(this));\n    },\n    _isDataValid: function () {\n        var elementsToValidate = [\n            this._label,\n            this._resourceId,\n            this._description,\n            this._path,\n            this._type\n        ];\n        return ValidationModule.validate(resource.getValidationEntries(elementsToValidate));\n    },\n    _validateTypeAndPath: function () {\n        var elementsToValidate = [\n            this._type,\n            this._path\n        ];\n        ValidationModule.validate(resource.getValidationEntries(elementsToValidate));\n    },\n    _typeValidator: function (value) {\n        var isValid = true;\n        var errorMessage = '';\n        var result = {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n        var extension = this._getExtension();\n        if (extension.blank()) {\n            return result;\n        }\n        if (this.typeToExtMap[value] && this.typeToExtMap[value].include('*')) {\n            return result;\n        }\n        var types = this._getTypesForExtension(extension);\n        if (!types.include(value)) {\n            result.errorMessage = resource.messages['typeIsNotValid'];\n            result.isValid = false;\n        }\n        return result;\n    },\n    _pathValidator: function (value) {\n        var isValid = true;\n        var errorMessage = '';\n        if (!this._isEditMode && value.blank()) {\n            errorMessage = resource.messages['pathIsEmpty'];\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    _getTypesForExtension: function (extension) {\n        var types = [];\n        for (var type in this.typeToExtMap) {\n            if (this.typeToExtMap[type] && this.typeToExtMap[type].include(extension.toLowerCase())) {\n                types.push(type);\n            }\n        }\n        return types;\n    },\n    _getExtension: function () {\n        var filename = this._path.getValue();\n        if (filename.blank()) {\n            return '';\n        }\n        var dotPosition = filename.lastIndexOf('.');\n        if (dotPosition == -1) {\n            return '';\n        }\n        return filename.substr(dotPosition + 1);\n    },\n    _getFileNameFromPath: function (path) {\n        var startPos = path.lastIndexOf('\\\\') > 0 ? path.lastIndexOf('\\\\') + 1 : 0;\n        return path.substring(startPos, path.length);\n    }\n};\n\nexport default addFileResource;","/*\n * Copyright (C) 2005 - 2019 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport addFileResource from '../../resource/resource.add.files';\nimport _ from 'underscore';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport resource from '../../resource/resource.base';\nimport {isIPad} from \"../../util/utils.common\";\n\nvar options = jrsConfigs.addFileResource.localContext.initOptions;\n_.extend(window.localContext, jrsConfigs.addFileResource.localContext);\n_.extend(resource.messages, jrsConfigs.addFileResource.resource.messages);\naddFileResource.initialize(options);\nisIPad() && resource.initSwipeScroll();\n"],"sourceRoot":""}