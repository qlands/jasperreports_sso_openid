{"version":3,"sources":["webpack://jrs-ui/./src/components/components.toolbarButtons.events.js","webpack://jrs-ui/./src/components/components.toolbarButtons.js","webpack://jrs-ui/./src/manage/mng.common.js","webpack://jrs-ui/./src/manage/mng.org.module.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/AlertDialog.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/alertDialogTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/confirmDialogTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/dialog/ConfirmationDialog.js","webpack://jrs-ui/../js-sdk/src/common/util/domUtil.js","webpack://jrs-ui/./src/repository/repository.search.main.js","webpack://jrs-ui/./src/repository/repository.search.actions.js","webpack://jrs-ui/./src/tenantImportExport/export/view/ExportDialogView.js","webpack://jrs-ui/./src/repository/repository.search.components.js","webpack://jrs-ui/./src/repository/repository.search.root.js","webpack://jrs-ui/./src/components/components.dependent.dialog.js","webpack://jrs-ui/./src/repository/repository.common.js","webpack://jrs-ui/./src/settings/settingsStore.js","webpack://jrs-ui/./src/util/tools.infiniteScroll.js","webpack://jrs-ui/../js-sdk/src/common/extension/backboneValidationExtension.js","webpack://jrs-ui/../js-sdk/src/common/extension/customEventExtension.js","webpack://jrs-ui/../js-sdk/src/common/enum/httpStatusCodes.js","webpack://jrs-ui/../js-sdk/src/common/enum/errorCodes.js","webpack://jrs-ui/../js-sdk/src/common/model/BaseModel.js","webpack://jrs-ui/../js-sdk/src/common/util/parse/NumberUtils.js"],"names":["toolbarButtonModule","actionMap","jQuery","on","evt","this","prop","type","substring","toUpperCase","isFirefox","each","index","li","css","el","execFunction","className","indexOf","id","getAsFunction","executableFunction","stopPropagation","buttonManager","originalEvent","UP","DOWN","OVER","DISABLED","PRESSED","CONTENT_PREFIX","MenuClass","TOOLBAR_MENU_CLASS","ACTION_MODEL_TAG","CAPSULE_PATTERN","showButtonMenu","event","object","context","attr","model","actionModel","setActionModel","newActionModel","isToolBarButton","button","hasClass","enable","disable","setButtonState","RegExpRepresenter","expression","charMap","expressionTokens","__parse","Object","assign","orgModule","TREE_ID","COOKIE_NAME","messages","ActionMap","SEARCH","BROWSE","NEXT","SELECT_AND_GET_DETAILS","SEARCH_AVAILABLE","SEARCH_ASSIGNED","NEXT_AVAILABLE","NEXT_ASSIGNED","CREATE","UPDATE","DELETE","DELETE_ALL","EXIST","Event","ORG_BROWSE","ENTITY_SEARCH","ENTITY_NEXT","ENTITY_SELECT_AND_GET_DETAILS","RESULT_CHANGED","RESULT_NEXT","ENTITY_DETAILS_LOADED","SEARCH_AVAILABLE_LOADED","SEARCH_ASSIGNED_LOADED","NEXT_AVAILABLE_LOADED","NEXT_ASSIGNED_LOADED","SERVER_ERROR","SERVER_UNAVAILABLE","ENTITY_CREATED","ENTITY_UPDATED","ENTITY_DELETED","ENTITIES_DELETED","observe","eventName","handler","_getContainer","stopObserving","fire","memo","getMessage","messageId","options","message","Template","evaluate","_comparator","l1","l2","_container","document","body","Configuration","nameSeparator","userDefaultRole","userNameNotSupportedSymbols","roleNameNotSupportedSymbols","emailRegExpPattern","superuserRole","adminRole","anonymousRole","jsonOrNode","Error","param","name","uri","treeNode","tenantId","tenantName","alias","tenantAlias","desc","tenantDesc","tenantUri","parentId","subTenantCount","level","org","primaryNavModule","deepClone","toQueryString","isInherited","permission","inheritedPermission","isDisabled","newPermission","userName","fullName","password","confirmPassword","email","enabled","external","roles","role","push","bind","permissionToDisplay","blank","_flowId","FLOW_ID","text","encodeURIComponent","user","toData","roleName","selectedItem","selectedTenant","properties","window","localStorage","setItem","JSON","stringify","organization","entityEvent","changeDisable","_EDIT_BUTTON_ID","entityId","hide","unlock","force","refreshAttributes","ID_PATTERN","_listId","_containerId","_searchBoxId","initialize","list","dynamicList","listTemplateDomId","listTemplateId","itemTemplateDomId","itemTemplateId","multiSelect","selectionDefaultsToCursor","comparator","item1","item2","getLabel","_initEvents","_infiniteScroll","InfiniteScroll","contentId","_searchBox","SearchBox","setText","onLoad","onSearch","toolbarModel","toolbar","show","item","lastSelectedName","getValue","getNameWithTenant","bindAsEventListener","tenantsTree","locked","getTenant","isCtrlHeld","refresh","stopSelectOrUnselect","entity","showConfirm","_createEntityItem","value","label","getDisplayName","entityList","processTemplate","element","select","update","xssUtil","getSearchText","getText","setSearchText","getSelectedEntities","getSelectedItems","collect","setEntities","entities","items","reset","setItems","findEntity","getItems","_","find","addEntities","addItems","selectEntity","entityName","matched","detect","isSelected","deselect","restoreSelectedEntity","deselectAll","resetSelected","newEntity","findAll","setValue","remove","entityNameOrNameSet","all","isArray","include","removeItems","_EDIT_MODE_CLASS","_moveButtonsId","_id","_value","isEditMode","_NOTHING_TO_DISPLAY_ID","_ASSIGNED_VIEW_ID","_ASSIGNED_VIEW_LIST_ID","_ASSIGNED_ID","_AVAILABLE_ID","_ASSIGNED_LIST_ID","_AVAILABLE_LIST_ID","_ATTRIBUTES_LIST_ID","_SAVE_BUTTON_ID","_CANCEL_BUTTON_ID","_DELETE_BUTTON_ID","_REMOVE_FROM_ASSIGNED_BUTTON_ID","_ADD_TO_ASSIGNED_BUTTON_ID","_BUTTONS_CONTAINER_ID","_MOVE_BUTTONS_CONTAINER_ID","_DND_CLASS","_DROP_CLASS","buttonsFunctions","attributesTypesEnum","_toggleButton","attributes","attributesType","TENANT","USER","optionsFactory","attributesViewOptionsFactory","scrollEventTrait","AttributesViewFacade","extend","attributesFacade","container","showAssigned","initDnD","initEvents","initButtonsFunctions","ConfirmationDialog","_initConfirmationDialog","self","i18n","confirmationDialog","title","cancelOnEdit","propertiesIsChanged","isChanged","containsUnsavedItems","saveButton","removeAttribute","removeClassName","setAttribute","isRoot","getCurrentView","setContext","done","render","$","addClassName","layoutModule","changeMode","nothingToDisplay","centerElement","horz","vert","lock","setDetailsLoadedEntity","detailsLoadedEntity","getDetailsLoadedEntity","editButton","cancelButton","deleteButton","removeFromAssigned","addToAssigned","assignedViewList","viewAssignedListTemplateDomId","viewAssignedItemTemplateDomId","assignedComparator","allowSelections","commonOptions","dragPattern","selectOnMousedown","setCursorOnMouseDown","assignedList","availableList","searchAssigned","assignedViewSearchBox","identify","availableSearchBox","assignedSearchBox","assignedViewInfiniteScroll","parentNode","availableInfiniteScroll","assignedInfiniteScroll","Droppables","up","accept","hoverclass","onDrop","dragged","dropped","_addToAssigned","_removeFromAssigned","assignedSelectionHandler","length","availableSelectionHandler","matchAny","call","preventDefault","extObj","dfd","asyncValidate","saveChildren","resolve","fail","reject","trigger","save","validate","open","_deleteEntity","_addFromAssigned","cancel","edit","tabs","attributeTab","propertiesTab","$anchor","hideFilters","detachScrollEvent","$container","parent","toggleMode","initScrollEvent","$$","down","removeClass","_assigned","_unassigned","style","zIndex","_editEntity","canEdit","canDelete","_showEntity","orgProperties","currentUser","setValuesProperty","setProperties","_moveEntities","bToAssigned","from","to","fromList","toList","concat","available","compact","fromItem","equals","_entitiesToItems","isAvailable","tooltipText","template","undefined","JSTooltip","templateId","nameAnchor","insert","writeAttribute","getManagerURL","getAssignedEntities","getUnassignedEntities","setAssignedEntities","filteredEntities","_filterEntities","addAssignedEntities","setAvailableEntities","addAvailableEntities","removeSet","addSet","allEntities","removeEntity","toLowerCase","changeReadonly","elementsPatterns","elementPattern","resetValidation","panel","ValidationModule","invokeFn","beforeInvoke","isFunction","invokeAction","apply","arguments","doNothing","eventId","actionURL","localContext","flowExecutionKey","data","onSuccess","onError","ajaxTargettedUpdate","postData","callback","response","error","errorHandler","ajaxAgent","getResponseHeader","baseErrorHandler","mode","AjaxRequester","_actionModel","_toActionMap","buttonId","testFn","toFunction","test","bulkActionModel","bulkAction","action","actionArgs","myAction","args","belongsToLocalContext","input","validator","isValid","regExp","errorMessage","symbols","unsupportedSymbols","messageKey","onValid","onInvalid","replaceKey","max","hasAttribute","readAttribute","maxlength","parseInt","replace","asElement","matches","exec","truncate","addMethod","result","$A","i","ch","charAt","token","startsWith","eval","chars","getCharacters","len","Dialog","contentTemplate","constructor","modal","additionalCssClasses","buttons","primary","close","setMessage","whiteList","content","rendered","renderContent","$contentContainer","html","confirmDialogTemplate","yesLabel","noLabel","setContent","onpageshow","persisted","location","reload","invokeFolderAction","actionName","folder","theFolder","repositorySearch","getContextFolder","folderActionFactory","invokeResourceAction","resource","theResource","getSelectedResources","resourceActionFactory","invokeBulkAction","resources","bulkActionFactory","invokeRedirectAction","RedirectAction","isFolderCopyOrMove","CopyMoveController","isCopyFolder","isMoveFolder","isResourceCopyOrMove","isCopyResource","isMoveResource","canFolderBeEdited","isEditable","canFolderBeCopied","isOrganization","isOrganizationsRoot","isReadable","canFolderBeCopiedOrMovedToFolder","toFolder","URI","canFolderBeMoved","isPublic","isTemp","isRemovable","isActiveThemeFolder","isThemeRootFolder","canFolderPropertiesBeEdited","canResourceBeCopied","canResourceBeMoved","canResourceBeDeleted","canResourcePropertiesBeShowed","canResourcePropertiesBeEdited","canAllBeRun","detected","canBeRun","canAllBeEdited","canResourceBeEdited","isIPad","canAllBeOpened","canBeOpenedInDesigner","canBeOpened","canAllBeCopied","canAllBeMoved","canAllBeCopiedOrMovedToFolder","isBulkAction","allow","isThemeFolder","resourceType","endsWith","canAllBePasted","getSelectedFolder","canAllBeDeleted","isPermissionsChanged","dialogsPool","getAllPermissionsDialogs","dialog","isPropertiesChanged","getAllPropertiesDialogs","isFlowRedirectRunning","Mode","LIBRARY","ResourceType","REPORT_UNIT","ADHOC_REPORT_UNIT","OLAP_UNIT","DASHBOARD_RESOURCE","DASHBOARD","REPORT_OPTIONS","REPORT_DATA_SOURCE","JDBC_REPORT_DATA_SOURCE","JNDI_JDBC_REPORT_DATA_SOURCE","VIRTUAL_REPORT_DATA_SOURCE","CUSTOM_REPORT_DATA_SOURCE","BEAN_REPORT_DATA_SOURCE","OLAP_DATA_SOURCE","OLAP_CLIENT_CONNECTION","QUERY","INPUT_CONTROL","LIST_OF_VALUES","LIST_OF_VALUES_ITEM","DATA_TYPE","MONDRIAN_CONNECTION","SECURE_MONDRIAN_CONNECTION","XMLA_CONNECTION","MONDRIAN_XMLA_DEFINITION","CONTENT_RESOURCE","FILE_RESOURCE","SEMANTIC_LAYER_DATA_SOURCE","DATA_DEFINER_UNIT","SearchAction","GET_RESOURCE_CHILDREN","SEARCH_RUN","SEARCH_BROWSE","SEARCH_FILTER","SEARCH_SORT","SEARCH_NEXT","SEARCH_ROLLBACK","SEARCH_SEARCH","SEARCH_CHILDREN","STATE_CHANGED","FILTER_PATH_CHANGED","CHILDREN_LOADED","RESULT_ERROR","REDIRECT_ERROR","FLOW_REDIRECT_RUNNING","InfoAction","GET_DISPLAY_PATH","PermissionAction","PermissionEvent","LOADED","UPDATED","ERROR","FolderAction","COPY","MOVE","FolderEvent","DELETED","DELETE_ERROR","CREATED","CREATE_ERROR","COPIED","COPY_ERROR","MOVED","MOVE_ERROR","UPDATE_ERROR","ResourceAction","GENERATE","CONVERT","ResourceEvent","GENERATED","GENERATE_ERROR","CONVERTED","CONVERT_ERROR","RedirectType","FLOW_REDIRECT","LOCATION_REDIRECT","WINDOW_REDIRECT","ThemeAction","SETTHEME","DOWNLOAD_THEME","REUPLOAD","ThemeEvent","REUPLOADED","THEME_ERROR","ResourcesFavoriteAction","FILTER_ID","ALL_RESOURCES","FAVORITE_RESOURCES","rsInitOptions","jsonToEntities","clazz","webHelpModule","enableDnD","setPublicFolderUri","publicFolderUri","setTempFolderUri","tempFolderUri","setRootFolderUri","rootFolderUri","setOrganizationsFolderUri","organizationsFolderUri","setFolderSeparator","folderSeparator","setAdministrator","isAdministrator","setConfiguration","configuration","setServerState","state","CursorManager","bulkActions","foldersPanel","filtersPanel","getFiltersConfiguration","getFiltersState","secondarySearchBox","getTextState","filterPath","resultsPanel","favoriteSwitchControl","sortersPanel","getSortersConfiguration","getSortState","initFolderEvents","initResourceEvents","initThemeEvents","ServerAction","createSearchAction","filterId","filterOption","optionId","sortBy","sorterId","folderUri","refreshToolbar","position","resourceUri","URIString","createPermissionAction","finishEdit","toPermissionData","entitiesWithPermission","toJSON","getPermissionsDialog","responseData","inputData","stopWaiting","doSet","_byUsersButton","_byRolesButton","updateEntities","alert","rJson","r","Resource","addChild","setResources","isLoaded","isLoading","setLoading","enableItems","updateUI","setPathItems","rData","getList","setCursor","addResources","defaultErrorHandler","isflowRedirectRunning","systemConfirm","dialogs","errorPopupMessage","_disableBfCacheIfSafari","showContextMenu","e","targetEvent","isFolderContextMenu","showFolderMenu","isResourceContextMenu","showResourceBulkMenu","showResourceMenu","isWebKitEngine","domUtil","customFilters","parentFolder","getParentFolder","refreshFolder","tree","_selectOrEditNode","node","moveOrCopyFolder","updateFolder","dependentResources","okOnly","canSave","topMessage","bottomMessage","removeResources","reselectFolder","selectedFolder","updateResource","run","createRunResourceAction","getSelectedUri","doBrowse","msg","Utils","restOfString","overwrite","createGenerateAction","errorDialog","AlertDialog","cursor","isActiveTheme","themeUri","createFolderAction","_createAction","actionFactory","getContextResource","_organizationsFolderUri","_rootFolderUri","_tempFolderUri","_publicFolderUri","_folderSeparator","_configuration","_serverState","_uiState","contextFolder","contextResource","selectedResources","_isAdministrator","getOrganizationsFolderUri","getRootFolderUri","getTempFolderUri","getPublicFolderUri","getFolderSeparator","getConfiguration","filters","sorters","getServerState","getUIState","getFolderUriState","setSelectedFolder","setContextFolder","setSelectedResources","RUN","EDIT","OPEN","CUT","PASTE","REMOVE","_holderId","_folderMenu","_resourceMenu","_resourceBulkMenu","page","isSupportsTouch","isRightClick","touches","coordinates","_move","_copy","_dndMode","onMove","move","onCopy","copy","onCancel","none","isObjectInstanceOf","o","Folder","isDnD","isMove","isCopy","isDnd","addClass","json","_json","description","date","dateTimestamp","dateTime","updateDate","updateDateTimestamp","updateDateTime","parentUri","fileType","isScheduled","scheduled","isFavorite","favorite","_permissions","permissions","hasChildren","isChild","parentResource","isOpen","_children","split","last","size","childIndex","child","isAdministrable","extra","prototype","getReadableUri","match","isWritable","ResourcesUtils","getResourceUris","uriList","getResourceUriAndTypeList","getSelectedResourceUris","map","checkNameLength","resourceNameMaxLength","checkDescriptionLength","resourceDescriptionMaxLength","labelValidator","resourceLabelMaxLength","descriptionValidator","_fileTypeValidatorTemplate","expectedType","zipFileTypeValidator","isCustomDataSource","getInitConfiguration","customDataSources","str","fromStr","lastIndexOf","trim","getInitOptions","__jrsConfigs__","stop","target","HTMLInputElement","HTMLTextAreaElement","canResourceBeCreated","Action","invokeCreate","resourceTypeSuffix","createCreateResourceAction","isCopyOrMove","isNonActiveThemeFolder","canThemeBeReuploaded","canFolderBeDeleted","canFolderBeExported","pathElements","canFolderPermissionsBeAssigned","canFolderPropertiesBeShowed","runActionFactory","typeSuffix","canBeGenerated","canBeConverted","openActionFactory","canBeRunInBackground","canBeScheduled","hasEditActionImpl","editActionFactory","allowed","canCreateFolder","canResourcePermissionsBeAssigned","canAllPropertiesBeShowed","canAllPropertiesBeEdited","canBeAddedToFavorites","every","canBeRemovedFromFavorites","DEFAULT","contains","j","createResourceAction","initDownload","JRS","createConvertAction","reportUri","createEditResourceAction","createOpenResourceAction","showDeleteResourceConfirm","showBulkDeleteResourcesConfirm","cascade","number","status","_serverErrorHandler","onFavoriteItem","url","favoriteList","request","headers","favorites","ajaxIframeDownload","onload","contentDocument","evalJSON","ex","params","errorEventName","sourceFolderUri","destFolderUri","themeName","copyUris","moveUris","selectedResource","convertErrorResponse","dataObj","parse","existingLabels","filteredResources","dependenciesBtnOk","dialogTitle","promptFilteredRetry","resp","successEvent","DIMMER_TIMEOUT","flowId","FLOW_URL","paramsMap","hash","encode","isUndefined","ajaxLoading","ajax","click","form","_serializeParams","timeout","setTimeout","strip","submit","hidePopup","clearTimeout","isContentResource","downloadFileByUrl","redirectToUrl","w","opener","inNewTab","reportUnit","standAlone","ParentFolderUri","parentFlow","dashboardResource","flow","reportOptionsURI","typeEquals","factoryMethod","createRunResourceInNewTabAction","actionType","isEdit","currentQuery","resourceTypeToDefaultRedirectTypeMap","getDefaultRedirectTypeByResourceType","defaultRedirectType","createRunInBackgroundResourceAction","reportUnitParentURI","createScheduleAction","createActionFactory","expectedFileType","confirmAndLeave","confirm","hasReports","resizable","_onExportButtonClick","_closeExportDialog","exportView","ExportView","listenTo","openRepoDialog","repoData","uris","jrsConfigs","orgTemplateFolderUri","subOrgRegExp","RegExp","rootOrgTemplateRegExp","isSubOrgLevel","renderOptions","exportTypesEnum","subtitle","i18n2","addCssClasses","_openExportDialog","set","openTenantDialog","tenant","fieldIsValid","fieldIsInvalid","doExport","$el","width","setTitle","applyEpoxyBindings","delegateEvents","minHeight","outerHeight","outerWidth","exportDialog","ExportDialogView","favoriteFilter","checked","onclick","_bulkActions","_treeId","_uri","_cookieName","_canDoBrowse","_touchController","isFolderSet","storedUri","getItem","getTreeId","parents","eq","dynamicTree","providerId","rootUri","organizationId","urlGetNode","urlGetChildren","escapeHyperlinks","disableSelectionWithoutCursorStyle","nodePosition","getBoxOffsets","menuLeft","menuTop","_overNode","refreshDropTarget","setDragStartState","draggable","isMetaHeld","setDragEndState","isDropTarget","refreshStyle","onHover","hover","Draggables","touch","changedTouches","getTreeNodeByElement","elementFromPoint","pageX","pageY","getTreeNodeByEvent","console","openAndSelectNode","rootNode","getSelectedNode","scroll","showTreePrefetchNodes","selectFolder","updateSubFolders","changeName","resortSubtree","refreshNode","hasChilds","setHasChilds","handleNode","isloaded","isIconEvent","targetFolder","removeChild","getTreeNodeChildren","n","_list","_resultListHeaderId","_resultListId","_resultsContainerId","_touchScroller","_folderDisplayPathCache","NOTHING_TO_DISPLAY_ID","RESOURCE_NAME_TOOLTIP_ID","NAME_PATTERN","LINK_NAME_PATTERN","DISCLOSURE_PATTERN","SCHEDULED_PATTERN","FAVORITE_PATTERN","LOADING_CLASS_NAME","it","_header","_intiListEvents","_initDnD","TouchController","getElementById","scrollbars","resizeHandler","_toggleInfiniteScrollBasedOnViewportHeight","_fixHeaderWidth","setStyle","getWidth","_createResourceItem","resourceItem","cssClassName","openHandlerPattern","closeHandlerPattern","favoriteIconPattern","scheduleIconPattern","excludeFromSelectionTriggers","listOptions","b","nameSelector","nameTitleElement","that","loadTextCallback","tooltip","folderPath","folderDisplayPath","updateTooltip","separator","getUri","updateText","isFolder","descriptionValue","jsTooltip","modifiedDate","createdDate","scheduleIcon","favoriteIcon","baseRefreshStyle","_getElement","_isLinkEvent","_isScheduleIconEvent","_isFavoriteIconClicked","_element","_selectOrUnselectResources","itemPosition","menuPosition","resourceVal","selectedElement","lItem","is","_isDisclosureEvent","_refreshEmptyListMessage","_isListHeightLessThanViewport","clientHeight","children","other","removedItems","compositeItems","isComposite","toItem","tooltipModule","CustomEvent","dispatchEvent","getItemByEvent","isItemSelected","selectItem","findResource","_filtersLists","_ignoreFilterEvent","filtersMetaData","selectedFilters","filter","childElements","Element","_createFiltersList","_buttonToggleListener","_refreshScroll","_createItemsList","filterMetaData","optionsMetaData","allItems","optionMetaData","labelId","partition","showCount","isMore","templateDomId","openUp","respondOnItemEvents","isSeparator","getId","isRestore","filterOptionSelector","$break","baseList","_contentBodySelector","_filterPathList","isLast","pathItems","lastIndex","listItems","pathItem","_LABEL_TEMPLATE_DOM_ID","_ignoreSortEvent","sortersList","sortersMetaData","selectedSorter","labelItem","isLabel","sortItems","sorterMetaData","ITEM_SELECTED","disableItems","_getLabelTemplate","clone","ResourcePermissions","_resource","_isVisible","ENTITY_LIST_ID","_listContainerId","LIST_CONTAINER_ID","SEARCH_BOX_ID","viewBy","_processTemplate","addVar","_dom","TEMPLATE_DOM_ID","path","PATH_PATTERN","_viewByTabSet","VIEW_BY_TAB_SET_PATTERN","TAB_PATTERN","_submitButton","SUBMIT_BUTTON","_applyButton","APPLAY_BUTTON","_cancelButton","CANCEL_BUTTON","viewType","listContainer","searchBox","veSelector","leSelector","valueElement","_waiting","getChangedEntities","_showWarning","_hideWarning","BODY_PATTERN","listItem","navigateToManager","tagName","selectedIndex","getResolvedPermission","addClas","PERMISSIONS_PATTERN","LIST_TEMPLATE_ID","ITEM_TEMPLATE_ID","forceLayout","_initControls","height","_buttonClickHandler","_launcherClickHandler","_selectMouseOverHandler","_waitingItem","WAIT_ITEM_TEMPLATE_ID","nameTooltipSelector","NAME_TOOLTIP_PATTERN","permissionsSelector","TOOLTIP_TEMPLATE_DOM_ID","_this","nameTooltip","origRemove","permissionsConfig","p","option","_selectChangeHandler","_createItem","listId","listUl","removeAttr","resetList","scrollReset","changed","updated","POOL_NOT_FOUND_EXCEPTION","DIALOD_EXIST_EXCEPTION","NULL_RESOURCE_EXCEPTION","_permissionsDialogPool","_propertiesDialogPool","_getPool","pool","ResourceProperties","toString","_createDialog","_createOrGetDialog","_getDialog","resourceOrUri","isString","_getAllDialogs","_removeDialog","createPermissionsDialog","createPropertiesDialog","createOrGetPermissionsDialog","createOrGetPropertiesDialog","getPropertiesDialog","removePermissionsDialog","removePropertiesDialog","_changedCallback","changedCallback","_showMode","showMode","_label","_updateValueAndLabel","_description","_updateContentAndLabel","_path","permissionsToString","_okButton","_hide","_isDataValid","showCreateFolderConfirm","add","doShow","accessibilityModule","focus","doHide","clear","doAdd","DeleteConfirmation","ID_DELETE_DIALOG_CONTAINER","ID_DELETE_DIALOG_OK_BUTTON","ID_DELETE_DIALOG_CANCEL_BUTTON","showDeleteFolderConfirm","count","_showDeleteDialog","confirmElement","okButtonSelector","cancelButtonSelector","showResourceProperties","editResourceProperties","showFolderProperties","editFolderProperties","addToFavorite","itemHovered","resourceSelectedElement","selectedElem","selectedResourceList","then","setFavorite","forEach","editResourcePermissions","showAndWait","editFolderPermissions","showUploadThemeConfirm","reupload","isReupload","zip","upload","_eventId","_flowExecutionKey","basicURI","slice","reuploadAction","fileSender","responseBody","respObj","themeExist","doUpload","repositorySearchRoot","repositorySearchActions","repositorySearchComponents","dependenciesPanel","actionsMap","_$title","_titleBackup","_changeMessage","_switchButtons","_initList","closest","off","uriElement","uristring","$buttonElements","saveAs","ok","$button","key","_contentId","_scroll","_loadFactor","loadFactor","_lastContentHeight","_loading","control","_control","_content","_eventType","_onScrollHandler","_handler","controlScrollTop","y","scrollTop","contentHeight","getHeight","controlHeight","allowLoad","isBottom","wait","_waitIndicator","dimensions","getDimensions","offsets","positionedOffset","top","left","after","numberUtils","NumberUtils","originalValidate","Validation","attrs","valid","view","invalid","doesNotContainSymbols","forbiddenSymbols","integerNumber","isNumberInt","types","some","fn","typeFn","join","hexColor","xRegExpPattern","customValue","startsWithLetter","substr","containsOnlyWordCharacters","search","arrayMinLength","minLength","bubbles","cancelable","detail","createEvent","initCustomEvent","100","101","200","201","202","203","204","205","206","300","301","302","303","304","305","307","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","500","501","502","503","504","505","BaseModel","Backbone","unifyServerErrors","serialize","xhr","errorStatus","httpStatusCodes","errorObj","createServerError","responseText","errorCode","errors","parameters","separatorSymbolToRegExpPattern","DECIMAL_SEPARATOR","decimalSeparator","GROUPING_SEPARATOR","groupingSeparator","DECIMAL_NUMBER_PATTERN","INTEGER_NUMBER_PATTERN","MAX_INT","Number","MAX_SAFE_INTEGER","MIN_INT","MIN_SAFE_INTEGER","number_format","decimals","dec_point","thousands_sep","num","absValue","k","isFinite","prec","Math","abs","sep","dec","pow","round","toFixed","Array","isInt","isStringInt","isNaN","POSITIVE_INFINITY","NEGATIVE_INFINITY","isInt32","parseNumber","isDecimal","warn","formatNumber","val","decimalNumStr","decimalPlacesAmount","MaxRange","MinRange"],"mappings":"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","file":"_chunks/chunk.3975.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\nimport jQuery from 'jquery';\nimport {isFirefox, getAsFunction} from \"../util/utils.common\";\nimport buttonManager from '../core/core.events.bis';\nimport toolbarButtonModule from './components.toolbarButtons';\n\ntoolbarButtonModule.initialize = function(actionMap){\n    toolbarButtonModule.actionMap = actionMap;\n    jQuery('.toolbar').on('mouseup mouseover mouseout','button',function(evt){\n        if(!jQuery(this).prop('disabled'))toolbarButtonModule['mouse' + evt.type.substring(5,6).toUpperCase() + evt.type.substring(6) + 'Handler'](evt,this);\n    });\n\n    if (isFirefox()) { // workaround for Bug 26223\n        jQuery(\".toolbar li\").each(function(index,li){\n            jQuery(li).css(\"padding\", \"0 2px\");\n        });\n    }\n};\n\ntoolbarButtonModule.mouseUpHandler = function(evt,el){\n    /*\n    if (element.hasClass(toolbarButtonModule.CAPSULE_PATTERN)) {\n        var elementId = element.attr(\"id\");\n        var execFunction = toolbarButtonModule.actionMap[elementId];\n        if (execFunction) {\n            var executableFunction = getAsFunction(execFunction);\n            executableFunction(evt);\n            evt.stopPropagation();\n        }\n    }\n    */\n    var execFunction = el.className.indexOf('capsule') >= 0 ? toolbarButtonModule.actionMap[el.id] : null;\n    if (execFunction) {\n        var executableFunction = getAsFunction(execFunction);\n        executableFunction(evt);\n        evt.stopPropagation();\n    }\n};\n\ntoolbarButtonModule.mouseOverHandler = function(evt,el){\n    /*\n    if (element.hasClass(toolbarButtonModule.CAPSULE_PATTERN)) {\n        if (element.hasClass(\"mutton\") && !buttonManager.isDisabled(element)) {\n            toolbarButtonModule.showButtonMenu(evt, element);\n        }\n    }\n    */\n    if(el.className.indexOf('capsule') >= 0 && el.className.indexOf('mutton') >= 0 && !buttonManager.isDisabled(el)){\n        toolbarButtonModule.showButtonMenu(evt.originalEvent,el);\n    }\n};\n\ntoolbarButtonModule.mouseOutHandler = function(evt,el){};\n\nexport default toolbarButtonModule;\n\n\n\n\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\n\nimport jQuery from 'jquery';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport buttonManager from '../core/core.events.bis';\n\n////////////////////////////////////////////////\n// Generic toolbar button utils\n////////////////////////////////////////////////\n\nvar toolbarButtonModule = {\n\n    UP : \"up\",\n    DOWN : \"down\",\n    OVER : \"over\",\n    DISABLED : \"disabled\",\n    PRESSED : \"pressed\",\n    CONTENT_PREFIX : \"toolbar_\", //action model\n    MenuClass : \"menu vertical dropDown\",\n    TOOLBAR_MENU_CLASS : \"menu vertical dropDown fitable\",\n    ACTION_MODEL_TAG : \"adhocActionModel\",\n    CAPSULE_PATTERN : \"capsule\",\n\n    /**\n     * Used by all toolbar components to show menu\n     * @param event\n     * @param object object we want the menu for\n     */\n    showButtonMenu : function(event, object){\n        object = jQuery(object);\n        var context = this.CONTENT_PREFIX + object.attr(\"id\"),\n            model = this.ACTION_MODEL_TAG == 'adhocActionModel' ? this.actionModel : this.ACTION_MODEL_TAG;\n\n        actionModel.showDropDownMenu(event, object, context, this.TOOLBAR_MENU_CLASS, model);\n    },\n\n    setActionModel: function(newActionModel){\n        this.actionModel = newActionModel;\n    },\n\n    /**\n     * Test to see if the button clicked is a toolbar type\n     * @param button\n     */\n    isToolBarButton : function(button){\n        if (button){\n            return (jQuery(button).hasClass(\"capsule\"));\n        } else{\n            return false;\n        }\n\n    },\n\n    /**\n     * Used to enable toolbar button\n     * @param button\n     * @param enable\n     */\n    enable : function(button, enable){\n        buttonManager.enable(button);\n    },\n\n    /**\n     * Used to disable toolbar button\n     * @param button\n     */\n    disable : function(button){\n        buttonManager.disable(button);\n    },\n\n    /**\n     * Used to enable or disable button based on adhoc state variables\n     * @param button\n     * @param enable\n     */\n    setButtonState : function(button, enable){\n        if(enable){\n            this.enable(button);\n        }else{\n            this.disable(button);\n        }\n    }\n};\n\nexport default toolbarButtonModule;\n\n\n\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// Main module for manege organizations, users and roles\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nimport {Droppables} from 'dragdropextra';\nimport {$, $$, $A, Template} from 'prototype';\nimport SearchBox from '../components/components.searchBox';\nimport toolbarButtonModule from '../components/components.toolbarButtons.events';\nimport {\n    toFunction,\n    getAsFunction,\n    isArray,\n    matchAny,\n    centerElement,\n    ValidationModule,\n    deepClone,\n    doNothing\n} from '../util/utils.common';\nimport layoutModule from '../core/core.layout';\nimport {dynamicList} from '../components/list.base';\nimport InfiniteScroll from '../util/tools.infiniteScroll';\nimport {JSTooltip} from '../components/components.tooltip';\nimport buttonManager from '../core/core.events.bis';\nimport primaryNavModule from '../actionModel/actionModel.primaryNavigation';\nimport {ajaxTargettedUpdate, AjaxRequester} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport orgModule from './mng.org.module';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport jQuery from 'jquery';\n\nObject.assign(orgModule, {\n    TREE_ID: 'orgTree',\n    COOKIE_NAME: 'selectedTenant',\n    messages: [],\n    ActionMap: {\n        SEARCH: 'search',\n        BROWSE: 'browse',\n        NEXT: 'next',\n        SELECT_AND_GET_DETAILS: 'selectAndGetDetails',\n        SEARCH_AVAILABLE: 'searchAvailable',\n        SEARCH_ASSIGNED: 'searchAssigned',\n        NEXT_AVAILABLE: 'nextAvailable',\n        NEXT_ASSIGNED: 'nextAssigned',\n        CREATE: 'create',\n        UPDATE: 'update',\n        DELETE: 'delete',\n        DELETE_ALL: 'deleteAll',\n        EXIST: 'exist'\n    },\n    Event: {\n        /** Request events. */\n        ORG_BROWSE: 'org:browse',\n        ENTITY_SEARCH: 'entity:search',\n        ENTITY_NEXT: 'entity:next',\n        ENTITY_SELECT_AND_GET_DETAILS: 'entity:selectAndGetDetails',\n        /** Response events. */\n        RESULT_CHANGED: 'result:changed',\n        RESULT_NEXT: 'result:next',\n        ENTITY_DETAILS_LOADED: 'entity:detailsLoaded',\n        SEARCH_AVAILABLE_LOADED: 'searchAvailable:loaded',\n        SEARCH_ASSIGNED_LOADED: 'searchAssigned:loaded',\n        NEXT_AVAILABLE_LOADED: 'nextAvailable:loaded',\n        NEXT_ASSIGNED_LOADED: 'nextAssigned:loaded',\n        SERVER_ERROR: 'server:error',\n        SERVER_UNAVAILABLE: 'server:unavailable',\n        ENTITY_CREATED: 'entity:created',\n        ENTITY_UPDATED: 'entity:updated',\n        ENTITY_DELETED: 'entity:deleted',\n        ENTITIES_DELETED: 'entities:deleted'\n    },\n    observe: function (eventName, handler) {\n        this._getContainer().observe(eventName, handler);\n    },\n    stopObserving: function (eventName, handler) {\n        this._getContainer().stopObserving(eventName, handler);\n    },\n    fire: function (eventName, memo) {\n        this._getContainer().fire(eventName, memo);\n    },\n    getMessage: function (messageId, options) {\n        var message = orgModule.messages[messageId];\n        return message ? new Template(message).evaluate(options ? options : {}) : '';\n    },\n    _comparator: function (l1, l2) {\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = document.body;\n        }\n        return this._container;\n    },\n    Configuration: {\n        nameSeparator: '|',\n        userDefaultRole: 'ROLE_USER',\n        userNameNotSupportedSymbols: '[|]',\n        roleNameNotSupportedSymbols: '[|]',\n        emailRegExpPattern: '^[\\\\p{L}\\\\p{M}\\\\p{N}._%\\'-\\\\@\\\\,\\\\;\\\\s]+$',\n        superuserRole: 'ROLE_SUPERUSER',\n        adminRole: 'ROLE_ADMINISTRATOR',\n        anonymousRole: 'ROLE_ANONYMOUS'\n    }\n});\n\norgModule.systemRoles = [\n    orgModule.Configuration.userDefaultRole,\n    orgModule.Configuration.superuserRole,\n    orgModule.Configuration.adminRole,\n    orgModule.Configuration.anonymousRole\n];    /**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\n/**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\norgModule.Organization = function (jsonOrNode) {\n    if (!jsonOrNode) {\n        throw new Error('Can\\'t create Organization from undefined json or node');\n    }\n    if (jsonOrNode.param) {\n        this.id = jsonOrNode.param.id;\n        this.name = jsonOrNode.name;\n        this.uri = jsonOrNode.param.uri;\n        this.treeNode = jsonOrNode;\n    } else {\n        this.id = jsonOrNode.tenantId || jsonOrNode.id;\n        this.name = jsonOrNode.tenantName;\n        this.alias = jsonOrNode.tenantAlias || jsonOrNode.alias || '';\n        this.desc = jsonOrNode.tenantDesc;\n        this.uri = jsonOrNode.tenantUri;\n        this.parentId = jsonOrNode.parentId;\n        this.subTenantCount = jsonOrNode.subTenantCount;\n    }\n};\norgModule.Organization.addMethod('isRoot', function (level) {\n    // TODO: load name of root organization from configuration.\n    return this.id == 'organizations';\n});\norgModule.Organization.addMethod('getNameWithTenant', function () {\n    return this.id;\n});\norgModule.Organization.addMethod('getDisplayName', function () {\n    return this.name;\n});\norgModule.Organization.addMethod('equals', function (org) {\n    return org && this.id == org.id;\n});\norgModule.Organization.addMethod('toJSON', function (org) {\n    return {\n        tenantId: this.id,\n        tenantName: this.name,\n        tenantAlias: this.alias,\n        tenantDesc: this.desc,\n        parentId: this.parentId,\n        tenantUri: this.uri\n    };\n});\norgModule.Organization.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.organization);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({ tenantId: this.id });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Permission = function (options) {\n    this.isInherited = !!options.isInherited;\n    if (options.permission) {\n        this.permission = options.permission;\n    }\n    if (options.inheritedPermission) {\n        this.inheritedPermission = options.inheritedPermission;\n    }\n    this.isDisabled = !!options.isDisabled;\n};\norgModule.Permission.addMethod('getResolvedPermission', function () {\n    return this.isInherited ? this.inheritedPermission : this.permission;\n});\norgModule.Permission.addMethod('toJSON', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.Permission.addMethod('toData', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.User = function (options) {\n    if (options) {\n        this.userName = options.userName;\n        this.fullName = options.fullName;\n        this.password = options.password || '';\n        this.confirmPassword = options.confirmPassword || '';\n        this.tenantId = options.tenantId;\n        this.email = options.email;\n        this.enabled = options.enabled;\n        this.external = options.external;\n        this.roles = [];\n        if (options.roles) {\n            options.roles.each(function (role) {\n                this.roles.push(new orgModule.Role(role));\n            }.bind(this));\n        }\n        if (options.permissionToDisplay) {\n            this.permission = new orgModule.Permission(options.permissionToDisplay);\n        }\n    }\n};\norgModule.User.addVar('FLOW_ID', 'userListFlow');\norgModule.User.addMethod('getDisplayName', function () {\n    return this.userName;\n});\norgModule.User.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.userName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.userName;\n    }\n});\norgModule.User.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        text: typeof this.userName !== 'undefined' ? encodeURIComponent(this.userName) : this.userName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.User.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.user);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.userName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.User.addMethod('equals', function (user) {\n    return user && this.userName == user.userName && this.tenantId == user.tenantId;\n});\norgModule.User.addMethod('toPermissionData', function (user) {\n    return {\n        userName: this.userName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\norgModule.Role = function (options) {\n    if (options) {\n        this.roleName = options.roleName;\n        this.external = options.external;\n        this.tenantId = options.tenantId;\n    }\n    if (options.permissionToDisplay) {\n        this.permission = new orgModule.Permission(options.permissionToDisplay);\n    }\n};\norgModule.Role.addVar('FLOW_ID', 'roleListFlow');\norgModule.Role.addMethod('getDisplayName', function () {\n    return this.roleName;\n});\norgModule.Role.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.roleName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.roleName;\n    }\n});\norgModule.Role.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        // Object.toQueryString already does encodeURIComponent() once, so we have double encoding here\n        text: typeof this.roleName !== 'undefined' ? encodeURIComponent(this.roleName) : this.roleName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.Role.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.role);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.roleName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Role.addMethod('equals', function (role) {\n    return role && this.roleName == role.roleName && this.tenantId == role.tenantId;\n});\norgModule.Role.addMethod('toPermissionData', function (user) {\n    return {\n        roleName: this.roleName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\n\norgModule.initTenantsTreeEvents = function () {\n    orgModule.manager.tenantsTree.on('selection:change', function (selectedItem) {\n        if (!orgModule.manager.lastSelectedOrg || orgModule.manager.lastSelectedOrg.id !== selectedItem.id) {\n            var selectedTenant = new orgModule.Organization(selectedItem), properties = orgModule.properties;\n            orgModule.manager.tenantsTree.setTenant(selectedTenant);\n            window.localStorage && localStorage.setItem(orgModule.COOKIE_NAME, JSON.stringify(selectedItem));\n            orgModule.fire(orgModule.Event.ORG_BROWSE, {\n                organization: selectedTenant,\n                entityEvent: false\n            });\n            if (orgModule.orgManager) {\n                properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: selectedTenant.id,\n                    entityEvent: false\n                });\n            }\n            if (orgModule.userManager || orgModule.roleManager) {\n                properties.hide();\n                properties.unlock();\n            }\n        }\n    });\n    orgModule.manager.tenantsTree.on('import:finished', function (tenantId) {\n        var properties = orgModule.properties;\n        orgModule.fire(orgModule.Event.ORG_BROWSE, {\n            force: true,\n            entityEvent: false\n        });\n        if (orgModule.orgManager) {\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                refreshAttributes: true,\n                entityId: tenantId,\n                entityEvent: false\n            });\n        }\n    });\n};\n\norgModule.entityList = {\n    ID_PATTERN: '.ID > a',\n    _listId: 'entitiesList',\n    _containerId: 'listContainer',\n    _searchBoxId: 'secondarySearchBox',\n    initialize: function (options) {\n        this.list = new dynamicList.List(this._listId, {\n            listTemplateDomId: options.listTemplateId,\n            itemTemplateDomId: options.itemTemplateId,\n            multiSelect: true,\n            selectionDefaultsToCursor: true,\n            comparator: function (item1, item2) {\n                return orgModule._comparator(item1.getLabel(), item2.getLabel());\n            }\n        });\n        this._initEvents();    // Infinite scroll setup.\n        // Infinite scroll setup.\n        this._infiniteScroll = new InfiniteScroll({\n            id: this._containerId,\n            contentId: this._listId\n        });\n        this._searchBox = new SearchBox({ id: this._searchBoxId });\n        if (options.text) {\n            this._searchBox.setText(options.text);\n        }\n        this._infiniteScroll.onLoad = function () {\n            orgModule.fire(orgModule.Event.ENTITY_NEXT, {});\n        };\n        this._searchBox.onSearch = function (text) {\n            orgModule.fire(orgModule.Event.ENTITY_SEARCH, { text: text });\n        };\n        orgModule.toolbar.initialize(options.toolbarModel);\n        this.toolbar = orgModule.toolbar;\n        this.list.show();\n    },\n    _initEvents: function () {\n        this.list.observe('item:selected', function (event) {\n            var item = event.memo.item, properties = orgModule.properties;\n            this.lastSelectedName = item.getValue().getNameWithTenant();\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                entityId: item.getValue().id,\n                entityEvent: true\n            });\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n        }.bindAsEventListener(this));\n        this.list.observe('item:unselected', function (event) {\n            var tenantsTree = orgModule.manager.tenantsTree, properties = orgModule.properties;\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);    // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            if (!properties.locked && tenantsTree) {\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: tenantsTree.getTenant().id,\n                    entityEvent: true,\n                    isCtrlHeld: event.memo.isCtrlHeld\n                });\n            } else {\n                properties.hide();\n                this.toolbar.refresh();\n            }\n        }.bindAsEventListener(this));\n        this.list.observe('item:beforeSelectOrUnselect', function (event) {\n            var item = event.memo.item;\n            event.stopSelectOrUnselect = !orgModule.invokeClientAction('cancelIfEdit', {\n                entity: item.getValue(),\n                showConfirm: event.memo.showConfirm\n            });\n        }.bindAsEventListener(this));\n    },\n    //    _refreshProperties: function() {\n    //        if (this.list.getSelectedItems().length == 1) {\n    //            orgModule.properties.show(this.list.getSelectedItems()[0].getValue());\n    //        } else {\n    //            orgModule.properties.hide();\n    //        }\n    //    },\n    _createEntityItem: function (value) {\n        var item = new dynamicList.ListItem({\n            label: value.getDisplayName(),\n            value: value\n        });\n        var entityList = this;\n        item.processTemplate = function (element) {\n            var id = element.select(entityList.ID_PATTERN)[0];\n            id.update(xssUtil.hardEscape(this.getValue().getDisplayName()));\n            return element;\n        };\n        return item;\n    },\n    getSearchText: function () {\n        return this._searchBox.getText();\n    },\n    setSearchText: function (text) {\n        return this._searchBox.setText(text);\n    },\n    getSelectedEntities: function () {\n        if (this.list) {\n            return this.list.getSelectedItems().collect(function (item) {\n                return item.getValue();\n            });\n        } else {\n            return [];\n        }\n    },\n    setEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this._infiniteScroll.reset();\n        this.list.setItems(items);\n        this.list.show();\n        this.toolbar.refresh();\n    },\n    findEntity: function (name) {\n        var items = this.list.getItems(), options = orgModule.properties.options || orgModule.userManager.options;\n        return options._.find(items, function (item) {\n            return item.getValue().fullName === name;\n        });\n    },\n    addEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this.list.addItems(items);\n        this.list.refresh();\n        this.toolbar.refresh();\n    },\n    selectEntity: function (entityName) {\n        var all = this.list.getItems();\n        var matched = all.detect(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        if (matched) {\n            matched.isSelected() && matched.deselect();\n            matched.select();\n            this.lastSelectedName = matched.getValue().getNameWithTenant();\n        }\n    },\n    restoreSelectedEntity: function (entityName) {\n        this.selectEntity(this.lastSelectedName ? this.lastSelectedName : entityName);\n    },\n    deselectAll: function () {\n        this.list.resetSelected();\n    },\n    update: function (entityName, newEntity) {\n        var all = this.list.getItems();\n        var matched = all.findAll(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        matched.each(function (item) {\n            item.setValue(newEntity);\n            item.refresh();\n        });\n    },\n    remove: function (entityNameOrNameSet) {\n        var all = this.list.getItems();\n        var matched;\n        if (isArray(entityNameOrNameSet)) {\n            matched = all.findAll(function (item) {\n                return entityNameOrNameSet.include(item.getValue().getNameWithTenant());\n            });\n        } else {\n            matched = all.findAll(function (item) {\n                return item.getValue().getNameWithTenant() == entityNameOrNameSet;\n            });\n        }\n        this.list.resetSelected();\n        this.list.removeItems(matched);\n    }\n};\norgModule.properties = {\n    _EDIT_MODE_CLASS: 'editMode',\n    _moveButtonsId: 'moveButtons',\n    _id: 'properties',\n    _value: null,\n    isEditMode: false,\n    _NOTHING_TO_DISPLAY_ID: 'nothingToDisplay',\n    _ASSIGNED_VIEW_ID: 'assignedView',\n    _ASSIGNED_VIEW_LIST_ID: 'assignedViewList',\n    _ASSIGNED_ID: 'assigned',\n    _AVAILABLE_ID: 'available',\n    _ASSIGNED_LIST_ID: 'assignedList',\n    _AVAILABLE_LIST_ID: 'availableList',\n    _ATTRIBUTES_LIST_ID: 'attributesTab',\n    _EDIT_BUTTON_ID: 'edit',\n    _SAVE_BUTTON_ID: 'save',\n    _CANCEL_BUTTON_ID: 'cancel',\n    _DELETE_BUTTON_ID: 'delete',\n    _REMOVE_FROM_ASSIGNED_BUTTON_ID: 'removeFromAssigned',\n    _ADD_TO_ASSIGNED_BUTTON_ID: 'addToAssigned',\n    _BUTTONS_CONTAINER_ID: 'propertiesButtons',\n    _MOVE_BUTTONS_CONTAINER_ID: 'moveButtons',\n    _DND_CLASS: '.draggable',\n    _DROP_CLASS: 'wrap',\n    buttonsFunctions: {},\n    initialize: function (options) {\n        var attributesTypesEnum = options.attributesTypesEnum;\n        this.options = options;\n        this.locked = false;\n        this.hide();\n        this.processTemplate(options);\n        this._toggleButton();\n        if (options.attributes) {\n            var attributesType = !orgModule.userManager && orgModule.orgManager ? attributesTypesEnum.TENANT : attributesTypesEnum.USER, optionsFactory = options.attributesViewOptionsFactory, scrollEventTrait = options.scrollEventTrait, AttributesViewFacade = options.AttributesViewFacade;\n            this.options._.extend(this, scrollEventTrait);\n            this.attributesFacade = new AttributesViewFacade(optionsFactory({\n                context: options.attributes.context,\n                container: jQuery('#attributesTab'),\n                type: attributesType\n            }));\n        }\n        if (this.options.showAssigned) {\n            this.initDnD();\n        }\n        this.initEvents();\n        this.initButtonsFunctions();\n        this.options.ConfirmationDialog && this._initConfirmationDialog();\n    },\n    _initConfirmationDialog: function () {\n        var self = this, i18n = this.options.i18n;\n        this.confirmationDialog = new this.options.ConfirmationDialog({\n            title: i18n['attributes.confirm.dialog.title'],\n            text: i18n['attributes.confirm.cancel.dialog.text']\n        });\n        this.confirmationDialog.on('button:yes', function () {\n            self.cancelOnEdit();\n        });\n    },\n    _toggleButton: function () {\n        var propertiesIsChanged = this.isChanged(), attributesAndPropertiesChanged = this.attributesFacade && this.attributesFacade.containsUnsavedItems() || propertiesIsChanged;\n        attributesAndPropertiesChanged ? this.saveButton.removeAttribute('disabled') : this.saveButton.removeClassName('over').setAttribute('disabled', 'disabled');\n    },\n    show: function (value, refreshAttributes) {\n        if (!this.locked) {\n            if (this.attributesFacade) {\n                var self = this, isRoot = value && value.isRoot && value.isRoot(), context = !isRoot ? value : this.options._.extend({}, value, { id: null });\n                this.attributesFacade.getCurrentView().setContext(context, refreshAttributes).done(function () {\n                    self.attributesFacade.render(isRoot);\n                });\n            }\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.addClassName(layoutModule.HIDDEN_CLASS);\n            document.body.removeClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = value;\n            this.changeMode(false);\n        }\n    },\n    hide: function () {\n        if (!this.locked) {\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.removeClassName(layoutModule.HIDDEN_CLASS);\n            centerElement(nothingToDisplay, {\n                horz: true,\n                vert: true\n            });\n            document.body.addClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = null;\n            this.changeMode(false);\n        }\n    },\n    lock: function () {\n        this.locked = true;\n    },\n    unlock: function () {\n        this.locked = false;\n    },\n    setDetailsLoadedEntity: function (entity) {\n        this.detailsLoadedEntity = entity;\n    },\n    getDetailsLoadedEntity: function () {\n        return this.detailsLoadedEntity;\n    },\n    processTemplate: function (options) {\n        this.editButton = $(this._EDIT_BUTTON_ID);\n        this.saveButton = $(this._SAVE_BUTTON_ID);\n        this.cancelButton = $(this._CANCEL_BUTTON_ID);\n        this.deleteButton = $(this._DELETE_BUTTON_ID);\n        if (this.options.showAssigned) {\n            this.removeFromAssigned = $(this._REMOVE_FROM_ASSIGNED_BUTTON_ID);\n            this.addToAssigned = $(this._ADD_TO_ASSIGNED_BUTTON_ID);\n            this.assignedViewList = new dynamicList.List(this._ASSIGNED_VIEW_LIST_ID, {\n                listTemplateDomId: options.viewAssignedListTemplateDomId,\n                itemTemplateDomId: options.viewAssignedItemTemplateDomId,\n                comparator: this.assignedComparator,\n                allowSelections: false,\n                selectionDefaultsToCursor: false\n            });\n            var commonOptions = {\n                listTemplateDomId: 'list_responsive_collapsible_fields',\n                itemTemplateDomId: 'list_responsive_collapsible_fields:fields',\n                comparator: this.assignedComparator,\n                dragPattern: this._DND_CLASS,\n                allowSelections: true,\n                selectionDefaultsToCursor: true,\n                multiSelect: true,\n                selectOnMousedown: true,\n                setCursorOnMouseDown: true\n            };\n            this.assignedList = new dynamicList.List(this._ASSIGNED_LIST_ID, Object.extend({}, commonOptions, {\n                allowSelections: false,\n                selectionDefaultsToCursor: false    //selectOnMouseDown: false,\n                //setCursorOnMouseDown: false\n            }));\n            this.availableList = new dynamicList.List(this._AVAILABLE_LIST_ID, commonOptions);    //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            if (options.searchAssigned) {\n                this.assignedViewSearchBox = new SearchBox({ id: $(this._ASSIGNED_VIEW_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n                this.assignedViewSearchBox.onSearch = function (text) {\n                    orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n                };\n            }\n            this.availableSearchBox = new SearchBox({ id: $(this._AVAILABLE_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.availableSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: text });\n            };\n            this.assignedSearchBox = new SearchBox({ id: $(this._ASSIGNED_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.assignedSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n            };\n            if (options.searchAssigned) {\n                this.assignedViewInfiniteScroll = new InfiniteScroll({\n                    id: $($(this._ASSIGNED_VIEW_LIST_ID).parentNode).identify(),\n                    contentId: this._ASSIGNED_VIEW_LIST_ID\n                });\n                this.assignedViewInfiniteScroll.onLoad = function () {\n                    orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n                };\n            }\n            this.availableInfiniteScroll = new InfiniteScroll({\n                id: $($(this._AVAILABLE_LIST_ID).parentNode).identify(),\n                contentId: this._AVAILABLE_LIST_ID\n            });\n            this.availableInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_AVAILABLE, {});\n            };\n            this.assignedInfiniteScroll = new InfiniteScroll({\n                id: $($(this._ASSIGNED_LIST_ID).parentNode).identify(),\n                contentId: this._ASSIGNED_LIST_ID\n            });\n            this.assignedInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n            };\n        }\n    },\n    initDnD: function () {\n        Droppables.add($(this._ASSIGNED_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._addToAssigned();\n                }\n            }.bind(this)\n        });\n        Droppables.add($(this._AVAILABLE_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._removeFromAssigned();\n                }\n            }.bind(this)\n        });\n    },\n    initEvents: function () {\n        function assignedSelectionHandler() {\n            (this.assignedList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.removeFromAssigned);\n        }\n        function availableSelectionHandler() {\n            (this.availableList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.addToAssigned);\n        }\n        $(this._BUTTONS_CONTAINER_ID).observe('click', function (event) {\n            var element = event.element();\n            var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n            if (button) {\n                if (this.buttonsFunctions[button.identify()]) {\n                    this.buttonsFunctions[button.identify()].call(this);\n                }\n            }\n            event.preventDefault();\n            event.stopPropagation();\n        }.bindAsEventListener(this));\n        if (this.options.showAssigned) {\n            $(this._MOVE_BUTTONS_CONTAINER_ID).observe('click', function (event) {\n                var element = event.element();\n                var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n                if (button) {\n                    if (button == this.removeFromAssigned) {\n                        this._removeFromAssigned();\n                    } else if (button == this.addToAssigned) {\n                        this._addToAssigned();\n                    }\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }.bindAsEventListener(this));\n            this.assignedList.observe('item:selected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:unselected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:dblclick', function (event) {\n                this._removeFromAssigned();\n            }.bindAsEventListener(this));\n            this.availableList.observe('item:selected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:unselected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:dblclick', function (event) {\n                this._addToAssigned();\n            }.bindAsEventListener(this));\n        }\n        this.attributesFacade && this.attributesFacade.on('change', this.options._.bind(this._toggleButton, this));\n    },\n    initButtonsFunctions: function () {\n        this.buttonsFunctions[this._EDIT_BUTTON_ID] = function () {\n            this.changeMode(true);\n        };\n        this.buttonsFunctions[this._SAVE_BUTTON_ID] = function () {\n            var extObj = this;\n            var dfd = new jQuery.Deferred();\n            if(this.asyncValidate) {\n                this.asyncValidate().done(function() {\n                    extObj.attributesFacade ? extObj.attributesFacade.getCurrentView().saveChildren().done(function () {\n                        dfd.resolve();\n                    }).fail(function () {\n                        dfd.reject();\n                        jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                    }) : dfd.resolve();\n                    dfd.done(function () {\n                        extObj.save(extObj._value);\n                    });\n                });\n            } else if(this.validate()) {\n                //This part never gets called, we can remove this in future.\n                this.attributesFacade ? this.attributesFacade.getCurrentView().saveChildren().done(function () {\n                    dfd.resolve();\n                }).fail(function () {\n                    dfd.reject();\n                    jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                }) : dfd.resolve();\n                dfd.done(function () {\n                    extObj.save(extObj._value);\n                });\n            }\n        };\n        this.buttonsFunctions[this._CANCEL_BUTTON_ID] = function () {\n            if (this.attributesFacade) {\n                this.isChanged() ? this.confirmationDialog.open() : this.cancelOnEdit();\n            } else {\n                orgModule.invokeClientAction('cancelIfEdit', { entity: this.getValue() });\n            }\n        };\n        this.buttonsFunctions[this._DELETE_BUTTON_ID] = function () {\n            this._deleteEntity();\n        };\n        this.buttonsFunctions[this._REMOVE_FROM_ASSIGNED_BUTTON_ID] = function () {\n            this._removeFromAssigned();\n        };\n        this.buttonsFunctions[this._ADD_TO_ASSIGNED_BUTTON_ID] = function () {\n            this._addFromAssigned();\n        };\n    },\n    cancelOnEdit: function () {\n        var self = this;\n        if (this.isEditMode) {\n            this.cancel().done(function () {\n                self.unlock();\n                self.changeMode(false);\n                self._toggleButton();\n            });\n        }\n    },\n    changeMode: function (edit) {\n        this.isEditMode = edit;\n        var tabs, attributeTab, propertiesTab, $anchor;\n        if (this.attributesFacade) {\n            attributeTab = $('attributesTab');\n            var hideFilters = !!this._value && this._value.id === 'organizations';\n            this.detachScrollEvent(this.attributesFacade.getCurrentView().$container.parent());\n            this.attributesFacade.toggleMode(edit, hideFilters);\n            edit && this.initScrollEvent(this.attributesFacade.getCurrentView());\n            tabs = $$('.tertiary')[0];\n            propertiesTab = $('propertiesTab');\n            $anchor = jQuery('.control.tabSet.anchor');\n        }\n        if (edit) {\n            $(this._id).addClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                tabs.down('.selected').removeClassName('selected');\n                tabs.down('li', 0).addClassName('selected');\n                tabs.addClassName('tabbed');\n                attributeTab.addClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                $anchor.removeClass('attributesAnchor');\n            }\n            this._assigned = [];\n            this._unassigned = [];\n            if (this.options.showAssigned) {\n                centerElement($(this._moveButtonsId), { horz: true });\n                $(this._moveButtonsId).style.zIndex = 1000;    //fix for bug 26831\n                //fix for bug 26831\n                this.assignedList.setItems([]);\n                this.assignedList.show();\n                this.availableList.setItems([]);\n                this.availableList.show();\n                buttonManager.disable(this.removeFromAssigned);\n                buttonManager.disable(this.addToAssigned);\n                this.assignedSearchBox.setText('');\n                this.availableSearchBox.setText('');\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: this.assignedSearchBox.getText() });\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: this.availableSearchBox.getText() });\n            }\n            this._editEntity();\n            this._toggleButton();\n        } else {\n            $(this._id).removeClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                attributeTab.removeClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                tabs.removeClassName('tabbed');\n            }\n            if (this.options.searchAssigned && this.assignedViewSearchBox) {\n                this.assignedViewSearchBox.setText('');\n            }\n            this.changeDisable(this.canEdit(), ['#' + this._EDIT_BUTTON_ID]);\n            this.changeDisable(this.canDelete(), ['#' + this._DELETE_BUTTON_ID]);\n            this._showEntity();\n            this._assigned = [];\n            this._unassigned = [];\n        }\n    },\n    canEdit: function () {\n        return true;\n    },\n    canDelete: function () {\n        let orgProperties = this.getValue();\n        if ( orgProperties && orgProperties.getNameWithTenant() === this.options.currentUser) {\n            return false;\n        }\n        return !!orgProperties && orgProperties.uri !== '/';\n    },\n    setValuesProperty: function (name, value) {\n        this._value[name] = value;\n    },\n    getValue: function () {\n        return this._value;\n    },\n    setProperties: function (properties) {\n    },    // Template method.\n\n    isChanged: function (properties) {\n    },    // Template method.\n\n    save: function (properties) {\n    },    // Template method.\n\n    validate: function () {\n        // Template method.\n        return true;\n    },\n    assignedComparator: function (item1, item2) {\n        var l1 = item1.getLabel();\n        var l2 = item2.getLabel();\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _moveEntities: function (bToAssigned) {\n        var from, to, fromList, toList;\n        if (bToAssigned) {\n            from = this._unassigned;\n            fromList = this.availableList;\n            to = this._assigned;\n            toList = this.assignedList;\n        } else {\n            from = this._assigned;\n            fromList = this.assignedList;\n            to = this._unassigned;\n            toList = this.availableList;\n        }\n        var items = fromList.getSelectedItems();\n        var entities = items.collect(function (item) {\n            return item.getValue();\n        });\n        to = to.concat(entities.collect(function (entity) {\n            return entity.available == bToAssigned ? entity : null;\n        })).compact();\n        from = from.reject(function (fromItem) {\n            return entities.detect(function (entity) {\n                return fromItem.equals(entity);\n            });\n        });\n        fromList.removeItems(items);\n        toList.addItems(items, true);\n        toList.refresh();\n        if (bToAssigned) {\n            this._unassigned = from;\n            this._assigned = to;\n        } else {\n            this._assigned = from;\n            this._unassigned = to;\n        }\n    },\n    _addToAssigned: function () {\n        this._moveEntities(true);\n    },\n    _removeFromAssigned: function () {\n        this._moveEntities(false);\n    },\n    _entitiesToItems: function (entities, isAvailable) {\n        entities = entities ? entities : [];\n        return entities.collect(function (entity) {\n            var label = '';\n            var tooltipText = [], template = 'orgTooltip';\n            if (entity instanceof orgModule.User) {\n                label = entity.userName;\n                if (entity.fullName && entity.fullName.length > 0) {\n                    tooltipText = [entity.fullName];\n                }\n                template = entity.tenantId ? 'fullNameAndOrgTooltip' : 'fullNameTooltip';\n            } else if (entity instanceof orgModule.Role) {\n                label = entity.roleName;\n                template = entity.tenantId ? 'orgTooltip' : undefined;\n            }\n            if (entity.tenantId && entity.tenantId.length > 0) {\n                tooltipText.push(entity.tenantId);\n            }\n            entity.available = !!isAvailable;\n            var item = new dynamicList.ListItem({\n                label: label,\n                value: entity\n            });\n            if (this.isEditMode) {\n                item.processTemplate = function (element) {\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return dynamicList.ListItem.prototype.processTemplate.call(this, element);\n                };\n            } else {\n                item.processTemplate = function (element) {\n                    var nameAnchor = element.select('a')[0];\n                    nameAnchor.insert(xssUtil.hardEscape(this.getLabel()));\n                    nameAnchor.writeAttribute('href', this.getValue().getManagerURL());\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return element;\n                };\n            }\n            return item;\n        }.bind(this));\n    },\n    getAssignedEntities: function () {\n        return this._assigned;\n    },\n    getUnassignedEntities: function () {\n        return this._unassigned;\n    },\n    setAssignedEntities: function (entities) {\n        this.assignedViewInfiniteScroll && this.assignedViewInfiniteScroll.reset();\n        this.assignedInfiniteScroll && this.assignedInfiniteScroll.reset();\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.setItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    addAssignedEntities: function (entities) {\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.addItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    setAvailableEntities: function (entities) {\n        this.availableInfiniteScroll.reset();\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.setItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    addAvailableEntities: function (entities) {\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.addItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    _filterEntities: function (entities, removeSet, addSet, text) {\n        var allEntities = entities.reject(function (entity) {\n            return removeSet.detect(function (removeEntity) {\n                return removeEntity.equals(entity);\n            });\n        });\n        text = text.toLowerCase();\n        allEntities = allEntities.concat(addSet.findAll(function (entity) {\n            return entity.getDisplayName().toLowerCase().include(text);\n        }));\n        return allEntities;\n    },\n    changeReadonly: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            $(this._id).select(elementPattern)[0].writeAttribute(layoutModule.READONLY_ATTR_NAME, edit ? null : layoutModule.READONLY_ATTR_NAME);\n        }.bind(this));\n    },\n    resetValidation: function (elementsPatterns) {\n        var panel = $(this._id);\n        elementsPatterns.each(function (elementPattern) {\n            ValidationModule.hideError(panel.select(elementPattern)[0]);\n        }.bind(this));\n    },\n    changeDisable: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            if (edit) {\n                buttonManager.enable($(this._id).select(elementPattern)[0]);\n            } else {\n                buttonManager.disable($(this._id).select(elementPattern)[0]);\n            }\n        }.bind(this));\n    },\n    _deleteEntity: function () {\n    },    // Template method.\n\n    _editEntity: function () {\n    },    // Template method.\n\n    _showEntity: function () {\n    }    // Template method.\n};\norgModule.addDialog = {\n    show: function (organization) {\n    },    // Template method.\n\n    hide: function (organization) {\n    }    // Template method.\n};\norgModule.Action = function (invokeFn, beforeInvoke) {\n    if (Object.isFunction(invokeFn)) {\n        beforeInvoke = beforeInvoke && Object.isFunction(beforeInvoke) ? beforeInvoke : this.beforeInvoke;\n        this.invokeAction = function () {\n            if (beforeInvoke()) {\n                return invokeFn.apply(this, arguments);\n            }\n        };\n    }\n};    /**\n * Invokes action.\n */\n/**\n * Invokes action.\n */\norgModule.Action.addMethod('invokeAction', doNothing);    /**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.Action.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.ServerAction = function (eventId, options) {\n    this.actionURL = 'flow.html?_flowExecutionKey=' + window.localContext.flowExecutionKey + '&_eventId=' + eventId;\n    this.data = Object.toQueryString(options);\n    this.onSuccess = doNothing();\n    this.onError = doNothing();\n};    /**\n * Invokes server action.\n */\n/**\n * Invokes server action.\n */\norgModule.ServerAction.addMethod('invokeAction', function () {\n    if (this.beforeInvoke()) {\n        ajaxTargettedUpdate(this.actionURL, {\n            postData: this.data,\n            callback: function (response) {\n                if (response.error) {\n                    this.onError(response.error);\n                } else {\n                    this.onSuccess(response.data);\n                }\n            }.bind(this),\n            errorHandler: function (ajaxAgent) {\n                if (ajaxAgent.getResponseHeader('LoginRequested')) {\n                    orgModule.fire(orgModule.Event.SERVER_UNAVAILABLE, {});\n                    return true;\n                }\n                return baseErrorHandler(ajaxAgent);\n            },\n            mode: AjaxRequester.prototype.EVAL_JSON\n        });\n    }\n});    /**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.ServerAction.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.toolbar = {\n    _actionModel: {},\n    initialize: function (actionModel) {\n        this._actionModel = actionModel;\n        toolbarButtonModule.initialize(this._toActionMap(this._actionModel));\n        this.refresh();\n    },\n    refresh: function () {\n        for (var name in this._actionModel) {\n            var id = this._actionModel[name].buttonId;\n            var testFn = toFunction(this._actionModel[name].test);\n            toolbarButtonModule.setButtonState($(id), testFn());\n        }\n    },\n    _toActionMap: function (bulkActionModel) {\n        var actionMap = {};\n        for (var name in bulkActionModel) {\n            var bulkAction = bulkActionModel[name];\n            var id = bulkAction.buttonId;\n            actionMap[id] = function (action, actionArgs) {\n                return function () {\n                    var myAction = getAsFunction(action);\n                    var args = actionArgs;\n                    var belongsToLocalContext = window.localContext && window.localContext[action];\n                    if (args && isArray(args)) {\n                        myAction.apply(belongsToLocalContext ? window.localContext : null, args);\n                    } else {\n                        myAction.call(belongsToLocalContext ? window.localContext : null, args);\n                    }\n                };\n            }(bulkAction.action, bulkAction.actionArgs);\n        }\n        return actionMap;\n    }\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\n////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\norgModule.createInputRegExValidator = function (input) {\n    return {\n        validator: function (value) {\n            var matches = input.regExp.test(value);\n            var isValid = !matches;\n            var errorMessage = isValid ? '' : orgModule.getMessage('unsupportedSymbols', { symbols: input.unsupportedSymbols });\n            input.isValid = isValid;\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: input\n    };\n};    /**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createBlankValidator = function (element, messageKey, onValid, onInvalid) {\n    return {\n        validator: function (value) {\n            var isValid = !value.blank();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element,\n        onValid: onValid,\n        onInvalid: onInvalid\n    };\n};    /**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createMaxLengthValidator = function (element, messageKey, replaceKey) {\n    return {\n        validator: function (value) {\n            var max = element.hasAttribute('maxlength') ? element.readAttribute('maxlength') : element.maxlength;\n            var isValid = value.length < parseInt(max);\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            replaceKey && (errorMessage = errorMessage.replace(replaceKey, max));\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\norgModule.createSameValidator = function (element, asElement, messageKey) {\n    return {\n        validator: function (value) {\n            var isValid = value === asElement.getValue();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\norgModule.createRegExpValidator = function (element, messageKey, regExp) {\n    return {\n        validator: function (value) {\n            var matches = regExp.exec(value);\n            var isValid = !matches && value.length === 0 || matches && value == matches[0];\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};\norgModule.truncateOrgName = function (name) {\n    return name && name.length > 0 ? name.truncate(15) : '';\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\nfunction RegExpRepresenter(expression) {\n    this.charMap = { '\\\\s': ' ' };\n    this.expressionTokens = this.__parse(expression);\n}\nRegExpRepresenter.addMethod('__parse', function (expression) {\n    var result = $A();\n    for (var i = 1; i < expression.length - 1; i++) {\n        var ch = expression.charAt(i);\n        if (ch == '\\\\') {\n            ch += expression.charAt(++i);\n        }\n        if (ch == '\\\\u') {\n            ch += expression.substring(++i, i + 4);\n            i += 3;\n        }\n        result.push(ch);\n    }\n    return result;\n});\nRegExpRepresenter.addMethod('getCharacters', function () {\n    var result = $A();\n    this.expressionTokens.each(function (token) {\n        if (token.startsWith('\\\\u')) {\n            /*eslint-disable-next-line no-eval*/\n            result.push(eval('\"' + token + '\"'));\n        } else if (token.startsWith('\\\\')) {\n            var ch = this.charMap[token];\n            result.push(ch ? ch : token.substring(1, token.length));\n        } else {\n            result.push(token);\n        }\n    }.bind(this));\n    return result;\n});\nRegExpRepresenter.addMethod('getRepresentedString', function () {\n    var result = '';\n    var chars = this.getCharacters();\n    var len = chars.length;\n    for (var i = 0; i < len; i++) {\n        var ch = chars[i];\n        if (ch == ' ' || ch == '.' || ch == ',') {\n            result += '[' + ch + ']';\n        } else {\n            result += ch;\n        }\n        if (i < len - 1) {\n            result += ', ';\n        }\n    }\n    return result;\n});\n\nexport default orgModule;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport xssUtil from '../../util/xssUtil';\nimport alertDialogTemplate from './template/alertDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    contentTemplate: _.template(alertDialogTemplate),\n    constructor: function (options) {\n        options || (options = {});\n        Dialog.prototype.constructor.call(this, {\n            modal: options.modal !== false,\n            message: options.message,\n            additionalCssClasses: 'alertDialog ' + (options.additionalCssClasses || ''),\n            title: options.title || i18n['dialog.exception.title'],\n            buttons: [{\n                label: i18n['button.close'],\n                action: 'close',\n                primary: true\n            }]\n        }, options);\n    },\n    initialize: function (options) {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:close', this.close);\n        this.setMessage(options.message);\n    },\n    setMessage: function (message) {\n        message = xssUtil.softHtmlEscape(message, {whiteList: [\"br\"]});\n        this.content = this.contentTemplate({ message: message });\n        var rendered = this.renderContent();\n        this.$contentContainer.html(rendered);\n    }\n});","export default \"<p class='alertText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{- message }}\\n</p>\";","export default \"<p class='confirmationText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{ print(_.xssSoftEscape(text)) }}\\n</p>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport confirmDialogTemplate from './template/confirmDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.confirmDialogTemplate = options.confirmDialogTemplate || _.template(confirmDialogTemplate);\n        Dialog.prototype.constructor.call(this, {\n            modal: true,\n            additionalCssClasses: options.additionalCssClasses || 'confirmationDialog',\n            title: options.title || i18n['dialog.confirm.title'],\n            content: this.confirmDialogTemplate({ text: options.text }),\n            buttons: [\n                {\n                    label: options.yesLabel || i18n['button.yes'],\n                    action: 'yes',\n                    primary: true\n                },\n                {\n                    label: options.noLabel || i18n['button.no'],\n                    action: 'no',\n                    primary: false\n                }\n            ]\n        });\n    },\n    initialize: function () {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:yes', this.close);\n        this.on('button:no', this.close);\n    },\n    setContent: function (content) {\n        Dialog.prototype.setContent.call(this, this.confirmDialogTemplate({ text: content }));\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar scrollbarWidth = 0;\nexport default {\n    getScrollbarWidth: function () {\n        if (scrollbarWidth) {\n            return scrollbarWidth;\n        }\n        var scrollDiv = document.createElement('div');\n        scrollDiv.style.width = '100px';\n        scrollDiv.style.height = '100px';\n        scrollDiv.style.overflow = 'scroll';\n        scrollDiv.style.position = 'absolute';\n        scrollDiv.style.top = '-9999px';\n        document.body.appendChild(scrollDiv);\n        scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n        document.body.removeChild(scrollDiv);\n        return scrollbarWidth;\n    },\n    hasScrollBar: function (el, direction) {\n        direction = direction === 'vertical' ? 'scrollTop' : 'scrollLeft';\n        var result = !!el[direction];\n        if (!result) {\n            el[direction] = 1;\n            result = !!el[direction];\n            el[direction] = 0;\n        }\n        return result;\n    },\n    isScrollable: function (el) {\n        var style = window.getComputedStyle ? window.getComputedStyle(el) : el.currentStyle;\n        if (!style) {\n            return;\n        }\n        return style.overflow == 'scroll' || style.overflow == 'auto' || style.overflowX == 'scroll' || style.overflowX == 'auto' || style.overflowY == 'scroll' || style.overflowY == 'auto';\n    },\n    getElementOffset: function (el) {\n        var left = 0, top = 0;\n        if (el.offsetParent) {\n            left = el.offsetLeft;\n            top = el.offsetTop;\n            while (el = el.offsetParent) { // jshint ignore: line\n                left += el.offsetLeft;\n                top += el.offsetTop;\n            }\n        }\n        return {\n            left: left,\n            top: top\n        };\n    },\n    getMargins: function ($element) {\n        var values = {\n            top: parseInt($element.css('margin-top'), 10),\n            right: parseInt($element.css('margin-right'), 10),\n            bottom: parseInt($element.css('margin-bottom'), 10),\n            left: parseInt($element.css('margin-left'), 10)\n        };\n        _.each(values, function (ignore, key) {\n            if (isNaN(values[key])) {\n                values[key] = 0;\n            }\n        });\n        return values;\n    },\n    getPaddings: function ($element) {\n        var values = {\n            top: parseInt($element.css('padding-top'), 10),\n            right: parseInt($element.css('padding-right'), 10),\n            bottom: parseInt($element.css('padding-bottom'), 10),\n            left: parseInt($element.css('padding-left'), 10)\n        };\n        _.each(values, function (ignore, key) {\n            if (isNaN(values[key])) {\n                values[key] = 0;\n            }\n        });\n        return values;\n    },\n    disableBackForwordCache: function () {\n        window.onpageshow = function () {\n            if (event.persisted) {\n                window.location.reload();\n            }\n        };\n    }\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global alert, confirm*/\n/**\n * Local context initialization.\n */\n\nimport {$ , Template} from 'prototype';\nimport jQuery from 'jquery';\nimport _ from 'underscore';\nimport {\n    isIPad,\n    isWebKitEngine,\n    isSupportsTouch,\n    isRightClick,\n    deepClone\n} from \"../util/utils.common\";\nimport layoutModule from '../core/core.layout';\nimport webHelpModule from '../components/components.webHelp';\nimport orgModule from '../manage/mng.common';\nimport buttonManager from '../core/core.events.bis';\nimport dialogs from '../components/components.dialogs';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport __jrsConfigs__ from 'js-sdk/src/jrs.configs';\nimport AlertDialog from 'js-sdk/src/common/component/dialog/AlertDialog';\nimport i18n from '../i18n/jasperserver_messages.properties';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport domUtil from 'js-sdk/src/common/util/domUtil';\n\n//var localContext = window;\n//////////////////////////\n// Tests for action model\n//////////////////////////\nfunction invokeAction(actionName) {\n    var action = repositorySearch.Action['create' + actionName].call();\n    action.invokeAction();\n}\nfunction invokeFolderAction(actionName, folder) {\n    var theFolder = folder ? folder : repositorySearch.model.getContextFolder();\n    var action = repositorySearch.folderActionFactory[actionName](theFolder);\n    action.invokeAction();\n}\nfunction invokeResourceAction(actionName, resource, options) {\n    var theResource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    var action = repositorySearch.resourceActionFactory[actionName](theResource, options);\n    action.invokeAction();\n}\nfunction invokeBulkAction(actionName) {\n    var resources = repositorySearch.model.getSelectedResources();\n    var action = repositorySearch.bulkActionFactory[actionName](resources);\n    action.invokeAction();\n}\n\nvar invokeRedirectAction = _.debounce(function (actionName, options) {\n    var action = repositorySearch.RedirectAction['create' + actionName].call();\n    action.invokeAction(options);\n}, 500)\n\nfunction invokeCreate(resourceTypeSuffix, fileType) {\n    var action = repositorySearch.RedirectAction.createCreateResourceAction(resourceTypeSuffix, fileType);\n    action.invokeAction();\n}\nfunction isCopyOrMove() {\n    return repositorySearch.CopyMoveController.isCopy() || repositorySearch.CopyMoveController.isMove();\n}\nfunction isFolderCopyOrMove() {\n    return repositorySearch.CopyMoveController.isCopyFolder() || repositorySearch.CopyMoveController.isMoveFolder();\n}\nfunction isResourceCopyOrMove() {\n    return repositorySearch.CopyMoveController.isCopyResource() || repositorySearch.CopyMoveController.isMoveResource();\n}\nfunction canCreateFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganizationsRoot() && folder.isEditable();\n}\nfunction canFolderBeDeleted() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isPublic() && !folder.isTemp() && !folder.isOrganizationsRoot() && folder.isRemovable() && !folder.isActiveThemeFolder() && !folder.isThemeRootFolder();\n}\nfunction canFolderBeEdited(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    return folder && folder.isEditable();\n}\nfunction canFolderBeCopied(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isOrganizationsRoot() && folder.isReadable();\n}\nfunction canFolderBeCopiedOrMovedToFolder(folder) {\n    var toFolder = folder ? folder : repositorySearch.model.getContextFolder();\n    var canFolderBeCopiedOrMoved = isFolderCopyOrMove() && !toFolder.isOrganizationsRoot() && canFolderBeEdited(toFolder);\n    if (!canFolderBeCopiedOrMoved) {\n        return false;\n    }\n    var theFolder = repositorySearch.CopyMoveController.object;\n    return toFolder.URI !== theFolder.URI;\n}\nfunction canFolderBeMoved(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isPublic() && !folder.isTemp() && !folder.isOrganizationsRoot() && folder.isRemovable() && !folder.isActiveThemeFolder() && !folder.isThemeRootFolder();\n}\nfunction canFolderBeExported(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    var pathElements = folder.URI.split('/');\n    return !((folder.URI === '/' || pathElements[pathElements.length - 1] === 'organizations' || pathElements[pathElements.length - 2] === 'organizations') && pathElements[pathElements.length - 1] !== 'org_template');\n}\nfunction canFolderPermissionsBeAssigned() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isAdministrable();\n}\nfunction canFolderPropertiesBeShowed() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isReadable() && !canFolderPropertiesBeEdited();\n}\nfunction canFolderPropertiesBeEdited() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isEditable() && !folder.isOrganization() && !folder.isOrganizationsRoot() && !folder.isRoot();\n}\nfunction canResourceBeCreated(type) {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isOrganizationsRoot() && folder.isEditable();\n}\nfunction canBeRun(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && repositorySearch.runActionFactory[resource.typeSuffix()] && !repositorySearch.isflowRedirectRunning;\n}\nfunction canBeGenerated(resource) {\n    return false;\n}\nfunction canBeConverted(resource) {\n    return false;\n}\nfunction canResourceBeEdited(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    var hasEditActionImpl = repositorySearch.editActionFactory[resource.typeSuffix()] || ResourcesUtils.isCustomDataSource(resource);\n    var allowed = resource && resource.isEditable() && hasEditActionImpl;    // Edit menu item is forbidden.\n    // Edit menu item is forbidden.\n    if (['DashboardResource'].include(resource.typeSuffix())) {\n        return false;\n    } else {\n        return allowed;\n    }\n}\nfunction canBeOpenedInDesigner(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isEditable() && repositorySearch.openActionFactory[resource.typeSuffix()] && resource.typeSuffix() !== 'ContentResource';\n}\nfunction canBeOpened(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && repositorySearch.openActionFactory[resource.typeSuffix()] && resource.typeSuffix() === 'ContentResource';\n}\nfunction canBeRunInBackground(resource) {\n    return window.canBeScheduled(resource);\n}\nfunction canBeScheduled(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && [\n        repositorySearch.ResourceType.REPORT_UNIT,\n        repositorySearch.ResourceType.ADHOC_REPORT_UNIT,\n        repositorySearch.ResourceType.REPORT_OPTIONS\n    ].include(resource.resourceType);\n}\nfunction canResourceBeCopied(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable();\n}\nfunction canResourceBeMoved(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isRemovable();\n}\nfunction canResourceBeDeleted(resource) {\n    resource = repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isRemovable();\n}\nfunction canResourcePropertiesBeShowed() {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && !resource.isEditable();\n}\nfunction canResourcePropertiesBeEdited(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isEditable();\n}\nfunction canResourcePermissionsBeAssigned() {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isAdministrable();\n}\nfunction canAllBeRun() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !window.canBeRun(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeEdited() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !window.canResourceBeEdited(resource);\n    });\n    return resources.length > 0 && detected === undefined && !isIPad();\n}\nfunction canAllBeOpened() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !window.canBeOpenedInDesigner(resource) && !window.canBeOpened(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeCopied() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourceBeCopied(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeMoved() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourceBeMoved(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeCopiedOrMovedToFolder(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    var canAllBeCopiedOrMoved = isResourceCopyOrMove() && !folder.isOrganizationsRoot() && canFolderBeEdited(folder);\n    if (!canAllBeCopiedOrMoved) {\n        return false;\n    }\n    var resources = repositorySearch.CopyMoveController.isBulkAction() ? repositorySearch.CopyMoveController.object : [repositorySearch.CopyMoveController.object];\n    var allow = true;\n    if (folder.isThemeRootFolder() || folder.isThemeFolder()) {\n        var allFiles = resources.detect(function (resource) {\n            return !resource.resourceType.endsWith('.FileResource');\n        }) == null;\n        allow = allFiles;\n    }\n    return allow;\n}\nfunction canAllBePasted() {\n    return canAllBeCopiedOrMovedToFolder(repositorySearch.model.getSelectedFolder());\n}\nfunction canAllPropertiesBeShowed() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function () {\n        return !canResourcePropertiesBeShowed();\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllPropertiesBeEdited() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourcePropertiesBeEdited(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canBeAddedToFavorites() {\n    let resources = repositorySearch.model.getSelectedResources();\n    return resources.every((resource)=>{\n        return !resource.isFavorite;\n    });\n}\nfunction canBeRemovedFromFavorites() {\n    let resources = repositorySearch.model.getSelectedResources();\n    return resources.every((resource)=>{\n        return resource.isFavorite;\n    });\n}\n\nfunction canAllBeDeleted() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourceBeDeleted(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction isThemeFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isThemeFolder();\n}\nfunction isNonActiveThemeFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return isThemeFolder() && !folder.isActiveThemeFolder();\n}\nfunction isThemeRootFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isThemeRootFolder();\n}\nfunction canThemeBeReuploaded() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isThemeFolder() && canFolderBeEdited(folder);\n}\nfunction isPermissionsChanged() {\n    var permissionDialogs = repositorySearch.dialogsPool.getAllPermissionsDialogs();\n    return permissionDialogs.detect(function (dialog) {\n        return dialog.isChanged();\n    });\n}\nfunction isPropertiesChanged() {\n    var propertyDialogs = repositorySearch.dialogsPool.getAllPropertiesDialogs();\n    return propertyDialogs.detect(function (dialog) {\n        return dialog.isChanged();\n    });\n}    ////////////////////////////\n// Repository search object\n////////////////////////////\n////////////////////////////\n// Repository search object\n////////////////////////////\nvar repositorySearch = {\n    _container: null,\n    mode: null,\n    isFlowRedirectRunning: false,\n    flowExecutionKey: '',\n    messages: [],\n    Mode: {\n        SEARCH: 'search',\n        BROWSE: 'browse',\n        LIBRARY: 'library'\n    },\n    ResourceType: {\n        REPORT_UNIT: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.ReportUnit',\n        ADHOC_REPORT_UNIT: 'com.jaspersoft.ji.adhoc.AdhocReportUnit',\n        OLAP_UNIT: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapUnit',\n        DASHBOARD_RESOURCE: 'com.jaspersoft.ji.adhoc.DashboardResource',\n        DASHBOARD: 'com.jaspersoft.ji.dashboard.DashboardModelResource',\n        REPORT_OPTIONS: 'com.jaspersoft.ji.report.options.metadata.ReportOptions',\n        REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.ReportDataSource',\n        JDBC_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.JdbcReportDataSource',\n        JNDI_JDBC_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.JndiJdbcReportDataSource',\n        VIRTUAL_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.VirtualReportDataSource',\n        CUSTOM_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.CustomReportDataSource',\n        BEAN_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.BeanReportDataSource',\n        OLAP_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapDataSource',\n        OLAP_CLIENT_CONNECTION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapClientConnection',\n        QUERY: 'com.jaspersoft.jasperserver.api.metadata.common.domain.Query',\n        INPUT_CONTROL: 'com.jaspersoft.jasperserver.api.metadata.common.domain.InputControl',\n        LIST_OF_VALUES: 'com.jaspersoft.jasperserver.api.metadata.common.domain.ListOfValues',\n        LIST_OF_VALUES_ITEM: 'com.jaspersoft.jasperserver.api.metadata.common.domain.ListOfValuesItem',\n        DATA_TYPE: 'com.jaspersoft.jasperserver.api.metadata.common.domain.DataType',\n        MONDRIAN_CONNECTION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.MondrianConnection',\n        SECURE_MONDRIAN_CONNECTION: 'com.jaspersoft.ji.ja.security.domain.SecureMondrianConnection',\n        XMLA_CONNECTION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.XMLAConnection',\n        MONDRIAN_XMLA_DEFINITION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.MondrianXMLADefinition',\n        CONTENT_RESOURCE: 'com.jaspersoft.jasperserver.api.metadata.common.domain.ContentResource',\n        FILE_RESOURCE: 'com.jaspersoft.jasperserver.api.metadata.common.domain.FileResource',\n        SEMANTIC_LAYER_DATA_SOURCE: 'com.jaspersoft.commons.semantic.datasource.SemanticLayerDataSource',\n        DATA_DEFINER_UNIT: 'com.jaspersoft.commons.semantic.DataDefinerUnit'\n    },\n    SearchAction: {\n        NEXT: 'next',\n        GET_RESOURCE_CHILDREN: 'getResourceChildren'\n    },\n    Event: {\n        SEARCH_RUN: 'search:run',\n        SEARCH_BROWSE: 'search:browse',\n        SEARCH_FILTER: 'search:filter',\n        SEARCH_SORT: 'search:sort',\n        SEARCH_NEXT: 'search:next',\n        SEARCH_ROLLBACK: 'search:rollback',\n        SEARCH_SEARCH: 'search:search',\n        SEARCH_CHILDREN: 'search:children',\n        STATE_CHANGED: 'state:changed',\n        FILTER_PATH_CHANGED: 'filterPath:changed',\n        RESULT_CHANGED: 'result:changed',\n        CHILDREN_LOADED: 'resourceChildren:loaded',\n        RESULT_NEXT: 'result:next',\n        RESULT_ERROR: 'result:error',\n        REDIRECT_ERROR: 'redirect:error',\n        FLOW_REDIRECT_RUNNING: 'flowRedirect:running'\n    },\n    InfoAction: { GET_DISPLAY_PATH: 'getDisplayPath' },\n    PermissionAction: {\n        BROWSE: 'permissionBrowse',\n        SEARCH: 'permissionSearch',\n        NEXT: 'permissionNext',\n        UPDATE: 'permissionsUpdate'\n    },\n    PermissionEvent: {\n        BROWSE: 'permission:browse',\n        SEARCH: 'permission:search',\n        NEXT: 'permission:next',\n        UPDATE: 'permission:update',\n        LOADED: 'permission:loaded',\n        UPDATED: 'permission:updated',\n        ERROR: 'permission:error'\n    },\n    FolderAction: {\n        CREATE: 'createFolder',\n        COPY: 'copyFolder',\n        MOVE: 'moveFolder',\n        UPDATE: 'updateFolder',\n        DELETE: 'deleteFolder'\n    },\n    FolderEvent: {\n        DELETED: 'folder:deleted',\n        DELETE_ERROR: 'folder:deleteError',\n        CREATED: 'folder:created',\n        CREATE_ERROR: 'folder:createError',\n        COPIED: 'folder:copied',\n        COPY_ERROR: 'folder:copyError',\n        MOVED: 'folder:moved',\n        MOVE_ERROR: 'folder:moveError',\n        UPDATED: 'folder:updated',\n        UPDATE_ERROR: 'folder:updateError'\n    },\n    ResourceAction: {\n        DELETE: 'deleteResources',\n        COPY: 'copyResources',\n        MOVE: 'moveResources',\n        UPDATE: 'updateResource',\n        GENERATE: 'generate',\n        CONVERT: 'convert'\n    },\n    ResourceEvent: {\n        DELETED: 'resource:deleted',\n        DELETE_ERROR: 'resource:deleteError',\n        COPIED: 'resource:copied',\n        COPY_ERROR: 'resource:copyError',\n        MOVED: 'resource:moved',\n        MOVE_ERROR: 'resource:moveError',\n        UPDATED: 'resource:updated',\n        UPDATE_ERROR: 'resource:updateError',\n        GENERATED: 'resource:generated',\n        GENERATE_ERROR: 'resource:generateError',\n        CONVERTED: 'resource:converted',\n        CONVERT_ERROR: 'resource:convertError'\n    },\n    RedirectType: {\n        FLOW_REDIRECT: 0,\n        LOCATION_REDIRECT: 1,\n        WINDOW_REDIRECT: 2\n    },\n    ThemeAction: {\n        SETTHEME: 'setActiveTheme',\n        DOWNLOAD_THEME: 'downloadTheme',\n        REUPLOAD: 'reuploadTheme'\n    },\n    ThemeEvent: {\n        UPDATED: 'theme:updated',\n        REUPLOADED: 'theme:reuploaded',\n        THEME_ERROR: 'theme:error'\n    },\n    ResourcesFavoriteAction: {\n        FILTER_ID: 'favoriteFilter',\n        ALL_RESOURCES: 'favoriteFilter-all',\n        FAVORITE_RESOURCES: 'favoriteFilter-favorites'\n    },\n    initialize: function (localContext) {\n        var options = localContext.rsInitOptions;\n        repositorySearch.mode = options.mode;\n        repositorySearch.flowExecutionKey = options.flowExecutionKey;\n        layoutModule.resizeOnClient(document.body.id == 'repoSearch' ? 'searchFilters' : 'folders', 'results');\n        webHelpModule.setCurrentContext(repositorySearch.mode === repositorySearch.Mode.SEARCH ? 'search' : 'repo');\n        options.enableDnD = repositorySearch.mode == repositorySearch.Mode.BROWSE && !isIPad();\n        repositorySearch.model.setPublicFolderUri(options.publicFolderUri);\n        repositorySearch.model.setTempFolderUri(options.tempFolderUri);\n        repositorySearch.model.setRootFolderUri(options.rootFolderUri);\n        repositorySearch.model.setOrganizationsFolderUri(options.organizationsFolderUri);\n        repositorySearch.model.setFolderSeparator(options.folderSeparator);\n        repositorySearch.model.setAdministrator(options.isAdministrator);\n        repositorySearch.model.setConfiguration(options.configuration);\n        repositorySearch.model.setServerState(options.state);\n        repositorySearch.CursorManager.initialize();\n        repositorySearch.actionModel.initialize();\n        if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n            repositorySearch.toolbar.initialize(repositorySearch.actionModel.bulkActions);\n            repositorySearch.foldersPanel.initialize(options);\n        } else {\n            repositorySearch.filtersPanel.initialize(repositorySearch.model.getFiltersConfiguration(), repositorySearch.model.getFiltersState());\n            repositorySearch.secondarySearchBox.initialize(repositorySearch.model.getTextState());\n            repositorySearch.filterPath.initialize();\n        }\n        repositorySearch.resultsPanel.initialize(options);\n        if(repositorySearch.mode === repositorySearch.Mode.LIBRARY){\n            repositorySearch.favoriteSwitchControl.initialize(options);\n        }\n        repositorySearch.sortersPanel.initialize(repositorySearch.model.getSortersConfiguration(), repositorySearch.model.getSortState());\n        repositorySearch.initFolderEvents();\n        repositorySearch.initResourceEvents();\n        repositorySearch.initThemeEvents();\n        repositorySearch.observe('search:filter', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('filter', {\n                filterId: event.memo.filterId,\n                filterOption: event.memo.optionId\n            });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:sort', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('sort', { sortBy: event.memo.sorterId });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:browse', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('browse', { folderUri: event.memo.uri });\n            action.invokeAction();\n            repositorySearch.actionModel.refreshToolbar();\n        });\n        repositorySearch.observe('search:search', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('search', { text: event.memo.text });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:next', function (event) {\n            var action = new this.ServerAction.createSearchAction(this.SearchAction.NEXT, {});\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('search:rollback', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('rollback', { position: event.memo.position });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:children', function (event) {\n            var resource = event.memo.resource;\n            var item = event.memo.item;\n            var action = new this.ServerAction.createSearchAction(this.SearchAction.GET_RESOURCE_CHILDREN, {\n                resourceUri: resource.URIString,\n                resourceType: resource.resourceType,\n                item: item\n            });\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:browse', function (event) {\n            var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.BROWSE, event.memo);\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:search', function (event) {\n            var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.SEARCH, event.memo);\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:next', function (event) {\n            var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.NEXT, event.memo);\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:update', function (event) {\n            var uri = event.memo.uri;\n            var entities = event.memo.entities;\n            var finishEdit = event.memo.finishEdit;\n            if (entities.length > 0) {\n                var data = entities.collect(function (entity) {\n                    return entity.toPermissionData();\n                });\n                var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.UPDATE, {\n                    uri: uri,\n                    entitiesWithPermission: Object.toJSON(data),\n                    finishEdit: finishEdit\n                });\n                action.invokeAction();\n            } else {\n                var dialog = repositorySearch.dialogsPool.getPermissionsDialog(uri);\n                finishEdit && dialog.hide();\n            }\n        }.bindAsEventListener(repositorySearch));\n        function jsonToEntities(entities, type) {\n            if (entities) {\n                var clazz = type == 'USER' ? orgModule.User : orgModule.Role;\n                return entities.collect(function (entity) {\n                    return new clazz(entity);\n                });\n            } else {\n                return [];\n            }\n        }\n        repositorySearch.observe('permission:loaded', function (event) {\n            var data = event.memo.responseData;\n            var dialog = repositorySearch.dialogsPool.getPermissionsDialog(event.memo.inputData.uri);\n            dialog.stopWaiting();\n            if (data) {\n                if (event.memo.doSet) {\n                    dialog.setEntities(jsonToEntities(data.entities, data.type));\n                } else {\n                    dialog.addEntities(jsonToEntities(data.entities, data.type));\n                }\n                if (data.type === 'USER') {\n                    buttonManager.select(dialog._byUsersButton.parentNode);\n                    buttonManager.unSelect(dialog._byRolesButton.parentNode);\n                } else {\n                    buttonManager.unSelect(dialog._byUsersButton.parentNode);\n                    buttonManager.select(dialog._byRolesButton.parentNode);\n                }\n            }\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:updated', function (event) {\n            var uri = event.memo.inputData.uri;\n            var finishEdit = event.memo.inputData.finishEdit;\n            var dialog = repositorySearch.dialogsPool.getPermissionsDialog(uri);\n            dialog.enable();\n            if (finishEdit) {\n                dialog.hide();\n            } else {\n                var data = event.memo.responseData;\n                data && dialog.updateEntities(jsonToEntities(data.entities, data.type));\n            }\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:error', function (event) {\n            alert(Object.toJSON(event.memo));\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('resourceChildren:loaded', function (event) {\n            var item = event.memo.inputData.item;\n            var resource = item.getValue();\n            var data = event.memo.responseData;\n            if (Object.isArray(data)) {\n                var resources = [];\n                data.each(function (rJson) {\n                    var r = new Resource(rJson);\n                    resource.addChild(r);\n                    resources.push(r);\n                });\n                repositorySearch.resultsPanel.setResources(resources, item);\n                if (resource.isLoaded() && item.isLoading) {\n                    item.setLoading(false);\n                }\n            }\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('state:changed', function (event) {\n            repositorySearch.sortersPanel.enableItems();\n            repositorySearch.updateUI(event.memo.state);\n        });\n        repositorySearch.observe('filterPath:changed', function (event) {\n            repositorySearch.filterPath.setPathItems(event.memo.filterPath);\n        });\n        repositorySearch.observe('result:changed', function (event) {\n            var data = event.memo.resources;\n            var resources = data.collect(function (rData) {\n                return new Resource(rData);\n            });\n            repositorySearch.resultsPanel.setResources(resources);\n\n            var list = repositorySearch.resultsPanel.getList(),\n                items = list.getItems();\n\n            list.setCursor(items[0]);\n        });\n        repositorySearch.observe('result:next', function (event) {\n            var data = event.memo.resources;\n            var resources = data.collect(function (rData) {\n                return new Resource(rData);\n            });\n            repositorySearch.resultsPanel.addResources(resources);\n        });\n        repositorySearch.observe('result:error', this.defaultErrorHandler);\n        repositorySearch.observe('redirect:error', this.defaultErrorHandler);\n        repositorySearch.observe('flowRedirect:running', function () {\n            repositorySearch.isflowRedirectRunning = true;\n            repositorySearch.toolbar.refresh();\n        });    // First call\n        // First call\n        if (repositorySearch.Mode.BROWSE != options.mode) {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: repositorySearch.model.getTextState() });\n        }\n        if (!localContext.rsInitOptions.systemConfirm.blank()) {\n            dialogs.systemConfirm.show(localContext.rsInitOptions.systemConfirm);\n        }    //Show popup dialog if error message present\n        //Show popup dialog if error message present\n        if (!localContext.rsInitOptions.errorPopupMessage.blank()) {\n            dialogs.errorPopup.show(localContext.rsInitOptions.errorPopupMessage);\n        }\n        this._disableBfCacheIfSafari();\n    },\n    showContextMenu: function (e) {\n        var event = e.memo.targetEvent;\n        if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n            if (repositorySearch.foldersPanel.isFolderContextMenu(event)) {\n                repositorySearch.actionModel.showFolderMenu(event);\n            }\n        }\n        if (repositorySearch.resultsPanel.isResourceContextMenu(event)) {\n            var resources = repositorySearch.model.getSelectedResources();\n            if (resources.length > 1) {\n                repositorySearch.actionModel.showResourceBulkMenu(event);\n            } else {\n                repositorySearch.actionModel.showResourceMenu(event);\n            }\n        }\n    },\n    _disableBfCacheIfSafari: function () {\n        if (isWebKitEngine()) {\n            domUtil.disableBackForwordCache();\n        }\n    },\n    updateUI: function (state) {\n        // Check sort state.\n        if (state.sortBy != repositorySearch.model.getSortState()) {\n            jQuery(repositorySearch.sortersPanel).find(state.sortBy, true)[0];\n        }    // Check text state.\n        // Check text state.\n        if (state.text != repositorySearch.model.getTextState()) {\n            if (repositorySearch.mode != repositorySearch.Mode.BROWSE) {\n                repositorySearch.secondarySearchBox.setText(state.text);\n            }\n        }    // Check filters states.\n        // Check filters states.\n        for (var filterId in state.customFilters) {\n            if (state.customFilters[filterId] != repositorySearch.model.getFiltersState()[filterId]) {\n                jQuery(repositorySearch.filtersPanel).find(filterId, state.customFilters[filterId], true)[0];\n            }\n        }\n        // TODO: select folder\n        repositorySearch.model.setServerState(state);\n    },\n    initFolderEvents: function () {\n        this.observe('folder:deleted', function (event) {\n            var folder = event.memo.inputData.folder;\n            var parentFolder = folder.getParentFolder();\n            var foldersPanel = repositorySearch.foldersPanel;\n            foldersPanel.refreshFolder(parentFolder);\n            if (parentFolder.URI === '/') {\n                //force root folder selection\n                foldersPanel.tree._selectOrEditNode(undefined, parentFolder.node, false);\n            }\n        });\n        this.observe('folder:deleteError', this.defaultErrorHandler);\n        this.observe('folder:created', function (event) {\n            var folder = event.memo.inputData.toFolder;\n            repositorySearch.foldersPanel.refreshFolder(folder);\n        });\n        this.observe('folder:createError', this.defaultErrorHandler);\n        this.observe('folder:copied', function (event) {\n            var folder = event.memo.inputData.folder;\n            var toFolder = event.memo.inputData.toFolder;\n            repositorySearch.CopyMoveController.cancel();\n            repositorySearch.foldersPanel.moveOrCopyFolder(folder, toFolder, true);\n        });\n        this.observe('folder:copyError', this.defaultErrorHandler);\n        this.observe('folder:moved', function (event) {\n            var folder = event.memo.inputData.folder;\n            var toFolder = event.memo.inputData.toFolder;\n            repositorySearch.CopyMoveController.cancel();\n            repositorySearch.foldersPanel.moveOrCopyFolder(folder, toFolder);\n        });\n        this.observe('folder:moveError', this.defaultErrorHandler);\n        this.observe('folder:updated', function (event) {\n            var folder = event.memo.inputData.folder;\n            var label = event.memo.responseData.label;\n            var desc = event.memo.responseData.desc;\n            repositorySearch.foldersPanel.updateFolder(folder, label, desc);\n        });\n        this.observe('folder:updateError', this.defaultErrorHandler);\n    },\n    initResourceEvents: function () {\n        this.observe('resource:deleted', function (event) {\n            var resources = event.memo.inputData.resources;\n            var response = event.memo.responseData;\n            if (response.dependentResources) {\n                dialogs.dependentResources.show(response.dependentResources, null, {\n                    okOnly: true,\n                    canSave: false,\n                    topMessage: repositorySearch.messages['dialog.dependencies.resources.message'],\n                    bottomMessage: repositorySearch.messages['dialog.dependencies.resources.deleteMessage']\n                });\n            } else {\n                repositorySearch.resultsPanel.removeResources(resources);\n            }\n        });\n        this.observe('resource:deleteError', this.defaultErrorHandler);\n        this.observe('resource:copied', function (event) {\n            var folder = event.memo.inputData.folder;\n            repositorySearch.foldersPanel.reselectFolder(folder);\n        });\n        this.observe('resource:copyError', this.defaultErrorHandler);\n        this.observe('resource:moved', function (event) {\n            var toFolder = event.memo.inputData.folder;\n            var selectedFolder = repositorySearch.model.getSelectedFolder();\n            repositorySearch.foldersPanel.reselectFolder(toFolder);\n            repositorySearch.foldersPanel.reselectFolder(selectedFolder);\n        });\n        this.observe('resource:moveError', this.defaultErrorHandler);\n        this.observe('resource:updated', function (event) {\n            repositorySearch.resultsPanel.updateResource(new Resource(event.memo.responseData));\n        });\n        this.observe('resource:updateError', this.defaultErrorHandler);\n        this.observe('resource:generated', function (event) {\n            var inputData = event.memo.inputData;\n            var data = event.memo.responseData;\n            var resource = new Resource(data);\n            if (inputData.run) {\n                var action = repositorySearch.RedirectAction.createRunResourceAction(resource, false);\n                action.invokeAction();\n            } else {\n                if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n                    if (inputData.location == repositorySearch.foldersPanel.getSelectedUri()) {\n                        repositorySearch.foldersPanel.doBrowse();\n                    }\n                } else {\n                    repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: repositorySearch.model.getTextState() });\n                }\n            }\n            dialogs.systemConfirm.show(repositorySearch.messages['RM_REPORT_CREATED'], 5000);\n        });\n        this.observe('resource:generateError', function (event) {\n            var error = event.memo.responseData;\n            var msg = error.msg;\n            var data = error.data;\n            var action;\n            if(msg && msg.indexOf(\"SYSTEM_CONFIRM_REQUIRED\") > -1) {\n                if (data) {\n                    var dialog = new ConfirmationDialog({text: Utils.restOfString(msg, \"SYSTEM_CONFIRM_REQUIRED:\")});\n                    dialog.on(\"button:yes\", function(){\n                        data.overwrite = true;\n\n                        var name = repositorySearch.ResourceAction.GENERATE;\n                        action = new repositorySearch.ServerAction.createGenerateAction(name, data);\n                        action.invokeAction();\n                        dialog.remove();\n                    });\n                    dialog.on(\"button:no\", function(){\n                        dialog.remove();\n                    });\n                    dialog.open();\n                }\n            } else {\n                repositorySearch.defaultErrorHandler(event);\n            }\n        });\n        this.observe('resource:converted', function (event) {\n            dialogs.systemConfirm.show(event.memo.responseData || event.memo, 5000);\n            if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n                repositorySearch.foldersPanel.doBrowse();\n            } else {\n                repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: repositorySearch.model.getTextState() });\n            }\n        });\n        this.observe('resource:convertError', this.defaultErrorHandler);\n    },\n    defaultErrorHandler: function (event) {\n        var errorDialog = new AlertDialog({ title: i18n['dialog.dependencies.title'] });\n        errorDialog.setMessage(event.memo.responseData || event.memo);\n        errorDialog.open();\n\n        repositorySearch.sortersPanel.enableItems();\n    },\n    initThemeEvents: function () {\n        this.observe('theme:updated', function (event) {\n            var data = event.memo.responseData;\n            if (data && data.refresh) {\n                document.body.style.cursor = 'wait';\n                window.location.reload(true);\n            } else {\n                var folder = repositorySearch && repositorySearch.model && repositorySearch.model.getContextFolder() && repositorySearch.model.getContextFolder().getParentFolder();\n                if (folder && repositorySearch.foldersPanel && repositorySearch.foldersPanel.refreshFolder) {\n                    repositorySearch.foldersPanel.refreshFolder(folder);\n                }\n            }\n        });\n        this.observe('theme:reuploaded', function (event) {\n            if (event.memo.responseData.isActiveTheme) {\n                var uri = event.memo.responseData.themeUri;\n                var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME, { folderUri: uri });\n                action.invokeAction();\n            }\n        });\n        this.observe('theme:error', function (event) {\n            var data = event.memo.responseData;\n            if (data) {\n                alert(data);\n            }\n        });\n    },\n    getMessage: function (messageId, object) {\n        var message = repositorySearch.messages[messageId];\n        return message ? new Template(message).evaluate(object ? object : {}) : '';\n    },\n    /**\n     * TODO: add comment.\n     *\n     * @param action\n     */\n    _createAction: function (actionFactory, actionName) {\n        var action;\n        if (actionName.endsWith('FolderAction')) {\n            var folder = repositorySearch.model.getContextFolder();\n            action = actionFactory['create' + actionName].call(null, folder);\n        } else if (actionName.endsWith('ResourceAction') || actionName.endsWith('RunAction')) {\n            var resource = repositorySearch.model.getContextResource();\n            action = actionFactory['create' + actionName].call(null, resource);\n        } else {\n            action = actionFactory['create' + actionName].call();\n        }\n        return action;\n    },\n    observe: function (eventName, handler) {\n        this._getContainer().observe(eventName, handler);\n    },\n    stopObserving: function (eventName, handler) {\n        this._getContainer().stopObserving(eventName, handler);\n    },\n    fire: function (eventName, memo) {\n        this._getContainer().fire(eventName, memo);\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = document.body;\n        }\n        return this._container;\n    }\n};    //////////////////////////////////\n// Repository search model object\n//////////////////////////////////\n//////////////////////////////////\n// Repository search model object\n//////////////////////////////////\nrepositorySearch.model = {\n    _organizationsFolderUri: null,\n    _rootFolderUri: null,\n    _tempFolderUri: null,\n    _publicFolderUri: null,\n    _folderSeparator: null,\n    _configuration: {},\n    _serverState: {},\n    _uiState: {\n        selectedFolder: null,\n        contextFolder: null,\n        contextResource: null,\n        selectedResources: []\n    },\n    _isAdministrator: false,\n    setOrganizationsFolderUri: function (uri) {\n        this._organizationsFolderUri = uri;\n    },\n    getOrganizationsFolderUri: function () {\n        return this._organizationsFolderUri;\n    },\n    setRootFolderUri: function (uri) {\n        this._rootFolderUri = uri;\n    },\n    getRootFolderUri: function () {\n        return this._rootFolderUri;\n    },\n    setTempFolderUri: function (uri) {\n        this._tempFolderUri = uri;\n    },\n    getTempFolderUri: function () {\n        return this._tempFolderUri;\n    },\n    setPublicFolderUri: function (uri) {\n        this._publicFolderUri = uri;\n    },\n    getPublicFolderUri: function () {\n        return this._publicFolderUri;\n    },\n    setFolderSeparator: function (folderSeparator) {\n        this._folderSeparator = folderSeparator;\n    },\n    getFolderSeparator: function () {\n        return this._folderSeparator;\n    },\n    setConfiguration: function (configuration) {\n        this._configuration = configuration;\n    },\n    /**\n     * Gets configuration of the repository search.\n     */\n    getConfiguration: function () {\n        return this._configuration;\n    },\n    /**\n     * Gets configuration of filters\n     */\n    getFiltersConfiguration: function () {\n        return this.getConfiguration().filters;\n    },\n    /**\n     * Gets configuration of sorters.\n     */\n    getSortersConfiguration: function () {\n        return this.getConfiguration().sorters;\n    },\n    setServerState: function (state) {\n        this._serverState = state;\n    },\n    /**\n     * Gets Server state of the repository search.\n     */\n    getServerState: function () {\n        return this._serverState;\n    },\n    /**\n     * Gets UI state of the repository search.\n     */\n    getUIState: function () {\n        return this._uiState;\n    },\n    setAdministrator: function (isAdministrator) {\n        this._isAdministrator = isAdministrator;\n    },\n    isAdministrator: function () {\n        return this._isAdministrator;\n    },\n    /**\n     * Gets state of filters.\n     */\n    getFiltersState: function () {\n        return this.getServerState().customFilters;\n    },\n    /**\n     * Gets state of sorters.\n     */\n    getSortState: function () {\n        return this.getServerState().sortBy;\n    },\n    /**\n     * Gets state of text.\n     */\n    getTextState: function () {\n        return this.getServerState().text;\n    },\n    /**\n     * Gets state of folderUri.\n     */\n    getFolderUriState: function () {\n        return this.getServerState().folderUri;\n    },\n    setSelectedFolder: function (folder) {\n        this.getUIState().selectedFolder = folder;\n\n        return folder;\n    },\n    getSelectedFolder: function () {\n        return this.getUIState().selectedFolder;\n    },\n    setContextFolder: function (folder) {\n        this.getUIState().contextFolder = folder;\n\n        return folder;\n    },\n    getContextFolder: function () {\n        return this.getUIState().contextFolder;\n    },\n    setSelectedResources: function (resources) {\n        this.getUIState().selectedResources = resources;\n\n        return resources;\n    },\n    getSelectedResources: function () {\n        return this.getUIState().selectedResources;\n    }\n};    /////////////////////////////////////////\n// Repository search action model object\n/////////////////////////////////////////\n/////////////////////////////////////////\n// Repository search action model object\n/////////////////////////////////////////\nrepositorySearch.actionModel = {\n    bulkActions: {\n        RUN: {\n            buttonId: 'run',\n            action: invokeBulkAction,\n            actionArgs: 'Run',\n            test: canAllBeRun\n        },\n        EDIT: {\n            buttonId: 'edit',\n            action: invokeBulkAction,\n            actionArgs: 'Edit',\n            test: canAllBeEdited\n        },\n        OPEN: {\n            buttonId: 'open',\n            action: invokeBulkAction,\n            actionArgs: 'Open',\n            test: canAllBeOpened\n        },\n        COPY: {\n            buttonId: 'copy',\n            action: invokeBulkAction,\n            actionArgs: 'Copy',\n            test: canAllBeCopied\n        },\n        CUT: {\n            buttonId: 'cut',\n            action: invokeBulkAction,\n            actionArgs: 'Move',\n            test: canAllBeMoved\n        },\n        PASTE: {\n            buttonId: 'paste',\n            action: invokeFolderAction,\n            actionArgs: 'PasteResources',\n            test: canAllBePasted\n        },\n        REMOVE: {\n            buttonId: 'remove',\n            action: invokeBulkAction,\n            actionArgs: 'Delete',\n            test: canAllBeDeleted\n        }\n    },\n    _holderId: 'searchActionModel',\n    _folderMenu: 'folder_mutton',\n    _resourceMenu: 'resource_menu',\n    _resourceBulkMenu: 'resource_bulk_menu',\n    initialize: function () {\n        var page = jQuery('#' + layoutModule.PAGE_BODY_ID)[0];\n        page && page.observe(isSupportsTouch() ? 'touchstart' : 'click', function (event) {\n            if (isIPad()) {\n                !isRightClick(event) && event.touches.length == 1 && actionModel.hideMenu();\n            } else {\n                !isRightClick(event) && actionModel.hideMenu();\n            }\n        });    //var treeContainer = ($(repositorySearch.foldersPanel.getTreeId()).parent());\n        //treeContainer.observe('scroll', function(event) {!isRightClick(event) && actionModel.hideMenu()});\n    },\n    showFolderMenu: function (event, coordinates) {\n        actionModel.showDynamicMenu(this._folderMenu, event, null, coordinates, this._holderId);\n    },\n    showResourceBulkMenu: function (event, coordinates) {\n        actionModel.showDynamicMenu(this._resourceBulkMenu, event, null, coordinates, this._holderId);\n    },\n    showResourceMenu: function (event, coordinates) {\n        actionModel.showDynamicMenu(this._resourceMenu, event, null, coordinates, this._holderId);\n    },\n    refreshToolbar: function (event) {\n        repositorySearch.toolbar.refresh();\n    }\n};\nrepositorySearch.CopyMoveController = {\n    object: null,\n    _move: false,\n    _copy: false,\n    _dndMode: false,\n    onMove: function () {\n        repositorySearch.CursorManager.move();\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    onCopy: function () {\n        repositorySearch.CursorManager.copy();\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    onCancel: function () {\n        repositorySearch.CursorManager.none();\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    isObjectInstanceOf: function (type) {\n        var object = this.object;\n        if (!object) {\n            return false;\n        }\n        if (this.isBulkAction()) {\n            return object.length == object.findAll(function (o) {\n                return o instanceof type;\n            }).length;\n        } else {\n            return object instanceof type;\n        }\n    },\n    isMoveResource: function () {\n        return this._move && this.isObjectInstanceOf(Resource);\n    },\n    isMoveFolder: function () {\n        return this._move && this.isObjectInstanceOf(Folder);\n    },\n    isCopyResource: function () {\n        return this._copy && this.isObjectInstanceOf(Resource);\n    },\n    isCopyFolder: function () {\n        return this._copy && this.isObjectInstanceOf(Folder);\n    },\n    isBulkAction: function () {\n        return Object.isArray(this.object);\n    },\n    move: function (object, isDnD) {\n        this.cancel();\n        this.object = object;\n        this._move = true;\n        this._copy = false;\n        this._dndMode = isDnD;\n        this.onMove();\n    },\n    copy: function (object, isDnD) {\n        this.cancel();\n        this.object = object;\n        this._move = false;\n        this._copy = true;\n        this._dndMode = isDnD;\n        this.onCopy();\n    },\n    cancel: function () {\n        this.object = null;\n        this._move = false;\n        this._copy = false;\n        this.onCancel();\n    },\n    //    dnd: function(dndMode) {\n    //        this._dndMode = dndMode;\n    //    },\n    //\n    isMove: function () {\n        return this._move;\n    },\n    isCopy: function () {\n        return this._copy;\n    },\n    isDnd: function () {\n        return this._dndMode;\n    }\n};\nrepositorySearch.CursorManager = {\n    container: null,\n    className: [\n        'copy_cursor',\n        'move_cursor'\n    ],\n    initialize: function () {\n        this.container = jQuery('#display')[0];\n    },\n    copy: function () {\n        this.none();\n        jQuery(this.container).addClass(this.className[0]);\n    },\n    move: function () {\n        this.none();\n        jQuery(this.container).addClass(this.className[1]);\n    },\n    none: function () {\n        this.className.each(function (name, index) {\n            jQuery(this.container).removeClass(this.className[index]);\n        }.bind(this));\n    }\n};    /////////////////////////////////////////\n// Repository search resource object\n/////////////////////////////////////////\n/////////////////////////////////////////\n// Repository search resource object\n/////////////////////////////////////////\nvar Resource = function (json) {\n    this._json = json;\n    this.name = json.name;\n    this.label = json.label;\n    this.description = json.description;\n    this.date = json.date;\n    this.dateTimestamp = json.dateTimestamp;\n    this.dateTime = json.dateTime;\n    this.updateDate = json.updateDate;\n    this.updateDateTimestamp = json.updateDateTimestamp;\n    this.updateDateTime = json.updateDateTime;\n    this.URI = json.URI;\n    this.URIString = json.URIString;\n    this.parentUri = json.parentUri;\n    this.parentFolder = json.parentFolder;\n    this.resourceType = json.resourceType;\n    this.type = json.type;\n    if (json.fileType) {\n        this.fileType = json.fileType;\n    }\n    this.isScheduled = json.scheduled;\n    this.isFavorite = json.favorite;\n    this._permissions = json.permissions;\n    this.hasChildren = json.hasChildren;\n    this.isChild = false;\n    this.parentResource = null;\n    this.isOpen = false;\n    this._children = [];\n};\nResource.addMethod('clone', function () {\n    return new Resource(this._json);\n});\nResource.addMethod('isReadable', function () {\n    return this._permissions.include('r');\n});\nResource.addMethod('isEditable', function () {\n    return this._permissions.include('e');\n});\nResource.addMethod('isRemovable', function () {\n    return this._permissions.include('d');\n});\nResource.addMethod('isAdministrable', function () {\n    return this._permissions.include('a');\n});\nResource.addMethod('typeEquals', function (type) {\n    return this.resourceType === type;\n});\nResource.addMethod('typeSuffix', function () {\n    return this.resourceType.split('.').last();\n});\nResource.addMethod('isLoaded', function () {\n    return this._children.size() > 0;\n});\nResource.addMethod('isFolder', function () {\n    return false;\n});\nResource.addMethod('getChildren', function (resource) {\n    return this._children;\n});\nResource.addMethod('addChild', function (resource) {\n    resource.isChild = true;\n    resource.parentResource = this;\n    this._children.push(resource);\n});\nResource.addMethod('updateChild', function (resource) {\n    resource.isChild = true;\n    resource.parentResource = this;\n    var childIndex = -1;\n    this._children.each(function (child, index) {\n        if (child.URIString == resource.URIString) {\n            childIndex = index;\n        }\n    });\n    if (childIndex > -1) {\n        this._children[childIndex] = resource;\n    } else {\n        this._children.push(resource);\n    }\n});\nResource.addMethod('permissionsToString', function () {\n    var result = '';\n    if (this.isEditable()) {\n        result += repositorySearch.messages['permission.modify'];\n    } else {\n        result += repositorySearch.messages['permission.readOnly'];\n    }\n    if (this.isRemovable()) {\n        result += ', ' + repositorySearch.messages['permission.delete'];\n    }\n    if (this.isAdministrable()) {\n        result += ', ' + repositorySearch.messages['permission.administer'];\n    }\n    return result;\n});    /////////////////////////////////////////\n// Repository search folder object\n/////////////////////////////////////////\n/////////////////////////////////////////\n// Repository search folder object\n/////////////////////////////////////////\nvar Folder = function (node) {\n    this.node = node;\n    this.name = node.param.id;\n    this.label = xssUtil.unescape(node.name);\n    this.desc = node.param.extra.desc ? xssUtil.unescape(node.param.extra.desc) : '';\n    this.description = xssUtil.unescape(this.desc);\n    this.date = node.param.extra.date ? xssUtil.unescape(node.param.extra.date) : '';\n    this.URI = node.param.uri;\n    this.URIString = node.param.uri;\n};\nFolder.prototype = deepClone(Resource.prototype);\nFolder.addMethod('clone', function () {\n    return new Folder(this.node);\n});\nFolder.addMethod('getParentFolder', function () {\n    return this.isRoot() ? null : new Folder(this.node.parent);\n});\nFolder.addMethod('getReadableUri', function () {\n    if (this.isRoot()) {\n        return '';\n    }\n    return this.getParentFolder().getReadableUri() + repositorySearch.model.getFolderSeparator() + this.label;\n});\nFolder.addMethod('isRoot', function () {\n    return this.URI == repositorySearch.model.getRootFolderUri() || this.node.parent == null;\n});\nFolder.addMethod('isPublic', function () {\n    return this.URI == repositorySearch.model.getPublicFolderUri();\n});\nFolder.addMethod('isTemp', function () {\n    return this.URI == repositorySearch.model.getTempFolderUri();\n});\nFolder.addMethod('isOrganization', function () {\n    return this.URI.match(repositorySearch.model.getOrganizationsFolderUri() + '/[^/]+$');\n});\nFolder.addMethod('isOrganizationsRoot', function () {\n    return this.URI.match(repositorySearch.model.getOrganizationsFolderUri() + '$');\n});\nFolder.addMethod('isReadable', function () {\n    return true;\n});\nFolder.addMethod('isEditable', function () {\n    return this.node.param.extra.isWritable;\n});\nFolder.addMethod('isRemovable', function () {\n    return this.node.param.extra.isRemovable;\n});\nFolder.addMethod('isAdministrable', function () {\n    return this.node.param.extra.isAdministrable;\n});\nFolder.addMethod('isSelected', function () {\n    return this.node.isSelected();\n});\nFolder.addMethod('equals', function (folder) {\n    return folder && this.URI == folder.URI;\n});\nFolder.addMethod('isThemeFolder', function () {\n    return this.node.param.extra && this.node.param.extra.isThemeFolder;\n});\nFolder.addMethod('isThemeRootFolder', function () {\n    return this.node.param.extra && this.node.param.extra.isThemeRootFolder;\n});\nFolder.addMethod('isActiveThemeFolder', function () {\n    return this.node.param.extra && this.node.param.extra.isActiveThemeFolder;\n});\nFolder.addMethod('isFolder', function () {\n    return true;\n});\nvar ResourcesUtils = {\n    getResourceUris: function (resources) {\n        var uriList = [];\n        resources.each(function (resource) {\n            uriList.push(resource.URIString ? resource.URIString : resource.URI);\n        });\n        return uriList;\n    },\n    getResourceUriAndTypeList: function (resources) {\n        var list = [];\n        resources.each(function (resource) {\n            var uri = resource.URIString ? resource.URIString : resource.URI;\n            list.push({\n                URIString: uri,\n                type: resource.type\n            });\n        });\n        return list;\n    },\n    getSelectedResourceUris: function (resources) {\n        return resources.map((resource)=>{\n            return {\n                uri: resource.URIString ? resource.URIString : resource.URI\n            };\n        });\n    },\n    checkNameLength: function (value) {\n        return !value.blank() && value.length <= repositorySearch.model.getConfiguration().resourceNameMaxLength;\n    },\n    checkDescriptionLength: function (value) {\n        return value.length <= repositorySearch.model.getConfiguration().resourceDescriptionMaxLength;\n    },\n    labelValidator: function (value) {\n        var isValid = true;\n        var errorMessage = '';\n        if (value.blank() || (value.length > repositorySearch.model.getConfiguration().resourceLabelMaxLength)) {\n            errorMessage = repositorySearch.messages['RE_INVALID_NAME_SIZE'].replace('{0}', repositorySearch.model.getConfiguration().resourceLabelMaxLength);\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    descriptionValidator: function (value) {\n        var isValid = true;\n        var errorMessage = '';\n        if (value.length > repositorySearch.model.getConfiguration().resourceDescriptionMaxLength) {\n            errorMessage = repositorySearch.messages['RE_INVALID_DESC_SIZE'].replace('{0}', repositorySearch.model.getConfiguration().resourceDescriptionMaxLength);\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    _fileTypeValidatorTemplate: function (value, expectedType) {\n        var isValid = true;\n        var errorMessage = '';\n        if (!value || value.blank()) {\n            errorMessage = repositorySearch.messages['RE_ENTER_FILE_NAME'];\n            isValid = false;\n        } else if (!value.toLowerCase().endsWith(expectedType)) {\n            errorMessage = repositorySearch.messages['RE_INVALID_FILE_TYPE'].replace('{0}', expectedType);\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    zipFileTypeValidator: function (value) {\n        return ResourcesUtils._fileTypeValidatorTemplate(value, '.zip');\n    },\n    isCustomDataSource: function (resource) {\n        return _.contains(Utils.getInitConfiguration().customDataSources, resource.resourceType);\n    }\n};\nvar Utils = {\n    restOfString: function (str, fromStr) {\n        var from = str.lastIndexOf(fromStr) + fromStr.length;\n        return str.substring(from, str.length).trim();\n    },\n    getInitOptions: function () {\n        return window.localContext.rsInitOptions || __jrsConfigs__.repositorySearch['localContext'].rsInitOptions;\n    },\n    getInitConfiguration: function () {\n        return Utils.getInitOptions().configuration;\n    }\n};    ////////////////////////////////////\n// Repository Search Initialization\n////////////////////////////////////\n////////////////////////////////////\n// Repository Search Initialization\n////////////////////////////////////\ndocument.observe('element:contextmenu', repositorySearch.showContextMenu.bindAsEventListener(repositorySearch));\ndocument.observe('key:escape', function (event) {\n    actionModel.hideMenu();\n    Event.stop(event);\n});\ndocument.observe('key:delete', function (event) {\n    // for bug 25864 - to prevent warning message appearing when trying to delete text in any text input\n    if (event.target instanceof HTMLInputElement || event.target instanceof HTMLTextAreaElement) {\n        return;\n    }\n    if (canAllBeDeleted())\n        invokeBulkAction('Delete');\n});\n\n// expose to global scope\nwindow.canResourceBeCreated = canResourceBeCreated;\nwindow.invokeResourceAction = invokeResourceAction;\nwindow.invokeAction = invokeAction;\nwindow.invokeFolderAction = invokeFolderAction;\nwindow.invokeCreate = invokeCreate;\nwindow.invokeBulkAction = invokeBulkAction;\nwindow.invokeRedirectAction = invokeRedirectAction;\nwindow.isPropertiesChanged = isPropertiesChanged;\nwindow.isPermissionsChanged = isPermissionsChanged;\nwindow.isCopyOrMove = isCopyOrMove;\nwindow.isFolderCopyOrMove = isFolderCopyOrMove;\nwindow.isResourceCopyOrMove = isResourceCopyOrMove;\nwindow.isThemeFolder = isThemeFolder;\nwindow.isNonActiveThemeFolder = isNonActiveThemeFolder;\nwindow.isThemeRootFolder = isThemeRootFolder;\nwindow.canThemeBeReuploaded = canThemeBeReuploaded;\nwindow.canFolderBeCopied = canFolderBeCopied;\nwindow.canFolderBeDeleted = canFolderBeDeleted;\nwindow.canFolderBeEdited = canFolderBeEdited;\nwindow.canFolderBeMoved = canFolderBeMoved;\nwindow.canFolderBeCopiedOrMovedToFolder = canFolderBeCopiedOrMovedToFolder;\nwindow.canAllBeCopiedOrMovedToFolder = canAllBeCopiedOrMovedToFolder;\nwindow.canFolderBeExported = canFolderBeExported;\nwindow.canFolderPermissionsBeAssigned = canFolderPermissionsBeAssigned;\nwindow.canFolderPropertiesBeShowed = canFolderPropertiesBeShowed;\nwindow.canFolderPropertiesBeEdited = canFolderPropertiesBeEdited;\nwindow.canBeRun = canBeRun;\nwindow.canBeGenerated = canBeGenerated;\nwindow.canBeConverted = canBeConverted;\nwindow.canBeOpened = canBeOpened;\nwindow.canBeRunInBackground = canBeRunInBackground;\nwindow.canResourceBeEdited = canResourceBeEdited;\nwindow.canBeOpenedInDesigner = canBeOpenedInDesigner;\nwindow.canCreateFolder = canCreateFolder;\nwindow.canBeScheduled = canBeScheduled;\nwindow.canResourceBeCopied = canResourceBeCopied;\nwindow.canResourceBeMoved = canResourceBeMoved;\nwindow.canResourceBeDeleted = canResourceBeDeleted;\nwindow.canResourcePropertiesBeShowed = canResourcePropertiesBeShowed;\nwindow.canResourcePropertiesBeEdited = canResourcePropertiesBeEdited;\nwindow.canResourcePermissionsBeAssigned = canResourcePermissionsBeAssigned;\nwindow.canAllBeRun = canAllBeRun;\nwindow.canAllBeEdited = canAllBeEdited;\nwindow.canAllBeOpened = canAllBeOpened;\nwindow.canAllBeCopied = canAllBeCopied;\nwindow.canAllBeMoved = canAllBeMoved;\nwindow.canAllBePasted = canAllBePasted;\nwindow.canAllPropertiesBeShowed = canAllPropertiesBeShowed;\nwindow.canAllPropertiesBeEdited = canAllPropertiesBeEdited;\nwindow.canAllBeDeleted = canAllBeDeleted;\nwindow.canBeAddedToFavorites = canBeAddedToFavorites;\nwindow.canBeRemovedFromFavorites = canBeRemovedFromFavorites;\n\n\nexport {\n    repositorySearch,\n    ResourcesUtils,\n    invokeResourceAction,\n    invokeFolderAction,\n    isPropertiesChanged,\n    isPermissionsChanged,\n    Folder,\n    canFolderBeCopied,\n    canFolderBeMoved,\n    canFolderBeCopiedOrMovedToFolder,\n    canAllBeCopiedOrMovedToFolder,\n    canBeRun,\n    canBeOpened,\n    invokeBulkAction,\n    invokeRedirectAction,\n    canBeScheduled,\n    canBeAddedToFavorites,\n    canBeRemovedFromFavorites\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global alert, confirm*/\n/**\n * Asynchronous action class.\n */\n\nimport dialogs from '../components/components.dialogs';\nimport _ from 'underscore';\nimport {repositorySearch, ResourcesUtils, invokeResourceAction, isPropertiesChanged, isPermissionsChanged} from './repository.search.main';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport {JRS} from \"../namespace/namespace\";\nimport {ajax, ajaxTargettedUpdate, AjaxRequester} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport {ajaxIframeDownload, doNothing, redirectToUrl, downloadFileByUrl} from \"../util/utils.common\";\nimport jQuery from 'jquery';\nimport layoutModule from '../core/core.layout';\nimport request from 'js-sdk/src/common/transport/request';\n\nrepositorySearch.Action = function (invokeFn) {\n    if (Object.isFunction(invokeFn)) {\n        this.invokeAction = invokeFn;\n    }\n};\nrepositorySearch.Action.DEFAULT = 'default-action';\nrepositorySearch.Action.addMethod('invokeAction', doNothing);\nrepositorySearch.folderActionFactory = {\n    'CreateFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showCreateFolderConfirm(folder);\n        });\n    },\n    'CopyFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.copy(folder);\n        });\n    },\n    'MoveFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.move(folder);\n        });\n    },\n    'PasteFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            var actionName;\n            var toFolder = folder ? folder : repositorySearch.model.getContextFolder();\n            if (repositorySearch.CopyMoveController.isCopyFolder()) {\n                actionName = repositorySearch.FolderAction.COPY;\n            } else if (repositorySearch.CopyMoveController.isMoveFolder()) {\n                actionName = repositorySearch.FolderAction.MOVE;\n            } else {\n                return;\n            }\n            var action = new repositorySearch.ServerAction.createFolderAction(actionName, {\n                toFolder: toFolder,\n                folder: repositorySearch.CopyMoveController.object\n            });\n            action.invokeAction();\n        });\n    },\n    'PasteResources': function (folder) {\n        return new repositorySearch.Action(function () {\n            var actionName;\n            var toFolder = folder ? folder : repositorySearch.model.getContextFolder();\n            if (!toFolder) {\n                toFolder = repositorySearch.model.getSelectedFolder();\n            }\n            var object = repositorySearch.CopyMoveController.object;\n            var resources = repositorySearch.CopyMoveController.isBulkAction() ? [].concat(object) : [object];\n            if (repositorySearch.CopyMoveController.isCopyResource()) {\n                actionName = repositorySearch.ResourceAction.COPY;\n            } else if (repositorySearch.CopyMoveController.isMoveResource()) {\n                actionName = repositorySearch.ResourceAction.MOVE;\n            } else {\n                return;\n            }\n            for (var i = 0; i < resources.length; i++) {\n                if (resources[i].parentResource) {\n                    var uri = resources[i].parentResource.URI, contains = false;\n                    for (var j = 0; j < resources.length && !contains; j++) {\n                        contains |= resources[j].URI == uri;\n                    }\n                    contains || resources.push(resources[i].parentResource);\n                }\n            }\n            var action = new repositorySearch.ServerAction.createResourceAction(actionName, {\n                resources: resources,\n                folder: toFolder\n            });\n            action.invokeAction();\n        });\n    },\n    'DeleteFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            actionModel.hideMenu();\n            repositorySearch.showDeleteFolderConfirm(folder);\n        });\n    },\n    'ShowFolderProperties': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showFolderProperties(folder);\n        });\n    },\n    'EditFolderProperties': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editFolderProperties(folder);\n        });\n    },\n    'AssignPermissions': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editFolderPermissions(folder);\n        });\n    },\n    'SetActiveThemeFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME, { folder: folder });\n            action.invokeAction();\n        });\n    },\n    'DownloadTheme': function (folder) {\n        return new repositorySearch.Action(function () {\n            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.DOWNLOAD_THEME, { folder: folder });\n            action.initDownload();\n        });\n    },\n    'UploadTheme': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showUploadThemeConfirm(folder, false);\n        });\n    },\n    'ReuploadTheme': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showUploadThemeConfirm(folder, true);\n        });\n    },\n    'Export': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.exportDialog.openRepoDialog(folder);\n        });\n    }\n};\nfunction parseRepoData(data) {\n    if (_.isArray(data)) {\n        return _.pluck(data, 'URIString');\n    } else {\n        return [data.URIString];\n    }\n}\nrepositorySearch.resourceActionFactory = {\n    'ResourceFavoriteAction': function () {\n        return new repositorySearch.Action((function () {\n            const resources = repositorySearch.model._uiState.selectedResources;\n            repositorySearch.addToFavorite(resources);\n        }));\n    },\n\n    'Copy': function (resource) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.copy(resource);\n        });\n    },\n    'Move': function (resource) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.move(resource);\n        });\n    },\n    'Delete': function (resource) {\n        return new repositorySearch.Action(function () {\n            actionModel.hideMenu();\n            repositorySearch.showDeleteResourceConfirm(resource);\n        });\n    },\n    'Export': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.exportDialog.openRepoDialog(resource);\n        });\n    },\n    'ShowProperties': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showResourceProperties(resource, options);\n        });\n    },\n    'EditProperties': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editResourceProperties(resource, options);\n        });\n    },\n    'AssignPermissionsToResourceAction': function (resource) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editResourcePermissions(resource);\n        });\n    },\n    'GenerateResourceAction': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            JRS.CreateReport.selectGenerator(resource.URIString);\n        });\n    },\n    'ConvertResourceAction': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            var action = new repositorySearch.ServerAction.createConvertAction(repositorySearch.ResourceAction.CONVERT, { reportUri: resource.URIString });\n            action.invokeAction();\n        });\n    }\n};\nrepositorySearch.bulkActionFactory = {\n    'Run': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                var action = repositorySearch.RedirectAction.createRunResourceAction(resource, index !== 0);\n                action.invokeAction();\n            });\n        });\n    },\n    'Edit': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                var action = repositorySearch.RedirectAction.createEditResourceAction(resource, index !== 0);\n                action.invokeAction();\n            });\n        });\n    },\n    'Open': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                var action = repositorySearch.RedirectAction.createOpenResourceAction(resource, resources.length > 1);\n                action.invokeAction();\n            });\n        });\n    },\n    'Copy': function (resources) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.copy(resources);\n        });\n    },\n    'Move': function (resources) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.move(resources);\n        });\n    },\n    'Delete': function (resources) {\n        return new repositorySearch.Action(function () {\n            actionModel.hideMenu();\n            resources.length == 1 ? repositorySearch.showDeleteResourceConfirm(resources[0]) : repositorySearch.showBulkDeleteResourcesConfirm(resources);\n        });\n    },\n    'ShowProperties': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                invokeResourceAction('ShowProperties', resource, {\n                    cascade: true,\n                    position: index,\n                    number: resources.length\n                });\n            });\n        });\n    },\n    'EditProperties': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                invokeResourceAction('EditProperties', resource, {\n                    cascade: true,\n                    position: index,\n                    number: resources.length\n                });\n            });\n        });\n    },\n    'Export': function (resources) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.exportDialog.openRepoDialog(resources);\n        });\n    }\n};    /**\n * Server action class.\n */\n/**\n * Server action class.\n */\nrepositorySearch.ServerAction = function (eventId, options) {\n    this.actionURL = 'flow.html?_flowExecutionKey=' + repositorySearch.flowExecutionKey + '&_eventId=' + eventId;\n    this.data = Object.toQueryString(options.data);\n};    /**\n * Invokes server action.\n */\n/**\n * Invokes server action.\n */\nrepositorySearch.ServerAction.addMethod('invokeAction', function () {\n    ajaxTargettedUpdate(this.actionURL, {\n        postData: this.data,\n        callback: function (response) {\n            if (response.status == 'OK') {\n                this.onSuccess(response.data);\n            } else {\n                this.onError(response.data);\n            }\n        }.bind(this),\n        errorHandler: this._serverErrorHandler,\n        mode: AjaxRequester.prototype.EVAL_JSON\n    });\n});\nrepositorySearch.onFavoriteItem = function(url, favoriteList){\n    return request({\n        url: url,\n        type: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'content-type': 'application/json',\n        },\n        data: Object.toJSON({ favorites: favoriteList})\n    });\n};\nrepositorySearch.ServerAction.addMethod('initDownload', function () {\n    var url = this.actionURL + '&' + this.data;\n    ajaxIframeDownload(url, {\n        onload: function () {\n            var str = jQuery(jQuery('#ajax-download-iframe')[0].contentDocument.body).html();\n            try {\n                var json = str.evalJSON();\n                alert(json.data);\n            } catch (ex) {\n            }    // exception here means there is no JSON object\n            // which is a good thing, i.e. file did download!\n        }\n    });\n});\nrepositorySearch.ServerAction.addMethod('_serverErrorHandler', function (ajaxAgent) {\n    /* Login request is handled in baseErrorHandler */\n    /* TODO clean up this method, looks like need to completely remove it and use baseErrorHandler directly */\n    /* if (ajaxAgent.getResponseHeader(\"LoginRequested\")) {\n        var loginAndGoToSearch = new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            flowId: 'searchFlow'\n        });\n\n        loginAndGoToSearch.invokeAction();\n        return true;\n    } */\n    return baseErrorHandler(ajaxAgent);    /* Error 500 is handled in baseErrorHandler */\n    /* if (resolved && ajaxAgent.status == 500) {\n        var gotoError = new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: 'flow.html',\n            paramsMap: {\n                _flowExecutionKey: repositorySearch.flowExecutionKey,\n                _eventId: 'error'\n            }\n        });\n        gotoError.invokeAction();\n        return true;\n    } */\n});    /**\n * Handler for success response.\n *\n * @param data the data received from the server.\n */\n/**\n * Handler for success response.\n *\n * @param data the data received from the server.\n */\nrepositorySearch.ServerAction.addMethod('onSuccess', doNothing);    /**\n * Handler for error response.\n *\n * @param data the data received from the server.\n */\n/**\n * Handler for error response.\n *\n * @param data the data received from the server.\n */\nrepositorySearch.ServerAction.addMethod('onError', doNothing);    /*\n * Creates server action instance for repository search actions.\n *\n * @param actionName the name of the search action.\n * @param options {JSON object} - set of options for search action. The number of options and their names are different\n *      for different search actions.\n */\n/*\n * Creates server action instance for repository search actions.\n *\n * @param actionName the name of the search action.\n * @param options {JSON object} - set of options for search action. The number of options and their names are different\n *      for different search actions.\n */\nrepositorySearch.ServerAction.createSearchAction = function (actionName, options) {\n    options.mode = repositorySearch.mode;\n    var action = new repositorySearch.ServerAction(actionName, { data: options });\n    action.onSuccess = function (data) {\n        if (actionName == repositorySearch.SearchAction.NEXT) {\n            repositorySearch.fire(repositorySearch.Event.RESULT_NEXT, data);\n        } else if (actionName == repositorySearch.SearchAction.GET_RESOURCE_CHILDREN) {\n            repositorySearch.fire(repositorySearch.Event.CHILDREN_LOADED, {\n                inputData: options,\n                responseData: data\n            });\n        } else {\n            repositorySearch.fire(repositorySearch.Event.RESULT_CHANGED, data);\n            repositorySearch.fire(repositorySearch.Event.STATE_CHANGED, data);\n            if (repositorySearch.mode == repositorySearch.Mode.SEARCH) {\n                repositorySearch.fire(repositorySearch.Event.FILTER_PATH_CHANGED, data);\n            }\n        }\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.Event.RESULT_ERROR, data);\n    };\n    return action;\n};    /*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\n/*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\nrepositorySearch.ServerAction.createFolderAction = function (actionName, options) {\n    var params;\n    var eventName;\n    var errorEventName;\n    if (repositorySearch.FolderAction.DELETE == actionName) {\n        params = { sourceFolderUri: options.folder.URI };\n        eventName = repositorySearch.FolderEvent.DELETED;\n        errorEventName = repositorySearch.FolderEvent.DELETE_ERROR;\n    } else if (repositorySearch.FolderAction.CREATE == actionName) {\n        params = {\n            destFolderUri: options.toFolder.URI,\n            folder: Object.toJSON({\n                URI: '',\n                label: options.label,\n                desc: options.desc\n            })\n        };\n        eventName = repositorySearch.FolderEvent.CREATED;\n        errorEventName = repositorySearch.FolderEvent.CREATE_ERROR;\n    } else if (repositorySearch.FolderAction.COPY == actionName) {\n        params = {\n            destFolderUri: options.toFolder.URI,\n            sourceFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.FolderEvent.COPIED;\n        errorEventName = repositorySearch.FolderEvent.COPY_ERROR;\n    } else if (repositorySearch.FolderAction.MOVE == actionName) {\n        params = {\n            destFolderUri: options.toFolder.URI,\n            sourceFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.FolderEvent.MOVED;\n        errorEventName = repositorySearch.FolderEvent.MOVE_ERROR;\n    } else if (repositorySearch.FolderAction.UPDATE == actionName) {\n        params = {\n            folder: Object.toJSON({\n                URI: options.folder.URI,\n                label: options.folder.label,\n                desc: options.folder.description\n            })\n        };\n        eventName = repositorySearch.FolderEvent.UPDATED;\n        errorEventName = repositorySearch.FolderEvent.UPDATE_ERROR;\n    } else if (repositorySearch.ThemeAction.SETTHEME == actionName) {\n        if (options.folder) {\n            params = { folderUri: options.folder.URI };\n        } else if (options.folderUri) {\n            params = { folderUri: options.folderUri };\n        }\n        eventName = repositorySearch.ThemeEvent.UPDATED;\n    } else if (repositorySearch.ThemeAction.DOWNLOAD_THEME == actionName) {\n        params = { folderUri: options.folder.URI };\n        errorEventName = repositorySearch.ThemeEvent.THEME_ERROR;\n    } else if (repositorySearch.ThemeAction.REUPLOAD == actionName) {\n        params = {\n            themeName: options.themeName,\n            folderUri: options.folderUri\n        };\n        eventName = repositorySearch.ThemeEvent.REUPLOADED;\n        errorEventName = repositorySearch.ThemeEvent.THEME_ERROR;\n    }\n    if (!params || !eventName || !errorEventName) {\n        new Error('Unsupported folder action.');\n    }\n    var action = new repositorySearch.ServerAction(actionName, { data: params });\n    action.onSuccess = function (data) {\n        repositorySearch.fire(eventName, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(errorEventName, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    return action;\n};    /*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\n/*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\nrepositorySearch.ServerAction.createResourceAction = function (actionName, options) {\n    var params;\n    var eventName;\n    var errorEventName;\n    if (repositorySearch.ResourceAction.DELETE == actionName) {\n        var list = ResourcesUtils.getResourceUriAndTypeList(options.resources);\n        params = { selectedResources: Object.toJSON(list) };\n        eventName = repositorySearch.ResourceEvent.DELETED;\n        errorEventName = repositorySearch.ResourceEvent.DELETE_ERROR;\n    } else if (repositorySearch.ResourceAction.COPY == actionName) {\n        var copyUris = ResourcesUtils.getResourceUris(options.resources);\n        params = {\n            selectedResources: Object.toJSON(copyUris),\n            destFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.ResourceEvent.COPIED;\n        errorEventName = repositorySearch.ResourceEvent.COPY_ERROR;\n    } else if (repositorySearch.ResourceAction.MOVE == actionName) {\n        var moveUris = ResourcesUtils.getResourceUris(options.resources);\n        params = {\n            selectedResources: Object.toJSON(moveUris),\n            destFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.ResourceEvent.MOVED;\n        errorEventName = repositorySearch.ResourceEvent.MOVE_ERROR;\n    } else if (repositorySearch.ResourceAction.UPDATE == actionName) {\n        params = { selectedResource: Object.toJSON(options.resource) };\n        eventName = repositorySearch.ResourceEvent.UPDATED;\n        errorEventName = repositorySearch.ResourceEvent.UPDATE_ERROR;\n    }\n    if (!params || !eventName || !errorEventName) {\n        new Error('Unsupported resource action.');\n    }\n    var action = new repositorySearch.ServerAction(actionName, { data: params });\n    action.onSuccess = function (data) {\n        if (repositorySearch.ResourceAction.MOVE == actionName) {\n            repositorySearch.CopyMoveController.cancel();\n        }\n        repositorySearch.fire(eventName, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    function promptFilteredRetry(existingLabels, filteredResources) {\n        dialogs.dependentResources.show(existingLabels, {\n            dependenciesBtnOk: function () {\n                var resourceAction = new repositorySearch.ServerAction.createResourceAction(actionName, {\n                    resources: filteredResources,\n                    folder: options.folder\n                });\n                resourceAction.invokeAction();\n            }\n        }, {\n            buttons: [\n                'ok',\n                'cancel'\n            ],\n            dialogTitle: repositorySearch.getMessage('dialog.resources.exist.title'),\n            topMessage: repositorySearch.getMessage('dialog.resources.exist'),\n            bottomMessage: repositorySearch.getMessage('dialog.resources.exist.confirm.skip')\n        });\n    }\n    function convertErrorResponse(data) {\n        var dataObj;\n        if (repositorySearch.ResourceAction.COPY != actionName && repositorySearch.ResourceAction.MOVE != actionName) {\n            return data;\n        }\n        try {\n            dataObj = JSON.parse(data);\n        } catch (e) {\n            return data;\n        }\n        if (!dataObj || !dataObj.existingLabels) {\n            return data;\n        }\n        var filteredResources = _.filter(options.resources, function (item) {\n            return dataObj.existingLabels.indexOf(item.label) == -1;\n        });\n        if (filteredResources.length === 0) {\n            return (dataObj.existingLabels.length == 1 ? repositorySearch.getMessage('dialog.resources.one.exists') : repositorySearch.getMessage('dialog.resources.all.exist')) + ' ' + options.folder.URIString;\n        }\n        promptFilteredRetry(dataObj.existingLabels, filteredResources);\n        return null;\n    }\n    action.onError = function (data) {\n        var resp = convertErrorResponse(data);\n        if (resp) {\n            repositorySearch.fire(errorEventName, {\n                responseData: resp,\n                inputData: options\n            });\n        }\n    };\n    return action;\n};    /*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\n/*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\nrepositorySearch.ServerAction.createPermissionAction = function (actionName, options) {\n    var action = new repositorySearch.ServerAction(actionName, { data: options });\n    var successEvent = actionName == repositorySearch.PermissionAction.UPDATE ? repositorySearch.PermissionEvent.UPDATED : repositorySearch.PermissionEvent.LOADED;\n    action.onSuccess = function (data) {\n        repositorySearch.fire(successEvent, {\n            responseData: data,\n            inputData: options,\n            doSet: actionName != repositorySearch.PermissionAction.NEXT\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.PermissionEvent.ERROR, data);\n    };\n    return action;\n};    /*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\n/*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\nrepositorySearch.ServerAction.createGenerateAction = function (actionName, options) {\n    var action = new repositorySearch.ServerAction(actionName, { data: { data: Object.toJSON(options) } });\n    action.actionURL = 'reportGenerator.html?action=' + actionName;\n    action.onSuccess = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.GENERATED, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.GENERATE_ERROR, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    return action;\n};\nrepositorySearch.ServerAction.createConvertAction = function (actionName, options) {\n    var action = new repositorySearch.ServerAction(actionName, { data: options });\n    action.actionURL = 'dataViewConverter.html?action=' + actionName;\n    action.onSuccess = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.CONVERTED, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.CONVERT_ERROR, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    return action;\n};    /**\n * Creates server action instance for folder actions.\n *\n * @param type {} type of redirect. All supported types defined in {@see repositorySearch.RedirectType} map.\n * @param options Set of options for action:\n * <ul>\n * <li>url {String} URL</li>\n * <li>flowId {String} ID of the flow</li>\n * <li>paramsMap {JSON Object} map of parameters</li>\n * <li>encode {Boolean} </li>\n * </ul>\n */\n/**\n * Creates server action instance for folder actions.\n *\n * @param type {} type of redirect. All supported types defined in {@see repositorySearch.RedirectType} map.\n * @param options Set of options for action:\n * <ul>\n * <li>url {String} URL</li>\n * <li>flowId {String} ID of the flow</li>\n * <li>paramsMap {JSON Object} map of parameters</li>\n * <li>encode {Boolean} </li>\n * </ul>\n */\nrepositorySearch.RedirectAction = function (type, options) {\n    this.DIMMER_TIMEOUT = 400;\n    this.type = type;\n    this.flowId = options.flowId;\n    this.url = options.url ? options.url : this.flowId ? this.FLOW_URL : undefined;\n    this.paramsMap = options.paramsMap || {};\n    this.hash = options.hash ? '#' + options.hash : '';    //part of the url which may come after parameters: \"#someHash\"\n    //part of the url which may come after parameters: \"#someHash\"\n    this.encode = options.encode;\n    if (this.type !== repositorySearch.RedirectType.FLOW_REDIRECT && this.url === this.FLOW_URL) {\n        this.paramsMap['_flowId'] = this.flowId;\n    }\n};\nrepositorySearch.RedirectAction.addMethod('FLOW_URL', 'flow.html');\nrepositorySearch.RedirectAction.addMethod('_serializeParams', function (paramsMap, encode) {\n    if (paramsMap) {\n        var result = '';\n        for (var name in paramsMap) {\n            if (!Object.isUndefined(name)) {\n                result += '&' + name + '=' + (encode ? encodeURIComponent(paramsMap[name]) : paramsMap[name]);\n            }\n        }\n        return result && result.length > 0 ? result.substring(1) : '';\n    } else {\n        return '';\n    }\n});\nrepositorySearch.RedirectAction.addMethod('invokeAction', function (options) {\n    options = options || {};\n    var ajaxLoading = jQuery('#' + ajax.LOADING_ID);\n\n    if (ajaxLoading.length > 0) {\n        ajaxLoading.addClass(layoutModule.CANCELLABLE_CLASS);\n        ajaxLoading.find(\"#cancel\").click(function () {\n            jQuery(this).addClass('disabled');\n            ajaxLoading.addClass('cancelCalled');\n            window.location.reload();\n        });\n    }\n    if (this.type === repositorySearch.RedirectType.FLOW_REDIRECT) {\n        var form = jQuery('#redirectForm')[0];\n        var flowParams = jQuery('#flowParams')[0];\n        flowParams.setValue(this.flowId + '?' + this._serializeParams(this.paramsMap, this.encode));\n\n        var action = new repositorySearch.ServerAction('isServerAvailable', { data: {} });\n        // // show loading popup. It will be shown till new page appears as a response for form submit below\n        var timeout = setTimeout(function () {\n            dialogs.popup.show(ajax.LOADING_ID, true);\n        }, this.DIMMER_TIMEOUT);\n\n        action.onSuccess = function (data) {\n            if (data.strip() == 'Yes') {\n                // increment ajax request counter to avoid closing of a loading dialogue by common ajax response handler\n                ++ajax.ajaxRequestCount;\n                if(ajaxLoading.hasClass('cancelCalled')){\n                    ajaxLoading.removeClass('cancelCalled');\n                }else{\n                    form.submit();\n                }\n                repositorySearch.fire(repositorySearch.Event.FLOW_REDIRECT_RUNNING, data);\n            } else {\n                hidePopup();\n                repositorySearch.fire(repositorySearch.Event.REDIRECT_ERROR, data);\n            }\n        };\n        action.onError = function (data) {\n            hidePopup();\n            repositorySearch.fire(repositorySearch.Event.REDIRECT_ERROR, data);\n        };\n\n        var hidePopup = function (){\n            clearTimeout(timeout);\n            dialogs.popup.hide(ajax.LOADING_ID);\n        }\n\n        action.invokeAction();\n    } else if (this.type === repositorySearch.RedirectType.LOCATION_REDIRECT) {\n        var url = this.url + (jQuery.isEmptyObject(this.paramsMap) ? '' : '?' + this._serializeParams(this.paramsMap, this.encode)) + this.hash;    // because of this bug: http://stackoverflow.com/questions/13681156\n        // because of this bug: http://stackoverflow.com/questions/13681156\n        // so, we do this to overcome this issue\n        if (options.isContentResource) {\n            downloadFileByUrl(url);\n        } else {\n            redirectToUrl(url);\n        }\n    } else if (this.type === repositorySearch.RedirectType.WINDOW_REDIRECT) {\n        var w = window.open(), params = this._serializeParams(this.paramsMap, this.encode);\n        w.opener = null;\n        w.document.location = this.url + (params ? '?' + params : '') + this.hash;\n    }\n});\nrepositorySearch.runActionFactory = {\n    'ReportUnit': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: 'viewReportFlow',\n            paramsMap: {\n                _flowId: 'viewReportFlow',\n                reportUnit: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n                standAlone: true,\n                ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n            }\n        });\n    },\n    'AdhocReportUnit': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: 'viewAdhocReportFlow',\n            paramsMap: {\n                reportUnit: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n                standAlone: true,\n                ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n            }\n        });\n    },\n    'OlapUnit': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.LOCATION_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'olap/viewOlap.html',\n            paramsMap: {\n                name: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n                'new': true,\n                parentFlow: 'searchFlow',\n                ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n            }\n        });\n    },\n    'DashboardResource': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: 'dashboardRuntimeFlow',\n            paramsMap: { dashboardResource: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString }\n        });\n    },\n    'DashboardModelResource': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.LOCATION_REDIRECT;\n        return new repositorySearch.RedirectAction(type, { url: 'dashboard/viewer.html#' + encodeURIComponent(resource.URIString) });\n    },\n    'ReportOptions': function (resource, inNewTab) {\n        var params = {\n            reportOptionsURI: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n            standAlone: true,\n            ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n        };\n        var flow;\n        var parentResource = resource.parentResource;\n        if (parentResource && parentResource.typeEquals(repositorySearch.ResourceType.ADHOC_REPORT_UNIT)) {\n            flow = 'viewAdhocReportFlow';\n            params.reportUnit = inNewTab ? encodeURIComponent(parentResource.URIString) : parentResource.URIString;\n        } else {\n            flow = 'viewReportFlow';\n        }\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: flow,\n            paramsMap: params\n        });\n    }\n};    /**\n * Creates server action instance for folder actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates server action instance for folder actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createRunResourceAction = function (resource, inNewTab) {\n    if (!resource) {\n        resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    }\n    var factoryMethod = repositorySearch.runActionFactory[resource.typeSuffix()];\n    if (factoryMethod) {\n        return factoryMethod(resource, inNewTab);\n    } else {\n        return new repositorySearch.Action(function () {\n            alert('Run action for resource type \\'' + resource.resourceType + '\\' is not implemented!');\n        });\n    }\n};    /**\n *\n *  Run resource in a new tab\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n *\n *  Run resource in a new tab\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createRunResourceInNewTabAction = function (resource, inNewTab) {\n    return repositorySearch.RedirectAction.createRunResourceAction(resource, true);\n};\nrepositorySearch.editActionFactory = {\n    'default-action': function (resource, actionType) {\n        if (ResourcesUtils.isCustomDataSource(resource)) {\n            return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n        } else {\n            return new repositorySearch.Action(function () {\n                alert('Edit action for resource type \\'' + resource.resourceType + '\\' is not implemented!');\n            });\n        }\n    },\n    'ReportUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'reportUnitFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'AdhocReportUnit': function (resource, actionType) {\n        return repositorySearch.editActionFactory['ReportUnit'](resource, actionType);\n    },\n    'DataDefinerUnit': function (resource, actionType) {\n        // Going into the report unit edit flow is useless for domain topic.\n        // Edit will go to the data chooser flow, and \"Open in designer\", which used to go to data chooser,\n        // is disabled.\n        // see JRS-3395\n        //        return repositorySearch.editActionFactory[\"ReportUnit\"](resource, actionType);\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'queryBuilderFlow',\n            paramsMap: {\n                uri: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'OlapUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'olapUnitFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'DashboardResource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'dashboardRuntimeFlow',\n            paramsMap: { dashboardResource: resource.URIString }\n        });\n    },\n    'ReportOptions': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'reportOptionsEditFlow',\n            paramsMap: {\n                reportOptionsURI: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'JdbcReportDataSource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addDataSourceFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'JndiJdbcReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'CustomReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'BeanReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'VirtualReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'HiveDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'CassandraDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'DiagnosticCustomDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'MongoDbDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'AwsReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'AzureSqlReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'Query': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'queryFlow',\n            paramsMap: {\n                currentQuery: resource.URIString,\n                isEdit: true,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'InputControl': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addInputControlFlow',\n            paramsMap: {\n                isEdit: true,\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'ListOfValues': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addListOfValuesFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'DataType': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'dataTypeFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'MondrianConnection': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'olapClientConnectionFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'SecureMondrianConnection': function (resource, actionType) {\n        return repositorySearch.editActionFactory['MondrianConnection'](resource, actionType);\n    },\n    'XMLAConnection': function (resource, actionType) {\n        return repositorySearch.editActionFactory['MondrianConnection'](resource, actionType);\n    },\n    'MondrianXMLADefinition': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'mondrianXmlaSourceFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'FileResource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addFileResourceFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n\n    'SemanticLayerDataSource': function(resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            url: 'domaindesigner.html',\n            paramsMap: {\n                uri: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    }\n};\n\nrepositorySearch.resourceTypeToDefaultRedirectTypeMap = {};\n\nrepositorySearch.resourceTypeToDefaultRedirectTypeMap[\n    repositorySearch.ResourceType.SEMANTIC_LAYER_DATA_SOURCE] = repositorySearch.RedirectType.LOCATION_REDIRECT;\n\nrepositorySearch.getDefaultRedirectTypeByResourceType = function(resourceType) {\n    var defaultRedirectType = repositorySearch.resourceTypeToDefaultRedirectTypeMap[resourceType];\n\n    if (!defaultRedirectType) {\n        defaultRedirectType = repositorySearch.RedirectType.FLOW_REDIRECT;\n    }\n\n    return defaultRedirectType;\n};\n\n/**\n * Creates edit resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createEditResourceAction = function (resource, inNewTab) {\n    if (!resource) {\n        resource = repositorySearch.model.getSelectedResources()[0];\n    }\n\n    var type;\n\n    if (inNewTab) {\n        type = repositorySearch.RedirectType.WINDOW_REDIRECT;\n    } else {\n        type = repositorySearch.getDefaultRedirectTypeByResourceType(resource.resourceType);\n    }\n\n    var factoryMethod = repositorySearch.editActionFactory[resource.typeSuffix()];\n    if (factoryMethod) {\n        return factoryMethod(resource, type);\n    } else {\n        return repositorySearch.editActionFactory[repositorySearch.Action.DEFAULT](resource, type);\n    }\n};\n\nrepositorySearch.openActionFactory = {\n    'ContentResource': function (resource, actionType) {\n        if (actionType === repositorySearch.RedirectType.FLOW_REDIRECT) {\n            actionType = repositorySearch.RedirectType.LOCATION_REDIRECT;\n        }\n        return new repositorySearch.RedirectAction(actionType, {\n            url: 'fileview/fileview' + resource.URIString,\n            paramsMap: {}\n        });\n    },\n    'DashboardResource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'dashboardDesignerFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'DashboardModelResource': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.LOCATION_REDIRECT;\n        return new repositorySearch.RedirectAction(type, { url: 'dashboard/designer.html#' + encodeURIComponent(resource.URIString) });\n    },\n    'DataDefinerUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'queryBuilderFlow',\n            paramsMap: {\n                uri: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'AdhocReportUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'adhocFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'AdhocDataView': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'adhocFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    }\n};    /**\n * Creates open action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates open action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createOpenResourceAction = function (resource, inNewTab) {\n    if (!resource) {\n        resource = repositorySearch.model.getSelectedResources()[0];\n    }\n    var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n    var factoryMethod = repositorySearch.openActionFactory[resource.typeSuffix()];\n    if (factoryMethod) {\n        return factoryMethod(resource, type);\n    } else {\n        return new repositorySearch.Action(function () {\n            alert('Open action for resource type \\'' + resource.resourceType + '\\' is not implemented!');\n        });\n    }\n};    /**\n * Creates run in background action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates run in background action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createRunInBackgroundResourceAction = function () {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    var reportUnitParentURI = '';\n    if (resource.resourceType.endsWith('.ReportUnit') || resource.resourceType.endsWith('.AdhocReportUnit') || resource.resourceType.endsWith('.DashboardModelResource') || resource.resourceType.endsWith('.ReportOptions')) {\n        if (resource.parentResource) {\n            reportUnitParentURI = '@@parentReportURI=' + resource.parentResource.URIString + '@@';\n        }\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: JRS.vars.contextPath + '/scheduler/main.html',\n            //paramsMap is necessary for backend controller\n            //while hash is necessary for UI scheduler application\n            paramsMap: {\n                'reportUnitURI': resource.URIString,\n                'parentReportUnitURI': resource.parentResource ? resource.parentResource.URIString : '',\n                'resourceType': resource.resourceType.substring(resource.resourceType.lastIndexOf('.') + 1)\n            },\n            hash: 'runInBackground@' + resource.URIString + reportUnitParentURI,\n            encode: true\n        });\n    }\n};    /**\n * Creates run in background action instance for resource.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates run in background action instance for resource.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createScheduleAction = function () {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    var reportUnitParentURI = '';\n    if (resource.resourceType.endsWith('.ReportUnit') || resource.resourceType.endsWith('.AdhocReportUnit') || resource.resourceType.endsWith('.DashboardModelResource') || resource.resourceType.endsWith('.ReportOptions')) {\n        if (resource.parentResource) {\n            reportUnitParentURI = '@@parentReportURI=' + resource.parentResource.URIString + '@@';\n        }\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: JRS.vars.contextPath + '/scheduler/main.html',\n            //paramsMap is necessary for backend controller\n            //while hash is necessary for UI scheduler application\n            paramsMap: {\n                'reportUnitURI': resource.URIString,\n                'resourceType': resource.resourceType.substring(1 + resource.resourceType.lastIndexOf('.')),\n                'parentReportUnitURI': resource.parentResource ? resource.parentResource.URIString : ''\n            },\n            hash: resource.URIString + reportUnitParentURI,\n            encode: true\n        });\n    }\n};\nrepositorySearch.createActionFactory = {\n    'OlapClientConnection': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'olapClientConnectionFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'OlapUnit': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'olapUnitFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'ReportDataSource': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'addDataSourceFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'SemanticLayerDataSource': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: 'domaindesigner.html',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'FileResource': function (folder, fileType) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            //            flowId: 'fileResourceFlow', // old\n            flowId: 'addFileResourceFlow',\n            // new\n            paramsMap: {\n                expectedFileType: fileType,\n                parentFolder: folder.URI\n            }\n        });\n    },\n    'ReportUnit': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'reportUnitFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'Query': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'queryFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'InputControl': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'addInputControlFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'DataType': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'dataTypeFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'ListOfValues': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'addListOfValuesFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'XMLAConnection': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'mondrianXmlaSourceFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    }\n};\nrepositorySearch.RedirectAction.createCreateResourceAction = function (resourceTypeSuffix, fileType) {\n    var folder = repositorySearch.model.getContextFolder();\n    var factoryMethod = repositorySearch.createActionFactory[resourceTypeSuffix];\n    if (factoryMethod) {\n        return factoryMethod(folder, fileType);\n    } else {\n        return new repositorySearch.Action(function () {\n            alert('Create action for resource type suffix \\'' + resourceTypeSuffix + '\\' is not implemented!');\n        });\n    }\n};\nrepositorySearch.confirmAndLeave = function () {\n    return new repositorySearch.Action(function () {\n        return !isPropertiesChanged() && !isPermissionsChanged() || confirm(repositorySearch.getMessage('RM_CANCEL_EDIT_MESSAGE'));\n    }).invokeAction();\n};\n\nexport default repositorySearch;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport Dialog from 'js-sdk/src/common/component/dialog/Dialog';\nimport ExportView from './ExportView';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport i18n2 from '../../../i18n/ImportExportBundle.properties';\nimport exportTypesEnum from '../enum/exportTypesEnum';\n\nfunction parseRepoData(data) {\n    if (_.isArray(data)) {\n        return _.pluck(data, 'URIString');\n    } else {\n        return [data.URIString];\n    }\n}\nfunction hasReports(data) {\n    _.isArray(data) || (data = [data]);\n    return !!_.reduce(data, function (memo, item) {\n        return memo || !item.resourceType || item.resourceType.indexOf('ReportUnit') + 1 || item.resourceType.indexOf('ReportOptions') + 1;\n    }, false);\n}\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.options = options;\n        Dialog.prototype.constructor.call(this, {\n            model: this.model,\n            resizable: true,\n            modal: true,\n            content: '',\n            buttons: [\n                {\n                    label: i18n['button.export'],\n                    action: 'export',\n                    primary: true\n                },\n                {\n                    label: i18n['button.cancel'],\n                    action: 'cancel',\n                    primary: false\n                }\n            ]\n        });\n        this.on('button:export', _.bind(this._onExportButtonClick, this));\n        this.on('button:cancel', _.bind(this._closeExportDialog, this));\n    },\n    initialize: function (options) {\n        this.exportView = new ExportView();\n        this.listenTo(this.exportView.model, 'validated', function (isValid) {\n            isValid ? this.buttons.enable('export') : this.buttons.disable('export');\n        }, this);\n        Dialog.prototype.initialize.apply(this, arguments);\n    },\n    openRepoDialog: function (repoData) {\n        var uris = parseRepoData(repoData);\n        var organizationsFolderUri = jrsConfigs.organizationsFolderUri || '/organizations';\n        var orgTemplateFolderUri = jrsConfigs.orgTemplateFolderUri || '/org_template';\n        var subOrgRegExp = new RegExp('^(' + organizationsFolderUri + '/([^/]+))+');\n        var rootOrgTemplateRegExp = new RegExp('^' + organizationsFolderUri + orgTemplateFolderUri + '(/.*)?');\n        var isSubOrgLevel = !!subOrgRegExp.exec(uris[0]) && !rootOrgTemplateRegExp.exec(uris[0]);\n        var renderOptions = {\n                type: exportTypesEnum.REPOSITORY,\n                isSubOrgLevel: isSubOrgLevel\n            }, subtitle = ' ' + i18n2['export.dialog.repository.title'];\n        this.addCssClasses('repository-export-dialog');\n        this._openExportDialog(renderOptions, subtitle);\n        this.exportView.model.set({\n            'uris': uris,\n            'includeScheduledReportJobs': hasReports(repoData)\n        });\n    },\n    openTenantDialog: function (tenant) {\n        var tenantName = ' ' + tenant.name, exportType = !tenant.isRoot() ? exportTypesEnum.TENANT : exportTypesEnum.ROOT_TENANT, renderOptions = {\n            type: exportType,\n            tenantId: tenant.id\n        };\n        this.addCssClasses('tenant-export-dialog');\n        this._openExportDialog(renderOptions, tenantName);\n    },\n    // block default validation handlers\n    fieldIsValid: function () {\n    },\n    fieldIsInvalid: function (error) {\n    },\n    _onExportButtonClick: function () {\n        this.exportView.doExport();\n        this._closeExportDialog();\n    },\n    _closeExportDialog: function () {\n        this.$el.css({ width: this.width });\n        this.close();\n        this.$el.find('.export-view').html('');\n    },\n    _openExportDialog: function (renderOptions, subtitle) {\n        var title = i18n2['export.dialog.title'] + (subtitle ? subtitle : '');\n        this.setContent(this.exportView.render(renderOptions).$el);\n        this.setTitle(title);    //TODO: Find out why applyEpoxyBindings and delegateEvents should be called after new content is set.\n        //TODO: Find out why applyEpoxyBindings and delegateEvents should be called after new content is set.\n        this.exportView.applyEpoxyBindings();\n        this.exportView.delegateEvents();\n        Dialog.prototype.open.apply(this, arguments);\n        this.$el.css({ minHeight: this.$el.outerHeight() });\n        this.width = this.$el.outerWidth();\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global alert, confirm*/\nimport {Droppables, Draggables} from 'dragdropextra';\nimport {$break} from 'prototype';\nimport accessibilityModule from '../core/core.accessibility';\nimport buttonManager from '../core/core.events.bis';\nimport orgModule from '../manage/mng.common';\nimport {dynamicList, baseList} from '../components/list.base';\nimport {\n    repositorySearch,\n    Folder,\n    canFolderBeCopied,\n    invokeFolderAction,\n    canFolderBeMoved,\n    canFolderBeCopiedOrMovedToFolder,\n    canAllBeCopiedOrMovedToFolder,\n    invokeBulkAction,\n    invokeRedirectAction,\n    ResourcesUtils\n} from \"./repository.search.main\";\nimport SearchBox from '../components/components.searchBox';\nimport dialogs from '../components/components.dialogs';\nimport toolbarButtonModule from '../components/components.toolbarButtons.events';\nimport {\n    isMetaHeld,\n    getBoxOffsets,\n    toFunction,\n    getAsFunction,\n    isArray,\n    disableSelectionWithoutCursorStyle,\n    isIPad,\n    isSupportsTouch,\n    matchAny,\n    centerElement,\n    ValidationModule,\n    fileSender\n} from \"../util/utils.common\";\nimport dynamicTree from '../dynamicTree/dynamicTree.utils';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport layoutModule from '../core/core.layout';\nimport TouchController from '../util/touch.controller';\nimport InfiniteScroll from '../util/tools.infiniteScroll';\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport {JSTooltip, tooltipModule} from '../components/components.tooltip';\nimport ExportDialogView from '../tenantImportExport/export/view/ExportDialogView';\nimport exportTypesEnum from '../tenantImportExport/export/enum/exportTypesEnum';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport _ from 'underscore';\nimport jQuery from 'jquery';\nimport 'js-sdk/src/common/extension/customEventExtension';\nimport __jrsConfigs__ from 'js-sdk/src/jrs.configs';\nimport i18n from '../i18n/jasperserver_messages.properties';\n\n// Get functions from the global scope in order to fix JRS-20092\n// in fact they are declared in repository.search.main for CE or in\n// jrs-ui-pro/src/repository/repository.search.js for PRO\n// Functions from PRO override same functions from CE\nconst canBeRun = function(...args) {\n    return window.canBeRun(...args)\n};\nconst canBeOpened = function(...args) {\n    return window.canBeOpened(...args);\n}\nconst canBeScheduled = function(...args) {\n    return window.canBeScheduled(...args);\n}\n\n///////////////////////////////\n// Export dialog\n///////////////////////////////\nrepositorySearch.exportDialog = new ExportDialogView();\nrepositorySearch.exportDialog.render({ type: exportTypesEnum.REPOSITORY });\n\n///////////////////////////////\n// Secondary search box object\n///////////////////////////////\nrepositorySearch.secondarySearchBox = {\n    _searchBox: null,\n    initialize: function (text) {\n        this._searchBox = new SearchBox({ id: 'secondarySearchBox' });\n        this._searchBox.onSearch = function (text) {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: text });\n        };\n\n        this.setText(text);\n    },\n    setText: function (text) {\n        this._searchBox.setText(text);\n    }\n};    ///////////////////////////////\n// Toolbar object\n///////////////////////////////\n///////////////////////////////\n// Toolbar object\n///////////////////////////////\nrepositorySearch.favoriteSwitchControl = {\n    _containerId: 'favorites-only',\n    initialize: function (options) {\n        this._container = jQuery('#' + this._containerId)[0];\n        if ( options.state?.customFilters?.favoriteFilter === repositorySearch.ResourcesFavoriteAction.FAVORITE_RESOURCES ) {\n            this._container.checked = true\n        }\n        this._container.onclick= function(){\n            repositorySearch.fire(repositorySearch.Event.SEARCH_FILTER, {\n                filterId: repositorySearch.ResourcesFavoriteAction.FILTER_ID,\n                optionId: this.checked ? repositorySearch.ResourcesFavoriteAction.FAVORITE_RESOURCES : repositorySearch.ResourcesFavoriteAction.ALL_RESOURCES\n            });\n        };\n    }\n};\nrepositorySearch.toolbar = {\n    _bulkActions: {},\n    initialize: function (bulkActions) {\n        this._bulkActions = bulkActions;\n        toolbarButtonModule.initialize(this._toActionMap(this._bulkActions));\n        this.refresh();\n    },\n    refresh: function () {\n        for (var name in this._bulkActions) {\n            var id = this._bulkActions[name].buttonId;\n            var testFn = toFunction(this._bulkActions[name].test);\n\n            toolbarButtonModule.setButtonState(jQuery('#' + id)[0], testFn());\n        }\n    },\n    _toActionMap: function (bulkActionModel) {\n        var actionMap = {};\n        for (var name in bulkActionModel) {\n            var bulkAction = bulkActionModel[name];\n            var id = bulkAction.buttonId;\n            actionMap[id] = function (action, actionArgs) {\n                return function () {\n                    var myAction = getAsFunction(action);\n                    var args = actionArgs;\n                    var belongsToLocalContext = window.localContext && window.localContext[action];\n                    if (args && isArray(args)) {\n                        myAction.apply(belongsToLocalContext ? window.localContext : null, args);\n                    } else {\n                        myAction.call(belongsToLocalContext ? window.localContext : null, args);\n                    }\n                };\n            }(bulkAction.action, bulkAction.actionArgs);\n        }\n        return actionMap;\n    }\n};    ///////////////////////////////\n// Folder panel object\n///////////////////////////////\n///////////////////////////////\n// Folder panel object\n///////////////////////////////\nrepositorySearch.foldersPanel = {\n    _treeId: 'foldersTree',\n    _uri: '/',\n    _cookieName: 'lastFolderUri',\n    _canDoBrowse: true,\n    _touchController: null,\n    initialize: function (options) {\n        if (options.isFolderSet) {\n            this._uri = options.state.folderUri;\n        } else {\n            var storedUri = window.localStorage ? localStorage.getItem(this._cookieName) : undefined;\n            this._uri = storedUri && storedUri.length > 0 ? storedUri : '/';\n        }\n        this._container = jQuery('#' + this.getTreeId()).parents().eq(1);\n        this.tree = new dynamicTree.createRepositoryTree(this.getTreeId(), {\n            providerId: 'repositoryExplorerTreeFoldersProvider',\n            rootUri: repositorySearch.model.getRootFolderUri(),\n            organizationId: options.organizationId,\n            publicFolderUri: options.publicFolderUri,\n            urlGetNode: 'flow.html?_flowId=searchFlow&method=getNode',\n            urlGetChildren: 'flow.html?_flowId=searchFlow&method=getChildren',\n            dragPattern: '.draggable',\n            selectOnMousedown: false,\n            escapeHyperlinks: true\n        });\n        disableSelectionWithoutCursorStyle(jQuery('#' + this.getTreeId()).parents().eq(1));\n        this.tree.observe('key:contextMenu', function (event) {\n            var node = event.memo.node;\n            var nodePosition = getBoxOffsets(node, true);\n            repositorySearch.actionModel.showFolderMenu(event, {\n                menuLeft: nodePosition[0] + 100,\n                //TODO: use constants for offsets\n                menuTop: nodePosition[1] + 20    //TODO: use constants for offsets\n            });\n            Event.stop(event);\n        });\n        this.tree.observe('key:escape', function (event) {\n            actionModel.hideMenu();\n            Event.stop(event);\n        });\n        this.tree.observe('tree:mouseover', function (event) {\n            this.tree._overNode = event.memo.node;\n        }.bindAsEventListener(this));\n        this.tree.observe('tree:mouseout', function (event) {\n            this.tree.refreshDropTarget(false);\n            this.tree._overNode == event.memo.node && (this.tree._overNode = null);\n        }.bindAsEventListener(this));\n        this.tree.setDragStartState = function (node, draggable, event) {\n            dynamicTree.Tree.prototype.setDragStartState.call(this, node, draggable, event);\n            var folder = new Folder(node);\n            if (isMetaHeld(event, true)) {\n                canFolderBeCopied(folder) && invokeFolderAction('CopyFolder', folder);\n                jQuery(document.body).addClass(layoutModule.COPY_CLASS);\n            } else {\n                canFolderBeMoved(folder) && invokeFolderAction('MoveFolder', folder);\n            }\n        };\n        this.tree.setDragEndState = function (node, draggable, event) {\n            repositorySearch.CopyMoveController.cancel();\n            this.refreshDropTarget(false);\n            jQuery(document.body).removeClass(layoutModule.COPY_CLASS);\n            dynamicTree.Tree.prototype.setDragEndState.call(this, node, draggable, event);\n        };\n        this.tree.refreshDropTarget = function (allowed) {\n            if (this._overNode) {\n                this._overNode.isDropTarget = allowed;\n                this._overNode.refreshStyle();\n            }\n        };\n        Droppables.remove(this.getTreeId());\n        Droppables.add(this.getTreeId(), {\n            accept: [\n                'dragging',\n                'wrap'\n            ],\n            onHover: function (dragged, dropped, event) {\n                if (this.tree._overNode) {\n                    var toFolder = new Folder(this.tree._overNode);\n                    var hover = dragged.node && canFolderBeCopiedOrMovedToFolder(toFolder) || dragged.items && canAllBeCopiedOrMovedToFolder(toFolder);\n                    this.tree.refreshDropTarget(hover);\n                }\n            }.bind(this),\n            onDrop: function (dragged, dropped, event) {\n                var node;\n                if (Draggables.supportsTouch) {\n                    var touch = event.changedTouches[0];\n                    node = this.tree.getTreeNodeByElement(jQuery('#' + document.elementFromPoint(touch.pageX, touch.pageY))[0]);\n                } else {\n                    node = this.tree.getTreeNodeByEvent(event);\n                }\n                node && (this.tree._overNode = node);\n                if (this.tree._overNode) {\n                    var toFolder = new Folder(this.tree._overNode);\n                    dragged.node && canFolderBeCopiedOrMovedToFolder(toFolder) && invokeFolderAction('PasteFolder', toFolder);\n                    dragged.items && canAllBeCopiedOrMovedToFolder(toFolder) && invokeFolderAction('PasteResources', toFolder);\n                }\n            }.bind(this)\n        });\n        this.tree.observe('server:error', function () {\n            if (window.console) {\n                alert('Tree load error.');\n            }\n        });\n        this.tree.observe('childredPrefetched:loaded', function (event) {\n            this.tree.openAndSelectNode(this._uri);\n        }.bindAsEventListener(this));\n        this.tree.observe('tree:loaded', function (event) {\n            this._canDoBrowse = false;    // Forbid do browse to prevent initial browsing for each folder in the uri.\n            // Forbid do browse to prevent initial browsing for each folder in the uri.\n            if (this._uri == '/') {\n                jQuery(this.tree.rootNode).select();\n            } else {\n                this.tree.openAndSelectNode(this._uri);\n            }\n            this._canDoBrowse = true;\n            var node = this.tree.getSelectedNode();\n            if (node) {\n                node.scroll(jQuery('#' + this._treeId)[0].parentNode);\n            }\n            this.doBrowse();    // Do initial browse.\n        }.bindAsEventListener(this));\n        this.tree.observe('node:selected', function (event) {\n            this._uri = event.memo.node.param.uri;\n            window.localStorage && localStorage.setItem(this._cookieName, this._uri);\n            repositorySearch.model.setSelectedFolder(new Folder(event.memo.node));\n            this.doBrowse();\n        }.bindAsEventListener(this));\n        this.tree.observe('node:mouseup', function (event) {\n            repositorySearch.model.setContextFolder(new Folder(event.memo.node));\n        });\n        this.tree.showTreePrefetchNodes(this._uri);\n        return this;\n    },\n    doBrowse: function () {\n        if (this._canDoBrowse) {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_BROWSE, { uri: this._uri });\n        }\n    },\n    getSelectedUri: function () {\n        return this._uri;\n    },\n    getTreeId: function () {\n        return this._treeId;\n    },\n    selectFolder: function (folder) {\n        this.tree.openAndSelectNode(folder.URI);\n    },\n    reselectFolder: function (folder) {\n        if (folder.node.isSelected()) {\n            folder.node.deselect();\n            folder.node.select();\n        }\n    },\n    refreshFolder: function (folder) {\n        this.selectFolder(folder);\n        this.updateSubFolders(folder);\n    },\n    updateFolder: function (folder, label, description) {\n        folder.label = label;\n        folder.description = description;\n        folder.node.changeName(folder.label);\n        folder.node.param.extra.desc = folder.description;\n        this.tree.resortSubtree(folder.node.parent);\n        folder.node.parent.refreshNode();    //        folder.node.param.extra.date = folder.date;\n    },\n    updateSubFolders: function (folder) {\n        if (!folder.node.hasChilds()) {\n            folder.node.setHasChilds(true);\n        }\n        if (folder.node.isOpen()) {\n            folder.node.handleNode();\n        }\n        folder.node.isloaded = false;\n        folder.node.handleNode();\n    },\n    isFolderContextMenu: function (event) {\n        return this.tree.getTreeNodeByEvent(event) && !this.tree.isIconEvent(event);\n    },\n    moveOrCopyFolder: function (targetFolder, toFolder, copy) {\n        var parent = targetFolder.getParentFolder().node;\n        copy || parent.removeChild(targetFolder.node);\n        return this.tree.getTreeNodeChildren(toFolder.node, function (result) {\n            if (result) {\n                var node = result.detect(function (n) {\n                    return n.param.id == targetFolder.name;\n                });\n                node && this.tree.openAndSelectNode(node.param.uri);\n            }\n        }.bind(this));\n    }\n};    ///////////////////////////////\n// Results panel object\n///////////////////////////////\n///////////////////////////////\n// Results panel object\n///////////////////////////////\nrepositorySearch.resultsPanel = {\n    _list: null,\n    _infiniteScroll: null,\n    _resultListHeaderId: 'resultsListHeader',\n    _resultListId: 'resultsList',\n    _resultsContainerId: 'resultsContainer',\n    _touchScroller: null,\n    _folderDisplayPathCache: {},\n    NOTHING_TO_DISPLAY_ID: 'nothingToDisplay',\n    RESOURCE_NAME_TOOLTIP_ID: 'resourceNameTooltip',\n    NAME_PATTERN: '.resourceName',\n    LINK_NAME_PATTERN: '.resourceName > a',\n    DISCLOSURE_PATTERN: '.disclosure',\n    SCHEDULED_PATTERN: '.scheduled',\n    FAVORITE_PATTERN: '.favorite',\n    LOADING_CLASS_NAME: 'loading',\n    initialize: function (options) {\n        var it = this;\n        this._container = jQuery('#' + this._resultListId).parents();\n        this._header = jQuery('#' + this._resultListHeaderId)[0];\n        this._list = new dynamicList.List(this._resultListId, {\n            listTemplateDomId: 'tabular_fourColumn_resources',\n            itemTemplateDomId: 'tabular_fourColumn_resources:leaf',\n            //dragPattern: '.selected>.wrap',\n            dragPattern: options.enableDnD ? '.draggable' : '',\n            multiSelect: true,\n            selectOnMousedown: !isIPad()\n        });\n        this._intiListEvents();\n        this._initDnD();\n        this.getList().show();\n        if (isSupportsTouch()) {\n            this._touchController = new TouchController(document.getElementById(this._resultListId), document.getElementById(this._resultsContainerId), { scrollbars: true });\n            jQuery('#' + this._resultListId).on('layout_update orientationchange', function () {\n                jQuery('#' + it._resultListId).css('min-width', jQuery('#' + it._resultsContainerId).width() + 'px');\n                jQuery('#' + it._resultListId).width(jQuery('#' + it._resultsContainerId).width());\n            });\n        }\n        if (isIPad()) {\n            this._infiniteScroll = new InfiniteScroll({\n                id: this._container[0].identify(),\n                contentId: this._resultListId,\n                scroll: this._touchController\n            });\n        } else {\n            this._infiniteScroll = new InfiniteScroll({\n                id: this._container[0].identify(),\n                contentId: this._resultListId\n            });\n        }\n        this._infiniteScroll.onLoad = function () {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_NEXT);\n        };\n        disableSelectionWithoutCursorStyle(this._container);\n\n        const resizeHandler = this._toggleInfiniteScrollBasedOnViewportHeight.bind(this);\n        // call the handler only after 250ms would pass after last resize event\n        Event.observe(jQuery(window)[0], 'resize', _.debounce(resizeHandler, 250));\n\n        this._fixHeaderWidth();\n        return this;\n    },\n    _fixHeaderWidth: function () {\n        if (!isIPad()) {\n            this._header.setStyle({ 'marginRight': this._container[0].getWidth() - jQuery('#' + this._resultListId)[0].getWidth() + 'px' });\n        }\n    },\n    _createResourceItem: function (value) {\n        var resourceItem;\n        if (value.hasChildren) {\n            resourceItem = new dynamicList.CompositeItem({\n                cssClassName: layoutModule.NODE_CLASS,\n                label: value.label,\n                value: value,\n                openHandlerPattern: '.disclosure.icon',\n                closeHandlerPattern: '.disclosure.icon',\n                favoriteIconPattern: '.favorite.icon',\n                scheduleIconPattern: '.scheduled.icon',\n                //respondOnItemEvents: false,\n                excludeFromSelectionTriggers: ['.disclosure.icon','.favorite.icon'],\n                listOptions: {\n                    listTemplateDomId: 'tabular_fourColumn_resources_sublist',\n                    itemTemplateDomId: 'tabular_fourColumn_resources_sublist:leaf',\n                    multiSelect: true\n                }\n            });\n            resourceItem.setLoading = function (b) {\n                this.isLoading = b;\n                this.refreshStyle();\n                repositorySearch.resultsPanel.refresh();\n            };\n        } else {\n            resourceItem = new dynamicList.ListItem({\n                cssClassName: layoutModule.LEAF_CLASS,\n                label: value.label,\n                value: value,\n                favoriteIconPattern: '.favorite.icon',\n                scheduleIconPattern: '.scheduled.icon',\n                excludeFromSelectionTriggers: ['.favorite.icon'],\n            });\n        }\n        resourceItem.processTemplate = function (element) {\n            var isRunnable = canBeRun(this.getValue()) || canBeOpened(this.getValue());\n            var nameSelector = isRunnable ? repositorySearch.resultsPanel.LINK_NAME_PATTERN : repositorySearch.resultsPanel.NAME_PATTERN;\n            var name = jQuery(element).find(nameSelector)[0];\n            var nameTitleElement = element.select(repositorySearch.resultsPanel.NAME_PATTERN)[0];\n            var desc = jQuery(element).find('.resourceDescription')[0];\n            name.update(xssUtil.hardEscape(this.getValue().label));\n            var that = this;\n            new JSTooltip(nameTitleElement, {\n                text: [\n                    xssUtil.hardEscape(this.getValue().label),\n                    xssUtil.hardEscape(repositorySearch.messages['loading'])\n                ],\n                templateId: repositorySearch.resultsPanel.RESOURCE_NAME_TOOLTIP_ID,\n                loadTextCallback: function (tooltip) {\n                    var folderPath = that.getValue().parentFolder;\n                    var folderDisplayPath = repositorySearch.resultsPanel._folderDisplayPathCache[folderPath];\n                    var label, uri;\n                    function getUri(parentUri, name) {\n                        var separator = repositorySearch.model.getFolderSeparator();\n                        if (parentUri === separator) {\n                            return parentUri + name;\n                        } else {\n                            return parentUri + separator + name;\n                        }\n                    }\n                    function updateTooltip(parentUri, label, name) {\n                        label = xssUtil.hardEscape(label);\n                        uri = xssUtil.hardEscape(getUri(parentUri, name));\n                        tooltip.updateText([\n                            label,\n                            uri\n                        ]);\n                    }\n                    if (folderDisplayPath) {\n                        updateTooltip(folderDisplayPath, that.getValue().label, that.getValue().name);\n                    } else {\n                        var action = new repositorySearch.ServerAction(repositorySearch.InfoAction.GET_DISPLAY_PATH, {\n                            data: {\n                                resourceUri: folderPath,\n                                isFolder: true\n                            }\n                        });\n                        action.onSuccess = function (data) {\n                            // Cache the display path of the folder.\n                            repositorySearch.resultsPanel._folderDisplayPathCache[folderPath] = data;\n                            updateTooltip(data, that.getValue().label, that.getValue().name);\n                        };\n                        action.onError = repositorySearch.defaultErrorHandler;\n                        action.invokeAction();\n                    }\n                }\n            });\n            let descriptionValue = this.getValue().description;\n            desc.update(xssUtil.hardEscape(descriptionValue));\n            if (!descriptionValue) {\n                desc.jsTooltip && desc.jsTooltip.disable();\n            } else {\n                new JSTooltip(desc, { text: descriptionValue });\n            }\n            let type = element.select('.resourceType')[0];\n            let modifiedDate = jQuery(element).find('.modifiedDate')[0];\n            let createdDate = jQuery(element).find('.createdDate')[0];\n            let scheduleIcon = jQuery(element).find('.scheduled')[0];\n            let favoriteIcon = jQuery(element).find('.favorite')[0];\n            type.update(this.getValue().type);\n            modifiedDate.update(this.getValue().updateDate);\n            new JSTooltip(modifiedDate, { text: this.getValue().updateDateTime });\n            createdDate.update(this.getValue().date);\n            new JSTooltip(createdDate, { text: this.getValue().dateTime });\n            new JSTooltip(scheduleIcon, { text: i18n['schedule.tooltip'] });\n            new JSTooltip(favoriteIcon, { text: i18n['favorite.tooltip'] });\n            return element;\n        };\n        var baseRefreshStyle = resourceItem.refreshStyle;\n        resourceItem.refreshStyle = function () {\n            baseRefreshStyle.call(this);\n            var element = this._getElement();\n            if (this.getValue().isScheduled) {\n                jQuery(element).addClass(layoutModule.SCHEDULED_CLASS);\n            }\n            if (this.getValue().isFavorite) {\n                jQuery(element).addClass(layoutModule.FAVORITE_CLASS);\n            }\n            if (this.isLoading) {\n                jQuery(element).addClass(layoutModule.LOADING_CLASS);\n            }\n        };\n        return resourceItem;\n    },\n    _initDnD: function () {\n        var list = this.getList();\n        list.setDragStartState = function (item, draggable, event) {\n            dynamicList.List.prototype.setDragStartState.call(this, item, draggable, event);\n            isMetaHeld(event, true) && jQuery(document.body).addClass(layoutModule.COPY_CLASS).setStyle({ cursor: null });\n            invokeBulkAction(isMetaHeld(event, true) ? 'Copy' : 'Move');\n        };\n        list.setDragEndState = function (item, draggable, event) {\n            repositorySearch.CopyMoveController.cancel();\n            repositorySearch.foldersPanel.tree.refreshDropTarget(false);\n            jQuery(document.body).removeClass(layoutModule.COPY_CLASS);\n            dynamicList.List.prototype.setDragEndState.call(this, item, draggable, event);\n        };\n    },\n    _intiListEvents: function () {\n        this.getList().observe('item:click', function (event) {\n            var item = event.memo.item;\n            var e = event.memo.targetEvent;\n            var resource = item.getValue();\n            if (this._isLinkEvent(e)) {\n                if (canBeRun(resource)) {\n                    invokeRedirectAction('RunResourceAction');\n                } else {\n                    if(__jrsConfigs__.isProVersion) {\n                        canBeOpened(resource) && invokeRedirectAction('OpenResourceAction', {\n                            isContentResource: window.isContentResource(resource)\n                        });\n                    } else {\n                        canBeOpened(resource) && invokeRedirectAction('OpenResourceAction');\n                    }\n                }\n            }\n            if (this._isScheduleIconEvent(e) && canBeScheduled(resource)) {\n                invokeRedirectAction('ScheduleAction');\n            }\n\n            if (this._isFavoriteIconClicked(e) ) {\n                const selectedItem = jQuery(item._element);\n                repositorySearch.addToFavorite([resource], selectedItem);\n            }\n        }.bindAsEventListener(this));\n        this.getList().observe('item:selected', function (event) {\n            this._selectOrUnselectResources(event);\n        }.bindAsEventListener(this));\n        this.getList().observe('item:unselected', function (event) {\n            this._selectOrUnselectResources(event);\n        }.bindAsEventListener(this));\n        this.getList().observe('item:mouseup', function (event) {\n        }    //            var item = event.memo.item;\n            //            var resource = item.getValue();\n            //            repositorySearch.model.setContextResource(resource);\n        );\n        this.getList().observe('item:open', function (event) {\n            var item = event.memo.item;\n            let resource = item.getValue();\n            if (!resource.isLoaded()) {\n                item.setLoading(true);\n                repositorySearch.fire(repositorySearch.Event.SEARCH_CHILDREN, {\n                    resource: resource,\n                    item: item\n                });\n            }\n            this.refresh();\n        }.bindAsEventListener(this));\n        this.getList().observe('item:closed', function (event) {\n            this.refresh();\n        }.bindAsEventListener(this));\n        this.getList().observe('key:contextMenu', function (event) {\n            var item = event.memo.node;\n            var itemPosition = getBoxOffsets(item, true);\n            var menuPosition = {\n                menuLeft: itemPosition[0] + 100,\n                //TODO: use constants for offsets\n                menuTop: itemPosition[1] + 20    //TODO: use constants for offsets\n            };\n            if (this.getList().getSelectedItems().length > 1) {\n                repositorySearch.actionModel.showResourceBulkMenu(event, menuPosition);\n            } else {\n                repositorySearch.actionModel.showResourceMenu(event, menuPosition);\n            }\n            Event.stop(event);\n        }.bindAsEventListener(this));\n        this.getList().observe('key:escape', function (event) {\n            actionModel.hideMenu();\n            Event.stop(event);\n        });\n    },\n    _selectOrUnselectResources:function(event){\n        const item = event.memo.item;\n        const resourceVal = item.getValue();\n        const selectedElement = jQuery(item._element);\n        const resources = this.getList().getSelectedItems().collect(function (lItem) {\n            return lItem.getValue();\n        });\n        resourceVal.isFavorite && selectedElement.addClass(layoutModule.FAVORITE_CLASS)\n        repositorySearch.model.setSelectedResources(resources);\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    _isLinkEvent: function (event) {\n        var element = Event.element(event);\n        return matchAny(element, [this.LINK_NAME_PATTERN]) != null;\n    },\n    _isScheduleIconEvent: function (event) {\n        var element = Event.element(event);\n        return jQuery(element).is(this.SCHEDULED_PATTERN);\n    },\n    _isFavoriteIconClicked: function (event) {\n        let element = Event.element(event);\n        return jQuery(element).is(this.FAVORITE_PATTERN);\n    },\n    _isDisclosureEvent: function (event) {\n        var element = Event.element(event);\n        return matchAny(element, [this.DISCLOSURE_PATTERN]) != null;\n    },\n    _refreshEmptyListMessage: function () {\n        var nothingToDisplay = jQuery('#' + this.NOTHING_TO_DISPLAY_ID)[0];\n        if (this._list.getItems().length === 0) {\n            jQuery(nothingToDisplay).removeClass(layoutModule.HIDDEN_CLASS);\n            centerElement(nothingToDisplay, {\n                horz: true,\n                vert: true\n            });\n        } else {\n            jQuery(nothingToDisplay).addClass(layoutModule.HIDDEN_CLASS);\n        }\n    },\n    _toggleInfiniteScrollBasedOnViewportHeight: function() {\n        if (this._isListHeightLessThanViewport()) {\n            this._infiniteScroll.onLoad();\n        } else {\n            this.refresh();\n            this._infiniteScroll.stopWaiting();\n        }\n    },\n\n    _isListHeightLessThanViewport: function() {\n        return this.getList()._element.clientHeight < document.body.clientHeight;\n    },\n    getList: function () {\n        return this._list;\n    },\n    removeResources: function (resources) {\n        var children = resources.findAll(function (r) {\n            return r.isChild;\n        });\n        var other = resources.findAll(function (r) {\n            return !r.isChild;\n        });\n        var items = this.getList().getItems();\n        var removedItems = [];\n        var compositeItems = [];\n        items.each(function (item) {\n            item.isComposite && compositeItems.push(item);\n            other.include(item.getValue()) && removedItems.push(item);\n        });\n        compositeItems.each(function (item) {\n            if (item.getItems()) {\n                item.removeItems(item.getItems().findAll(function (item) {\n                    return children.include(item.getValue());\n                }));\n            }\n        });\n        this.getList().removeItems(removedItems);\n        this._refreshEmptyListMessage();\n        this.refresh();\n    },\n    setResources: function (resources, toItem) {\n        var items = resources.collect(this._createResourceItem);\n        var list = this.getList();\n\n        if (toItem) {\n            toItem.setItems(items);\n            toItem.refresh();\n        } else {\n            this._infiniteScroll && this._infiniteScroll.reset();\n            list.setItems(items);\n            list.show();\n            this._refreshEmptyListMessage();\n        }\n\n        if (this._isListHeightLessThanViewport()) {\n            tooltipModule.disableTooltips();\n        }\n\n        if (items.length > 0) {\n            this._toggleInfiniteScrollBasedOnViewportHeight();\n        }\n\n        //custom event is necessary for QAA so they will know\n        //when list is loaded\n        var event = new CustomEvent(`${list._id}:loaded`);\n        list._element.dispatchEvent(event);\n    },\n    addResources: function (resources) {\n        var items = resources.collect(this._createResourceItem);\n\n        tooltipModule.disableTooltips();\n\n        this.getList().addItems(items);\n        this.getList().refresh();\n\n        if (items.length > 0) {\n            this._toggleInfiniteScrollBasedOnViewportHeight();\n            tooltipModule.enableTooltips();\n        }\n    },\n    isResourceContextMenu: function (event) {\n        return this.getList().getItemByEvent(event);\n    },\n    updateResource: function (resource) {\n        var items = this.getList().getItems();\n        items.each(function (item) {\n            if (item.getValue().URIString == resource.URIString) {\n                item.setValue(resource);\n                item.refresh();\n                if (this.getList().isItemSelected(item)) {\n                    // Reselecting to update item in selected list.\n                    this.getList().selectItem(item);\n                }\n            }\n        }.bind(this));\n    },\n    findResource: function (uri) {\n        var items = this.getList().getItems();\n        var item = items.detect(function (item) {\n            return item.getValue().URIString === uri;\n        });\n        return item ? item.getValue() : null;\n    },\n    refresh: function () {\n        this._fixHeaderWidth();\n        tooltipModule.cleanUp();\n    }\n};    ///////////////////////////////\n// Filter panel object\n///////////////////////////////\n///////////////////////////////\n// Filter panel object\n///////////////////////////////\nrepositorySearch.filtersPanel = {\n    _id: 'filtersPanel',\n    _container: undefined,\n    _filtersLists: {},\n    _cookieName: 'filtersPopularity',\n    _ignoreFilterEvent: false,\n    initialize: function (filtersMetaData, selectedFilters) {\n        //this._getContainer().update();    // Process filters configuration\n        // Process filters configuration\n        filtersMetaData.each(function (filter, index) {\n            var element= jQuery(this._getContainer().childElements()[index]);\n            element.find('.subcontainer.ui-resizable')[0].insert(new Element('ul', {\n                id: filter.id,\n                'data-tab-index': 5 + index,\n                'data-component-type': 'list'\n            }));\n            var list = this._createFiltersList(filter.id, filter);\n            list.show();\n            this._filtersLists[filter.id] = list;\n            (element.find('.buttonIconToggle')).on('click', this._buttonToggleListener.bindAsEventListener(this._container.children[index]))[0];\n\n        }.bind(this));\n        for (var filterId in selectedFilters) {\n            this.select(filterId, selectedFilters[filterId]);\n        }\n        if (isSupportsTouch()) {\n            this._touchController = new TouchController(document.getElementById(this._id), jQuery('#' + this._id).parents());\n        }    //this._refreshScroll();\n        //this._refreshScroll();\n        return this;\n    },\n    _buttonToggleListener: function(element){\n        if(jQuery(this).hasClass('open')){\n            jQuery(this).addClass('closed').removeClass('open');\n            jQuery(this).find('.subcontainer.ui-resizable')[0].hide();\n        }else{\n            jQuery(this).addClass('open').removeClass('closed');\n            jQuery(this).find('.subcontainer.ui-resizable')[0].show();\n        }\n    },\n    _refreshScroll: function () {\n        var scroll = layoutModule.scrolls.get(this._id);\n        scroll && scroll.refresh();\n    },\n    _createItemsList: function (filterMetaData) {\n        var optionsMetaData = filterMetaData.options;\n        var index = 0;\n        var allItems = optionsMetaData.collect(function (optionMetaData) {\n            return new dynamicList.ListItem({\n                value: optionMetaData,\n                cssClassName: layoutModule.LEAF_CLASS,\n                label: repositorySearch.getMessage(optionMetaData.labelId)\n            });\n        }).partition(function () {\n            index++;\n            return filterMetaData.showCount === -1 || filterMetaData.showCount > index;\n        });\n        if (allItems[1].length > 0) {\n            allItems[0].push(new dynamicList.CompositeItem({\n                value: { isMore: true },\n                templateDomId: 'list_responsive_filters:node',\n                openUp: true,\n                openHandlerPattern: '.more.launcher',\n                closeHandlerPattern: '.fewer.launcher',\n                respondOnItemEvents: false,\n                items: allItems[1]\n            }));\n        }\n        return allItems[0];\n    },\n    _createFiltersList: function (filterId, filterMetaData) {\n        var list = new dynamicList.List(filterId, {\n            listTemplateDomId: 'list_responsive_filters',\n            itemTemplateDomId: 'list_responsive_filters:leaf',\n            items: this._createItemsList(filterMetaData)\n        });\n        // When item is selected fire filter event\n        // When item is selected fire filter event\n        list.observe('item:selected', function (event) {\n            var item = event.memo.item;\n            if (item.getValue().isSeparator || item.getValue().isMore || this._ignoreFilterEvent) {\n                return;\n            }\n            repositorySearch.fire(repositorySearch.Event.SEARCH_FILTER, {\n                filterId: list.getId(),\n                optionId: item.getValue().id\n            });\n        }.bindAsEventListener(this));\n        return list;\n    },\n    select: function (filterId, optionId, isRestore) {\n        var list = this._filtersLists[filterId];\n        var filterOptionSelector = function (item) {\n            if (item.getValue().id == optionId) {\n                if (!item.isSelected()) {\n                    this._ignoreFilterEvent = isRestore;\n                    item.select();\n                    this._ignoreFilterEvent = false;\n                }\n                throw $break;\n            }\n            if (item.isComposite) {\n                var element = item._getElement();\n                if (!baseList.isItemOpen(element)) {\n                    baseList.openItem(element);\n                }\n                if (item.getItems()) {\n                    item.getItems().each(filterOptionSelector);\n                }\n            }\n        }.bind(this);\n        list.getItems().each(filterOptionSelector);\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = jQuery('#' + this._id)[0];\n            jQuery(this._container).hasClass(layoutModule.SWIPE_SCROLL_PATTERN) && (this._container = this._container.children());\n        }\n        return this._container;\n    }\n};    ///////////////////////////////\n// Filter path object\n///////////////////////////////\n///////////////////////////////\n// Filter path object\n///////////////////////////////\nrepositorySearch.filterPath = {\n    _containerId: 'filterPath',\n    _contentBodySelector: '.primary.column>.content>.body',\n    initialize: function () {\n        this._filterPathList = new dynamicList.List(this._containerId, {\n            listTemplateDomId: 'list_control_path',\n            itemTemplateDomId: 'list_control_path:step'\n        });    // When item is selected fire rollback event\n        // When item is selected fire rollback event\n        this._filterPathList.observe('item:selected', function (event) {\n            var item = event.memo.item;\n            if (!item.getValue().isLast) {\n                repositorySearch.fire(repositorySearch.Event.SEARCH_ROLLBACK, { position: item.getValue().position });\n            }\n        });\n        return this;\n    },\n    setPathItems: function (pathItems) {\n        if (pathItems.length > 1) {\n            var lastIndex = pathItems.length - 1;\n            var listItems = pathItems.collect(function (pathItem, index) {\n                pathItem.isLast = index == lastIndex;\n                return new dynamicList.ListItem({\n                    label: pathItem.label,\n                    value: pathItem\n                });\n            });\n            this._filterPathList.setItems(listItems);\n            this._filterPathList.show();\n            jQuery('#' + this._containerId).parent().removeClass('hidden');\n            jQuery(document.body).find(this._contentBodySelector).addClass('showingSubHeader');\n        } else {\n            this._filterPathList.setItems([]);\n            this._filterPathList.show();\n            jQuery('#' + this._containerId).parent().addClass('hidden');\n            jQuery(document.body).find(this._contentBodySelector).removeClass('showingSubHeader');\n        }\n    }\n};    ///////////////////////////////\n// Sorters panel object\n///////////////////////////////\n///////////////////////////////\n// Sorters panel object\n///////////////////////////////\nrepositorySearch.sortersPanel = {\n    _LABEL_TEMPLATE_DOM_ID: 'sortPanelLabelTemplate',\n    _containerId: 'sortMode',\n    _ignoreSortEvent: false,\n    sortersList: null,\n    initialize: function (sortersMetaData, selectedSorter) {\n        this.labelItem = new dynamicList.ListItem({\n            label: repositorySearch.getMessage(\"SEARCH_SORT_BY\") + \":\",\n            value: {isLabel: true},\n            templateDomId: \"tabSet_control_horizontal_responsive:label\",\n            respondOnItemEvents: false\n        });\n\n        var sortItems = sortersMetaData.collect(function(sorterMetaData, index) {\n            return new dynamicList.ListItem({\n                label: repositorySearch.getMessage(sorterMetaData.labelId),\n                value: sorterMetaData\n            });\n        });\n\n        this.sortersList = new dynamicList.List(this._containerId, {\n            listTemplateDomId: \"tabSet_control_horizontal_responsive\",\n            itemTemplateDomId: \"tabSet_control_horizontal_responsive:tab\",\n            items: [this.labelItem].concat(sortItems)\n        });\n\n        var self = this;\n\n        // When item is selected fire sort event\n        this.sortersList.observe(this.sortersList.Event.ITEM_SELECTED, function(event) {\n            var item = event.memo.item;\n\n            if (item.getValue().isLabel || self._ignoreSortEvent) { return; }\n\n            repositorySearch.sortersPanel.disableItems();\n\n            repositorySearch.fire(repositorySearch.Event.SEARCH_SORT, {\n                sorterId: item.getValue().id\n            });\n        });\n\n        this.sortersList.show();\n\n        this.labelItem.disable();\n\n        this.select(selectedSorter);\n\n        return this;\n    },\n    select: function (sorterId, isRestore) {\n        this.sortersList.getItems().each(function(item) {\n            if (item.getValue().id === sorterId && !item.isSelected()) {\n                this._ignoreSortEvent = isRestore;\n                this.sortersList.selectItem(item);\n                this._ignoreSortEvent = false;\n\n                return;\n            }\n        }.bind(this));\n    },\n    disableItems: function() {\n        var self = this;\n\n        this.sortersList.getItems().each(function(item) {\n            if (item !== self.labelItem && !item.isSelected()) {\n                item.disable();\n                item.refresh();\n            }\n        });\n    },\n\n    enableItems: function() {\n        var self = this;\n\n        this.sortersList.getItems().each(function(item) {\n            if (item !== self.labelItem && !item.isSelected()) {\n                item.enable();\n                item.refresh();\n            }\n        });\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = jQuery('#' + this._containerId)[0];\n        }\n        return this._container;\n    },\n    _getLabelTemplate: function () {\n        var e = jQuery('#' + this._LABEL_TEMPLATE_DOM_ID).clone(true);\n        e.removeAttribute('id');\n        return e;\n    }\n};    /////////////////////////////////\n// Repository permissions dialog\n/////////////////////////////////\n/////////////////////////////////\n// Repository permissions dialog\n/////////////////////////////////\nvar ResourcePermissions = function (resource) {\n    this._resource = resource;\n    this._isVisible = false;\n    this._listId = this.ENTITY_LIST_ID;\n    this._listContainerId = this.LIST_CONTAINER_ID;\n    this._searchBoxId = this.SEARCH_BOX_ID;\n    this.viewBy = 'USER', this._processTemplate();\n};\nResourcePermissions.addVar('TEMPLATE_DOM_ID', 'permissions');\nResourcePermissions.addVar('TOOLTIP_TEMPLATE_DOM_ID', 'orgTooltip');\nResourcePermissions.addVar('LIST_TEMPLATE_ID', 'tabular_twoColumn_setLeft');\nResourcePermissions.addVar('ITEM_TEMPLATE_ID', 'tabular_twoColumn_setLeft:leaf');\nResourcePermissions.addVar('WAIT_ITEM_TEMPLATE_ID', 'tabular_twoColumn_setLeft:loading');\nResourcePermissions.addVar('ENTITY_LIST_ID', 'permissionsList');\nResourcePermissions.addVar('LIST_CONTAINER_ID', 'permissionsListContainer');\nResourcePermissions.addVar('SEARCH_BOX_ID', 'searchPermissionsBox');\nResourcePermissions.addVar('NAME_TOOLTIP_PATTERN', '.one');\nResourcePermissions.addVar('NAME_PATTERN', '.one>a.launcher');\nResourcePermissions.addVar('PERMISSIONS_PATTERN', '.two>select');\nResourcePermissions.addVar('VIEW_BY_TAB_SET_PATTERN', '#permissionsViewBy');\nResourcePermissions.addVar('TAB_PATTERN', '.tab>p');\nResourcePermissions.addVar('PATH_PATTERN', '.path');\nResourcePermissions.addVar('SUBMIT_BUTTON', '#permissionsOk');\nResourcePermissions.addVar('APPLAY_BUTTON', '#permissionsApply');\nResourcePermissions.addVar('CANCEL_BUTTON', '#permissionsCancel');\nResourcePermissions.addVar('BODY_PATTERN', 'div.body');\nResourcePermissions.addMethod('_processTemplate', function () {\n    this._dom = jQuery('#' + this.TEMPLATE_DOM_ID).clone(true)[0];\n    jQuery(this._dom).attr('id', null);\n    jQuery(this._dom).children('.body').attr('id', '');\n    var path = jQuery(this._dom).find(this.PATH_PATTERN)[0];\n    path.update(xssUtil.hardEscape(this._resource.URIString.truncate(50)));\n    jQuery(path).attr('title', this._resource.URIString);\n    this._viewByTabSet = jQuery(this._dom).find(this.VIEW_BY_TAB_SET_PATTERN)[0];\n    this._byUsersButton = jQuery(this._dom).find(this.TAB_PATTERN)[0];\n    this._byRolesButton = jQuery(this._dom).find(this.TAB_PATTERN)[1];\n    this._submitButton = jQuery(this._dom).find(this.SUBMIT_BUTTON)[0];\n    this._applyButton = jQuery(this._dom).find(this.APPLAY_BUTTON)[0];\n    this._cancelButton = jQuery(this._dom).find(this.CANCEL_BUTTON)[0];\n    this._byUsersButton.viewType = 'USER';\n    this._byRolesButton.viewType = 'ROLE';\n    jQuery(this._submitButton).attr('id', null);\n    jQuery(this._applyButton).attr('id', null);\n    jQuery(this._cancelButton).attr('id', null);\n    var list = jQuery(this._dom).find('#' + this.ENTITY_LIST_ID)[0];\n    var listContainer = jQuery(this._dom).find('#' + this.LIST_CONTAINER_ID)[0];\n    var searchBox = jQuery(this._dom).find('#' + this.SEARCH_BOX_ID)[0];\n    this._listId = jQuery(list).attr('id', null)[0].identify();\n    this._listContainerId = jQuery(listContainer).attr('id', null)[0].identify();\n    this._searchBoxId = jQuery(searchBox).attr('id', null)[0].identify();\n});\nResourcePermissions.addMethod('_updateValueAndLabel', function (element, veSelector, value, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    valueElement.writeAttribute('id', null);\n    valueElement.setValue(value);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourcePermissions.addMethod('_updateContentAndLabel', function (element, veSelector, content, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    valueElement.writeAttribute('id', null);\n    valueElement.update(content);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourcePermissions.addMethod('_buttonClickHandler', function (e) {\n    var element = e.target;\n    if (!this._waiting) {\n        var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n        var uri = this._resource.URIString;\n        if ([\n            this._submitButton,\n            this._applyButton\n        ].include(button)) {\n            jQuery(this._byUsersButton).addClass(layoutModule.BUTTON_CLASS);\n            jQuery(this._byRolesButton).addClass(layoutModule.BUTTON_CLASS);\n            repositorySearch.fire(repositorySearch.PermissionEvent.UPDATE, {\n                uri: uri,\n                entities: this.getChangedEntities(),\n                finishEdit: button == this._submitButton\n            });\n        }\n        if ([\n            this._byUsersButton,\n            this._byRolesButton\n        ].include(button)) {\n            if (this.isChanged()) {\n                this._showWarning();\n                e.stopPropagation();\n            } else {\n                this._hideWarning();\n                this.viewBy = button.viewType;\n                repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE, {\n                    uri: uri,\n                    type: this.viewBy\n                });\n            }\n        }\n        [this._cancelButton].include(button) && this.hide();\n    }\n});\nResourcePermissions.addMethod('_showWarning', function () {\n    jQuery(this._dom).find(this.BODY_PATTERN).addClass(layoutModule.ERROR_CLASS);\n});\nResourcePermissions.addMethod('_hideWarning', function () {\n    jQuery(this._dom).find(this.BODY_PATTERN).removeClass(layoutModule.ERROR_CLASS);\n});\nResourcePermissions.addMethod('_launcherClickHandler', function (e) {\n    var element = e.element();\n    if (!this._waiting) {\n        var launcher = matchAny(element, [this.NAME_PATTERN], true);\n        if (launcher) {\n            var li = jQuery(element).parent('li');\n            if (li && li.listItem) {\n                var value = li.listItem.getValue();\n                value.navigateToManager();\n            }\n        }\n    }\n    e.preventDefault();\n    e.stopPropagation();\n});\nResourcePermissions.addMethod('_selectChangeHandler', function (e) {\n    var element = e.target;\n    e.stopPropagation();\n    if (this._waiting) {\n        return;\n    }\n    if (element.tagName.toLowerCase() == 'select') {\n        var newPermission = element.options[element.selectedIndex].value;\n        var li = jQuery(element).parents('li')[0];\n        if (li && li.listItem) {\n            var value = li.listItem.getValue();\n            li.listItem.getValue().permission.newPermission = newPermission != value.permission.getResolvedPermission() ? newPermission : undefined;\n            li.listItem.refresh();\n        }\n    }\n    if (this.isChanged()) {\n        jQuery(this._byUsersButton).removeClass(layoutModule.BUTTON_CLASS);\n        jQuery(this._byRolesButton).removeClass(layoutModule.BUTTON_CLASS);\n    } else {\n        jQuery(this._byUsersButton).addClas(layoutModule.BUTTON_CLASS);\n        jQuery(this._byRolesButton).addClass(layoutModule.BUTTON_CLASS);\n    }\n});\nResourcePermissions.addMethod('_selectMouseOverHandler', function (e) {\n    var element = matchAny(e.target, [this.PERMISSIONS_PATTERN], true);\n    element && e.stopPropagation()  ;\n});\nResourcePermissions.addMethod('_initControls', function () {\n    this.list = new dynamicList.List(this._listId, {\n        listTemplateDomId: this.LIST_TEMPLATE_ID,\n        itemTemplateDomId: this.ITEM_TEMPLATE_ID\n    });\n    var container = jQuery('#' + this._listId).parents();\n    if (isSupportsTouch()) {\n        if (!this._touchController) {\n            this._touchController = new TouchController(jQuery('#' + this._listId)[0], jQuery('#' + this._listId).parents(), { forceLayout: true });\n        }\n    }\n    this._infiniteScroll = new InfiniteScroll({\n        id: container[0].identify(),\n        contentId: this._listId,\n        scroll: this._touchController || undefined\n    });\n    this._searchBox = new SearchBox({ id: this._searchBoxId });\n    var uri = this._resource.URIString;\n    this._infiniteScroll.onLoad = function () {\n        if (!this._waiting) {\n            repositorySearch.fire(repositorySearch.PermissionEvent.NEXT, {\n                text: this._searchBox.getText(),\n                uri: uri,\n                type: this.viewBy\n            });\n        }\n    }.bind(this);\n    this._searchBox.onSearch = function (text) {\n        if (!this._waiting) {\n            if (this.isChanged()) {\n                this._showWarning();\n            } else {\n                this._hideWarning();\n                repositorySearch.fire(repositorySearch.PermissionEvent.SEARCH, {\n                    text: text,\n                    uri: uri,\n                    type: this.viewBy\n                });\n            }\n        }\n    }.bind(this);\n});\nResourcePermissions.addMethod('show', function () {\n    if (!this._isVisible) {\n        document.body.insert(this._dom);\n        this._initControls();\n        this.list.setItems([]);\n        this.list.show();\n        orgModule.entityList._createEntityItem = this._createEntityItem;\n        this.viewBy = 'ROLE';\n        repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE, {\n            initialize: true,\n            uri: this._resource.URIString,\n            type: this.viewBy,\n            isFolder: this._resource.isFolder()\n        });\n        this._isVisible = true;\n        document.getElementById(this._listId).parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.style.height = '360px';\n        dialogs.popup.show(this._dom);\n        this._dom.observe('click', this._buttonClickHandler.bindAsEventListener(this));\n        if (isSupportsTouch()) {\n            this._viewByTabSet.observe('touchstart', this._buttonClickHandler.bindAsEventListener(this));\n        }\n        this._dom.observe('click', this._launcherClickHandler.bindAsEventListener(this));    // Change event not bubbled up in IE\n        //        this._dom.observe('change', this._selectChangeHandler.bindAsEventListener(this));\n        // Change event not bubbled up in IE\n        //        this._dom.observe('change', this._selectChangeHandler.bindAsEventListener(this));\n        this._dom.observe('mouseover', this._selectMouseOverHandler.bindAsEventListener(this));\n    }\n});\nResourcePermissions.addMethod('showAndWait', function () {\n    if (!this._isVisible) {\n        this._waiting = true;\n        this.show();\n        this._waitingItem = new dynamicList.ListItem({ templateDomId: this.WAIT_ITEM_TEMPLATE_ID });\n        this.list.addItems([this._waitingItem]);\n        this.list.refresh();\n        this.disable();\n    }\n});\nResourcePermissions.addMethod('stopWaiting', function () {\n    if (this._waiting) {\n        this._waiting = false;\n        this.list.removeItems([this._waitingItem]);\n        this.enable();\n    }\n});\nResourcePermissions.addMethod('hide', function () {\n    dialogs.popup.hide(this._dom);\n    this._dom.remove();\n    this._dom.stopObserving('click');\n    this._dom.stopObserving('change');\n    this._dom.stopObserving('mouseover');\n    if (isSupportsTouch()) {\n        this._viewByTabSet.stopObserving('touchstart');\n    }\n    repositorySearch.dialogsPool.removePermissionsDialog(this._resource);\n});\nResourcePermissions.addMethod('enable', function () {\n    this._searchBox.enable();\n    buttonManager.enable(this._byUsersButton);\n    buttonManager.enable(this._byRolesButton);\n});\nResourcePermissions.addMethod('disable', function () {\n    this._searchBox.disable();\n    buttonManager.disable(this._byUsersButton);\n    buttonManager.disable(this._byRolesButton);\n});\nResourcePermissions.addMethod('_createItem', function (value) {\n    var item = new dynamicList.ListItem({\n        label: value.getDisplayName(),\n        value: value\n    });\n    var nameTooltipSelector = this.NAME_TOOLTIP_PATTERN;\n    var nameSelector = this.NAME_PATTERN;\n    var permissionsSelector = this.PERMISSIONS_PATTERN;\n    var template = this.TOOLTIP_TEMPLATE_DOM_ID;\n    var _this = this;\n    item.processTemplate = function (element) {\n        var nameTooltip = jQuery(element).find(nameTooltipSelector)[0];\n        var name = jQuery(element).find(nameSelector)[0];\n        var permissions = jQuery(element).find(permissionsSelector)[0];\n        var permission = this.getValue().permission;\n        var tenantId = this.getValue().tenantId;\n        if (permission.newPermission) {\n            jQuery(name).addClass(layoutModule.EMPHASIS_CLASS);\n        } else {\n            jQuery(name).removeClass(layoutModule.EMPHASIS_CLASS);\n        }\n        name.update(xssUtil.hardEscape(this.getValue().getDisplayName()));\n        if (tenantId && tenantId.length > 0) {\n            new JSTooltip(nameTooltip, {\n                text: xssUtil.hardEscape(tenantId),\n                templateId: template\n            });\n            var origRemove = element.remove;\n            element.remove = function () {\n                tooltipModule.hideJSTooltip(nameTooltip);\n                tooltipModule.cleanUp();\n                origRemove.apply(this);\n            };\n        }\n        permissions.update('');\n        var index = 0, permissionsConfig = repositorySearch.model.getConfiguration().permissions;\n        permissionsConfig = _.uniq(permissionsConfig, false, function (p) {\n            return p.labelId;\n        });\n        for (var i = 0; i < permissionsConfig.length; i++) {\n            if (permissionsConfig[i].name === 'REAL_READ_WRITE_DELETE') {\n                permissionsConfig[i].name = \"READ_WRITE_DELETE\";\n            }\n            var label = repositorySearch.getMessage(permissionsConfig[i].labelId);\n            var option = new Element('option', { value: permissionsConfig[i].name });\n            permissions.insert(option.update(permission.inheritedPermission == permissionsConfig[i].name ? xssUtil.hardEscape(label + ' *') : xssUtil.hardEscape(label)));\n            if (permission.newPermission) {\n                permission.newPermission == permissionsConfig[i].name && (index = i);\n            } else {\n                permission.getResolvedPermission() == permissionsConfig[i].name && (index = i);\n            }\n        }\n        permissions.observe('change', _this._selectChangeHandler.bindAsEventListener(_this));\n        permissions.selectedIndex = index;\n        if (this.getValue().permission.isDisabled) {\n            jQuery(permissions).attr('disabled', 'disabled');\n        }\n        return element;\n    };\n    return item;\n});\nResourcePermissions.addMethod('addEntities', function (entities) {\n    var items = entities.collect(this._createItem.bind(this));\n    this.list.addItems(items);\n    this.list.refresh();\n    this._infiniteScroll.stopWaiting();\n});\nResourcePermissions.addMethod('resetList', function (listId) {\n    // removes stdNav(508c) behavior for permissions list\n    // to correct a firefox-only issue with select elements in permissions list\n    // see http://jira.jaspersoft.com/browse/JRS-8471\n    var listUl = jQuery('#' + listId);\n    jQuery(listUl).find('[js-nonmodal-tabindex]').removeAttr('js-nonmodal-tabindex');\n    jQuery(listUl).find('[js-navtype]').attr('js-navtype', false);\n    jQuery(listUl).find('[tabindex]').removeAttr('tabindex');\n});\nResourcePermissions.addMethod('scrollReset', function () {\n    var listId = this._listId;\n    var resetList = this.resetList;\n    var scrollBody = jQuery('#' + this._listContainerId).find('.content').find('.body');\n    scrollBody.on('scroll', _.debounce(function () {\n        resetList(listId);\n    }, 100));\n});\nResourcePermissions.addMethod('setEntities', function (entities) {\n    this.list.setItems([]);\n    this._touchController && this._touchController.reset();\n    this.addEntities(entities);\n    this.resetList(this._listId);\n    this.scrollReset();\n});\nResourcePermissions.addMethod('getChangedEntities', function () {\n    var items = this.list.getItems();\n    var changed = [];\n    items.each(function (item) {\n        var value = item.getValue();\n        if (value.permission && value.permission.newPermission) {\n            changed.push(value);\n        }\n    });\n    return changed;\n});\nResourcePermissions.addMethod('updateEntities', function (entities) {\n    var items = this.list.getItems();\n    items.each(function (item) {\n        var value = item.getValue();\n        var updated = entities.detect(function (entity) {\n            return entity.equals(value);\n        });\n        if (updated) {\n            item.setValue(updated);\n            item.refresh();\n        }\n    });\n});\nResourcePermissions.addMethod('isChanged', function () {\n    return this.getChangedEntities().length > 0;\n});    /////////////////////////////////////////////////////////////////\n// Poll with all properties and permissions dialogs.\n// Use this pool object to create instances of those dialogs.\n/////////////////////////////////////////////////////////////////\n/////////////////////////////////////////////////////////////////\n// Poll with all properties and permissions dialogs.\n// Use this pool object to create instances of those dialogs.\n/////////////////////////////////////////////////////////////////\nrepositorySearch.dialogsPool = {\n    POOL_NOT_FOUND_EXCEPTION: 'PoolNotFoundException',\n    DIALOD_EXIST_EXCEPTION: 'DialodExistException',\n    NULL_RESOURCE_EXCEPTION: 'NullResourceException',\n    _permissionsDialogPool: {},\n    _propertiesDialogPool: {},\n    _getPool: function (clazz) {\n        var pool;\n        clazz == ResourcePermissions && (pool = this._permissionsDialogPool);\n        clazz == ResourceProperties && (pool = this._propertiesDialogPool);\n        if (pool) {\n            return pool;\n        } else {\n            throw {\n                name: this.POOL_NOT_FOUND_EXCEPTION,\n                message: 'Can\\'t find pool for ' + clazz.toString()\n            };\n        }\n    },\n    _createDialog: function (clazz, resource, options) {\n        var uri = resource.URIString;\n        var pool = this._getPool(clazz);\n        if (resource == null) {\n            throw {\n                name: this.NULL_RESOURCE_EXCEPTION,\n                message: 'Resource is null.'\n            };\n        }\n        if (!pool[uri]) {\n            pool[uri] = new clazz(resource, options);\n        } else {\n            throw {\n                name: this.DIALOD_EXIST_EXCEPTION,\n                message: clazz.toString() + ' dilaog for resource \\'' + uri + '\\' arleady exist.'\n            };\n        }\n        return pool[uri];\n    },\n    _createOrGetDialog: function (clazz, resource, options) {\n        try {\n            return this._createDialog(clazz, resource, options);\n        } catch (e) {\n            if (e.name == this.DIALOD_EXIST_EXCEPTION) {\n                return this._getDialog(clazz, resource);\n            } else {\n                throw e;\n            }\n        }\n    },\n    _getDialog: function (clazz, resourceOrUri) {\n        var uri = Object.isString(resourceOrUri) ? resourceOrUri : resourceOrUri.URIString;\n        return this._getPool(clazz)[uri];\n    },\n    _getAllDialogs: function (clazz) {\n        var pool = this._getPool(clazz), dialogs = [];\n        for (var uri in pool) {\n            pool[uri] && dialogs.push(pool[uri]);\n        }\n        return dialogs;\n    },\n    _removeDialog: function (clazz, resourceOrUri) {\n        var uri = Object.isString(resourceOrUri) ? resourceOrUri : resourceOrUri.URIString;\n        this._getPool(clazz)[uri] = undefined;\n    },\n    createPermissionsDialog: function (resource) {\n        return this._createDialog(ResourcePermissions, resource);\n    },\n    createPropertiesDialog: function (resource) {\n        return this._createDialog(ResourceProperties, resource);\n    },\n    createOrGetPermissionsDialog: function (resource) {\n        return this._createOrGetDialog(ResourcePermissions, resource);\n    },\n    createOrGetPropertiesDialog: function (resource, options) {\n        return this._createOrGetDialog(ResourceProperties, resource, options);\n    },\n    getAllPermissionsDialogs: function () {\n        return this._getAllDialogs(ResourcePermissions);\n    },\n    getAllPropertiesDialogs: function () {\n        return this._getAllDialogs(ResourceProperties);\n    },\n    getPermissionsDialog: function (resourceOrUri) {\n        return this._getDialog(ResourcePermissions, resourceOrUri);\n    },\n    getPropertiesDialog: function (resourceOrUri) {\n        return this._getDialog(ResourceProperties, resourceOrUri);\n    },\n    removePermissionsDialog: function (resourceOrUri) {\n        return this._removeDialog(ResourcePermissions, resourceOrUri);\n    },\n    removePropertiesDialog: function (resourceOrUri) {\n        return this._removeDialog(ResourceProperties, resourceOrUri);\n    }\n};    /////////////////////////////////\n// Repository properties dialog\n/////////////////////////////////\n/////////////////////////////////\n// Repository properties dialog\n/////////////////////////////////\nvar ResourceProperties = function (resource, options) {\n    this._resource = resource;\n    this._changedCallback = options.changedCallback;\n    this._showMode = options.showMode;\n    this._processTemplate();\n};\nResourceProperties.addVar('TEMPLATE_DOM_ID', 'propertiesResource');\nResourceProperties.addMethod('_processTemplate', function () {\n    this._dom = jQuery('#' + this.TEMPLATE_DOM_ID).clone(true)[0];;\n    jQuery(this._dom).attr('id', null);\n    jQuery(this._dom).addClass('_activeResourcePropertiesDialog');\n    var title = jQuery(this._dom).find('.title')[0];\n    title.update(jQuery(title).html().strip() + ': ' + xssUtil.hardEscape(this._resource.label).truncate(50));\n    this._label = this._updateValueAndLabel(this._dom, 'input#displayName', this._resource.label, 'label[for=\"displayName\"]');\n    this._description = this._updateContentAndLabel(this._dom, 'textarea#description', xssUtil.hardEscape(this._resource.description), 'label[for=\"description\"]');\n    this._path = this._updateValueAndLabel(this._dom, 'input#path', xssUtil.hardEscape(this._resource.URIString), 'label[for=\"path\"]');\n    if (this._showMode) {\n        jQuery(this._dom).addClass('showMode');\n        jQuery(this._label).attr('readonly', 'readonly');\n        jQuery(this._description).attr('readonly', 'readonly');\n    }\n    this._updateValueAndLabel(this._dom, 'div#resourceID', xssUtil.hardEscape(this._resource.name), 'label[for=\"resourceID\"]');\n    this._updateValueAndLabel(this._dom, 'input#type', xssUtil.hardEscape(this._resource.type), 'label[for=\"type\"]');\n    this._updateValueAndLabel(this._dom, 'input#createdDate', xssUtil.hardEscape(this._resource.date), 'label[for=\"createdDate\"]');\n    this._updateValueAndLabel(this._dom, 'input#userAccess', xssUtil.hardEscape(this._resource.permissionsToString()), 'label[for=\"userAccess\"]');\n    this._submitButton = jQuery(this._dom).find('button.submit')[0];\n    this._cancelButton = jQuery(this._dom).find('button.cancel')[0];\n    this._okButton = jQuery(this._dom).find('button.ok')[0];\n});\nResourceProperties.addMethod('_updateValueAndLabel', function (element, veSelector, value, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    jQuery(valueElement).attr('id', null);\n    jQuery(valueElement).attr('value', value);\n    valueElement.setValue ? valueElement.setValue(value) : valueElement.update(value);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourceProperties.addMethod('_updateContentAndLabel', function (element, veSelector, content, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    jQuery(valueElement).attr('id', null);\n    valueElement.update(content);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourceProperties.addMethod('_buttonClickHandler', function (e) {\n    var button = matchAny(e.target, [layoutModule.BUTTON_PATTERN], true);\n    if (button == this._submitButton) {\n        if (this._showMode) {\n            this._hide();\n        } else {\n            if (this._isDataValid()) {\n                if (this._changedCallback) {\n                    var resource = this._resource.clone();\n                    resource.label = this._label.getValue();\n                    resource.description = this._description.getValue();\n                    this._changedCallback(resource);\n                }\n                this._hide();\n            }\n        }\n    } else if (button == this._cancelButton || button == this._okButton) {\n        this._hide();\n    }\n});\nResourceProperties.addMethod('_isDataValid', function (e) {\n    return ValidationModule.validate([\n        {\n            validator: ResourcesUtils.labelValidator,\n            element: this._label\n        },\n        {\n            validator: ResourcesUtils.descriptionValidator,\n            element: this._description\n        }\n    ]);\n});\nResourceProperties.addMethod('show', function (options) {\n    document.body.insert(this._dom);\n    if (options && options.cascade) {\n        dialogs.popup.show(this._dom, false, options);\n    } else {\n        dialogs.popup.show(this._dom);\n    }\n    this._dom.observe('click', this._buttonClickHandler.bindAsEventListener(this));\n});\nResourceProperties.addMethod('_hide', function () {\n    dialogs.popup.hide(this._dom);\n    this._dom.remove();\n    this._dom.stopObserving('click');\n    repositorySearch.dialogsPool.removePropertiesDialog(this._resource);\n});\nResourceProperties.addMethod('isChanged', function () {\n    return this._resource.label != this._label.getValue() || this._resource.description != this._description.getValue();\n});\nrepositorySearch.showCreateFolderConfirm = function (folder) {\n    var toFolder;\n    var dialog = jQuery('#addFolder')[0], name = jQuery('#addFolderInputName')[0], description = jQuery('#addFolderInputDescription')[0], add = jQuery('#addFolderBtnAdd')[0], cancel = jQuery('#addFolderBtnCancel')[0];\n    var doShow = function (folder) {\n        toFolder = folder;\n        dialogs.popup.show(dialog);\n        name.setValue(repositorySearch.messages['action.create.folder.name']);\n        accessibilityModule.disable();\n        setTimeout(function () {\n            name.focus();\n            name.select();\n        }, 500);\n    };\n    var doHide = function (event) {\n        name.clear();\n        description.clear();\n        ValidationModule.hideError(name);\n        ValidationModule.hideError(description);\n        dialogs.popup.hide(dialog);\n        accessibilityModule.enable();\n        event.stopPropagation();\n    };\n    var doValidate = function () {\n        var isValid = ValidationModule.validate([\n            {\n                validator: ResourcesUtils.labelValidator,\n                element: name\n            },\n            {\n                validator: ResourcesUtils.descriptionValidator,\n                element: description\n            }\n        ]);\n        return isValid;\n    };\n    var doAdd = function (event) {\n        if (jQuery(add).attr('disabled') === 'disabled') {\n            return;\n        }\n        new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.CREATE, {\n            toFolder: toFolder,\n            label: name.getValue(),\n            desc: description.getValue()\n        }).invokeAction();\n        doHide(event);\n    };\n    add.observe('click', function (event) {\n        if (doValidate()) {\n            doAdd(event);\n        }\n        event.stopPropagation();\n    });\n    cancel.observe('click', doHide);\n    repositorySearch.showCreateFolderConfirm = doShow;\n    doShow(folder);\n};\nrepositorySearch.DeleteConfirmation = {\n    ID_DELETE_DIALOG_CONTAINER: 'standardConfirm',\n    ID_DELETE_DIALOG_OK_BUTTON: 'deleteResourceOK',\n    ID_DELETE_DIALOG_CANCEL_BUTTON: 'deleteResourceCancel'\n};\nrepositorySearch.showDeleteFolderConfirm = function (folder) {\n    var message = repositorySearch.getMessage('SEARCH_DELETE_FOLDER_CONFIRM_MSG', { folderUri: folder.URI });\n    var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.DELETE, { folder: folder });\n    repositorySearch._showDeleteDialog(message, action);\n};\nrepositorySearch.showDeleteResourceConfirm = function (resource) {\n    var message = repositorySearch.getMessage('SEARCH_DELETE_CONFIRM_MSG', { resourceUri: resource.URIString });\n    var action = new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE, { resources: [resource] });\n    repositorySearch._showDeleteDialog(message, action);\n};\nrepositorySearch.showBulkDeleteResourcesConfirm = function (resources) {\n    var message = repositorySearch.getMessage('SEARCH_BULK_DELETE_CONFIRM_MSG', { count: resources.length });\n    var action = new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE, { resources: resources });\n    repositorySearch._showDeleteDialog(message, action);\n};\nrepositorySearch._showDeleteDialog = function (message, action) {\n    var confirmElement = jQuery('#' + repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_CONTAINER);\n    confirmElement.find('.body').html(xssUtil.hardEscape(message));\n    dialogs.popupConfirm.show(confirmElement, true, {\n        okButtonSelector: '#' + repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_OK_BUTTON,\n        cancelButtonSelector: '#' + repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_CANCEL_BUTTON\n    });\n    jQuery('#' + repositorySearch.DeleteConfirmation.ID_DELETE_DIALOG_OK_BUTTON).on('click', function () {\n        action.invokeAction();\n    });\n};\nrepositorySearch.showResourceProperties = function (resource, options) {\n    var resourceProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(resource, { showMode: true });\n    resourceProperties.show(options);\n};\nrepositorySearch.editResourceProperties = function (resource, options) {\n    var resourceProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(resource, {\n        changedCallback: function (resource) {\n            var action = new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.UPDATE, { resource: resource });\n            action.invokeAction();\n        }\n    });\n    resourceProperties.show(options);\n};\nrepositorySearch.showFolderProperties = function (folder) {\n    var folderProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(folder, { showMode: true });\n    folderProperties.show();\n};\nrepositorySearch.editFolderProperties = function (folder) {\n    var folderProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(folder, {\n        changedCallback: function (folder) {\n            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.UPDATE, { folder: folder });\n            action.invokeAction();\n        }\n    });\n    folderProperties.show();\n};\nrepositorySearch.addToFavorite = function (resources, itemHovered) {\n    const resourceSelectedElement = jQuery(this._container).find('.resources.selected'),\n        selectedElem = itemHovered? itemHovered : resourceSelectedElement;\n    let url = __jrsConfigs__.contextPath + '/rest_v2/favorites';\n    const selectedResourceList = ResourcesUtils.getSelectedResourceUris(resources);\n    const isItemMarkedAsFav = resources.every((resource)=>{\n        return resource.isFavorite;\n    });\n    if ( !isItemMarkedAsFav ) {\n        repositorySearch.onFavoriteItem(url, selectedResourceList).then(()=>{\n            selectedElem.addClass(layoutModule.FAVORITE_CLASS);\n            repositorySearch.setFavorite(resources);\n        });\n    } else {\n        url = url+ '/delete';\n        repositorySearch.onFavoriteItem(url, selectedResourceList).then(()=>{\n            selectedElem.removeClass(layoutModule.FAVORITE_CLASS);\n            repositorySearch.setFavorite(resources);\n        });\n    }\n};\n\nrepositorySearch.setFavorite = function(resources){\n    resources.forEach((resource)=>{\n        resource.isFavorite = ! resource.isFavorite\n    });\n};\nrepositorySearch.editResourcePermissions = function (resource) {\n    var dialog = repositorySearch.dialogsPool.createOrGetPermissionsDialog(resource);\n    dialog.showAndWait();\n};\nrepositorySearch.editFolderPermissions = function (folder) {\n    var dialog = repositorySearch.dialogsPool.createOrGetPermissionsDialog(folder);\n    dialog.showAndWait();\n};\nrepositorySearch.showUploadThemeConfirm = function (folder, reupload) {\n    var toFolder;\n    var isReupload;\n    var dialog = jQuery('#uploadTheme')[0], themeName =jQuery('#themeName')[0], zip = jQuery('#themeZip')[0], upload = jQuery('#uploadThemeBtnUpload')[0], cancel = jQuery('#uploadThemeBtnCancel')[0];\n    var doShow = function (folder, reupload) {\n        toFolder = folder;\n        isReupload = reupload;\n        dialogs.popup.show(dialog);\n        themeName.removeAttribute('disabled');\n        themeName.setValue(repositorySearch.messages['RM_NEW_THEME_NAME']);\n        if (isReupload) {\n            jQuery(themeName).attr('disabled');\n            themeName.setValue(toFolder.name);\n        }\n        themeName.select();\n        themeName.focus();\n    };\n    var doHide = function (event) {\n        themeName.clear();\n        zip.clear();\n        dialogs.popup.hide(dialog);\n        event.stopPropagation();\n    };\n    var doValidate = function () {\n        var isValid = ValidationModule.validate([\n            {\n                validator: ResourcesUtils.labelValidator,\n                element: themeName\n            },\n            {\n                validator: ResourcesUtils.zipFileTypeValidator,\n                element: zip\n            }\n        ]);\n        return isValid;\n    };\n    var doUpload = function (event) {\n        var options = {};\n        options.themeName = themeName.getValue();\n        options._eventId = 'uploadTheme';\n        options._flowExecutionKey = repositorySearch.flowExecutionKey;\n        options.folderUri = toFolder.URI;\n        options.folderUri = toFolder.URI;\n\n        if (isReupload) {\n            var basicURI = toFolder.URI;\n            options.folderUri = basicURI.slice(0, basicURI.lastIndexOf('/'));\n            options.reuploadAction = isReupload;\n            options._eventId = 'reuploadTheme';\n        }\n        var callback = function (responseBody) {\n            var respObj;    //zip var should be refreshed to point to correct file input\n            //zip var should be refreshed to point to correct file input\n            zip = jQuery('#themeZip')[0];\n            if (responseBody) {\n                try {\n                    respObj = responseBody.evalJSON();\n                    if (respObj && respObj.status == 'OK') {\n                        if (respObj.data.themeExist) {\n                            var msg = repositorySearch.messages[\"SEARCH_OVERWRITE_THEME_CONFIRM_MSG\"];\n\n                            var dialog = new ConfirmationDialog({ text: msg} );\n                            dialog.on(\"button:yes\", function() {\n                                var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.REUPLOAD, options);\n                                action.invokeAction();\n                                dialog.remove();\n                            });\n\n                            dialog.on(\"button:no\", function(){\n                                dialog.remove();\n                            });\n                            dialog.open();\n                        } else if (respObj.data.isActiveTheme) {\n                            var uri = respObj.data.themeUri;\n                            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME, { folderUri: uri });\n                            action.invokeAction();\n                        }\n                    } else if (respObj && respObj.status == 'ERROR') {\n                        alert(respObj.data);\n                    } else {\n                        alert(repositorySearch.messages['RM_UPLOAD_THEME_ERROR']);\n                    }\n                } catch (ex) {\n                    alert(ex);\n                }\n            }    //for all cases, except active theme re-uploade (for this action handler of \"theme:updated\" event will reload window)\n            //for all cases, except active theme re-uploade (for this action handler of \"theme:updated\" event will reload window)\n            if (!isReupload || !respObj.data.isActiveTheme) {\n                repositorySearch.foldersPanel.refreshFolder(toFolder);\n            }\n        };\n\n        fileSender.upload(zip, 'searchFlow', options, callback);\n        doHide(event);\n    };\n    upload.observe('click', function (event) {\n        if (doValidate()) {\n            doUpload(event);\n        }\n        event.stopPropagation();\n    });\n    cancel.observe('click', doHide);\n    repositorySearch.showUploadThemeConfirm = doShow;\n    doShow(folder, reupload);\n};\n\nexport default repositorySearch;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport repositorySearchActions from './repository.search.actions';\nimport repositorySearchComponents from './repository.search.components';\nimport {repositorySearch} from './repository.search.main';\n\nlet repositorySearchRoot = Object.assign(repositorySearch, repositorySearchActions, repositorySearchComponents);\n\n// expose to global scope\nwindow.repositorySearch = repositorySearchRoot;\n\nexport default repositorySearchRoot;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\nimport dialogs from './components.dialogs';\nimport _ from 'underscore';\nimport layoutModule from '../core/core.layout';\nimport {dynamicList} from './list.base';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport jQuery from 'jquery';\n\ndialogs.dependentResources = {\n    dependenciesPanel: null,\n\n    show: function(resources, actionsMap, options) {\n        this.dependenciesPanel = jQuery(\"#dependencies\");\n        this._$title = this.dependenciesPanel.find(\".content .header .title\");\n        if(options.dialogTitle) {\n            this._titleBackup = this._$title.html();\n            this._$title.html(options.dialogTitle);\n        }\n        dialogs.popup.show(this.dependenciesPanel[0]);\n\n        this._changeMessage(options);\n        this._switchButtons(options);\n        var list =\n            this._initList(resources);\n\n        ///////////////////////////////////////////////////////////\n        // Observe buttons\n        //////////////////////////////////////////////////////////\n        this.dependenciesPanel.on(\"click\", function(event){\n            var buttonId = jQuery(event.target).closest('button').attr('id');\n            var action = actionsMap && actionsMap[buttonId];\n            if (_.include([\"dependenciesBtnSave\", \"dependenciesBtnSaveAs\", \"dependenciesBtnOk\", \"dependenciesBtnCancel\"], buttonId)) {\n                dialogs.dependentResources.hide();\n                list.setItems([]);\n\n                event.stopPropagation();\n\n                action && action();\n            }\n        });\n        //        designerBase.enableSelection();\n    },\n\n    hide: function () {\n        if (this.dependenciesPanel) {\n            this.dependenciesPanel.off(\"click\");\n            dialogs.popup.hide(this.dependenciesPanel[0]);\n            this.dependenciesPanel = null;\n        }\n        if (this._titleBackup && this._$title) {\n            this._$title.html(this._titleBackup);\n            this._titleBackup = null;\n        }\n    },\n\n    /**\n     * Show message\n     *\n     * @param canSave\n     * @private\n     */\n    _changeMessage: function(options) {\n        jQuery(\"#topMessage\").html(options.topMessage);\n        jQuery(\"#bottomMessage\").html(options.bottomMessage);\n    },\n\n    _initList: function(resources) {\n        var list = new dynamicList.List(\"dependenciesList\", {\n            listTemplateDomId: \"tabular_oneColumn\",\n            itemTemplateDomId: \"tabular_oneColumn:leaf\"\n        });\n\n        var items = [];\n        if(resources) {\n            items = resources.collect(function(resource) {\n                var resourceItem = new dynamicList.ListItem({\n                    cssClassName: layoutModule.LEAF_CLASS,\n                    value: resource\n                });\n\n                resourceItem.processTemplate = function(element) {\n                    var uriElement = jQuery(element).find(\".uri\");\n                    var uri;\n                    if(typeof this.getValue() == \"string\") {\n                        uri = this.getValue();\n                    } else if(this.getValue().uristring) {\n                        uri = this.getValue().uristring;\n                    } else {\n                        uri = this.getValue().URIString;\n                    }\n\n                    uriElement.html(xssUtil.hardEscape(uri));\n                    return element;\n                };\n                return resourceItem;\n            });\n        }\n\n        list.setItems(items);\n        list.show();\n\n        return list;\n    },\n\n    _switchButtons: function(options) {\n        var $buttonElements = {\n            save:  jQuery(\"#dependenciesBtnSave\"),\n            saveAs: jQuery(\"#dependenciesBtnSaveAs\"),\n            ok: jQuery(\"#dependenciesBtnOk\"),\n            cancel: jQuery(\"#dependenciesBtnCancel\")\n        };\n\n        var buttons;\n        if(options.buttons) {\n            buttons = options.buttons;\n        } else {\n            if(options.okOnly) {\n                buttons = [\"ok\"];\n            } else if (options.canSave) {\n                buttons = [\"save\", \"saveAs\", \"cancel\"];\n            } else {\n                buttons = [\"ok\", \"cancel\"];\n            }\n        }\n\n        _.each($buttonElements, function($button, key) {\n            if(buttons.indexOf(key) < 0 ) {\n                $button.addClass(\"hidden\");\n            } else {\n                $button.removeClass(\"hidden\");\n            }\n        });\n\n    }\n};\n\nexport default dialogs.dependentResources;","/*\n * Copyright (C) 2005 - 2019 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport repositorySearch from '../repository/repository.search.root';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport {dynamicList} from '../components/list.base';\nimport _ from 'underscore';\n\nimport 'backbone';\n\nimport '../components/components.dependent.dialog';\nimport '../components/components.toolbarButtons.events';\nimport '../components/components.tooltip';\n\nimport '../util/tools.infiniteScroll';\nimport '../manage/mng.common';\n\n_.extend(repositorySearch.messages, jrsConfigs.repositorySearch.i18n);\n_.extend(dynamicList.messages, jrsConfigs.dynamicList.i18n);\n_.extend(window.localContext, jrsConfigs.repositorySearch.localContext);\nrepositorySearch.initialize(window.localContext);\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n// This settings store will be filled with the actual settings loaded from the server\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {doNothing, isSupportsTouch, isIPad} from \"./utils.common\";\nimport jQuery from 'jquery';\n\nvar InfiniteScroll = function (options) {\n    this._id = options.id;\n    this._contentId = options.contentId ? options.contentId : undefined;\n    this._scroll = options.scroll;\n    this._loadFactor = options.loadFactor ? options.loadFactor : 0.95;\n    this._lastContentHeight = 0;\n    this._loading = false;    // getting control from 'id' of jquery object or from DOM element\n    // getting control from 'id' of jquery object or from DOM element\n    if (options.control) {\n        if (options.control.length !== undefined && options.control.length > 1) {\n            this._control = jQuery(options.control[0]);\n        } else {\n            this._control = jQuery(options.control)[0];\n        }\n    } else {\n        this._control = this._scroll ? this._scroll.parent : jQuery('#' + this._id)[0];\n    }\n    if (this._scroll) {\n        this._content = this._scroll.element;\n    } else {\n        // getting content from 'id' of jquery object or from DOM element\n        if (options.content) {\n            if (options.content.length !== undefined && options.content.length > 1) {\n                this._content = jQuery(options.content[0]);\n            } else {\n                this._content = jQuery(options.content)[0];\n            }\n        } else {\n            this._content = this._contentId ? jQuery('#' + this._contentId)[0] : this._control.childElements()[0];\n        }\n    }\n    this._eventType = isSupportsTouch() ? 'touchmove' : 'scroll';\n    this._control.observe(this._eventType, this._onScrollHandler.bind(this));\n};\n/**\n\t * Destroys the infinite scroll.\n\t */\nInfiniteScroll.addMethod('destroy', function () {\n    if (this._control) {\n        this._control.stopObserving(this._eventType, this._handler);\n    }\n});    /**\n\t * Handler for scroll event on the control element.\n\t */\n/**\n\t * Handler for scroll event on the control element.\n\t */\nInfiniteScroll.addMethod('_onScrollHandler', function (e) {\n    var controlScrollTop = this._scroll ? this._scroll.y * -1 : this._control.scrollTop;\n    var contentHeight = this._content.getHeight();\n    var controlHeight = this._control.getHeight();\n    if (contentHeight != this._lastContentHeight) {\n        this._loading = false;\n    }\n    var allowLoad = !this._loading && contentHeight != 0;\n    if (this._scroll) {\n        allowLoad = allowLoad && this._scroll.isBottom();\n    } else {\n        allowLoad = allowLoad && (controlHeight + controlScrollTop) / contentHeight > this._loadFactor;\n    }\n    if (allowLoad) {\n        this._loading = true;\n        this._lastContentHeight = contentHeight;\n        isIPad() && this.wait();\n        this.onLoad();\n    }\n});    /**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\n/**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\nInfiniteScroll.addMethod('onLoad', doNothing);    /**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\n/**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\nInfiniteScroll.addMethod('reset', function () {\n    isIPad() ? this._scroll.reset() : this._control.scrollTop = 0;\n    this._loading = false;\n});\nInfiniteScroll.addMethod('wait', function () {\n    if (!this._waitIndicator) {\n        this._waitIndicator = new Element('div', { 'class': 'dimmer resultsOverlay' });\n        var dimensions = this._control.getDimensions();\n        var offsets = this._control.positionedOffset();\n        this._waitIndicator.setStyle({\n            zIndex: '4000',\n            top: offsets.top + 'px',\n            left: offsets.left + 'px',\n            height: dimensions.height + 'px',\n            width: dimensions.width + 'px'\n        });\n        this._control.insert({ after: this._waitIndicator });\n    }\n    this._waitIndicator.show();\n});\nInfiniteScroll.addMethod('stopWaiting', function () {\n    this._waitIndicator && this._waitIndicator.hide();\n});    // TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\n// TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\nwindow.InfiniteScroll = InfiniteScroll;\nexport default InfiniteScroll;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Validation from 'backbone-validation';\nimport _ from 'underscore';\nimport NumberUtils from '../util/parse/NumberUtils';\n\nvar numberUtils = new NumberUtils();\nvar originalValidate = Validation.mixin.validate;\n\nValidation.mixin.validate = function (attrs, options) {\n    options || (options = {});\n    var self = this;\n    return originalValidate.call(this, attrs, _.extend({\n        valid: function (view, attr) {\n            self.trigger('validate:' + attr, self, attr);\n        },\n        invalid: function (view, attr, error) {\n            self.trigger('validate:' + attr, self, attr, error);\n        }\n    }, options));\n};\n_.extend(Validation.validators, {\n    doesNotContainSymbols: function (value, attr, forbiddenSymbols) {\n        if (new RegExp('[' + forbiddenSymbols + ']', 'g').test(value)) {\n            return 'Attribute \\'' + attr + '\\' contains forbidden symbols';\n        }\n    },\n    integerNumber: function (value) {\n        if (!numberUtils.isNumberInt(value)) {\n            return 'Value is not a valid integer number';\n        }\n    },\n    type: function (value, attr, types) {\n        function typeFn(type) {\n            var fn;\n            if ('string' == type) {\n                fn = _.isString;\n            } else if ('number' === type) {\n                fn = _.isNumber;\n            } else if ('object' === type) {\n                fn = _.isObject;\n            } else if ('boolean' === type) {\n                fn = _.isBoolean;\n            } else if ('null' === type) {\n                fn = _.isNull;\n            } else if ('undefined' === type) {\n                fn = _.isUndefined;\n            }\n            return fn;\n        }\n        if (!_.isArray(types)) {\n            types = [types];\n        }\n        var isValueOneOfTypes = types.some(function (type) {\n            return typeFn(type)(value);\n        });\n        if (!isValueOneOfTypes) {\n            return '\\'{attr}\\' is not {type}'.replace('{attr}', attr).replace('\\'{type}\\'', types.join(' '));\n        }\n    },\n    url: function (value) {\n        if (!/(http|https):\\/\\/.*\\..*./.test(value)) {\n            return 'Value is not a valid url';\n        }\n    },\n    hexColor: function (value) {\n        if (!/^#[0-9a-f]{3,6}$/i.test(value)) {\n            return 'Value is not a valid hex color';\n        }\n    },\n    xRegExpPattern: function (value, attr, customValue, model) {\n        if (!customValue.test(value)) {\n            return 'Value does not match pattern';\n        }\n    },\n    startsWithLetter: function (value, attr, customValue, model) {\n        if (!value.substr(0, 1).match(/[A-Za-z]/)) {\n            return 'Value should start with letter';\n        }\n    },\n    containsOnlyWordCharacters: function (value, attr, customValue, model) {\n        if (value.search(/\\W/) >= 0) {\n            return 'Value should contain only word characters (letters, digits and underscore)';\n        }\n    },\n    arrayMinLength: function (value, attr, minLength, model) {\n        if (_.isArray(value) && value.length < minLength) {\n            return 'Array length is less than ' + minLength;\n        }\n    }\n});\nexport default Validation;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nif (typeof window.CustomEvent !== \"function\") {\n    // JRS-20985: For IE11 we have to polyfill CustomEvent\n\n    function CustomEvent(event, params) {\n        params = params || {bubbles: false, cancelable: false, detail: undefined};\n\n        var evt = document.createEvent('CustomEvent');\n\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n\n        return evt;\n    }\n\n    CustomEvent.prototype = window.Event.prototype;\n\n    window.CustomEvent = CustomEvent;\n}","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {\n    100: 'continue',\n    101: 'switchingProtocols',\n    200: 'ok',\n    201: 'created',\n    202: 'accepted',\n    203: 'nonAuthoritativeInformation',\n    204: 'noContent',\n    205: 'resetContent',\n    206: 'partialContent',\n    300: 'multipleChoices',\n    301: 'movedPermanently',\n    302: 'found',\n    303: 'seeOther',\n    304: 'notModified',\n    305: 'useProxy',\n    307: 'temporaryRedirect',\n    400: 'badRequest',\n    401: 'unauthorized',\n    402: 'paymentRequired',\n    403: 'forbidden',\n    404: 'notFound',\n    405: 'methodNotAllowed',\n    406: 'notAcceptable',\n    407: 'proxyAuthenticationRequired',\n    408: 'requestTimeout',\n    409: 'conflict',\n    410: 'gone',\n    411: 'lengthRequired',\n    412: 'preconditionFailed',\n    413: 'requestEntityTooLarge',\n    414: 'requestUriTooLong',\n    415: 'unsupportedMediaType',\n    416: 'requestedRangeNotSatisfiable',\n    417: 'expectationFailed',\n    500: 'internalServerError',\n    501: 'notImplemented',\n    502: 'badGateway',\n    503: 'serviceUnavailable',\n    504: 'gatewayTimeout',\n    505: 'httpVersionNotSupported'\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {\n    UNEXPECTED_ERROR: 'unexpected.error',\n    INVALID_RESOURCE_TYPE: 'invalid.resource.type',\n    ACCESS_DENIED: 'access.denied'\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Backbone from 'backbone';\nimport httpStatusCodes from '../enum/httpStatusCodes';\nimport errors from '../enum/errorCodes';\nvar BaseModel = Backbone.Model.extend({\n    initialize: function () {\n        this.on('error', BaseModel.unifyServerErrors);\n    },\n    serialize: function () {\n        return _.clone(this.attributes);\n    }\n}, {\n    unifyServerErrors: function (model, xhr) {\n        var errorStatus = httpStatusCodes[xhr.status], errorObj = BaseModel.createServerError(xhr);\n        model.trigger('error:' + errorStatus, model, errorObj, xhr);\n        model.trigger('error:all', model, errorObj, xhr);\n    },\n    createServerError: function (xhr) {\n        var error;\n        try {\n            error = JSON.parse(xhr.responseText);\n        } catch (e) {\n            error = {\n                message: 'Can\\'t parse server response',\n                errorCode: errors.UNEXPECTED_ERROR,\n                parameters: []\n            };\n        }\n        return error;\n    }\n});\nexport default BaseModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\n\nconst NumberUtils = function (options) {\n    options = options || {};\n    this.DECIMAL_SEPARATOR = options.decimalSeparator || '.';\n    this.GROUPING_SEPARATOR = options.groupingSeparator || ',';\n    function separatorSymbolToRegExpPattern(separator) {\n        if (separator === '.') {\n            separator = '\\\\.';\n        } else if (separator === ' ') {\n            separator = '\\\\s';\n        }\n        return separator;\n    }\n    this.decimalSeparator = separatorSymbolToRegExpPattern(this.DECIMAL_SEPARATOR);\n    this.groupingSeparator = separatorSymbolToRegExpPattern(this.GROUPING_SEPARATOR);\n\n    // http://regexlib.com/REDetails.aspx?regexp_id=196 with some changes\n    this.DECIMAL_NUMBER_PATTERN = new RegExp('^-?([1-9]{1}[0-9]{0,2}(' + this.groupingSeparator + '[0-9]{3})*(' + this.decimalSeparator + '[0-9]+)?|[1-9]{1}[0-9]{0,}(' + this.decimalSeparator + '[0-9]+)?|0(' + this.decimalSeparator + '[0-9]+)?)$');\n    this.INTEGER_NUMBER_PATTERN = new RegExp('^-?([1-9]{1}[0-9]{0,2}(' + this.groupingSeparator + '[0-9]{3})*|[1-9]{1}[0-9]{0,}|0)$');\n};\nconst MIN_INT32 = -2147483648;\nconst MAX_INT32 = 2147483647;\nconst MAX_INT = Number.MAX_SAFE_INTEGER ? Number.MAX_SAFE_INTEGER+1 : 9007199254740992;\nconst MIN_INT = Number.MIN_SAFE_INTEGER ? Number.MIN_SAFE_INTEGER-1 : -9007199254740992;\n\n/*\n     Copyright (c) 2013 Kevin van Zonneveld (http://kvz.io)\n     and Contributors (http://phpjs.org/authors)\n\n     Permission is hereby granted, free of charge, to any person obtaining a copy of\n     this software and associated documentation files (the \"Software\"), to deal in\n     the Software without restriction, including without limitation the rights to\n     use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\n     of the Software, and to permit persons to whom the Software is furnished to do\n     so, subject to the following conditions:\n\n     The above copyright notice and this permission notice shall be included in all\n     copies or substantial portions of the Software.\n\n     THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n     IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n     FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n     AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n     LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n     OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n     SOFTWARE.\n     */\n\nNumberUtils.prototype.number_format = function (number, decimals, dec_point, thousands_sep) {\n    //  discuss at: http://phpjs.org/functions/number_format/\n    // original by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)\n    // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // improved by: davook\n    // improved by: Brett Zamir (http://brett-zamir.me)\n    // improved by: Brett Zamir (http://brett-zamir.me)\n    // improved by: Theriault\n    // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // bugfixed by: Michael White (http://getsprink.com)\n    // bugfixed by: Benjamin Lupton\n    // bugfixed by: Allan Jensen (http://www.winternet.no)\n    // bugfixed by: Howard Yeend\n    // bugfixed by: Diogo Resende\n    // bugfixed by: Rival\n    // bugfixed by: Brett Zamir (http://brett-zamir.me)\n    //  revised by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)\n    //  revised by: Luke Smith (http://lucassmith.name)\n    //    input by: Kheang Hok Chin (http://www.distantia.ca/)\n    //    input by: Jay Klehr\n    //    input by: Amir Habibi (http://www.residence-mixte.com/)\n    //    input by: Amirouche\n    //   example 1: number_format(1234.56);\n    //   returns 1: '1,235'\n    //   example 2: number_format(1234.56, 2, ',', ' ');\n    //   returns 2: '1 234,56'\n    //   example 3: number_format(1234.5678, 2, '.', '');\n    //   returns 3: '1234.57'\n    //   example 4: number_format(67, 2, ',', '.');\n    //   returns 4: '67,00'\n    //   example 5: number_format(1000);\n    //   returns 5: '1,000'\n    //   example 6: number_format(67.311, 2);\n    //   returns 6: '67.31'\n    //   example 7: number_format(1000.55, 1);\n    //   returns 7: '1,000.6'\n    //   example 8: number_format(67000, 5, ',', '.');\n    //   returns 8: '67.000,00000'\n    //   example 9: number_format(0.9, 0);\n    //   returns 9: '1'\n    //  example 10: number_format('1.20', 2);\n    //  returns 10: '1.20'\n    //  example 11: number_format('1.20', 4);\n    //  returns 11: '1.2000'\n    //  example 12: number_format('1.2000', 3);\n    //  returns 12: '1.200'\n    //  example 13: number_format('1 000,50', 2, '.', ' ');\n    //  returns 13: '100 050.00'\n    //  example 14: number_format(1e-8, 8, '.', '');\n    //  returns 14: '0.00000001'\n\n    number = (number + '').replace(/[^0-9+\\-Ee.]/g, '');\n    const n = !isFinite(+number) ? 0 : +number,\n        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),\n        sep = typeof thousands_sep === 'undefined' ? ',' : thousands_sep,\n        dec = typeof dec_point === 'undefined' ? '.' : dec_point,\n        toFixedFix = function (num, absValue) {\n            const k = Math.pow(10, absValue);\n            return '' + (Math.round(num * k) / k).toFixed(absValue);\n        };\n\n    let result = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');\n    if (result[0].length > 3) {\n        result[0] = result[0].replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, sep);\n    }\n    if ((result[1] || '').length < prec) {\n        result[1] = result[1] || '';\n        result[1] += new Array(prec - result[1].length + 1).join('0');\n    }\n    return result.join(dec);\n};\nNumberUtils.prototype.isInt = function (value) {\n    return this.isNumberInt(value) || this.isStringInt(value);\n};\n\n// http://stackoverflow.com/a/3885844\nNumberUtils.prototype.isNumberInt = function (value) {\n    return _.isNumber(value) && !isNaN(value) && value !== Number.POSITIVE_INFINITY && value !== Number.NEGATIVE_INFINITY && (value === +value && value === (value | 0) || value % 1 === 0);\n};\nNumberUtils.prototype.isStringInt = function (value) {\n    return _.isString(value) && this.INTEGER_NUMBER_PATTERN.test(value);\n};\n\n/**\n     * We don't use this validator, since back-end maps Long, bigint fields to Integer filters.\n     * So isInt should be used to validate Long and bigint filters\n     * @param value\n     * @returns {*|boolean}\n     */\n\nNumberUtils.prototype.isInt32 = function (value) {\n    return this.isInt(value) && this.parseNumber(value) >= MIN_INT32 && this.parseNumber(value) <= MAX_INT32;\n};\nNumberUtils.prototype.isDecimal = function (value) {\n    return _.isNumber(value) && !isNaN(value) && value !== Number.POSITIVE_INFINITY && value !== Number.NEGATIVE_INFINITY || _.isString(value) && this.DECIMAL_NUMBER_PATTERN.test(value);\n};\nNumberUtils.prototype.parseNumber = function (value) {\n    if (_.isNumber(value)) {\n        return value;\n    } else if (_.isString(value) && this.DECIMAL_NUMBER_PATTERN.test(value)) {\n        value = value.replace(new RegExp(this.groupingSeparator, 'g'), '').replace(new RegExp(this.decimalSeparator, 'g'), '.');\n        var result = value * 1;\n        if (result >= MAX_INT || result <= MIN_INT) {\n            if (window.console) {\n                window.console.warn(value + ' is out of the [' + (MIN_INT+1)   + ', ' + (MAX_INT-1) + '] bounds. ' + 'Parsing results may be corrupted. Use string representation instead. ' + 'For more details see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number.');\n            }\n            return false;\n        }\n        return result;\n    }\n    return undefined;\n};\nNumberUtils.prototype.formatNumber = function (val, options) {\n    options = options || {};\n    const decimalNumStr = val.toString().split('.')[1];\n\n    let decimalPlacesAmount = decimalNumStr ? decimalNumStr.length : 0;\n    if (!_.isUndefined(options.decimalPlacesAmount)) {\n        decimalPlacesAmount = options.decimalPlacesAmount;\n    }\n\n    try {\n        return this.number_format(\n            val,\n            decimalPlacesAmount,\n            options.decimalSeparator || this.DECIMAL_SEPARATOR,\n            options.groupingSeparator || this.GROUPING_SEPARATOR\n        );\n    } catch (ex) {\n        return val.toString();\n    }\n};\nNumberUtils.prototype.MaxRange = Number.MAX_SAFE_INTEGER ? Number.MAX_SAFE_INTEGER+1 : 9007199254740992;\nNumberUtils.prototype.MinRange = Number.MIN_SAFE_INTEGER ? Number.MIN_SAFE_INTEGER-1 : -9007199254740992;\n\nexport default NumberUtils;\n"],"sourceRoot":""}