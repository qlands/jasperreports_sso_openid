(self.webpackChunkjrs_ui=self.webpackChunkjrs_ui||[]).push([[1049,4277,4613,2602],{41049:(e,t,r)=>{"use strict";r.r(t);var i=r(97836),o=r.n(i),n=r(71914),a=r(17620),s=r(72157),l=r.n(s),c=r(32758),d={CONTENT_REPOSITORY:"CONTENT_REPOSITORY",LOCAL:"LOCAL",NONE:"NONE",FILE_SYSTEM:"FILE_SYSTEM",LOCATE_EVENT:"resource:locate",ALLOWED_FILE_RESOURCE_EXTENSIONS:["css","ttf","jpg","jpeg","gif","bmp","png","jar","jrxml","properties","jrtx","xml","agxml","docx","doc","ppt","pptx","xls","xlsx","ods","odt","odp","pdf","rtf","html"],initialize:function(e){var t=function(e){return o().isObject(e)?e:l()("#"+e)[0]};this.resourceUri=t(e.resourceInput),this.browseButton=t(e.browseButton),this.filePath=t(e.fileUploadInput),this.fakeFilePath=t(e.fakeFileUploadInput),this.fakeFileInput=t(e.fakeFileUploadInputText),this.newResourceLink=t(e.newResourceLink);try{this._initFileSelector(e)}catch(e){}finally{this._initEvents(e)}return this},_initEvents:function(e){l()(document).on("click","#CONTENT_REPOSITORY, #FILE_SYSTEM, #NONE, #LOCAL",this._clickHandler),"fileResourceTreeDataProvider"===e.providerId&&(l()("#next").on("click",d._nextClickHandler),l()("#filePath").on("change",d._uploadChangeHandler))},_nextClickHandler:function(e){l()("#fileUpload").hasClass("error")&&e.preventDefault()},_uploadChangeHandler:function(e){l()("#fileUpload").removeClass("error");var t=!0;if(l()("#filePath")[0].value){var r=l()("#filePath")[0].value.match(/.*\.([^\.]+)$/);if(r){var i=r[1];o().indexOf(d.ALLOWED_FILE_RESOURCE_EXTENSIONS,i)<0&&(t=!1)}else t=!1}else t=!1;if(!t){var n=a.Z.messages["resource.report.unsupportedFileType.error"]+" "+d.ALLOWED_FILE_RESOURCE_EXTENSIONS.join(", ");l()("#fileUpload").addClass("error").find("span.warning").html(n)}},_clickHandler:function(e){d._updateResourceSelectorState(e.target.id)},_updateResourceSelectorState:function(e){a.Z.switchButtonState(this.filePath,e===this.FILE_SYSTEM),a.Z.switchButtonState(this.fakeFilePath,e===this.FILE_SYSTEM),a.Z.switchButtonState(this.fakeFileInput,e===this.FILE_SYSTEM),a.Z.switchButtonState(this.browseButton,e===this.CONTENT_REPOSITORY),a.Z.switchDisableState(this.resourceUri,e!==this.CONTENT_REPOSITORY);var t=e===this.LOCAL?["disabled","launcher"]:[];this._switchElementClasses(this.newResourceLink,t)},_initFileSelector:function(e){this.fileSelector=new c.Z.FileSelector(o().extend({},e,{uriTextboxId:this.resourceUri,browseButtonId:this.browseButton,title:e.dialogTitle}))},remove:function(e){this.fileSelector.remove()},_switchElementClasses:function(e,t){e&&t&&l()(e).removeClass(t[0]).addClass(t[1])}};const u=d;var _=r(64155);const p={SET_UP_PAGE_ID:"addReport_SetUp",LABEL_ID:"label",RESOURCE_ID_ID:"resourceID",DESCRIPTION_ID:"reportUnit\\.description",FILE_PATH_ID:"filePath",RESOURCE_URI_ID:"resourceUri",FILE_SYSTEM_SOURCE_ID:"FILE_SYSTEM",CONTENT_REPOSITORY_SOURCE_ID:"CONTENT_REPOSITORY",RESOURCE_NAME_ID:"resourceName",EDIT_RESOURCE_BUTTON_ID:"editResourceButton",REMOVE_RESOURCE_BUTTON_ID:"removeResourceButton",ADD_RESOURCE_BUTTON_ID:"addResourceButton",EDIT_CONTROL_BUTTON_ID:"editControlButton",REMOVE_CONTROL_BUTTON_ID:"removeControlButton",ADD_CONTROL_BUTTON_ID:"addControlButton",FILE_NAME_ID:"fileName",FILE_UPLOAD_BUTTON_ID:"fake_upload_button",SAVE_BUTTON_ID:"done",JRXML_FILE_PATH_COOKIE:"jrxmlFilePath",_canGenerateId:!0,initialize:function(e){this._setUpPage=l()("#"+this.SET_UP_PAGE_ID)[0],this._setUpPage&&(this._form=l()(document.body).find("form")[0],this._label=l()("#"+this.LABEL_ID)[0],this._resourceId=l()("#"+this.RESOURCE_ID_ID)[0],this._description=l()("#"+this.DESCRIPTION_ID)[0],this._filePath=l()("#"+this.FILE_PATH_ID)[0],this._resourceUri=l()("#"+this.RESOURCE_URI_ID)[0],this._fileName=l()("#"+this.FILE_NAME_ID)[0],this._fileSystemSource=l()("#"+this.FILE_SYSTEM_SOURCE_ID)[0],this._contentRepositorySource=l()("#"+this.CONTENT_REPOSITORY_SOURCE_ID)[0],this._saveButton=l()("#"+this.SAVE_BUTTON_ID),this._isEditMode=!!e&&e.isEditMode,this._initialSource=this._fileSystemSource.checked?this._fileSystemSource:this._contentRepositorySource,this._jrxmlFileResourceAlreadyUploaded=e.jrxmlFileResourceAlreadyUploaded,this._label.validator=a.Z.labelValidator.bind(this),this._resourceId.validator=a.Z.resourceIdValidator.bind(this),this._description.validator=a.Z.descriptionValidator.bind(this),this._filePath.validator=this._filePathValidator.bind(this),this._resourceUri.validator=this._resourceUriValidator.bind(this),this._initEvents(),this._adjustFileSelectorPosition(),this._fileName.value=this._jrxmlFileResourceAlreadyUploaded);var t={fileUploadInput:"filePath",fakeFileUploadInput:"fake_upload_button",fakeFileUploadInputText:"fileName",resourceInput:"resourceUri",browseButton:"browser_button",uploadButton:"upload_button",treeId:"resourceTreeRepoLocation",dialogTitle:a.Z.messages["resource.Report.Title"],selectLeavesOnly:!0};e&&l()("#"+t.browseButton)[0]&&("fileResource"==e.type?t.providerId="fileResourceTreeDataProvider":"jrxml"==e.type?t.providerId="jrxmlTreeDataProvider":"olapMondrianSchema"==e.type?t.providerId="olapSchemaTreeDataProvider":"folder"==e.type&&(t.treeId="addFileTreeRepoLocation",t.providerId="repositoryExplorerTreeFoldersProvider",t.resourceInput="folderUri"),u.initialize(t),u._updateResourceSelectorState(l()("input[type=radio]:checked").attr("id")))},_initEvents:function(){var e=this;l()("#"+this.FILE_UPLOAD_BUTTON_ID).click((function(t){t.preventDefault(),l()("#"+e.FILE_PATH_ID).trigger("click")})),this._saveButton.on("click",(function(t){e._isDataValid()||t.preventDefault()})),l()(this._form).on("keyup",(function(t){var r=t.target;[e._label,e._resourceId,e._description].include(r)&&(_.n4K.validate(a.Z.getValidationEntries([r])),r==e._resourceId&&e._resourceId.getValue()!=a.Z.generateResourceId(e._label.getValue())&&(e._canGenerateId=!1),r==e._label&&!e._isEditMode&&e._canGenerateId&&(e._resourceId.setValue(a.Z.generateResourceId(e._label.getValue())),_.n4K.validate(a.Z.getValidationEntries([e._resourceId]))))})),this._filePath.observe("change",(function(){(0,_.w1q)()?-1!=this.value.toLowerCase().indexOf("c:\\fakepath\\")?e._fileName.value=this.value.substring("c:\\fakepath\\".length,this.value.length):e._fileName.value=this.value:e._fileName.value=this.files[0].name,l()("#fileUpload").removeClass("error"),e._adjustFileSelectorPosition()}))},_isDataValid:function(){var e=[this._label,this._resourceId,this._description,this._filePath,this._resourceUri];return(0,_.w1q)()?this.file=this._filePath.value:this.file=this._filePath.files[0],this.html=l()(this._filePath).html(),_.n4K.validate(a.Z.getValidationEntries(e))},_filePathValidator:function(e){var t=!0,r="";return!this._fileSystemSource.checked||!e.blank()||this._isEditMode&&this._initialSource==this._fileSystemSource||this._jrxmlFileResourceAlreadyUploaded||(r=a.Z.messages.filePathIsEmpty,t=!1),t?_.n4K.hideError(l()("#fileName")[0]):_.n4K.showError(l()("#fileName")[0],r),{isValid:t,errorMessage:r}},_resourceUriValidator:function(e){var t=!0,r="";return this._contentRepositorySource.checked&&e.blank()&&(r=a.Z.messages.resourceUriIsEmpty,t=!1),{isValid:t,errorMessage:r}},_adjustFileSelectorPosition:function(){var e=l()("#filePath");if((0,_.Isx)()||(0,_.UBd)()||(0,_.D8Z)()||(0,_.UnL)()){var t=20;e.parents("label").hasClass("error")&&(t+=13),e.css({opacity:"0",position:"absolute",right:0,top:t,width:95,height:30})}else e.css({position:"fixed",right:"-1000px",top:"-1000px"})},editResource:function(e){l()("#"+this.RESOURCE_NAME_ID)[0].setValue(e),l()("#"+this.EDIT_RESOURCE_BUTTON_ID)[0].click()},removeResource:function(e){l()("#"+this.RESOURCE_NAME_ID)[0].setValue(e),l()("#"+this.REMOVE_RESOURCE_BUTTON_ID)[0].click()},addResource:function(){l()("#"+this.ADD_RESOURCE_BUTTON_ID)[0].click()},editControl:function(e){l()("#"+this.RESOURCE_NAME_ID)[0].setValue(e),l()("#"+this.EDIT_CONTROL_BUTTON_ID)[0].click()},removeControl:function(e){l()("#"+this.RESOURCE_NAME_ID)[0].setValue(e),l()("#"+this.REMOVE_CONTROL_BUTTON_ID)[0].click()},addControl:function(){l()("#"+this.ADD_CONTROL_BUTTON_ID)[0].click()}};var h,f,E=r(94277);E.MP.components.templateEngine=(h=l(),f=o(),{render:function(e,t,r){if(!r)return f.template(e)(t);if(r==this.STD_PLACEHOLDERS){var i=String(e);return f.each(t,(function(e,t){var r=new RegExp("\\{"+t+"\\}");i=i.replace(r,e)})),i}},renderUrl:function(e,t,r){var i=f.template(e)(t);return r&&(i=encodeURI(i)),i},getTemplateText:function(e){return h("#"+e).html()},createTemplate:function(e){var t=h("#"+e).html();if(t&&t.length>0)return function(e){return f.template(t)(e)}},createTemplateFromText:function(e){if(e&&e.length>0)return function(t){return f.template(e)(t)}},createTemplateSection:function(e,t){var r="\x3c!--#val--\x3e(\\s|\\S)*\x3c!--/val--\x3e".replace(/val/g,e),i=new RegExp(r,"g"),o=this.getTemplateText(t).match(i)[0];return function(e){return f.template(o)(e)}},STD_PLACEHOLDERS:"std_placeholder"});const R=E.MP.components.templateEngine;o().extend(a.Z.messages,n.Z.addJasperReport.resource.messages),p.initialize(),(0,_.zcy)()&&a.Z.initSwipeScroll();var T,I,m,S,O=l()(l()("#resources ul")[0]);T=O,I=n.Z.addJasperReport.nonSuggestedResources,m=n.Z.addJasperReport.canChangeResources,S=R.getTemplateText("addJasperReportNonSuggestedResourceTemplate"),o().each(I,(function(e){var t=l()(R.render(S,e));m&&(t.find("a.emphasis").on("click",(function(){return p.editResource(e.name),!1})),t.find("a.launcher").on("click",(function(){return p.removeResource(e.name),!1}))),T.append(t)})),function(e,t){var r=R.getTemplateText("addJasperReportSuggestedResourceTemplate");o().each(t,(function(t){var i=l()(R.render(r,o().defaults({},t,{fileType:""})));i.find("a.emphasis").on("click",(function(){return p.editResource(t.name),!1})),t.located||i.find("a.launcher").on("click",(function(){return p.editResource(t.name),!1})),e.append(i)}))}(O,n.Z.addJasperReport.suggestedResources),function(e,t){var r=R.getTemplateText("addJasperReportAddResourceTemplate"),i=l()(R.render(r,t));i.find("a.launcher").on("click",(function(){return p.addResource(),!1})),e.append(i)}(O,{canChangeResources:n.Z.addJasperReport.canChangeResources});var v=l()(l()("#controls ul")[0]);!function(e,t,r){var i=R.getTemplateText("addJasperReportNonSuggestedControlTemplate");o().each(t,(function(t){var o=l()(R.render(i,t));r&&(o.find("a.emphasis").on("click",(function(){return t.local?p.editControl(t.name):p.editControl(t.referenceURI),!1})),o.find("a.launcher").on("click",(function(){return t.local?p.removeControl(t.name):p.removeControl(t.referenceURI),!1}))),e.append(o)}))}(v,n.Z.addJasperReport.nonSuggestedControls,n.Z.addJasperReport.canChangeResources),function(e,t){var r=R.getTemplateText("addJasperReportSuggestedControlTemplate");o().each(t,(function(t){var i=l()(R.render(r,t));i.find("a.emphasis").on("click",(function(){return p.editControl(t.name),!1})),t.located&&i.find("a.launcher").on("click",(function(){return p.removeControl(t.name),!1})),e.append(i)}))}(v,n.Z.addJasperReport.suggestedControls),function(e,t){var r=R.getTemplateText("addJasperReportAddControlTemplate"),i=l()(R.render(r,t));i.find("a.launcher").on("click",(function(){return p.addControl(),!1})),e.append(i)}(v,{canChangeResources:n.Z.addJasperReport.canChangeResources})},94277:(e,t,r)=>{"use strict";r.d(t,{MP:()=>a,hl:()=>i,YT:()=>n});var i={vars:{element_scrolled:!1,ajax_in_progress:!1,current_flow:null,contextPath:__jrsConfigs__.contextPath},i18n:{}};if(void 0===o)var o=!1;function n(){return __jrsConfigs__.isProVersion}var a={components:{},i18n:{}};void 0===i&&(i={Mocks:{}}),void 0===i.vars&&(i.vars={element_scrolled:!1,ajax_in_progress:!1,current_flow:null}),void 0===i.Export&&(i.Export={i18n:{"file.name.empty":"export.file.name.empty","file.name.too.long":"export.file.name.too.long","file.name.not.valid":"export.file.name.not.valid","export.select.users":"export.select.users","export.select.roles":"export.select.roles","export.session.expired":"export.session.expired","error.timeout":"export.file.name.empty"},configs:{TIMEOUT:12e5,DELAY:3e3}}),void 0===window.localContext&&(window.localContext={}),__jrsConfigs__.calendar&&(i.i18n.bundledCalendarFormat=__jrsConfigs__.calendar.i18n.bundledCalendarFormat,i.i18n.bundledCalendarTimeFormat=__jrsConfigs__.calendar.i18n.bundledCalendarTimeFormat),window.JRS=i,window.jaspersoft=a,window.isProVersion=n}}]);
//# sourceMappingURL=chunk.1049.js.map